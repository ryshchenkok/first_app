!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=17)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.getWindow=function(){return window},e.getDocument=function(){return window.document},e.getParentWithClass=function(e,t){for(;e&&!this.hasClass(e,t);)e=e.parentNode;return e},e.hasClass=function(e,t){if(e.classList)return e.classList.contains(t);for(var n=e.className?e.className.split(" "):[],o=0;o<n.length;o++)if(n[o]===t)return!0;return!1},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.NotSet=0]="NotSet",e[e.Identity=10]="Identity"}(t.PIIType||(t.PIIType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=function(){function e(){}return e.Create=function(t,n,r){r||o.PIIType.NotSet;var i=new e;return i.key=t,i.value=n,i.type=r,i},e}();t.TelemetryPropertyValue=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),r=function(){function e(){}return e.combine=function(e,t){return e.lastIndexOf("/")!==e.length-1&&"/"!==t.substring(0,1)?e+"/"+t:SkypeWebControl.EcsConfig.appUri+e+t},e.getAbsoluteUrl=function(e,t){var n=this.getCompletePath(e,t),r="css"===t?"css/":"";return e===o.PackageName.SDK_LOADER_CHAT?this.combine(SkypeWebControl.EcsConfig.loaderUrl,n):e===o.PackageName.CONNECT?this.combine(SkypeWebControl.EcsConfig.loaderUrl,n):this.combine(r,n)},e.getCompletePath=function(e,t){var n="";switch(SkypeWebControl.EcsConfig.environment){case"df":case"prod":n=".min"}return""+e+n+"."+t},e.setQueryParameters=function(e,t){var n="";for(var o in t)n+=(n?"&":"?")+encodeURIComponent(o)+"="+encodeURIComponent(t[o]);return e+=n},e.getHost=function(){try{var e=window.location.hostname;return!e&&e.length>0?e:("file:"===window.location.protocol.toLowerCase()&&(e="local"),e)}catch(e){return null}},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(13),r=n(0),i=n(15),a=n(8),s=function(){function e(){function e(){o.fetchConfig({queryParams:{configOption:p.env},requestTypeOptions:{callbackName:"Skype.ECS.jsonpCallback"},deviceId:t()},function(e){p.ver&&p.ver.length>0&&s(SkypeWebControl.EcsConfig,p.ver),p.env&&(SkypeWebControl.EcsConfig.environment=p.env),p.ver&&(SkypeWebControl.EcsConfig.version=p.ver),SkypeWebControl.SDK||(SkypeWebControl.SDK={}),p.host&&(SkypeWebControl.SDK.host=p.host),n()},function(e){})}function t(){var e=a.LocalStorage.getItem("swc-deviceId");return e||(e=i.default.createNew(),a.LocalStorage.setItem("swc-deviceId",e)),e}function n(){var e=r.default.getDocument(),t=e.createElement("script");t.type="text/javascript",t.src=SkypeWebControl.EcsConfig.loaderUrl,e.body.appendChild(t)}function s(e,t){var n=/\d+.\d+.[^\D]\d+/g;for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];if(!r.replace)continue;r=r.replace(n,t),e[o]=r}}function c(){var e=/((sdk\/(v\d+))|(\d+\.\d+\.\d+))\/sdk(.min)?.js/g;if(l)return l;for(var t=0;t<f.scripts.length;t++){var n=document.scripts[t];if(e.test(n.src))return l=n}return null}function u(){try{return window.location.hostname}catch(e){return null}}var l,f=window.document;this.start=e;var p=function(){return{ver:"",env:"prod",host:u()}}();window.SkypeWebControl.isManualBoot=function(){var e=c();return"true"===(e?e.getAttribute("data-manual-boot")||"false":"false").toLowerCase()}(),function(){return"true"===(c()?c().getAttribute("data-init")||"false":"false").toLowerCase()}()||e()}return e}();window.SkypeWebControl=window.SkypeWebControl||{},window.SkypeWebControl.SDK=window.SkypeWebControl.SDK||new s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(16),r=function(){function e(){this.sessionId="",this.host="N/A",this.style="",this.correlationId="N/A",this.translatorEnabled=!1,this.frameless=!1,this.callingReady=!1,this.standaloneCalling=!1,this.largeEmoticonClass=!1,this.isParallelView=!1,this.parentProtocol="n/a"}return Object.defineProperty(e,"get",{get:function(){return window.swc=window.swc||{},window.swc.shared=window.swc.shared||{},window.swc.shared.app||(window.swc.shared.app=new e),window.swc.shared.app},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentLocale",{get:function(){return o.default.locale},enumerable:!0,configurable:!0}),e.prototype.copy=function(t){t&&Object.getOwnPropertyNames(t).forEach(function(n){var o=Object.getOwnPropertyDescriptor(t,n);o&&o.writable&&(e[n]=o.value||e[n])})},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(11),i=function(){function e(){}return Object.defineProperty(e,"ECS",{get:function(){return SkypeWebControl.EcsConfig},set:function(e){window.SkypeWebControl=window.SkypeWebControl||{},window.SkypeWebControl.EcsConfig=e},enumerable:!0,configurable:!0}),e.getPlatformId=function(){if(e._platformID)return e._platformID;var t=o.default.getHost(),n={};n["outlook.live.com"]=915,n["outlook-sdf.live.com"]=915,n["interviews.skype.com"]=916,n["interviews-df.skype.com"]=916,n["interviews-int.skype.com"]=916,n["www.bing.com"]=917,n["www.staging-bing-int.com"]=917,n["www.bing-int.com"]=917,n["www.msn.com"]=918,n["int.msn.com"]=918,n["int1.msn.com"]=918,n["wtskype2.azurewebsites.net"]=919,n["azuresupportextension-ms.hosting.portal.azure.net"]=919,n["portal.azure.com"]=919,n["rc.portal.azure.com"]=919,n["ms.portal.azure.com"]=919;for(var r in n)if(n.hasOwnProperty(r)&&t.indexOf(r)>-1)return n[r];return 912},e.getClientVersion=function(){if(e.CLIENT_VERSION!==e.DEFAULT_CLIENT_VERSION)return e.CLIENT_VERSION;var t=e.ECS.version;return/^\d+\.\d+\.\d+$/.test(t)&&(t+=".0"),e.CLIENT_VERSION=e.PLATFORM_ID+"/"+t,e.CLIENT_VERSION},e.APPNAME="SWC",e.LOCALE="en-us",e.PES_LOCALE="en",e.ORIGIN="SkypeLWC",e.ORIGIN_CALLING="SkypeCalling",e.MSG_MAX_LENGTH=2e3,e.SKYPE_TOKEN_KEY=r.SKYPE_TOKEN_KEY,e.SKYPE_REGTOKEN_KEY=r.SKYPE_REGTOKEN_KEY,e.PLATFORM_ID=912,e.BUTTON_MARKER_CLASS=".skype-button",e.CHAT_MARKER_CLASS=".skype-chat",e.RECENTS_MARKER_CLASS=".skype-recents",e.CHAT_FRAME_MARKER_CLASS=".lwc-chat-frame",e.CALL_FRAME_MARKER_CLASS=".swc-call-frame",e.LOGIN_CLIENT_ID="919866",e.LOGIN_PAGE_URL="https://login.skype.com/login",e.LOGIN_THEME="skype-white",e.LOGOUT_PAGE_URL="https://login.skype.com/logout",e.LOGIN_POPUP_URL="https://demoplayground.skype.com/joinlwc?t=",e.LOGIN_POPUP_FEATURES="width=600, height=620, menubar=no, status=no, titlebar=no, toolbar=no",e.LOGOUT_POPUP_FEATURES="width=1, height=1, menubar=no, status=no, titlebar=no, toolbar=no",e.AMS_HOST_URL="https://api.asm.skype.com/v1/",e.APS_HOST_URL="https://api.aps.skype.com/v1/",e.CDN_SERVICE_HOST="secure.skypeassets.com",e.OA_URL="https://pro.skype.com/v1/onboarding",e.OA_URL_INT="https://havana-latest.skype.com/v1/onboarding",e.URLP_SERVICE_URL="https://urlp.asm.skype.com",e.SKYPE_GRAPH_URL="https://skypegraph.skype.com/",e.ECS_GRAPH_URL="https://skypegraph.skype.com/",e.ECS_GRAPH_ETAG=null,e.ECS_GRAPH_SERVICE_SETTINGS=null,e.INVITE_HOST_URL_INT="https://latest-join.skype.com/api/v1/",e.INVITE_HOST_URL="https://join.skype.com/api/v1/",e.CHAT_CLIENT_INFO="os=Windows; osVer=10; proc=Win32; lcid=en-us; deviceType=1; country=n/a; clientName=swc; clientVer=999/0.80.0.0/swc",e.CHAT_GUEST_HOST_URL="https://client-s.gateway.messenger.live.com/v1/",e.CHAT_HOST_URL="https://client-s.gateway.messenger.live.com/v1/",e.CHAT_JOIN_URL="https://latest-join.skype.com/api/v2/conversation",e.SKYPE_CALLER_ID="lwc",e.CONTACTS_HOST_URL="https://contacts.skype.com/contacts/v2/",e.AGENTS_HOST_URL="https://join.skype.com/",e.AVATAR_SERVICE_URL="https://avatar.skype.com/v1/",e.STRATUS_DOMAIN_HOST_URL_OLD="https://api.skype.com/",e.STRATUS_DOMAIN_HOST_URL="https://profile.skype.com/profile/v1/",e.WX_HOST_URL="https://wx-int.trafficmanager.net/api/v1/scom/",e.ECS_CLIENT_NAME="skype",e.ECS_TEAM_NAME="lwc",e.ECS_CLIENT_VERSION="1.00",e.DEFAULT_CLIENT_VERSION=e.getPlatformId()+"/0.0.0.0",e.CLIENT_VERSION=e.DEFAULT_CLIENT_VERSION,e.DEFAULT_AVATAR_URI="https://swc.cdn.skype.com/assets/img/defaultAvatar.png",e.WELCOME_IMG_URI="https://swc.cdn.skype.com/assets/img/welcome_add_2x.png",e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.DIRECTLINE_CHAT="directline-bundle",e.SDK_LOADER_CHAT="sdk-loader",e.SDK_CORE="sdk-core",e.ASSETS="assets-bundle",e.BUILDER="builder-bundle",e.BUILDER_CORE="builder-core",e.CALLING="calling-bundle",e.CALLING_STANDALONE="callingStandalone-bundle",e.SERVICES="services-bundle",e.CHAT_BUNDLE="chat-bundle",e.RECENTS_BUNDLE="recents-bundle",e.INDEX_BUILDER="index-builder",e.INDEX_CHAT="lwc-chat-index",e.INDEX_CALLING="calling-index",e.INDEX_RECENTS="recents-index",e.CONNECT="connect",e.HOST_CHAT_PAGE="host-chat",e.HOST_BING_PAGE="host-button",e.HOST_BUILDER_PAGE="host-builder",e.STYLE_BUILDER="swc-builder",e.STYLE_SDK="swc-sdk",e.STYLE_CHAT_SKYPE="swc-chat",e.STYLE_RECENTS_SKYPE="swc-recents",e.STYLE_CHAT_BING="swc-bing",e.STYLE_CHAT_THEME_DARK="swc-dark",e.STYLE_CALLING="swc-calling",e}();t.PackageName=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.getItem=function(e){return this.get().getItem(e)},e.setItem=function(e,t){this.get().setItem(e,t)},e.removeItem=function(e){this.get().removeItem(e)},e.get=function(){if(this._storage)return this._storage;try{"object"==typeof sessionStorage&&(localStorage.setItem("ls","0"),localStorage.removeItem("ls"),this._storage=window.sessionStorage)}catch(e){this._storage=new i}return this._storage},e}();t.default=o;var r=function(){function e(){}return e.getItem=function(e){return this.get().getItem(e)},e.setItem=function(e,t){this.get().setItem(e,t)},e.removeItem=function(e){this.get().removeItem(e)},e.get=function(){if(this._storage)return this._storage;try{"object"==typeof localStorage&&(localStorage.setItem("ls","0"),localStorage.removeItem("ls"),this._storage=window.localStorage)}catch(e){this._storage=new i}return this._storage},e}();t.LocalStorage=r;var i=function(){function e(){this._items={}}return Object.defineProperty(e.prototype,"length",{get:function(){return this._items.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._items.length=0},e.prototype.getItem=function(e){return this._items[e]},e.prototype.key=function(e){return null},e.prototype.removeItem=function(e){delete this._items[e]},e.prototype.setItem=function(e,t){this._items[e]=t},e}()},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),i=n(2),a=n(1),s=function(e){function t(){return e.call(this,"runtimeError")||this}return o(t,e),t.prototype.getCustomProperties=function(){var e=new Array;return e.push(i.TelemetryPropertyValue.Create("message",this.message)),e.push(i.TelemetryPropertyValue.Create("shortMessage",this.shortMessage)),e.push(i.TelemetryPropertyValue.Create("stack",this.stack)),e.push(i.TelemetryPropertyValue.Create("code",this.code)),e.push(this.getConversationId()),e},t.prototype.getConversationId=function(){return this.conversationId?0===this.conversationId.indexOf("8:")?i.TelemetryPropertyValue.Create("conversationId",this.conversationId,a.PIIType.Identity):i.TelemetryPropertyValue.Create("conversationId",this.conversationId):i.TelemetryPropertyValue.Create("conversationId",r.NA)},t}(r.TelemetryEvent);t.ErrorEvent=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),r=n(5),i=n(6),a=n(3);t.NA="n/a";var s=function(){function e(e){this.name=e,this.timestamp=Date.now(),this.type="general"}return e.prototype.getEventProperties=function(){this.version=o.TelemetryPropertyValue.Create("version",i.default.ECS.version),this.host=o.TelemetryPropertyValue.Create("host",this.gethost()),this.isFirstPartyIntegration=o.TelemetryPropertyValue.Create("isFirstParty",this.isFirstParty()),this.lang=o.TelemetryPropertyValue.Create("locale",r.default.get.currentLocale||t.NA),this.correlationId=this.correlationId||o.TelemetryPropertyValue.Create("correlationId",r.default.get.correlationId||t.NA),this.identityType=this.identityType||o.TelemetryPropertyValue.Create("identitytype",t.NA);var e=this.getCustomProperties();return e.forEach(function(e){void 0===e.value&&(e.value=t.NA)}),e},e.prototype.getProperty=function(e){return void 0===e||null===e?t.NA:"string"!=typeof e?e+"":e},e.prototype.gethost=function(){return r.default.get.host&&r.default.get.host.toLowerCase()!==t.NA.toLowerCase()?r.default.get.host:a.default.getHost()||t.NA},e.prototype.isFirstParty=function(){var e=new Array(".skype.com",".bing.com",".live.com",".office.com",".msn.com",".linkedin.com",".azure.com",".microsoft.com"),t=this.gethost();return e.some(function(e){return t.indexOf(e)>-1})},e}();t.TelemetryEvent=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SKYPE_TOKEN_KEY="skype|token",t.SKYPE_REGTOKEN_KEY="skype|registrationtoken"},function(e,t,n){"use strict";function o(e,t,n,o,i){function a(e){clearTimeout(p),n&&n(e)}function s(e){clearTimeout(p),o&&(o(new Error(e)),o=void 0,n=void 0)}function u(){s("timeout")}function f(){s("script.onerror invoked")}(t<=0||t>=Math.pow(2,31)||t!==(0|t))&&l.default.throwError(10040,"invalid timeout"),("string"!=typeof i.callbackName&&void 0!==i.callbackName||""===i.callbackName)&&l.default.throwError(10041,"if provided, jsonp callback name must be a non-empty string"),"boolean"!=typeof i.async&&void 0!==i.async&&l.default.throwError(10042,"if provided, async flag must be boolean");try{c(e+(/\?/.test(e)?"&":"?")+"callback="+r(a,i.callbackName),f,i.async)}catch(e){return void o(e,!0)}var p=setTimeout(u,t)}function r(e,t){var n=u.default.getWindow();return t?a(e,t,n):i(e,n)}function i(e,t){var n;do{n=(Math.random().toString(36)+"00000000000000000").slice(2,12)}while(n in t);return t[n]=e,n}function a(e,t,n){var o=t.split("."),r=s(o.slice(0,-1),n),i=o.pop();return i in r&&"function"!=typeof r[i]&&l.default.throwError(10060,"non-function property with supplied callback name already exists"),r[i]=e,t}function s(e,t){var n=t;return e.forEach(function(e){e in n?n[e]&&!Object.isExtensible(n[e])&&l.default.throwError(10061,"callback namespace already exists but is not an extensible type"):n[e]={},n=n[e]}),n}function c(e,t,n){var o=u.default.getDocument(),r=o.createElement("script");r.src=e,r.type="text/javascript",n?r.async=!0:r.defer=!0,r.onerror=t,o.getElementsByTagName("head")[0].appendChild(r)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(0),l=n(14);t.request=o},function(e,t,n){"use strict";function o(e,t,n){function o(e){var t=new Error(e);if(!n)throw t;n(t)}function a(t){N++,r.request(t,E,c,s,e.requestTypeOptions||{})}function s(e,t){if(N/I.length<v&&!t){if(N%I.length==0&&!A)return void(P=!0);N%I.length==0&&(A=!1,P=!1,k=setTimeout(l,w*Math.pow(w,N/I.length))),a(I[++O%I.length])}else y()||o("Configuration service is unreachable and no valid cached config is available: "+e.message)}function c(e){if(clearTimeout(k),P=!1,!L){var n=f(e);n&&(L=!0,u(n),d(n),t(n))}}function u(e){window.SkypeWebControl=window.SkypeWebControl||{};var t=JSON.stringify(e);SkypeWebControl.EcsConfig=JSON.parse(t)}function l(){clearTimeout(k),P&&!L?(P=!1,A=!1,k=setTimeout(l,w*Math.pow(C,N/I.length)),a(I[++O%I.length])):A=!0}function f(e){if("object"==typeof e)return e;try{return JSON.parse(e)}catch(e){return y()||o("Malformed response and no valid cached config for team is available"),null}}function p(){if(void 0===h){h=!1;try{if(b&&T&&T.localStorage){var e=T.localStorage.getItem(b)||"{}";T.localStorage.setItem(b,e),h=!0}}catch(e){}}return h}function d(e){if(p()){try{m()}catch(e){}try{T.localStorage.setItem(b,JSON.stringify(e))}catch(e){}}}function m(){for(var e in T.localStorage)e.indexOf("swx|")>-1&&T.localStorage.removeItem(e)}function y(){if(!p())return!1;var e;try{e=JSON.parse(T.localStorage.getItem(b))}catch(e){return!1}return!!e&&(t(e),!0)}var h,_=["https://a.config.skype.com","https://b.config.skype.com"],g=function(){var t=[],n=e.queryParams||{};return e.userId&&t.push("id="+encodeURIComponent(e.userId)),e.clientId&&t.push("clientId="+encodeURIComponent(e.clientId)),e.deviceId&&t.push("deviceId="+encodeURIComponent(e.deviceId)),Object.keys(n).sort().forEach(function(e){t.push([encodeURIComponent(e),encodeURIComponent(n[e])].join("="))}),0===t.length?"":"?"+t.join("&")}(),v=3,E=7500,w=500,C=1.2,S="skype/1.00/lwc"+g,I=_.map(function(e){return encodeURI(e)+"/config/v1/"+S}),b="lwc-ecs",T=i.default.getWindow(),O=Math.floor(Math.random()*I.length),N=0,L=!1;a(I[O]);var P,A,k=setTimeout(l,w)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),i=n(0);t.fetchConfig=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),r=function(){function e(){}return e.throwError=function(e,t,n,r){var i=new Error(function(){if(!n||0===Object.getOwnPropertyNames(n).length)return e+(t?": "+t:"");if("string"==typeof n)return n;var o="";return Object.getOwnPropertyNames(n).forEach(function(e){o+=e+": "+n[e]+";"}),o}()),a=new o.ErrorEvent;a.code=e+"",a.message=i.message,a.shortMessage=e+(t?": "+t:""),a.stack=i.stack,a.conversationId=r;try{window.SkypeWebControl.services.telemetryManager.sendEvent(a)}catch(e){}},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.createNew=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return Object.defineProperty(e,"locale",{get:function(){return this._locale?this._locale:document.documentElement.lang?document.documentElement.lang.toLowerCase():window.navigator.languages&&0!==window.navigator.languages.length?window.navigator.languages[0].toLowerCase():navigator.language.toLowerCase()},set:function(e){e=e||"",this._locale=e.toLowerCase()},enumerable:!0,configurable:!0}),e}();t.default=o},function(e,t,n){e.exports=n(4)}]);