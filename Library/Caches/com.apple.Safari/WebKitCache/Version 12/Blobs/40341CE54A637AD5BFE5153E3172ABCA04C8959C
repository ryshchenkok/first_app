qy.prototype.sj=fQ(91,function(){return U(this,2)});bI.prototype.sj=fQ(90,g("F"));oV.prototype.sj=fQ(89,function(){return U(this,1)});qV.prototype.sj=fQ(88,function(){return U(this,1)});tV.prototype.sj=fQ(87,function(){return U(this,2)});yV.prototype.sj=fQ(86,function(){return U(this,1)});JV.prototype.sj=fQ(85,function(){return U(this,1)});
KV.prototype.sj=fQ(84,function(a){var b=this;this.Zc.Rh=!0;var c=this.Zc.serialize(a);return new kf(function(a,e){LV(b,"/dbx/getExecutionStatus",c,function(c){b.Zc.Rh=!1;c=b.Zc.Bd(JV.Ca(),c.mf());a(c)},function(){e()})})});
function NNd(a,b){a.Zc.Rh=!0;var c=ql(a.Zc.serialize(b));return new kf(function(b,e){nt(kr($t(ot(lu(lr(a.C.qf("/dbx/createConnection"),"POST")),1).setTimeout(3E4),["data",c]),function(c){a.Zc.Rh=!1;c=a.Zc.Bd(mV.Ca(),c.mf());c.Nr()?e(c):b(c)}),function(){var a=new mV;W(a,1,!1);W(a,3,1);e(a)}).Oe()})}
function ONd(a,b){a.Zc.Rh=!0;var c=a.Zc.serialize(b);return new kf(function(b,e){LV(a,"/dbx/createQuery",c,function(c){a.Zc.Rh=!1;c=a.Zc.Bd(oV.Ca(),c.mf());3==c.sj().getState()?e(c):b(c)},function(){var a=new oV,b=new Tv;W(a,1,b);b.wb(3);W(b,2,1);e(a)})})}function PNd(a,b){a.Zc.Rh=!0;var c=ql(a.Zc.serialize(b));return new kf(function(b,e){nt(kr($t(ot(lu(lr(a.C.qf("/dbx/importConnection"),"POST")),1).setTimeout(3E4),["data",c]),function(){b()}),function(){e()}).Oe()})}
function QNd(a,b){a.Zc.Rh=!0;var c=a.Zc.serialize(b);return new kf(function(b,e){LV(a,"/dbx/previewQuery",c,function(c){a.Zc.Rh=!1;c=a.Zc.Bd(qV.Ca(),c.mf());3==c.sj().getState()?e(c):b(c)},function(){var a=new qV,b=new Tv;W(a,1,b);b.wb(3);W(b,2,1);e(a)})})}
function RNd(a,b){a.Zc.Rh=!0;var c=a.Zc.serialize(b);return new kf(function(d,e){LV(a,"/dbx/refreshSheets",c,function(b){a.Zc.Rh=!1;b=a.Zc.Bd(sV.Ca(),b.mf());Bu(b,1).some(function(a){return 3==a.sj().getState()})?e(b):d(b)},function(){var a=new sV,c=new Tv;c.wb(3);W(c,2,1);Bu(b,1).forEach(function(b){var d=new tV;W(d,1,b);W(d,2,c);zu(a,1,d)});e(a)})})}
function SNd(a,b){a.Zc.Rh=!0;var c=a.Zc.serialize(b);return new kf(function(b,e){LV(a,"/dbx/editQuery",c,function(c){a.Zc.Rh=!1;c=a.Zc.Bd(yV.Ca(),c.mf());3==c.sj().getState()?e(c):b(c)},function(){var a=new yV,b=new Tv;W(a,1,b);b.wb(3);W(b,2,1);e(a)})})}function TNd(a){return new kf(function(b,c){nt(kr(ot(lu(lr(a.C.qf("/dbx/listConnections"),"GET")),1).setTimeout(3E4),function(c){a.Zc.Rh=!1;c=a.Zc.Bd(YSc.Ca(),c.mf());b(c)}),c).Oe()})}
function UNd(a,b){a.Zc.Rh=!0;var c=ql(a.Zc.serialize(b));return new kf(function(b,e){nt(kr($t(ot(lu(lr(a.C.qf("/dbx/getQuery"),"POST")),1).setTimeout(3E4),["data",c]),function(c){a.Zc.Rh=!1;c=a.Zc.Bd(HV.Ca(),c.mf());U(c,1)?b(c):e("Query is not found")}),e).Oe()})}
function VNd(a,b){a.Zc.Rh=!0;var c=a.Zc.serialize(b);return new kf(function(b,e){LV(a,"/dbx/getBigQueryProjects",c,function(c){a.Zc.Rh=!1;c=a.Zc.Bd(EV.Ca(),c.mf());c.Nr()&&e(c);b(c)},function(){var a=new qV,b=new Tv;W(a,1,b);b.wb(3);W(b,2,1);e(a)})})}function WNd(a){Gf(this,a,0,-1,null,null)}v(WNd,Ff);function XNd(a,b,c){b=void 0===b?"":b;c=void 0===c?"dataconnector-querytype-raw":c;this.C=[];for(var d=0;d<a.length;d++)this.C.push(a[d].clone());this.F=b;this.D=c};function YNd(a){a=a.sJb;var b='<div class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-project-section")+'"><h3 class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-project-select-header")+'">';b=b+"Billing project"+('</h3><div class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-project-select-wrapper")+'"></div>'+(a?'<div class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-radio-group")+'"><div class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-raw-data-radio-wrapper")+
'"></div><div class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-pivot-table-radio-wrapper")+'"></div></div>':"")+"</div>");return P(b)}
function ZNd(){var a='<div class="'+Q("waffle-dataconnector-bigqueryquerysettingsdialog-continue-button-wrapper")+'"><p>';a=a+'Your use of BigQuery is governed by the Google Cloud Platform <a href="https://cloud.google.com/terms/" target="_blank">Terms of Service</a>.'+('</p></div><div class="'+Q("waffle-dataconnector-footer-sharing-message")+'">');return P(a+'<span>The data you query is visible to everyone with view access, but your query is only visible to people with edit access. <a href="https://sites.google.com/corp/google.com/sheets-data-connectors-tt-help/home" target="_blank">Learn more</a></span></div>')}
;function $Nd(a){a=a||{};var b=a.color;a="";b=Ep(b,null)?"#D0021B":b;a+='<svg class="waffle-dataconnector-error-icon" width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path fill="'+Q(b)+'" fill-rule="evenodd" d="M9,13 L11,13 L11,15 L9,15 L9,13 Z M9,5 L11,5 L11,11 L9,11 L9,5 Z M9.99,0 C4.47,0 0,4.48 0,10 C0,15.52 4.47,20 9.99,20 C15.52,20 20,15.52 20,10 C20,4.48 15.52,0 9.99,0 Z M10,18 C5.58,18 2,14.42 2,10 C2,5.58 5.58,2 10,2 C14.42,2 18,5.58 18,10 C18,14.42 14.42,18 10,18 Z"></path></g></svg>';
return P(a)}
function aOd(){return P('<svg class="waffle-dataconnector-bigquery-icon" width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path fill="#000000" fill-rule="evenodd" d="M17.6210231,14.9676464 C17.7267041,14.964158 17.8336481,14.999598 17.9136667,15.0739664 L21.2187334,18.1431672 C21.3715333,18.2853017 21.3715333,18.5181274 21.2187334,18.6604475 L19.8908,19.8929813 C19.7375334,20.0356729 19.4867333,20.0356729 19.3334666,19.8929813 L16.0288667,16.8252043 C15.9483809,16.7504669 15.9100327,16.6511429 15.9138223,16.5530387 C14.5318646,17.5088871 12.8185327,18.0746254 10.962963,18.0746254 C6.38121025,18.0746254 2.66666667,14.6253786 2.66666667,10.3707987 C2.66666667,6.11585235 6.38121025,2.66666667 10.962963,2.66666667 C15.5447814,2.66666667 19.259325,6.11585235 19.2592593,10.3708597 C19.2592593,12.0936892 18.6501585,13.6844725 17.6210231,14.9676464 Z M10.9627632,16.1481946 C14.3991593,16.1481946 17.1851852,13.5615621 17.1851852,10.3706486 C17.1851852,7.17973497 14.3992258,4.59254616 10.9627632,4.59254616 C7.52630064,4.59254616 4.74074074,7.17967314 4.74074074,10.3706486 C4.74074074,13.561624 7.52630064,16.1481946 10.9627632,16.1481946 Z M6.81481481,10.3703704 L8.88888889,10.3703704 L8.88888889,14.0029401 C8.03391111,13.6464441 7.31942754,13.1505168 6.81481481,12.5594013 L6.81481481,10.3703704 Z M9.92592593,8.44442896 L12,8.44442896 L12,14.1665272 C11.6766072,14.200082 11.3475683,14.2222532 11.0093815,14.2222532 C10.6390341,14.2222532 10.2784063,14.1975885 9.92592593,14.1574203 L9.92592593,8.44442896 Z M13.044326,11.3333411 L15.1184,11.3333411 L15.1184,12.4901418 C14.6287957,13.0790718 13.9116201,13.5742789 13.044326,13.933362 L13.044326,11.3333411 Z"></path></g></svg>')}
function bOd(a){a=a||{};var b=a.opacity;a="";b=Ep(b,null)?1:b;a+='<svg class="waffle-dataconnector-menu-icon" fill="#000000" fill-opacity="'+Q(b)+'" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/></svg>';return P(a)};function cOd(){var a=P,b='<div class="'+Q("waffle-dataconnector-modal-header")+'"><div class="'+Q("waffle-dataconnector-modal-title")+'" role="heading"></div><div class="'+Q("waffle-dataconnector-modal-close-button")+'" tabindex="0" role="button">';var c=P('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g fill="none" fill-rule="evenodd"><path d="M0,0 L18,0 L18,18 L0,18 L0,0 Z M0,0 L18,0 L18,18 L0,18 L0,0 Z"/><polygon fill="#000" points="14.53 4.53 13.47 3.47 9 7.94 4.53 3.47 3.47 4.53 7.94 9 3.47 13.47 4.53 14.53 9 10.06 13.47 14.53 14.53 13.47 10.06 9"/></g></svg>');
return a(b+c+'</div></div><div class="'+Q("waffle-dataconnector-modal-body")+'"></div><div class="'+Q("waffle-dataconnector-modal-footer")+'"></div>')};function g2(a,b){a=void 0===a?"":a;aq.call(this,!1,b);this.Bb=a;this.C=new Ro(void 0,dOd.getInstance());this.Ha(this.C);Xj(this.C,"Close");this.rb=null;this.ib=!0}q(g2,aq);p=g2.prototype;
p.Da=function(){aq.prototype.Da.call(this);var a=this.getId();vh(this.Oa(),"labelledby",a);uh(this.Oa(),"dialog");Eh(this.getElement(),"waffle-dataconnector-modal");this.Bb&&Eh(this.getElement(),this.Bb);rp(this.getElement(),cOd);this.Ka("waffle-dataconnector-modal-title").id=a;a=this.Ir();Eh(a,"waffle-dataconnector-modal-bg");L(a,this.ib);this.C.Xa(this.Ka("waffle-dataconnector-modal-close-button"));this.rb&&eOd(this)};
p.Ja=function(){aq.prototype.Ja.call(this);fOd(this);this.getHandler().R(this.C,"action",this.v_);this.getHandler().R(this.Oa(),["keydown","keypress"],this.wNb)};p.tb=function(){return this.jb("waffle-dataconnector-modal-body")};function gOd(a){return a.jb("waffle-dataconnector-modal-footer")}function hOd(a,b){a.rb=b;a.ub()&&eOd(a)}function fOd(a){var b=a.va(),c=a.Ir(),d=a.Fp;a.ib?(d&&b.Pr(d,a.getElement()),b.Pr(c,a.getElement())):(b.Ff(d),b.Ff(c))}p.v_=function(){Sbb.Ab()};p.a9=function(){Sbb.Ab()};
p.wNb=function(a){"keydown"==a.type?27==a.keyCode?this.a9():9==a.keyCode&&a.shiftKey&&a.target==this.getElement()&&zFa(this):this.AJa(a)};function eOd(a){Gi.getInstance().setContent(a.Ka("waffle-dataconnector-modal-title"),a.rb)}p.AJa=ba();function dOd(){}q(dOd,Qo);dOd.prototype.Qp=n("waffle-dataconnector-modal-close-button");ua(dOd);function iOd(a,b){g2.call(this,a,b);this.H=pf()}q(iOd,g2);p=iOd.prototype;p.getResult=function(){return this.H.C};p.resolve=function(a){this.H.resolve(a)};p.reject=function(a){this.H.reject(a)};p.Ia=function(){g2.prototype.Ia.call(this);this.H.reject()};p.a9=function(){this.reject()};p.v_=function(){this.reject()};var jOd=new Ur(1);function kOd(a){var b=1024<=a;a=b?lJc(parseInt(a,10)):a;return(new Wr("{AT_LEAST_ONE_KB, select, \n     true {Will process {BYTES}.}\n     other {\n         {BYTES, plural,\n             =0 {Will process # bytes.}\n             =1 {Will process # byte.}\n             other {Will process # bytes.}}}}")).format({AT_LEAST_ONE_KB:b?"true":"false",BYTES:a})}
function lOd(){var a=new Tn,b="Configure a project in the Google Cloud Platform console to continue. "+(a.Ee("a",{"class":"goog-inline-block",href:"https://sites.google.com/corp/google.com/sheets-data-connectors-tt-help/bigquery-projects",target:"_blank"})+("Learn more"+a.Ge("a")));return a.format(b)};function mOd(a,b){iOd.call(this,"waffle-dataconnector-bigqueryquerysettingsdialog",b);hOd(this,this.va().Da("SPAN",void 0,N(aOd),"BigQuery data connection"));this.J=a.C;this.D=new JP;this.Ha(this.D);this.D.Rd("waffle-dataconnector-bigqueryquerysettingsdialog-project-select");Xj(this.D,"Billing project");a=this.D;a.F="Select a project";a.kB();this.L=new jU(this.va(),"Raw data");this.oa=new jU(this.va(),"Pivot table");this.O=new lU([this.L,this.oa]);this.F=new GU("Write query");this.Ha(this.F);this.F.Rd("waffle-dataconnector-bigqueryquerysettingsdialog-continue-button")}
q(mOd,iOd);
mOd.prototype.Da=function(){iOd.prototype.Da.call(this);var a=I(H(),"fedp");rp(this.tb(),YNd,{sJb:a});rp(gOd(this),ZNd);this.D.render(this.Ka("waffle-dataconnector-bigqueryquerysettingsdialog-project-select-wrapper"));this.F.render(this.Ka("waffle-dataconnector-bigqueryquerysettingsdialog-continue-button-wrapper"));a&&(this.L.render(this.Ka("waffle-dataconnector-bigqueryquerysettingsdialog-raw-data-radio-wrapper")),this.oa.render(this.Ka("waffle-dataconnector-bigqueryquerysettingsdialog-pivot-table-radio-wrapper")),mU(this.O,
this.L))};mOd.prototype.Ja=function(){iOd.prototype.Ja.call(this);if(0==this.J.length){this.D.Pa(!1);var a=this.D;a.F="No billing projects";a.kB();a=this.va();var b=Be(a,lOd());a.appendChild(this.Ka("waffle-dataconnector-bigqueryquerysettingsdialog-project-section"),a.Da("DIV","waffle-dataconnector-bigqueryquerysettingsdialog-error-caption",b))}else{a=this.J;for(b=0;b<a.length;b++){var c=a[b];this.D.xd(new mk(nOd(c),c.getId()))}this.getHandler().R(this.F,"action",this.Ea).R(this.D,"change",this.Ba)}this.Ba()};
mOd.prototype.Ba=function(){this.F.Pa(null!=this.D.jf())};mOd.prototype.Ea=function(){this.resolve(oOd(this))};function oOd(a){var b=a.D.jf().getValue(),c="dataconnector-querytype-raw";I(H(),"fedp")&&"Pivot table"==nU(a.O).getLabel()&&(c="dataconnector-querytype-pivot");return new XNd(a.J,b,c)}function nOd(a){var b=a.getName();a=a.getId();return b+" ["+a+"]"};function pOd(a,b){this.D=a;this.C=b}function qOd(a){var b=new fTc;W(b,1,a.C);return VNd(a.D,b).then(function(a){return Bu(a,4)})};function h2(a,b){bq.call(this,"waffle-dataconnector-prompt",a,b);this.L=pf();nq(this,null);mq(this,!0);this.C=new MS("Continue");this.Ha(this.C);this.J=new NS("Cancel");this.Ha(this.J);this.O=[]}q(h2,bq);p=h2.prototype;p.Rd=function(a){this.O.push(a);var b=this.getElement();b&&Eh(b,a)};p.getResult=function(){return this.L.C};p.resolve=function(a){this.L.resolve(a)};p.reject=function(){this.L.reject()};
p.Da=function(){bq.prototype.Da.call(this);var a=gq(this);this.J.render(a);this.C.render(a);L(a,!0)};p.Ja=function(){var a=this;bq.prototype.Ja.call(this);Fh(this.Oa(),this.O);this.getHandler().R(this.J,"action",function(){return a.reject()})};p.setVisible=function(a){bq.prototype.setVisible.call(this,a);a||this.reject()};p.Ia=function(){bq.prototype.Ia.call(this);this.reject()};function rOd(a,b){h2.call(this,a,b)}q(rOd,h2);rOd.prototype.Ja=function(){var a=this;h2.prototype.Ja.call(this);this.getHandler().R(this.C,"action",function(){return a.resolve(0)})};function sOd(a){return P('<div class="'+Q("waffle-dataconnector-connectioncard")+'" role="button" tab-index="0"><div class="'+Q("waffle-dataconnector-connectioncard-icon")+'"></div><div class="'+Q("waffle-dataconnector-connectioncard-body")+'"><div class="'+Q("waffle-dataconnector-connectioncard-header")+'">'+O(a.Lha)+"</div></div></div>")};function tOd(a,b,c,d){this.Dc=a;this.D=b;this.Rc=c;this.C=d}tOd.prototype.getName=g("D");tOd.prototype.getId=g("Dc");tOd.prototype.getType=g("Rc");function uOd(){this.Rc=this.Dc=this.D=null;this.C=!1}uOd.prototype.Ne=function(a){this.D=a;return this};uOd.prototype.kf=function(a){this.Dc=a;return this};uOd.prototype.setType=function(a){this.Rc=a;return this};function vOd(a){a.C=!0;return a}uOd.prototype.build=function(){return new tOd(this.Dc,this.D,this.Rc,this.C)};function wOd(){}q(wOd,Qo);wOd.prototype.Da=function(a){a=a.Ta();var b=N(sOd,{Lha:a.getName()});Ih(b,"waffle-dataconnector-connectioncard-authenticated",a.C);return b};wOd.prototype.Ob=n("waffle-dataconnector-connectioncard");ua(wOd);function xOd(a,b){Ro.call(this,void 0,wOd.getInstance(),b);this.gc(a);this.rf(8,!0)}q(xOd,Ro);xOd.prototype.gc=function(a){Ro.prototype.gc.call(this,a)};function yOd(){return P('<div class="'+Q("waffle-dataconnector-connectionmanager-content")+'"><div class="'+Q("waffle-dataconnector-connectionmanager-connections")+'"><div class="'+Q("waffle-dataconnector-connectionmanager-authorized")+'"></div></div></div>')};function zOd(){return P('<div class="'+Q("waffle-dataconnector-dialog-progress-message")+'"><div class="'+Q("waffle-dataconnector-dialog-progress-label")+'"></div><div class="'+Q("waffle-dataconnector-dialog-progress-bar")+'"></div></div>')};function AOd(a){WQ.call(this,a);this.F=!1}q(AOd,WQ);AOd.prototype.Da=function(){WQ.prototype.Da.call(this);Eh(this.getElement(),"waffle-progress-bar");Ih(this.getElement(),"waffle-indeterminate-progress-bar",this.F)};function BOd(a,b){a.F!=b&&(a.F=b,a.getElement()&&Ih(a.getElement(),"waffle-indeterminate-progress-bar",b))}AOd.prototype.Sa=function(a){BOd(this,!1);WQ.prototype.Sa.call(this,a)};function i2(a,b){bq.call(this,"waffle-dataconnector-dialog",a,b);nq(this,null);this.Kx(!1);mq(this,!0);this.Za=[];this.oa=new MS("Ok");this.Ha(this.oa);this.O=new NS("Cancel");this.Ha(this.O);this.Na=new dj;this.Ra=sj(new rj,1).build();this.Ba=this.va().Da("DIV","waffle-dataconnector-dialog-error-message");this.Ea=this.va().Da("DIV","waffle-dataconnector-dialog-info-message");this.Ua=N(zOd);this.C=new AOd;BOd(this.C,!0);this.Ha(this.C)}q(i2,bq);
i2.prototype.Da=function(){bq.prototype.Da.call(this);Fh(this.Oa(),this.Za);var a=gq(this),b=this.va().Da("DIV","waffle-dataconnector-dialog-button-wrapper");a.appendChild(b);this.O.render(b);this.oa.render(b);L(a,!0);b=this.va().Da("DIV","waffle-dataconnector-dialog-message-container",this.Ba,this.Ea,this.Ua);a.appendChild(b);this.C.render(this.Ka("waffle-dataconnector-dialog-progress-bar"));rp(DFa(this),PIc)};
i2.prototype.Ja=function(){bq.prototype.Ja.call(this);var a=this.Ka("waffle-dataconnector-dialog-error-message");ld(a,ed(""));L(a,!1);a=this.Ka("waffle-dataconnector-dialog-info-message");ld(a,ed(""));L(a,!1);this.C.Sa(0);BOd(this.C,!0);L(this.Ka("waffle-dataconnector-dialog-progress-message"),!1);vh(this.Ba,"live","polite");vh(this.Ea,"live","polite");vh(this.Ua,"live","polite")};i2.prototype.Kx=function(a){bq.prototype.Kx.call(this,a);iq(this,this.eL?0:.6)};function COd(a,b){i2.call(this,a,b);cq(this,"Managed connections");this.F=new ap;this.Aa(this.F);this.J=new M(this.va());this.Ha(this.J);this.L=new uT;this.Ha(this.L);jj(this.Na,this.oa,aB,lj,void 0,this.Ra);jj(this.Na,this.O,Sbb,lj,void 0,this.Ra)}q(COd,i2);COd.prototype.Da=function(){i2.prototype.Da.call(this);rp(this.tb(),yOd)};
COd.prototype.Ja=function(){i2.prototype.Ja.call(this);this.L.render(this.Ka("waffle-dataconnector-connectionmanager-content"));this.J.Xa(this.Ka("waffle-dataconnector-connectionmanager-connections"));this.getHandler().R(this.J,"action",this.Wa).R(this.F,"select",this.bb);DOd(this,!0)};function DOd(a,b){Ih(a.Oa(),"waffle-dataconnector-connectionmanager-loading",b);a.L.setActive(b)}
function EOd(a,b){var c=a.Ka("waffle-dataconnector-connectionmanager-authorized");b=ha(b);for(var d=b.next();!d.done;d=b.next())d=new xOd(d.value),a.J.Ha(d),d.render(c)}COd.prototype.Wa=function(a){a.stopPropagation();bp(this.F,a.target)};COd.prototype.bb=function(){var a=(a=(a=this.F.jf())&&a)&&a.Ta();aB.Sa(a)};function FOd(){y.call(this);this.C={};this.Zc=new Qv}q(FOd,y);function GOd(a,b,c){a.C[b]=c}function HOd(a,b){var c=ritz_api.DbxApi.getExecutionStatusForQuery(b);c=null==c?null:a.Zc.Bd(Tv.Ca(),c);var d=a.C[b];return d?c&&d.getToken()==c.getToken()?(yc(a.C,b),c):d:c};function IOd(a){switch(a){case 2:var b=1;break;case 3:b=2;break;default:b=0}a=new WNd;G(a,1,b);b=new tg;Qf(b,91,a);return b};function JOd(){var a='<div class="'+Q("waffle-dataconnector-pill-menuitem-refreshquery")+" "+Q("waffle-dataconnector-pill-menuitem")+'"><span class="'+Q("waffle-dataconnector-pill-menuitem-refreshquery-info")+'"><span class="'+Q("waffle-dataconnector-pill-menuitem-refreshquery-info-button")+'">';var b=P('<svg class="waffle-dataconnector-info-icon-filled" fill="#000000" fill-opacity="0.54" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>');
a=a+O(b)+'</span><span class="'+Q("waffle-dataconnector-pill-menuitem-refreshquery-info-message")+'"></span><span class="'+Q("waffle-dataconnector-pill-menuitem-refreshquery-info-spinner")+'"></span><span class="'+Q("waffle-dataconnector-pill-menuitem-refreshquery-info-error-button")+'">';a+="Error";b=P('<svg class="waffle-dataconnector-refresh-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g fill="none" fill-rule="evenodd"><polygon points="0 0 18 0 18 18 0 18"/><path fill="#000" d="M9,13.5 C6.51,13.5 4.5,11.49 4.5,9 C4.5,6.51 6.51,4.5 9,4.5 C10.24,4.5 11.36,5.02 12.17,5.83 L10,8 L15,8 L15,3 L13.24,4.76 C12.15,3.68 10.66,3 9,3 C5.69,3 3.01,5.69 3.01,9 C3.01,12.31 5.69,15 9,15 C11.97,15 14.43,12.84 14.9,10 L13.38,10 C12.92,12 11.14,13.5 9,13.5 L9,13.5 Z"/></g></svg>');
a+="</span></span>"+O(b);return P(a+"Refresh query</div>")}
function KOd(){var a='<div class="'+Q("waffle-dataconnector-pill-menuitem-editquery")+" "+Q("waffle-dataconnector-pill-menuitem")+'">';var b=P('<svg class="waffle-dataconnector-edit-icon" xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="#000000"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');a+=O(b);return P(a+
"Edit query</div>")}function LOd(a,b,c){b=c||b;a='<div class="'+Q("waffle-dataconnector-pill-menuitem-viewerror")+" "+Q("waffle-dataconnector-pill-menuitem")+'">'+O($Nd({color:"#000000"},b));return P(a+"View error</div>")}function MOd(a,b,c){b=c||b;a='<div class="'+Q("waffle-dataconnector-pill-menuitem-bigquery-helpdoc")+" "+Q("waffle-dataconnector-pill-menuitem")+'">'+O(aOd(null,b));return P(a+"Learn more about BigQuery</div>")};function NOd(a,b,c,d,e){mk.call(this,N(JOd),a,e);this.Qa=b;this.oa=c;this.Ea=d;this.O=sj(new rj,72).build();this.C=new Ro(void 0,Hi(Qo,"waffle-dataconnector-pill-menuitem-refreshquery-info-button"),this.va());this.Ha(this.C);this.F=new Ro(void 0,Hi(Qo,"waffle-dataconnector-pill-menuitem-refreshquery-info-error-button"),this.va());this.Ha(this.F);this.H=!1;this.hE(73)}q(NOd,mk);p=NOd.prototype;
p.Ja=function(){mk.prototype.Ja.call(this);Eh(this.Oa(),"waffle-dataconnector-pill-menuitem-refreshquery");this.C.Xa(this.Ka("waffle-dataconnector-pill-menuitem-refreshquery-info-button"));Xj(this.C,"To show the query info, press I.");this.C.Td("Show the query info");this.F.Xa(this.Ka("waffle-dataconnector-pill-menuitem-refreshquery-info-error-button"));this.reset();this.getHandler().R(this.C,"action",this.MKa).R(this.F,"action",this.vNb)};
p.Oh=function(a){return a.keyCode==this.QT?(this.H&&this.MKa(null),!0):mk.prototype.Oh.call(this,a)};p.Pg=function(a){if(a&&Wd(a.target)){var b=this.Ka("waffle-dataconnector-pill-menuitem-refreshquery-info");if(me(b,a.target))return!0}return mk.prototype.Pg.call(this,a)};p.refresh=function(a){this.H=a;this.reset()};
p.reset=function(){L(this.Ka("waffle-dataconnector-pill-menuitem-refreshquery-info"),this.H);if(this.H){OOd(this,"waffle-dataconnector-pill-menuitem-refreshquery-info-button");var a=this.Ka("waffle-dataconnector-pill-menuitem-refreshquery-info-message");ld(a,jd)}};p.vNb=function(a){a.stopPropagation();ccb.Ab(void 0,this.O)};
p.MKa=function(a){var b=this;a&&a.stopPropagation();OOd(this,"waffle-dataconnector-pill-menuitem-refreshquery-info-spinner");this.Ea.C(35737,this.O);POd(this).then(function(a){a=U(a,2);return QOd(b,a).then(function(a){a=U(U(a,5),1);a=kOd(a);var c=b.Ka("waffle-dataconnector-pill-menuitem-refreshquery-info-message");ld(c,ed(a));OOd(b,"waffle-dataconnector-pill-menuitem-refreshquery-info-message");kE(a)},function(){return ROd(b)})},function(){return ROd(b)})};
function ROd(a){OOd(a,"waffle-dataconnector-pill-menuitem-refreshquery-info-error-button")}function POd(a){var b=new GV;W(b,1,a.Qa);return UNd(KV.getInstance(),b)}function QOd(a,b){U(b,6);var c=new pV;W(c,1,a.oa);a=b.clone();W(c,2,a);W(c,3,1);W(c,5,!0);return QNd(KV.getInstance(),c)}
function OOd(a,b){["waffle-dataconnector-pill-menuitem-refreshquery-info-button","waffle-dataconnector-pill-menuitem-refreshquery-info-message","waffle-dataconnector-pill-menuitem-refreshquery-info-spinner","waffle-dataconnector-pill-menuitem-refreshquery-info-error-button"].forEach(function(b){return L(a.Ka(b),!1)});L(a.Ka(b),!0);a.C.setVisible("waffle-dataconnector-pill-menuitem-refreshquery-info-button"==b);a.F.setVisible("waffle-dataconnector-pill-menuitem-refreshquery-info-error-button"==b)}
;function SOd(a,b,c,d,e){d=void 0===d?!1:d;PU.call(this,sp(bOd,{opacity:.54}),new rk(e),TOd.getInstance(),e);this.H=a;this.V=b;this.Qa=d;this.Ea=c;this.ma=tj(sj(new rj,72),IOd(ritz_api.DbxApi.getConnectionTypeForQuery(this.H))).build();this.F={};this.F["refresh-query"]=new NOd("refresh-query",this.H,this.V,this.Ea,this.va());this.xd(this.F["refresh-query"]);this.F["edit-query"]=new mk(N(KOd),"edit-query",this.va());this.xd(this.F["edit-query"]);this.F["view-error"]=new mk(N(LOd),"view-error",this.va());
this.xd(this.F["view-error"]);this.F["menu-separator"]=new qk(this.va());this.xd(this.F["menu-separator"]);this.F["bigquery-helpdoc"]=new mk(N(MOd),"bigquery-helpdoc",this.va());this.xd(this.F["bigquery-helpdoc"]);this.getHandler().R(this.Yb(),"action",this.Ua)}q(SOd,PU);SOd.prototype.Ja=function(){PU.prototype.Ja.call(this);Eh(this.Yb().getElement(),"waffle-dataconnector-pill-menu");llc(this,new xj(this.Oa(),this.Qa?4:0));this.Tx=!0};
SOd.prototype.Ua=function(a){a=a.target.Ta();(a=UOd[a])&&a.Ab(void 0,this.ma)};SOd.prototype.refresh=function(a){var b=[];switch(a){case 2:b.push("edit-query");b.push("refresh-query");break;case 3:b.push("view-error")}if(a=3==ritz_api.DbxApi.getConnectionTypeForQuery(this.H))b.push("menu-separator"),b.push("bigquery-helpdoc");this.F["refresh-query"].refresh(a);a=ha(Object.values(this.F));for(var c=a.next();!c.done;c=a.next())c.value.setVisible(!1);b=ha(b);for(a=b.next();!a.done;a=b.next())this.F[a.value].setVisible(!0)};
SOd.prototype.Nd=function(a,b){if(a){var c=this.Yb();if(c&&c.ub()){c=ha(Object.values(this.F));for(var d=c.next();!d.done;d=c.next())d=d.value,d.reset&&d.reset()}}PU.prototype.Nd.call(this,a,b)};var VOd={},UOd=(VOd["bigquery-helpdoc"]=Rbb,VOd["edit-query"]=Vbb,VOd["refresh-query"]=bcb,VOd["view-error"]=ccb,VOd);function TOd(){}q(TOd,$Qc);TOd.prototype.xq=function(a){return a.Da("DIV",{style:"display:none;"})};ua(TOd);function WOd(a,b,c){b=c||b;a='<div class="'+Q("waffle-dataconnector-pill")+'" tabindex="0"><div class="'+Q("waffle-dataconnector-pill-info")+'"><div class="'+Q("waffle-dataconnector-pill-timestamp")+'"></div><div class="'+Q("waffle-dataconnector-pill-progress")+'"><div class="'+Q("waffle-dataconnector-pill-spinner")+'"></div><span class="'+Q("waffle-dataconnector-pill-progress-message")+'">';a=a+"Running query..."+(' </span></div><div class="'+Q("waffle-dataconnector-pill-error")+'">'+O($Nd(null,
b)));a=a+"Execution error"+('</div></div><div class="'+Q("waffle-dataconnector-pill-editquery-button-wrapper")+'"></div><div class="'+Q("waffle-dataconnector-pill-refresh-button-wrapper")+'"></div><div class="'+Q("waffle-dataconnector-pill-menu-button-wrapper")+'"></div></div>');return P(a)};function XOd(a,b,c,d,e,f,h,k){h=void 0===h?!1:h;M.call(this,k);this.O=a;this.Ea=c;this.Ba=d;this.H=h;this.V=e;this.oa=f;c=ritz_api.DbxApi.getConnectionTypeForQuery(a);this.L=tj(sj(new rj,72),IOd(c)).build();this.ma=new YOd;this.J=new dj;this.Aa(this.J);this.F=new NS;this.Ha(this.F);this.F.Rd("waffle-dataconnector-pill-editquery-button");jj(this.J,this.F,Vbb,lj,void 0,this.L);this.D=new NS("Refresh");this.D.Rd("waffle-dataconnector-pill-refresh-button");this.Ha(this.D);this.C=new SOd(a,b,this.oa,this.H,
this.va());this.C.Rd("waffle-dataconnector-pill-menu-button");this.Ha(this.C)}q(XOd,M);p=XOd.prototype;p.Da=function(){this.mb(N(WOd))};
p.Ja=function(){var a=this;M.prototype.Ja.call(this);uh(this.Oa(),"toolbar");var b=this.getId()+":label";this.Ka("waffle-dataconnector-pill-info").id=b;vh(this.Oa(),"labelledby",b);this.F.render(this.Ka("waffle-dataconnector-pill-editquery-button-wrapper"));this.D.render(this.Ka("waffle-dataconnector-pill-refresh-button-wrapper"));this.C.render(this.Ka("waffle-dataconnector-pill-menu-button-wrapper"));cj(this.C.Oa(),"More options",void 0);this.getHandler().R(this.D,"action",this.yBb).R(ze(this.va()),
"focus",this.refresh).R(this.Oa(),"keydown",function(a){var b=a.keyCode;37!=b&&39!=b||a.preventDefault()});B.Dp&&B.product.zp&&this.getHandler().R(this.Oa(),"focus",function(){Uh(a.Oa(),{outline:"1px dotted black"})}).R(this.Oa(),"blur",function(){Uh(a.Oa(),{outline:"0"})});this.refresh();b=new ML(this.Oa(),this.va());this.Aa(b);NL(b)};p.Ia=function(){M.prototype.Ia.call(this)};p.qd=function(){this.Ba.qd(this.Oa(),this.H?5:1,new Oh(0,this.H?50:0,12,this.H?0:50))};
p.refresh=function(){var a=HOd(this.V,this.O);a=a?a.getState():2;var b=Wbb.isEnabled();switch(a){case 5:case 1:L(this.Ka("waffle-dataconnector-pill-timestamp"),!1);L(this.Ka("waffle-dataconnector-pill-progress"),!0);L(this.Ka("waffle-dataconnector-pill-error"),!1);this.F.setVisible(!1);this.D.setVisible(!1);this.D.Pa(!1);this.C.setVisible(!1);break;case 4:case 2:L(this.Ka("waffle-dataconnector-pill-timestamp"),!0);L(this.Ka("waffle-dataconnector-pill-progress"),!1);L(this.Ka("waffle-dataconnector-pill-error"),
!1);ZOd(this);this.F.setVisible(!1);this.D.setVisible(b);this.D.Pa(b);this.C.setVisible(b);this.C.isVisible()&&this.C.refresh(a);break;case 3:L(this.Ka("waffle-dataconnector-pill-timestamp"),!1);L(this.Ka("waffle-dataconnector-pill-progress"),!1);L(this.Ka("waffle-dataconnector-pill-error"),!0);this.F.setVisible(b);this.D.setVisible(!1);this.D.Pa(!1);this.C.setVisible(b);this.C.isVisible()&&this.C.refresh(a);b||(L(this.Ka("waffle-dataconnector-pill-timestamp"),!0),L(this.Ka("waffle-dataconnector-pill-error"),
!1),ZOd(this));break;default:$sc("Unrecognized execution state: "+a)}this.qd()};function ZOd(a){var b=ritz_api.DbxApi.getLastExecutionTimeForSheet(a.Ea);0>=b||(b="Updated "+a.ma.format(b),a=a.Ka("waffle-dataconnector-pill-timestamp"),oe(a,b))}p.yBb=function(){this.D.Pa(!1);bcb.Ab(void 0,this.L)};p.focus=function(){this.Oa().focus()};function YOd(){this.C=new Or(1);this.D=new Or(Rr.MONTH_DAY_MEDIUM);this.F=new Or(7)}
YOd.prototype.format=function(a){a=new Date(a);var b=new Date,c;0<b.getFullYear()-a.getFullYear()?c=this.C.format(a):a.getMonth()==b.getMonth()&&a.getDate()==b.getDate()?c="today":c=this.D.format(a);a=this.F.format(a);return c+(", "+a)};function $Od(a,b,c,d,e,f,h){y.call(this);this.D=a;this.H=b;this.L=c;this.ma=d;this.J=e;this.Ma=new Lh(this);this.Aa(this.Ma);this.F=new Pe(this);this.Aa(this.F);this.O=f;this.V=h;this.C=null;this.Ma.R(this.L,"K",this.tNb).R(this.D,"jb",this.uNb).R(this.D,"kb",this.JDb).R(this.ma,"db-execution-status-updated",this.sNb).R(this.D,"Cb",this.refresh);this.F.subscribe(Xbb,"action",this.ctb)}q($Od,y);p=$Od.prototype;p.Ia=function(){y.prototype.Ia.call(this);A(this.C)};p.refresh=function(){aPd(this)};
p.tNb=function(){this.C&&this.C.qd()};p.uNb=function(){aPd(this)};p.JDb=function(){A(this.C);this.C=null};p.ctb=function(){this.C&&(this.C.focus(),this.O.wb(2))};function aPd(a){var b=a.D.C.C;if(b&&EE(b))if(a.C)a.C.refresh();else{var c=tE(a.H);if(c){b=c.ye();c=new xj(c.La.J,b?5:1);var d=a.D.C.C,e=d.H,f=U(e,1);e=U(e,2);d=d.kb();a.C=new XOd(f,e,d,c,a.J,a.V,b);a.C.render()}}}p.sNb=function(a){a.F&&0!=a.F.length&&this.C&&cb(a.F,this.C.O)&&this.C.refresh()};function bPd(a,b,c,d){y.call(this);this.ma=a;this.oa=b;this.Ba=c;this.O=this.J=this.L=null;this.D=d||null;this.C=3;this.V=new cPd;this.F=this.H=null}q(bPd,y);p=bPd.prototype;p.getId=function(){return Ba(this)};p.Ia=function(){this.stop();y.prototype.Ia.call(this)};p.start=function(){this.C=2;this.F=this.H=null;this.XDa(this.ma)};p.stop=function(){2==this.C&&(this.C=3,this.V.stop())};function dPd(a,b){a.L=b;return a}function ePd(a,b){a.J=b;return a}function fPd(a,b){a.O=b;return a}
p.XDa=function(a){var b=this;this.oa.call(this.D,a).then(function(a){if(2==b.C){b.H=a;b.F=null;var c=b.Ba.call(b.D,a);if(c){b.O&&b.O.call(b.D,a);a:{a=b.V;c=t(b.XDa,b,c);if(10>a.F){a.F++;var e=1E3}else if(60>a.D)a.D++,e=5E3;else{a=!1;break a}e+=Math.round(.2*e*(Math.random()-.5)*2);a.C=Ni(c,e);a=!0}a||gPd(b,Error("Polling timed out"))}else b.stop(),b.C=4,b.H=a,b.F=null,b.L&&b.L.call(b.D,a)}},function(a){2==b.C&&gPd(b,a)})};function gPd(a,b){a.stop();a.C=1;a.H=null;a.F=b;a.J&&a.J.call(a.D,b)}
p.getStatus=g("C");p.XG=g("F");function cPd(){this.D=this.F=0;this.C=null}cPd.prototype.stop=function(){this.D=this.F=0;Oi(this.C);this.C=null};function hPd(a){this.C=a}function iPd(a,b){var c=U(b,2);return new bPd(b,function(b){return QNd(a.C,b)},function(a){if(1==a.sj().getState()){var b=new pV;W(b,2,c);b.setToken(a.sj().getToken());return b}return null})};function jPd(a,b){Yp(a.Pc,kPd(a));a.C="vertical"==a.D?jFa(a.Pc,b):kFa(a.Pc,b);var c=ha("vertical"==a.D?[a.C,0]:[0,a.C]);b=c.next().value;c=c.next().value;YC(a.Oa(),b,c,a.ye());a.dispatchEvent("Kf")}function kPd(a){var b=a.Oa().parentElement.getBoundingClientRect(),c=b.height;b=b.width;"horizontal"==a.D?(b=0,c-=a.fd()):(c=0,b-=a.fd());return new Ph(0,0,b,c)};function lPd(a,b){var c=b.getErrorCode(),d=U(b,3);switch(c){case 20:return mPd(a,d);case 14:return j2('Update parameter "'+(U(b,6).toUpperCase()+'" to reference a cell in the current workbook and try again'));case 15:return j2('Update the cell referenced by parameter "'+(U(b,6).toUpperCase()+'" to be text or a number'));case 16:return j2("Select a parameter name you haven't used before");case 13:return j2('Define your parameter "'+(U(b,6).toUpperCase()+'" and try again'));case 6:return I(H(),"docs-idu")?
(a=new Tn,b=a.Ee("span",{"class":"waffle-dataconnector-error-message"})+("Query timed out. "+(a.Ee("a",{href:"https://sites.google.com/corp/google.com/sheets-dataconnectors-help/error-messages",target:"_blank"})+("Learn more"+(a.Ge("a")+a.Ge("span"))))),a=a.format(b)):a=nPd("Query timed out",d),a;case 8:return I(H(),"docs-idu")?(a=new Tn,b="Results exceed "+(oPd+(" rows. Update query and run again. "+(a.Ee("a",{href:"https://sites.google.com/corp/google.com/sheets-dataconnectors-help/error-messages",
target:"_blank"})+("Learn more"+a.Ge("a"))))),a=a.format(b),a=j2(a)):a=nPd(pPd,d),a;case 18:return j2("The query returns an ARRAY or a STRUCT type, which is currently not supported.");case 9:return a=new Tn,b="Go to Plx to specify an engine other than 'Auto' and try again. "+(a.Ee("a",{href:"https://sites.google.com/corp/google.com/sheets-dataconnectors-help/error-messages",target:"_blank"})+("Learn more"+a.Ge("a"))),a=a.format(b),j2(a);case 19:return j2("The query is already in execution.");case 17:return a=
"Can not insert the results of the query: that would increase the number of cells in the workbook above the limit of "+(oh(H(),"fmtc")+" cells."),j2(a);case 22:return j2("Duplicated column names or aliases are not supported. Please update your query.");case 23:return j2("There is no sheet associated with this query.")}return qPd(d)}
function rPd(a){var b=new Tn;a=(new Wr("To execute this query, {startLink}sign in to your Google account{endLink}")).format({startLink:b.Ee("a",{href:"#",id:a}),endLink:b.Ge("a")});return b.format(a)}function mPd(a,b){if(!b)return qPd(b);switch(a){case 2:return j2("Plx error: "+b);case 3:return j2("BigQuery error: "+b);default:return j2("Database error: "+b)}}function qPd(a){return nPd("Something's wrong. Please try again later",a)}var oPd=(new Ur(1)).format(1E4),pPd="Results exceed "+(oPd+" rows. Update query and run again.");
function j2(a){return hd("span",{"class":"waffle-dataconnector-error-message"},a)}function nPd(a,b){var c=new Tn;b&&(a=a+": "+b);return j2(c.format(a))};function sPd(){}q(sPd,Qo);sPd.prototype.Ob=n("waffle-dataconnector-queryeditor-removable-chip-remove-button");ua(sPd);function tPd(){}q(tPd,Qo);tPd.prototype.Da=function(a){var b=Qo.prototype.Da.call(this,a);a.va().appendChild(b,a.va().Da("DIV","waffle-dataconnector-queryeditor-removable-chip-chip-content"));return b};tPd.prototype.tb=function(a){return Qd("waffle-dataconnector-queryeditor-removable-chip-chip-content",a)};tPd.prototype.Ob=n("waffle-dataconnector-queryeditor-removable-chip-button");
ua(tPd);var uPd=new Qv;function vPd(a){return a.C.Dd().map(function(a){return a.Ta()})};function wPd(){y.call(this);this.C=oA("win")}q(wPd,y);function xPd(a,b){a.C.dataConnectorOnCompleteAuth=b;b=(new Zk(a.C.location.href)).resolve(new Zk("dbx/ssoLogin")).toString();var c=Sd();(a=Vn(b,{target:"google_popup",width:500,height:500,top:Math.floor((c.height-500)/2),left:Math.floor((c.width-500)/2),toolbar:!1,menubar:!1,location:!1,statusbar:!1},a.C))&&a.focus()}wPd.prototype.Ia=function(){delete this.C.dataConnectorOnCompleteAuth;y.prototype.Ia.call(this)};function yPd(a){var b=a.ola(),c;if(c=b){a=ha(vPd(a.Za));for(c=a.next();!c.done;c=a.next())zu(b,3,c.value);c=b}return c}function zPd(a){a.J.setVisible(!0);var b=Math.min(a.J.mgb().height+16,240);APd(a,b)}function BPd(a){if(!a.O.enabled){var b=0;CPd(a,b);a.O.R("tick",function(){a.isDisposed()||(b+=.1,CPd(a,b))});a.O.start()}}function CPd(a,b){k2(a,ed("Executing query "+(b.toFixed(1)+"s")))}function DPd(a,b){a.Ua=!1;a.O.stop();a.O.WD();EPd(a,!0);FPd(a,b.sj());l2(a)}
function FPd(a,b){10==b.getErrorCode()?GPd(a):k2(a,lPd(a.gI(),b))}function HPd(a){a.Ua=!0;k2(a,ed("Updating workbook"));l2(a)}function APd(a,b){var c=void 0===c?!0:c;A(a.Ba);a.Ba=null;c?(c=IPd(a),a.Ba=new JPd(c,b,200,a),a.Aa(a.Ba),a.Ba.play()):KPd(a,b)}function IPd(a){return a.ub()?ni(a.Ka("waffle-dataconnector-newqueryeditor-preview-pane")).height:0}function KPd(a,b){var c=a.Ka("waffle-dataconnector-newqueryeditor-main");b=ni(c).height-a.F.fd()-b;jPd(a.F,b)}
function l2(a){var b=yPd(a),c=a.bb.C;a.Ua||null==b||c?(a.Na.Pa(!1),a.oa.Pa(!1)):(a.oa.Pa(!0),a.Na.Pa(!0));b=a.gb&&a.gb.equals(b);a.J.Psa(!b)}function LPd(a){var b=new pV;W(b,1,a.dc);a=yPd(a);W(b,2,a);W(b,3,30);return b}function GPd(a){var b="waffle-dataconnector-ssologin-"+cc(),c=rPd(b);k2(a,c);(b=Md(b))&&a.getHandler().R(b,"click",function(){return MPd(a)})}function MPd(a){xPd(a.dd,function(){EPd(a,!1);$A.Ab(LPd(a),a.cx)})}
function k2(a,b,c){c=void 0===c?!0:c;a=a.Ka("waffle-dataconnector-newqueryeditor-footer-message");ld(a,b);c&&kE(re(a))}function EPd(a,b){a.ub()&&Ih(a.Ka("waffle-dataconnector-newqueryeditor-footer-message-container"),"waffle-dataconnector-newqueryeditor-unhandled-error",b)}function JPd(a,b,c,d){Fr.call(this,[a],[b],c);this.F=d}q(JPd,Fr);JPd.prototype.waa=function(){KPd(this.F,this.coords[0])};JPd.prototype.H=function(){KPd(this.F,this.JQ[0])};
var NPd=new Tn,OPd="Inserted data is visible to all. The query is visible only to people with edit access. "+(NPd.Ee("a",{"class":"goog-inline-block",href:"https://sites.google.com/corp/google.com/sheets-data-connectors-tt-help/home",target:"_blank"})+("Learn more"+NPd.Ge("a"))),PPd=NPd.format(OPd);var QPd=Object.freeze({caption:"Dremel",value:"DREMEL"}),RPd=Object.freeze({caption:"F1",value:"F1"}),SPd=Object.freeze({caption:"Procella",value:"PROCELLA"});function TPd(a,b,c,d){var e="Error in query on "+c;c=new rOd;c.Rd("waffle-dataconnector-error-popup");cq(c,e);c.C.setContent("Open query editor");c.J.setContent("Ok");a=10==a.getErrorCode()?rPd(d):lPd(b,a);dq(c,a);return c};function UPd(a,b,c,d,e,f,h,k,l){y.call(this);var m=this;this.L=new FOd;this.Aa(this.L);this.O=a.rb;this.D=KV.getInstance();this.Ga=new hPd(this.D);this.F=b;this.V=f;this.oa=l;this.C=null;this.ma=new E;this.Aa(this.ma);this.H=new $Od(b,c,d,a,this.L,e,this.oa);this.Aa(this.H);this.Ma=new Lh(this);this.Aa(this.Ma);this.Ba=new Pe(this);this.Aa(this.Ba);this.Ea=new wPd;this.Aa(this.Ea);VPd(this,k);this.Ma.R(this.ma,["show","hide"],this.oqb);this.Ba.subscribe(Sbb,"action",this.yha).subscribe($A,"action",
this.uAb).subscribe(YA,"action",this.tpb).subscribe(Ubb,"action",this.spb).subscribe(bcb,"action",this.xBb).subscribe(Vbb,"action",this.Sqa).subscribe(ZA,"action",this.Grb).subscribe(aB,"action",this.dpb).subscribe($bb,"action",this.Lyb).subscribe(ccb,"action",this.Sqa).subscribe(Rbb,"action",this.Iyb);this.H.refresh();this.J=new tf;yA("queryeditor",function(){var a=BA("queryeditor");m.J.callback(a.C(h,m.D,m.V,m.oa))})}q(UPd,y);
function VPd(a,b){var c=g5b(),d=new as(UN.concat(["waffle-dataconnector-connection-selected"])),e=new as(["waffle-dataconnector-active-sheet-db-connection"]),f=UN.concat(["waffle-dataconnector-active-sheet-db-connection","sheet-access-no-protected-range-for-sheet"]);c||f.push("waffle-dataconnector-active-sheet-not-plx");c=new as(f);Sbb.Pa(!0);b.C(YA,VN).D(YA,VN).C(ZA,VN).D(ZA,VN).C(bcb,c).C(Vbb,c).C($A,VN).C(aB,d).C($bb,c).C(ccb,c).C(Xbb,e);b.C(Wbb,c);a.Ba.xb(Wbb,Qa,function(){a.H.refresh()});I(H(),
"fedp")&&b.C(Ubb,VN).D(Ubb,VN)}p=UPd.prototype;p.xf=function(a){this.D.xf(a)};function m2(a,b){A(a.C);a.C=b;a.C.Xd(a.ma);b instanceof bq?a.V.Sh(a.C):a.V.Sh(new gtb(a.C));a.C.render();a.C.setVisible(!0)}p.yha=function(){A(this.C);this.C=null};p.oqb=function(){this.C&&this.C.isVisible()||($A.Sa(null),aB.Sa(null))};
p.eRb=function(){var a=new COd;this.Aa(a);m2(this,a);TNd(this.D).then(function(b){var c=[];Bu(b,1).forEach(function(a){c.push(vOd((new uOd).kf(a.getId()).Ne(a.getName()).setType(U(a,3))).build())});a.isDisposed()||(EOd(a,c),DOd(a,!1))},function(){n2("Error getting managed connections");var b=[];a.isDisposed()||(EOd(a,b),DOd(a,!1))})};
p.k7a=function(){var a=this,b=WPd("Connecting to Plx...");XPd(this,"Plx",2).then(function(c){YPd(a,c);Pn(On.getInstance(),b)},function(){n2("Could not connect to Plx");Pn(On.getInstance(),b)})};p.j7a=function(){var a=this,b=WPd("Connecting to BigQuery..."),c;XPd(this,"BigQuery",3).then(function(b){c=b;return qOd(new pOd(a.D,b))}).then(function(d){Pn(On.getInstance(),b);ZPd(a,c,d)},function(){Pn(On.getInstance(),b);n2("Could not connect to BigQuery")})};p.jUb=function(){$Pd(this,[],!1)};
function ZPd(a,b,c){c=new XNd(c);var d=new mOd(c);a.Aa(d);m2(a,d);d.getResult().then(function(c){aQd(a,b,c)},function(){a.oa.C(35753);A(d)})}function WPd(a){return On.getInstance().postMessage(Qn(a,"info",!0))}function n2(a){On.getInstance().postMessage(Qn(a,"error",!0))}function XPd(a,b,c){var d=new kV;d.Ne(b);W(d,2,c);return NNd(a.D,d).then(function(a){return U(a,2)})}
function bQd(a,b){var c=WPd("Importing connection..."),d=new lV;d.kf(b);d.setType(1);return new kf(function(b,f){PNd(a.D,d).then(function(){Pn(On.getInstance(),c);b()},function(){Pn(On.getInstance(),c);f()})})}function cQd(a,b){var c=mvb(a.O,b).getName();a.J.addCallback(function(d){d=d.Kfb(b,c);a.Aa(d);m2(a,d)})}function aQd(a,b,c){a.J.addCallback(function(d){d=d.Jfb(b,c);a.Aa(d);m2(a,d)})}function YPd(a,b){a.J.addCallback(function(c){c=c.Lfb(b);a.Aa(c);m2(a,c)})}
p.dpb=function(){var a=this,b=aB.getValue(),c=b.getId(),d=b.getType();switch(d){case 2:YPd(this,c);break;case 1:mvb(this.O,b.getId())?cQd(this,c):bQd(this,c).then(function(){cQd(a,c)},function(){n2("Error importing connection")});break;default:throw Error("Unsupported connection type: "+d);}};
p.uAb=function(a){var b=this.C;b.Ua=!0;k2(b,ed("Executing query"));l2(b);var c=U(a,2);ePd(fPd(dPd(iPd(this.Ga,a),function(a){if(!b.isDisposed()){b.O.stop();b.O.WD();EPd(b,!1);b.Ua=!1;b.gb=c;var d=1E4<U(a,3)||!!U(a,4);b.Cc=d;if(!b.isDisposed()){d=b.Cc;var f=U(a,3);d=d?U(a,4)?"Query returns more than "+(jOd.format(f)+(" rows of data. Please revise your query to return no more than "+(jOd.format(1E4)+" rows."))):"Query returns "+(jOd.format(f)+(" rows of data. Please revise your query to return no more than "+
(jOd.format(1E4)+" rows."))):(new Wr("{TOTAL_ROWS, plural, =0 {Query returns no results.}=1 {Query returns 1 row of data.}other {Query returns # rows of data.}}")).format({TOTAL_ROWS:f});d=hd("strong",void 0,d);d=id(d,hd("br"),PPd);k2(b,d)}b.J.CUb(U(a,2));zPd(b);b.oa.setContent("Refresh preview");l2(b)}}),function(){b.isDisposed()||BPd(b)}),function(a){b.isDisposed()||DPd(b,a)}).start()};p.tpb=function(a){dQd(this,1,a)};p.spb=function(a){dQd(this,2,a)};
function dQd(a,b,c){var d=a.C;W(c,3,b);ONd(a.D,c).then(function(c){eQd(a,c);2==b&&okb()},function(a){d.isDisposed()||DPd(d,a)});HPd(d)}function eQd(a,b){GOd(a.L,U(b,2),b.sj());var c=b.kb();a.yha();DG(a.F,c)?GG(a.F.C)==c?a.H.refresh():IG(a.F,c):a.Ma.Uc(a.F,["ub","jb"],function(b){"ub"==b.type&&b.Ph==c&&IG(a.F,c)})}p.xBb=function(){$Pd(this,[KI(this.F.C)],!0)};
function $Pd(a,b,c){var d=new PSc;b.forEach(function(a){zu(d,1,a)});RNd(a.D,d).then(function(b){fQd(a,Bu(b,1));a.H.refresh()},function(b){return gQd(a,b,c)})}function gQd(a,b,c){var d=[],e=[];Bu(b,1).forEach(function(a){return 3==a.sj().getState()?e.push(a):d.push(a)});fQd(a,d);a.H.refresh();c&&(b=e[0],c=b.sj(),c.getErrorCode(),hQd(a,b.kb(),c))}function fQd(a,b){b.forEach(function(b){var c=DG(a.F,b.kb());if(c=c&&c.H)c=U(c,1),b=b.sj(),a.L.C[c]=b})}
function hQd(a,b,c){var d=DG(a.F,b),e=d&&d.H;if(e){d=d.we();e=iQd(a,e);var f="waffle-dataconnector-ssologin-"+cc(),h=TPd(c,e,d,f);a.Aa(h);a.V.Sh(h);h.render();h.setVisible(!0);h.getResult().then(function(){A(h);a.Sqa(b)},function(){A(h)});(c=Md(f))&&h2.prototype.getHandler.call(h).R(c,"click",function(){jQd(a,b,h)})}}function jQd(a,b,c){xPd(a.Ea,function(){A(c);$Pd(a,[b],!0)})}
p.Sqa=function(a){if((a=void 0!==a?DG(this.F,a):this.F.C.C)&&EE(a)){var b=a.H;a=U(b,2);b=U(b,1);switch(U(mvb(this.O,a),3)){case 2:kQd(this,a,b);break;case 1:lQd(this,a,b);break;case 3:mQd(this,a,b)}}};function lQd(a,b,c){var d=mvb(a.O,b).getName(),e=nQd(a,c),f=oQd(a,c);a.J.addCallback(function(h){var k=WPd("Loading query...");of([e,f]).then(function(e){e=h.Ofb(b,d,c,e[0],e[1]?e[1]:null);a.Aa(e);Pn(On.getInstance(),k);m2(a,e)},function(){Pn(On.getInstance(),k);n2("Could not load query")})})}
function kQd(a,b,c){var d=nQd(a,c),e=oQd(a,c);a.J.addCallback(function(f){var h=WPd("Loading query...");of([d,e]).then(function(d){d=f.Pfb(b,c,d[0],d[1]?d[1]:null);a.Aa(d);Pn(On.getInstance(),h);m2(a,d)},function(){Pn(On.getInstance(),h);n2("Could not load query")})})}
function mQd(a,b,c){var d=qOd(new pOd(a.D,b)),e=nQd(a,c),f=oQd(a,c);a.J.addCallback(function(h){var k=WPd("Connecting to BigQuery...");of([e,f,d]).then(function(d){var e=d[0],f=d[1]?d[1]:null;d=d[2];var l=U(e,4).zn();d=new XNd(d,l);e=h.Nfb(b,d,c,e,f);Pn(On.getInstance(),k);m2(a,e)},function(){Pn(On.getInstance(),k);n2("Could not load query")})})}function nQd(a,b){var c=pf(),d=new GV;W(d,1,b);UNd(a.D,d).then(function(a){c.resolve(U(a,2))},function(a){return c.reject(a)});return c.C}
function oQd(a,b){var c=HOd(a.L,b);if(!c||3!=c.getState())return mf(null);c=new IV;W(c,1,b);return a.D.sj(c).then(function(a){return a.sj()})}p.Grb=function(a){var b=this,c=U(a,1),d=this.C;SNd(this.D,a).then(function(a){a=a.sj();b.L.C[c]=a;a=ritz_api.DbxApi.getSheetIdForQuery(c);IG(b.F,a);b.yha();b.H.refresh()},function(a){d.isDisposed()||DPd(d,a)});HPd(d)};function iQd(a,b){b=U(b,2);a=a.O.C[b];b=U(a,3);a.getName();return b}
p.Lyb=function(){var a=this,b=this.F.C.C,c=U(b.H,1),d=new IV;W(d,1,c);this.D.sj(d).then(function(c){(c=c.sj())&&3==c.getState()&&hQd(a,b.kb(),c)})};p.Iyb=function(){Vn("https://cloud.google.com/bigquery/docs/projects")};function pQd(){y.call(this)}q(pQd,uA);pQd.prototype.C=function(){return UPd};AA("dataconnector",pQd);
