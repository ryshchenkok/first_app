!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function c(a){var b=a.length,c=_.type(a);return"function"===c||_.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}function d(a,b,c){if(_.isFunction(b))return _.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return _.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(ha.test(b))return _.filter(b,a,c);b=_.filter(b,a)}return _.grep(a,function(a){return U.call(b,a)>=0!==c})}function e(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function f(a){var b=oa[a]={};return _.each(a.match(na)||[],function(a,c){b[c]=!0}),b}function g(){Z.removeEventListener("DOMContentLoaded",g,!1),a.removeEventListener("load",g,!1),_.ready()}function h(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=_.expando+Math.random()}function i(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(ua,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:ta.test(c)?_.parseJSON(c):c}catch(e){}sa.set(a,b,c)}else c=void 0;return c}function j(){return!0}function k(){return!1}function l(){try{return Z.activeElement}catch(a){}}function m(a,b){return _.nodeName(a,"table")&&_.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function n(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function o(a){var b=Ka.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function p(a,b){for(var c=0,d=a.length;d>c;c++)ra.set(a[c],"globalEval",!b||ra.get(b[c],"globalEval"))}function q(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(ra.hasData(a)&&(f=ra.access(a),g=ra.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)_.event.add(b,e,j[e][c])}sa.hasData(a)&&(h=sa.access(a),i=_.extend({},h),sa.set(b,i))}}function r(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&_.nodeName(a,b)?_.merge([a],c):c}function s(a,b){var c=b.nodeName.toLowerCase();"input"===c&&ya.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function t(b,c){var d,e=_(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:_.css(e[0],"display");return e.detach(),f}function u(a){var b=Z,c=Oa[a];return c||(c=t(a,b),"none"!==c&&c||(Na=(Na||_("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Na[0].contentDocument,b.write(),b.close(),c=t(a,b),Na.detach()),Oa[a]=c),c}function v(a,b,c){var d,e,f,g,h=a.style;return c=c||Ra(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||_.contains(a.ownerDocument,a)||(g=_.style(a,b)),Qa.test(g)&&Pa.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function w(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}function x(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,e=Xa.length;e--;)if(b=Xa[e]+c,b in a)return b;return d}function y(a,b,c){var d=Ta.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function z(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=_.css(a,c+wa[f],!0,e)),d?("content"===c&&(g-=_.css(a,"padding"+wa[f],!0,e)),"margin"!==c&&(g-=_.css(a,"border"+wa[f]+"Width",!0,e))):(g+=_.css(a,"padding"+wa[f],!0,e),"padding"!==c&&(g+=_.css(a,"border"+wa[f]+"Width",!0,e)));return g}function A(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ra(a),g="border-box"===_.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=v(a,b,f),(0>e||null==e)&&(e=a.style[b]),Qa.test(e))return e;d=g&&(Y.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+z(a,b,c||(g?"border":"content"),d,f)+"px"}function B(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=ra.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&xa(d)&&(f[g]=ra.access(d,"olddisplay",u(d.nodeName)))):(e=xa(d),"none"===c&&e||ra.set(d,"olddisplay",e?c:_.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function C(a,b,c,d,e){return new C.prototype.init(a,b,c,d,e)}function D(){return setTimeout(function(){Ya=void 0}),Ya=_.now()}function E(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=wa[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function F(a,b,c){for(var d,e=(cb[b]||[]).concat(cb["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function G(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},n=a.style,o=a.nodeType&&xa(a),p=ra.get(a,"fxshow");c.queue||(h=_._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,_.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[n.overflow,n.overflowX,n.overflowY],j=_.css(a,"display"),k="none"===j?ra.get(a,"olddisplay")||u(a.nodeName):j,"inline"===k&&"none"===_.css(a,"float")&&(n.display="inline-block")),c.overflow&&(n.overflow="hidden",l.always(function(){n.overflow=c.overflow[0],n.overflowX=c.overflow[1],n.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],$a.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(o?"hide":"show")){if("show"!==e||!p||void 0===p[d])continue;o=!0}m[d]=p&&p[d]||_.style(a,d)}else j=void 0;if(_.isEmptyObject(m))"inline"===("none"===j?u(a.nodeName):j)&&(n.display=j);else{p?"hidden"in p&&(o=p.hidden):p=ra.access(a,"fxshow",{}),f&&(p.hidden=!o),o?_(a).show():l.done(function(){_(a).hide()}),l.done(function(){var b;ra.remove(a,"fxshow");for(b in m)_.style(a,b,m[b])});for(d in m)g=F(o?p[d]:0,d,l),d in p||(p[d]=g.start,o&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function H(a,b){var c,d,e,f,g;for(c in a)if(d=_.camelCase(c),e=b[d],f=a[c],_.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=_.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function I(a,b,c){var d,e,f=0,g=bb.length,h=_.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Ya||D(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:_.extend({},b),opts:_.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Ya||D(),duration:c.duration,tweens:[],createTween:function(b,c){var d=_.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(H(k,j.opts.specialEasing);g>f;f++)if(d=bb[f].call(j,a,k,j.opts))return d;return _.map(k,F,j),_.isFunction(j.opts.start)&&j.opts.start.call(a,j),_.fx.timer(_.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function J(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(na)||[];if(_.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function K(a,b,c,d){function e(h){var i;return f[h]=!0,_.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===vb;return e(b.dataTypes[0])||!f["*"]&&e("*")}function L(a,b){var c,d,e=_.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&_.extend(!0,a,d),a}function M(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function N(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function O(a,b,c,d){var e;if(_.isArray(b))_.each(b,function(b,e){c||zb.test(a)?d(a,e):O(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==_.type(b))d(a,b);else for(e in b)O(a+"["+e+"]",b[e],c,d)}function P(a){return _.isWindow(a)?a:9===a.nodeType&&a.defaultView}var Q=[],R=Q.slice,S=Q.concat,T=Q.push,U=Q.indexOf,V={},W=V.toString,X=V.hasOwnProperty,Y={},Z=a.document,$="2.1.1",_=function(a,b){return new _.fn.init(a,b)},aa=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ba=/^-ms-/,ca=/-([\da-z])/gi,da=function(a,b){return b.toUpperCase()};_.fn=_.prototype={jquery:$,constructor:_,selector:"",length:0,toArray:function(){return R.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:R.call(this)},pushStack:function(a){var b=_.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return _.each(this,a,b)},map:function(a){return this.pushStack(_.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(R.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:T,sort:Q.sort,splice:Q.splice},_.extend=_.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||_.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(_.isPlainObject(d)||(e=_.isArray(d)))?(e?(e=!1,f=c&&_.isArray(c)?c:[]):f=c&&_.isPlainObject(c)?c:{},g[b]=_.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},_.extend({expando:"jQuery"+($+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===_.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!_.isArray(a)&&a-parseFloat(a)>=0},isPlainObject:function(a){return"object"!==_.type(a)||a.nodeType||_.isWindow(a)?!1:!a.constructor||X.call(a.constructor.prototype,"isPrototypeOf")},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?V[W.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=_.trim(a),a&&(1===a.indexOf("use strict")?(b=Z.createElement("script"),b.text=a,Z.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(ba,"ms-").replace(ca,da)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,g=a.length,h=c(a);if(d){if(h)for(;g>f&&(e=b.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=b.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=b.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),e===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(aa,"")},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?_.merge(d,"string"==typeof a?[a]:a):T.call(d,a)),d},inArray:function(a,b,c){return null==b?-1:U.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,d){var e,f=0,g=a.length,h=c(a),i=[];if(h)for(;g>f;f++)e=b(a[f],f,d),null!=e&&i.push(e);else for(f in a)e=b(a[f],f,d),null!=e&&i.push(e);return S.apply([],i)},guid:1,proxy:function(a,b){var c,d,e;return"string"==typeof b&&(c=a[b],b=a,a=c),_.isFunction(a)?(d=R.call(arguments,2),e=function(){return a.apply(b||this,d.concat(R.call(arguments)))},e.guid=a.guid=a.guid||_.guid++,e):void 0},now:Date.now,support:Y}),_.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){V["[object "+b+"]"]=b.toLowerCase()});var ea=function(a){function b(a,b,c,d){var e,f,g,h,i,j,l,n,o,p;if((b?b.ownerDocument||b:O)!==G&&F(b),b=b||G,c=c||[],!a||"string"!=typeof a)return c;if(1!==(h=b.nodeType)&&9!==h)return[];if(I&&!d){if(e=sa.exec(a))if(g=e[1]){if(9===h){if(f=b.getElementById(g),!f||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&M(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return _.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&v.getElementsByClassName&&b.getElementsByClassName)return _.apply(c,b.getElementsByClassName(g)),c}if(v.qsa&&(!J||!J.test(a))){if(n=l=N,o=b,p=9===h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(j=z(a),(l=b.getAttribute("id"))?n=l.replace(ua,"\\$&"):b.setAttribute("id",n),n="[id='"+n+"'] ",i=j.length;i--;)j[i]=n+m(j[i]);o=ta.test(a)&&k(b.parentNode)||b,p=j.join(",")}if(p)try{return _.apply(c,o.querySelectorAll(p)),c}catch(q){}finally{l||b.removeAttribute("id")}}}return B(a.replace(ia,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>w.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[N]=!0,a}function e(a){var b=G.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=a.length;d--;)w.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||W)-(~a.sourceIndex||W);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function i(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function j(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function k(a){return a&&typeof a.getElementsByTagName!==V&&a}function l(){}function m(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function n(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Q++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[P,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[N]||(b[N]={}),(h=i[d])&&h[0]===P&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function o(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function p(a,c,d){for(var e=0,f=c.length;f>e;e++)b(a,c[e],d);return d}function q(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function r(a,b,c,e,f,g){return e&&!e[N]&&(e=r(e)),f&&!f[N]&&(f=r(f,g)),d(function(d,g,h,i){var j,k,l,m=[],n=[],o=g.length,r=d||p(b||"*",h.nodeType?[h]:h,[]),s=!a||!d&&b?r:q(r,m,a,h,i),t=c?f||(d?a:o||e)?[]:g:s;if(c&&c(s,t,h,i),e)for(j=q(t,n),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(t[n[k]]=!(s[n[k]]=l));if(d){if(f||a){if(f){for(j=[],k=t.length;k--;)(l=t[k])&&j.push(s[k]=l);f(null,t=[],j,i)}for(k=t.length;k--;)(l=t[k])&&(j=f?ba.call(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else t=q(t===g?t.splice(o,t.length):t),f?f(null,g,t,i):_.apply(g,t)})}function s(a){for(var b,c,d,e=a.length,f=w.relative[a[0].type],g=f||w.relative[" "],h=f?1:0,i=n(function(a){return a===b},g,!0),j=n(function(a){return ba.call(b,a)>-1},g,!0),k=[function(a,c,d){return!f&&(d||c!==C)||((b=c).nodeType?i(a,c,d):j(a,c,d))}];e>h;h++)if(c=w.relative[a[h].type])k=[n(o(k),c)];else{if(c=w.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;e>d&&!w.relative[a[d].type];d++);return r(h>1&&o(k),h>1&&m(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ia,"$1"),c,d>h&&s(a.slice(h,d)),e>d&&s(a=a.slice(d)),e>d&&m(a))}k.push(c)}return o(k)}function t(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,o="0",p=d&&[],r=[],s=C,t=d||f&&w.find.TAG("*",j),u=P+=null==s?1:Math.random()||.1,v=t.length;for(j&&(C=g!==G&&g);o!==v&&null!=(k=t[o]);o++){if(f&&k){for(l=0;m=a[l++];)if(m(k,g,h)){i.push(k);break}j&&(P=u)}e&&((k=!m&&k)&&n--,d&&p.push(k))}if(n+=o,e&&o!==n){for(l=0;m=c[l++];)m(p,r,g,h);if(d){if(n>0)for(;o--;)p[o]||r[o]||(r[o]=Z.call(i));r=q(r)}_.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(P=u,C=s),p};return e?d(g):g}var u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+-new Date,O=a.document,P=0,Q=0,R=c(),S=c(),T=c(),U=function(a,b){return a===b&&(E=!0),0},V="undefined",W=1<<31,X={}.hasOwnProperty,Y=[],Z=Y.pop,$=Y.push,_=Y.push,aa=Y.slice,ba=Y.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},ca="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",da="[\\x20\\t\\r\\n\\f]",ea="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",fa=ea.replace("w","w#"),ga="\\["+da+"*("+ea+")(?:"+da+"*([*^$|!~]?=)"+da+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+fa+"))|)"+da+"*\\]",ha=":("+ea+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ga+")*)|.*)\\)|)",ia=new RegExp("^"+da+"+|((?:^|[^\\\\])(?:\\\\.)*)"+da+"+$","g"),ja=new RegExp("^"+da+"*,"+da+"*"),ka=new RegExp("^"+da+"*([>+~]|"+da+")"+da+"*"),la=new RegExp("="+da+"*([^\\]'\"]*?)"+da+"*\\]","g"),ma=new RegExp(ha),na=new RegExp("^"+fa+"$"),oa={ID:new RegExp("^#("+ea+")"),CLASS:new RegExp("^\\.("+ea+")"),TAG:new RegExp("^("+ea.replace("w","w*")+")"),ATTR:new RegExp("^"+ga),PSEUDO:new RegExp("^"+ha),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+da+"*(even|odd|(([+-]|)(\\d*)n|)"+da+"*(?:([+-]|)"+da+"*(\\d+)|))"+da+"*\\)|)","i"),bool:new RegExp("^(?:"+ca+")$","i"),needsContext:new RegExp("^"+da+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+da+"*((?:-\\d)?\\d*)"+da+"*\\)|)(?=[^-]|$)","i")},pa=/^(?:input|select|textarea|button)$/i,qa=/^h\d$/i,ra=/^[^{]+\{\s*\[native \w/,sa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ta=/[+~]/,ua=/'|\\/g,va=new RegExp("\\\\([\\da-f]{1,6}"+da+"?|("+da+")|.)","ig"),wa=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{_.apply(Y=aa.call(O.childNodes),O.childNodes),Y[O.childNodes.length].nodeType}catch(xa){_={apply:Y.length?function(a,b){$.apply(a,aa.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}v=b.support={},y=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},F=b.setDocument=function(a){var b,c=a?a.ownerDocument||a:O,d=c.defaultView;return c!==G&&9===c.nodeType&&c.documentElement?(G=c,H=c.documentElement,I=!y(c),d&&d!==d.top&&(d.addEventListener?d.addEventListener("unload",function(){F()},!1):d.attachEvent&&d.attachEvent("onunload",function(){F()})),v.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),v.getElementsByTagName=e(function(a){return a.appendChild(c.createComment("")),!a.getElementsByTagName("*").length}),v.getElementsByClassName=ra.test(c.getElementsByClassName)&&e(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),v.getById=e(function(a){return H.appendChild(a).id=N,!c.getElementsByName||!c.getElementsByName(N).length}),v.getById?(w.find.ID=function(a,b){if(typeof b.getElementById!==V&&I){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},w.filter.ID=function(a){var b=a.replace(va,wa);return function(a){return a.getAttribute("id")===b}}):(delete w.find.ID,w.filter.ID=function(a){var b=a.replace(va,wa);return function(a){var c=typeof a.getAttributeNode!==V&&a.getAttributeNode("id");return c&&c.value===b}}),w.find.TAG=v.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==V?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},w.find.CLASS=v.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==V&&I?b.getElementsByClassName(a):void 0},K=[],J=[],(v.qsa=ra.test(c.querySelectorAll))&&(e(function(a){a.innerHTML="<select msallowclip=''><option selected=''></option></select>",a.querySelectorAll("[msallowclip^='']").length&&J.push("[*^$]="+da+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||J.push("\\["+da+"*(?:value|"+ca+")"),a.querySelectorAll(":checked").length||J.push(":checked")}),e(function(a){var b=c.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&J.push("name"+da+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||J.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),J.push(",.*:")})),(v.matchesSelector=ra.test(L=H.matches||H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&e(function(a){v.disconnectedMatch=L.call(a,"div"),L.call(a,"[s!='']:x"),K.push("!=",ha)}),J=J.length&&new RegExp(J.join("|")),K=K.length&&new RegExp(K.join("|")),b=ra.test(H.compareDocumentPosition),M=b||ra.test(H.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},U=b?function(a,b){if(a===b)return E=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!v.sortDetached&&b.compareDocumentPosition(a)===d?a===c||a.ownerDocument===O&&M(O,a)?-1:b===c||b.ownerDocument===O&&M(O,b)?1:D?ba.call(D,a)-ba.call(D,b):0:4&d?-1:1)}:function(a,b){if(a===b)return E=!0,0;var d,e=0,f=a.parentNode,h=b.parentNode,i=[a],j=[b];if(!f||!h)return a===c?-1:b===c?1:f?-1:h?1:D?ba.call(D,a)-ba.call(D,b):0;if(f===h)return g(a,b);for(d=a;d=d.parentNode;)i.unshift(d);for(d=b;d=d.parentNode;)j.unshift(d);for(;i[e]===j[e];)e++;return e?g(i[e],j[e]):i[e]===O?-1:j[e]===O?1:0},c):G},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==G&&F(a),c=c.replace(la,"='$1']"),v.matchesSelector&&I&&(!K||!K.test(c))&&(!J||!J.test(c)))try{var d=L.call(a,c);if(d||v.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return b(c,G,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==G&&F(a),M(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==G&&F(a);var c=w.attrHandle[b.toLowerCase()],d=c&&X.call(w.attrHandle,b.toLowerCase())?c(a,b,!I):void 0;return void 0!==d?d:v.attributes||!I?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(E=!v.detectDuplicates,D=!v.sortStable&&a.slice(0),a.sort(U),E){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return D=null,a},x=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=x(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=x(b);return c},w=b.selectors={cacheLength:50,createPseudo:d,match:oa,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(va,wa),a[3]=(a[3]||a[4]||a[5]||"").replace(va,wa),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return oa.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&ma.test(c)&&(b=z(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(va,wa).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=R[a+" "];return b||(b=new RegExp("(^|"+da+")"+a+"("+da+"|$)"))&&R(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==V&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:c?(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f+" ").indexOf(d)>-1:"|="===c?f===d||f.slice(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[N]||(q[N]={}),j=k[a]||[],n=j[0]===P&&j[1],m=j[0]===P&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[P,n,m];break}}else if(s&&(j=(b[N]||(b[N]={}))[a])&&j[0]===P)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[N]||(l[N]={}))[a]=[P,m]),l!==b)););return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,c){var e,f=w.pseudos[a]||w.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[N]?f(c):f.length>1?(e=[a,a,"",c],w.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=ba.call(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=A(a.replace(ia,"$1"));return e[N]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return function(b){return(b.textContent||b.innerText||x(b)).indexOf(a)>-1}}),lang:d(function(a){return na.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(va,wa).toLowerCase(),function(b){var c;do if(c=I?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===H},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!w.pseudos.empty(a)},header:function(a){return qa.test(a.nodeName)},input:function(a){return pa.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:j(function(){return[0]}),last:j(function(a,b){return[b-1]}),eq:j(function(a,b,c){return[0>c?c+b:c]}),even:j(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:j(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:j(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:j(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},w.pseudos.nth=w.pseudos.eq;for(u in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[u]=h(u);for(u in{submit:!0,reset:!0})w.pseudos[u]=i(u);return l.prototype=w.filters=w.pseudos,w.setFilters=new l,z=b.tokenize=function(a,c){var d,e,f,g,h,i,j,k=S[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=w.preFilter;h;){d&&!(e=ja.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=ka.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ia," ")}),h=h.slice(d.length));for(g in w.filter)!(e=oa[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):S(a,i).slice(0)},A=b.compile=function(a,b){var c,d=[],e=[],f=T[a+" "];if(!f){for(b||(b=z(a)),c=b.length;c--;)f=s(b[c]),f[N]?d.push(f):e.push(f);f=T(a,t(e,d)),f.selector=a}return f},B=b.select=function(a,b,c,d){var e,f,g,h,i,j="function"==typeof a&&a,l=!d&&z(a=j.selector||a);if(c=c||[],1===l.length){if(f=l[0]=l[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&v.getById&&9===b.nodeType&&I&&w.relative[f[1].type]){if(b=(w.find.ID(g.matches[0].replace(va,wa),b)||[])[0],!b)return c;j&&(b=b.parentNode),a=a.slice(f.shift().value.length)}for(e=oa.needsContext.test(a)?0:f.length;e--&&(g=f[e],!w.relative[h=g.type]);)if((i=w.find[h])&&(d=i(g.matches[0].replace(va,wa),ta.test(f[0].type)&&k(b.parentNode)||b))){if(f.splice(e,1),a=d.length&&m(f),!a)return _.apply(c,d),c;break}}return(j||A(a,l))(d,b,!I,c,ta.test(a)&&k(b.parentNode)||b),c},v.sortStable=N.split("").sort(U).join("")===N,v.detectDuplicates=!!E,F(),v.sortDetached=e(function(a){return 1&a.compareDocumentPosition(G.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),v.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(ca,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(a);_.find=ea,_.expr=ea.selectors,_.expr[":"]=_.expr.pseudos,_.unique=ea.uniqueSort,_.text=ea.getText,_.isXMLDoc=ea.isXML,_.contains=ea.contains;var fa=_.expr.match.needsContext,ga=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ha=/^.[^:#\[\.,]*$/;_.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?_.find.matchesSelector(d,a)?[d]:[]:_.find.matches(a,_.grep(b,function(a){return 1===a.nodeType}))},_.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(_(a).filter(function(){
for(b=0;c>b;b++)if(_.contains(e[b],this))return!0}));for(b=0;c>b;b++)_.find(a,e[b],d);return d=this.pushStack(c>1?_.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(d(this,a||[],!1))},not:function(a){return this.pushStack(d(this,a||[],!0))},is:function(a){return!!d(this,"string"==typeof a&&fa.test(a)?_(a):a||[],!1).length}});var ia,ja=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ka=_.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:ja.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||ia).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof _?b[0]:b,_.merge(this,_.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:Z,!0)),ga.test(c[1])&&_.isPlainObject(b))for(c in b)_.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=Z.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=Z,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):_.isFunction(a)?"undefined"!=typeof ia.ready?ia.ready(a):a(_):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),_.makeArray(a,this))};ka.prototype=_.fn,ia=_(Z);var la=/^(?:parents|prev(?:Until|All))/,ma={children:!0,contents:!0,next:!0,prev:!0};_.extend({dir:function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&_(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),_.fn.extend({has:function(a){var b=_(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(_.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=fa.test(a)||"string"!=typeof a?_(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&_.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?_.unique(f):f)},index:function(a){return a?"string"==typeof a?U.call(_(a),this[0]):U.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(_.unique(_.merge(this.get(),_(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),_.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return _.dir(a,"parentNode")},parentsUntil:function(a,b,c){return _.dir(a,"parentNode",c)},next:function(a){return e(a,"nextSibling")},prev:function(a){return e(a,"previousSibling")},nextAll:function(a){return _.dir(a,"nextSibling")},prevAll:function(a){return _.dir(a,"previousSibling")},nextUntil:function(a,b,c){return _.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return _.dir(a,"previousSibling",c)},siblings:function(a){return _.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return _.sibling(a.firstChild)},contents:function(a){return a.contentDocument||_.merge([],a.childNodes)}},function(a,b){_.fn[a]=function(c,d){var e=_.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=_.filter(d,e)),this.length>1&&(ma[a]||_.unique(e),la.test(a)&&e.reverse()),this.pushStack(e)}});var na=/\S+/g,oa={};_.Callbacks=function(a){a="string"==typeof a?oa[a]||f(a):_.extend({},a);var b,c,d,e,g,h,i=[],j=!a.once&&[],k=function(f){for(b=a.memory&&f,c=!0,h=e||0,e=0,g=i.length,d=!0;i&&g>h;h++)if(i[h].apply(f[0],f[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,i&&(j?j.length&&k(j.shift()):b?i=[]:l.disable())},l={add:function(){if(i){var c=i.length;!function f(b){_.each(b,function(b,c){var d=_.type(c);"function"===d?a.unique&&l.has(c)||i.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),d?g=i.length:b&&(e=c,k(b))}return this},remove:function(){return i&&_.each(arguments,function(a,b){for(var c;(c=_.inArray(b,i,c))>-1;)i.splice(c,1),d&&(g>=c&&g--,h>=c&&h--)}),this},has:function(a){return a?_.inArray(a,i)>-1:!(!i||!i.length)},empty:function(){return i=[],g=0,this},disable:function(){return i=j=b=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,b||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return!i||c&&!j||(b=b||[],b=[a,b.slice?b.slice():b],d?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!c}};return l},_.extend({Deferred:function(a){var b=[["resolve","done",_.Callbacks("once memory"),"resolved"],["reject","fail",_.Callbacks("once memory"),"rejected"],["notify","progress",_.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return _.Deferred(function(c){_.each(b,function(b,f){var g=_.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&_.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?_.extend(a,d):d}},e={};return d.pipe=d.then,_.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=R.call(arguments),g=f.length,h=1!==g||a&&_.isFunction(a.promise)?g:0,i=1===h?a:_.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?R.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);g>e;e++)f[e]&&_.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var pa;_.fn.ready=function(a){return _.ready.promise().done(a),this},_.extend({isReady:!1,readyWait:1,holdReady:function(a){a?_.readyWait++:_.ready(!0)},ready:function(a){(a===!0?--_.readyWait:_.isReady)||(_.isReady=!0,a!==!0&&--_.readyWait>0||(pa.resolveWith(Z,[_]),_.fn.triggerHandler&&(_(Z).triggerHandler("ready"),_(Z).off("ready"))))}}),_.ready.promise=function(b){return pa||(pa=_.Deferred(),"complete"===Z.readyState?setTimeout(_.ready):(Z.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1))),pa.promise(b)},_.ready.promise();var qa=_.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===_.type(c)){e=!0;for(h in c)_.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,_.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(_(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};_.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType},h.uid=1,h.accepts=_.acceptData,h.prototype={key:function(a){if(!h.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=h.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,_.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(_.isEmptyObject(f))_.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,_.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{_.isArray(b)?d=b.concat(b.map(_.camelCase)):(e=_.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(na)||[])),c=d.length;for(;c--;)delete g[d[c]]}},hasData:function(a){return!_.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var ra=new h,sa=new h,ta=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ua=/([A-Z])/g;_.extend({hasData:function(a){return sa.hasData(a)||ra.hasData(a)},data:function(a,b,c){return sa.access(a,b,c)},removeData:function(a,b){sa.remove(a,b)},_data:function(a,b,c){return ra.access(a,b,c)},_removeData:function(a,b){ra.remove(a,b)}}),_.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=sa.get(f),1===f.nodeType&&!ra.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=_.camelCase(d.slice(5)),i(f,d,e[d])));ra.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){sa.set(this,a)}):qa(this,function(b){var c,d=_.camelCase(a);if(f&&void 0===b){if(c=sa.get(f,a),void 0!==c)return c;if(c=sa.get(f,d),void 0!==c)return c;if(c=i(f,d,void 0),void 0!==c)return c}else this.each(function(){var c=sa.get(this,d);sa.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&sa.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){sa.remove(this,a)})}}),_.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=ra.get(a,b),c&&(!d||_.isArray(c)?d=ra.access(a,b,_.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=_.queue(a,b),d=c.length,e=c.shift(),f=_._queueHooks(a,b),g=function(){_.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return ra.get(a,c)||ra.access(a,c,{empty:_.Callbacks("once memory").add(function(){ra.remove(a,[b+"queue",c])})})}}),_.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?_.queue(this[0],a):void 0===b?this:this.each(function(){var c=_.queue(this,a,b);_._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&_.dequeue(this,a)})},dequeue:function(a){return this.each(function(){_.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=_.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)c=ra.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var va=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,wa=["Top","Right","Bottom","Left"],xa=function(a,b){return a=b||a,"none"===_.css(a,"display")||!_.contains(a.ownerDocument,a)},ya=/^(?:checkbox|radio)$/i;!function(){var a=Z.createDocumentFragment(),b=a.appendChild(Z.createElement("div")),c=Z.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),Y.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",Y.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var za="undefined";Y.focusinBubbles="onfocusin"in a;var Aa=/^key/,Ba=/^(?:mouse|pointer|contextmenu)|click/,Ca=/^(?:focusinfocus|focusoutblur)$/,Da=/^([^.]*)(?:\.(.+)|)$/;_.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=ra.get(a);if(q)for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=_.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return typeof _!==za&&_.event.triggered!==b.type?_.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(na)||[""],j=b.length;j--;)h=Da.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=_.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=_.event.special[n]||{},k=_.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&_.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),_.event.global[n]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=ra.hasData(a)&&ra.get(a);if(q&&(i=q.events)){for(b=(b||"").match(na)||[""],j=b.length;j--;)if(h=Da.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=_.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||_.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)_.event.remove(a,n+b[j],c,d,!0);_.isEmptyObject(i)&&(delete q.handle,ra.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,j,k,l,m=[d||Z],n=X.call(b,"type")?b.type:b,o=X.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||Z,3!==d.nodeType&&8!==d.nodeType&&!Ca.test(n+_.event.triggered)&&(n.indexOf(".")>=0&&(o=n.split("."),n=o.shift(),o.sort()),j=n.indexOf(":")<0&&"on"+n,b=b[_.expando]?b:new _.Event(n,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=o.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:_.makeArray(c,[b]),l=_.event.special[n]||{},e||!l.trigger||l.trigger.apply(d,c)!==!1)){if(!e&&!l.noBubble&&!_.isWindow(d)){for(i=l.delegateType||n,Ca.test(i+n)||(g=g.parentNode);g;g=g.parentNode)m.push(g),h=g;h===(d.ownerDocument||Z)&&m.push(h.defaultView||h.parentWindow||a)}for(f=0;(g=m[f++])&&!b.isPropagationStopped();)b.type=f>1?i:l.bindType||n,k=(ra.get(g,"events")||{})[b.type]&&ra.get(g,"handle"),k&&k.apply(g,c),k=j&&g[j],k&&k.apply&&_.acceptData(g)&&(b.result=k.apply(g,c),b.result===!1&&b.preventDefault());return b.type=n,e||b.isDefaultPrevented()||l._default&&l._default.apply(m.pop(),c)!==!1||!_.acceptData(d)||j&&_.isFunction(d[n])&&!_.isWindow(d)&&(h=d[j],h&&(d[j]=null),_.event.triggered=n,d[n](),_.event.triggered=void 0,h&&(d[j]=h)),b.result}},dispatch:function(a){a=_.event.fix(a);var b,c,d,e,f,g=[],h=R.call(arguments),i=(ra.get(this,"events")||{})[a.type]||[],j=_.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||j.preDispatch.call(this,a)!==!1){for(g=_.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,c=0;(f=e.handlers[c++])&&!a.isImmediatePropagationStopped();)a.namespace_re&&!a.namespace_re.test(f.namespace)||(a.handleObj=f,a.data=f.data,d=((_.event.special[f.origType]||{}).handle||f.handler).apply(e.elem,h),void 0!==d&&(a.result=d)===!1&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?_(e,this).index(i)>=0:_.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||Z,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[_.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Ba.test(e)?this.mouseHooks:Aa.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new _.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=Z),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==l()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===l()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&_.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return _.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=_.extend(new _.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?_.event.trigger(e,null,b):_.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},_.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},_.Event=function(a,b){return this instanceof _.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?j:k):this.type=a,b&&_.extend(this,b),this.timeStamp=a&&a.timeStamp||_.now(),void(this[_.expando]=!0)):new _.Event(a,b)},_.Event.prototype={isDefaultPrevented:k,isPropagationStopped:k,isImmediatePropagationStopped:k,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=j,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=j,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=j,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},_.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){_.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||_.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),Y.focusinBubbles||_.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){_.event.simulate(b,a.target,_.event.fix(a),!0)};_.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=ra.access(d,b);e||d.addEventListener(a,c,!0),ra.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=ra.access(d,b)-1;e?ra.access(d,b,e):(d.removeEventListener(a,c,!0),ra.remove(d,b))}}}),_.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=k;else if(!d)return this;return 1===e&&(f=d,d=function(a){return _().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=_.guid++)),this.each(function(){_.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,_(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return b!==!1&&"function"!=typeof b||(c=b,b=void 0),c===!1&&(c=k),this.each(function(){_.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){_.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?_.event.trigger(a,b,c,!0):void 0}});var Ea=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Fa=/<([\w:]+)/,Ga=/<|&#?\w+;/,Ha=/<(?:script|style|link)/i,Ia=/checked\s*(?:[^=]|=\s*.checked.)/i,Ja=/^$|\/(?:java|ecma)script/i,Ka=/^true\/(.*)/,La=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ma={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ma.optgroup=Ma.option,Ma.tbody=Ma.tfoot=Ma.colgroup=Ma.caption=Ma.thead,Ma.th=Ma.td,_.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=_.contains(a.ownerDocument,a);if(!(Y.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||_.isXMLDoc(a)))for(g=r(h),f=r(a),d=0,e=f.length;e>d;d++)s(f[d],g[d]);if(b)if(c)for(f=f||r(a),g=g||r(h),d=0,e=f.length;e>d;d++)q(f[d],g[d]);else q(a,h);return g=r(h,"script"),g.length>0&&p(g,!i&&r(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,n=a.length;n>m;m++)if(e=a[m],e||0===e)if("object"===_.type(e))_.merge(l,e.nodeType?[e]:e);else if(Ga.test(e)){for(f=f||k.appendChild(b.createElement("div")),g=(Fa.exec(e)||["",""])[1].toLowerCase(),h=Ma[g]||Ma._default,f.innerHTML=h[1]+e.replace(Ea,"<$1></$2>")+h[2],j=h[0];j--;)f=f.lastChild;_.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));for(k.textContent="",m=0;e=l[m++];)if((!d||-1===_.inArray(e,d))&&(i=_.contains(e.ownerDocument,e),f=r(k.appendChild(e),"script"),i&&p(f),c))for(j=0;e=f[j++];)Ja.test(e.type||"")&&c.push(e);return k},cleanData:function(a){for(var b,c,d,e,f=_.event.special,g=0;void 0!==(c=a[g]);g++){if(_.acceptData(c)&&(e=c[ra.expando],e&&(b=ra.cache[e]))){if(b.events)for(d in b.events)f[d]?_.event.remove(c,d):_.removeEvent(c,d,b.handle);ra.cache[e]&&delete ra.cache[e]}delete sa.cache[c[sa.expando]]}}}),_.fn.extend({text:function(a){return qa(this,function(a){return void 0===a?_.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=m(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=m(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?_.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||_.cleanData(r(c)),c.parentNode&&(b&&_.contains(c.ownerDocument,c)&&p(r(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(_.cleanData(r(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return _.clone(this,a,b)})},html:function(a){return qa(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!Ha.test(a)&&!Ma[(Fa.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Ea,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(_.cleanData(r(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,_.cleanData(r(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=S.apply([],a);var c,d,e,f,g,h,i=0,j=this.length,k=this,l=j-1,m=a[0],p=_.isFunction(m);if(p||j>1&&"string"==typeof m&&!Y.checkClone&&Ia.test(m))return this.each(function(c){var d=k.eq(c);p&&(a[0]=m.call(this,c,d.html())),d.domManip(a,b)});if(j&&(c=_.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(e=_.map(r(c,"script"),n),f=e.length;j>i;i++)g=c,i!==l&&(g=_.clone(g,!0,!0),f&&_.merge(e,r(g,"script"))),b.call(this[i],g,i);if(f)for(h=e[e.length-1].ownerDocument,_.map(e,o),i=0;f>i;i++)g=e[i],Ja.test(g.type||"")&&!ra.access(g,"globalEval")&&_.contains(h,g)&&(g.src?_._evalUrl&&_._evalUrl(g.src):_.globalEval(g.textContent.replace(La,"")))}return this}}),_.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){_.fn[a]=function(a){for(var c,d=[],e=_(a),f=e.length-1,g=0;f>=g;g++)c=g===f?this:this.clone(!0),_(e[g])[b](c),T.apply(d,c.get());return this.pushStack(d)}});var Na,Oa={},Pa=/^margin/,Qa=new RegExp("^("+va+")(?!px)[a-z%]+$","i"),Ra=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)};!function(){function b(){g.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",g.innerHTML="",e.appendChild(f);var b=a.getComputedStyle(g,null);c="1%"!==b.top,d="4px"===b.width,e.removeChild(f)}var c,d,e=Z.documentElement,f=Z.createElement("div"),g=Z.createElement("div");g.style&&(g.style.backgroundClip="content-box",g.cloneNode(!0).style.backgroundClip="",Y.clearCloneStyle="content-box"===g.style.backgroundClip,f.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",f.appendChild(g),a.getComputedStyle&&_.extend(Y,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return null==d&&b(),d},reliableMarginRight:function(){var b,c=g.appendChild(Z.createElement("div"));return c.style.cssText=g.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",g.style.width="1px",e.appendChild(f),b=!parseFloat(a.getComputedStyle(c,null).marginRight),e.removeChild(f),b}}))}(),_.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Sa=/^(none|table(?!-c[ea]).+)/,Ta=new RegExp("^("+va+")(.*)$","i"),Ua=new RegExp("^([+-])=("+va+")","i"),Va={position:"absolute",visibility:"hidden",display:"block"},Wa={letterSpacing:"0",fontWeight:"400"},Xa=["Webkit","O","Moz","ms"];_.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=v(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=_.camelCase(b),i=a.style;return b=_.cssProps[h]||(_.cssProps[h]=x(i,h)),g=_.cssHooks[b]||_.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Ua.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(_.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||_.cssNumber[h]||(c+="px"),Y.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=_.camelCase(b);return b=_.cssProps[h]||(_.cssProps[h]=x(a.style,h)),g=_.cssHooks[b]||_.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=v(a,b,d)),"normal"===e&&b in Wa&&(e=Wa[b]),""===c||c?(f=parseFloat(e),c===!0||_.isNumeric(f)?f||0:e):e}}),_.each(["height","width"],function(a,b){_.cssHooks[b]={get:function(a,c,d){return c?Sa.test(_.css(a,"display"))&&0===a.offsetWidth?_.swap(a,Va,function(){return A(a,b,d)}):A(a,b,d):void 0},set:function(a,c,d){var e=d&&Ra(a);return y(a,c,d?z(a,b,d,"border-box"===_.css(a,"boxSizing",!1,e),e):0)}}}),_.cssHooks.marginRight=w(Y.reliableMarginRight,function(a,b){return b?_.swap(a,{display:"inline-block"},v,[a,"marginRight"]):void 0}),_.each({margin:"",padding:"",border:"Width"},function(a,b){_.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+wa[d]+b]=f[d]||f[d-2]||f[0];return e}},Pa.test(a)||(_.cssHooks[a+b].set=y)}),_.fn.extend({css:function(a,b){return qa(this,function(a,b,c){var d,e,f={},g=0;if(_.isArray(b)){for(d=Ra(a),e=b.length;e>g;g++)f[b[g]]=_.css(a,b[g],!1,d);return f}return void 0!==c?_.style(a,b,c):_.css(a,b)},a,b,arguments.length>1)},show:function(){return B(this,!0)},hide:function(){return B(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){xa(this)?_(this).show():_(this).hide()})}}),_.Tween=C,C.prototype={constructor:C,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(_.cssNumber[c]?"":"px")},cur:function(){var a=C.propHooks[this.prop];return a&&a.get?a.get(this):C.propHooks._default.get(this)},run:function(a){var b,c=C.propHooks[this.prop];return this.options.duration?this.pos=b=_.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):C.propHooks._default.set(this),this}},C.prototype.init.prototype=C.prototype,C.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=_.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){_.fx.step[a.prop]?_.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[_.cssProps[a.prop]]||_.cssHooks[a.prop])?_.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},C.propHooks.scrollTop=C.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},_.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},_.fx=C.prototype.init,_.fx.step={};var Ya,Za,$a=/^(?:toggle|show|hide)$/,_a=new RegExp("^(?:([+-])=|)("+va+")([a-z%]*)$","i"),ab=/queueHooks$/,bb=[G],cb={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=_a.exec(b),f=e&&e[3]||(_.cssNumber[a]?"":"px"),g=(_.cssNumber[a]||"px"!==f&&+d)&&_a.exec(_.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,_.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};_.Animation=_.extend(I,{tweener:function(a,b){_.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],cb[c]=cb[c]||[],cb[c].unshift(b)},prefilter:function(a,b){b?bb.unshift(a):bb.push(a)}}),_.speed=function(a,b,c){var d=a&&"object"==typeof a?_.extend({},a):{complete:c||!c&&b||_.isFunction(a)&&a,duration:a,easing:c&&b||b&&!_.isFunction(b)&&b};return d.duration=_.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in _.fx.speeds?_.fx.speeds[d.duration]:_.fx.speeds._default,null!=d.queue&&d.queue!==!0||(d.queue="fx"),d.old=d.complete,d.complete=function(){_.isFunction(d.old)&&d.old.call(this),d.queue&&_.dequeue(this,d.queue)},d},_.fn.extend({fadeTo:function(a,b,c,d){return this.filter(xa).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=_.isEmptyObject(a),f=_.speed(b,c,d),g=function(){var b=I(this,_.extend({},a),f);(e||ra.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=_.timers,g=ra.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&ab.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||_.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=ra.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=_.timers,g=d?d.length:0;for(c.finish=!0,_.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);
delete c.finish})}}),_.each(["toggle","show","hide"],function(a,b){var c=_.fn[b];_.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(E(b,!0),a,d,e)}}),_.each({slideDown:E("show"),slideUp:E("hide"),slideToggle:E("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){_.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),_.timers=[],_.fx.tick=function(){var a,b=0,c=_.timers;for(Ya=_.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||_.fx.stop(),Ya=void 0},_.fx.timer=function(a){_.timers.push(a),a()?_.fx.start():_.timers.pop()},_.fx.interval=13,_.fx.start=function(){Za||(Za=setInterval(_.fx.tick,_.fx.interval))},_.fx.stop=function(){clearInterval(Za),Za=null},_.fx.speeds={slow:600,fast:200,_default:400},_.fn.delay=function(a,b){return a=_.fx?_.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=Z.createElement("input"),b=Z.createElement("select"),c=b.appendChild(Z.createElement("option"));a.type="checkbox",Y.checkOn=""!==a.value,Y.optSelected=c.selected,b.disabled=!0,Y.optDisabled=!c.disabled,a=Z.createElement("input"),a.value="t",a.type="radio",Y.radioValue="t"===a.value}();var db,eb,fb=_.expr.attrHandle;_.fn.extend({attr:function(a,b){return qa(this,_.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){_.removeAttr(this,a)})}}),_.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===za?_.prop(a,b,c):(1===f&&_.isXMLDoc(a)||(b=b.toLowerCase(),d=_.attrHooks[b]||(_.expr.match.bool.test(b)?eb:db)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=_.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void _.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(na);if(f&&1===a.nodeType)for(;c=f[e++];)d=_.propFix[c]||c,_.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!Y.radioValue&&"radio"===b&&_.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),eb={set:function(a,b,c){return b===!1?_.removeAttr(a,c):a.setAttribute(c,c),c}},_.each(_.expr.match.bool.source.match(/\w+/g),function(a,b){var c=fb[b]||_.find.attr;fb[b]=function(a,b,d){var e,f;return d||(f=fb[b],fb[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,fb[b]=f),e}});var gb=/^(?:input|select|textarea|button)$/i;_.fn.extend({prop:function(a,b){return qa(this,_.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[_.propFix[a]||a]})}}),_.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!_.isXMLDoc(a),f&&(b=_.propFix[b]||b,e=_.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||gb.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),Y.optSelected||(_.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),_.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){_.propFix[this.toLowerCase()]=this});var hb=/[\t\r\n\f]/g;_.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(_.isFunction(a))return this.each(function(b){_(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(na)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(hb," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=_.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(_.isFunction(a))return this.each(function(b){_(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(na)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(hb," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");g=a?_.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):_.isFunction(a)?this.each(function(c){_(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,e=_(this),f=a.match(na)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else c!==za&&"boolean"!==c||(this.className&&ra.set(this,"__className__",this.className),this.className=this.className||a===!1?"":ra.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(hb," ").indexOf(b)>=0)return!0;return!1}});var ib=/\r/g;_.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=_.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,_(this).val()):a,null==e?e="":"number"==typeof e?e+="":_.isArray(e)&&(e=_.map(e,function(a){return null==a?"":a+""})),b=_.valHooks[this.type]||_.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=_.valHooks[e.type]||_.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(ib,""):null==c?"":c)}}}),_.extend({valHooks:{option:{get:function(a){var b=_.find.attr(a,"value");return null!=b?b:_.trim(_.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],(c.selected||i===e)&&(Y.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!_.nodeName(c.parentNode,"optgroup"))){if(b=_(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=_.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=_.inArray(d.value,f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),_.each(["radio","checkbox"],function(){_.valHooks[this]={set:function(a,b){return _.isArray(b)?a.checked=_.inArray(_(a).val(),b)>=0:void 0}},Y.checkOn||(_.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),_.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){_.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),_.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var jb=_.now(),kb=/\?/;_.parseJSON=function(a){return JSON.parse(a+"")},_.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return b&&!b.getElementsByTagName("parsererror").length||_.error("Invalid XML: "+a),b};var lb,mb,nb=/#.*$/,ob=/([?&])_=[^&]*/,pb=/^(.*?):[ \t]*([^\r\n]*)$/gm,qb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rb=/^(?:GET|HEAD)$/,sb=/^\/\//,tb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,ub={},vb={},wb="*/".concat("*");try{mb=location.href}catch(xb){mb=Z.createElement("a"),mb.href="",mb=mb.href}lb=tb.exec(mb.toLowerCase())||[],_.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:mb,type:"GET",isLocal:qb.test(lb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":wb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":_.parseJSON,"text xml":_.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?L(L(a,_.ajaxSettings),b):L(_.ajaxSettings,a)},ajaxPrefilter:J(ub),ajaxTransport:J(vb),ajax:function(a,b){function c(a,b,c,g){var i,k,r,s,u,w=b;2!==t&&(t=2,h&&clearTimeout(h),d=void 0,f=g||"",v.readyState=a>0?4:0,i=a>=200&&300>a||304===a,c&&(s=M(l,v,c)),s=N(l,s,v,i),i?(l.ifModified&&(u=v.getResponseHeader("Last-Modified"),u&&(_.lastModified[e]=u),u=v.getResponseHeader("etag"),u&&(_.etag[e]=u)),204===a||"HEAD"===l.type?w="nocontent":304===a?w="notmodified":(w=s.state,k=s.data,r=s.error,i=!r)):(r=w,!a&&w||(w="error",0>a&&(a=0))),v.status=a,v.statusText=(b||w)+"",i?o.resolveWith(m,[k,w,v]):o.rejectWith(m,[v,w,r]),v.statusCode(q),q=void 0,j&&n.trigger(i?"ajaxSuccess":"ajaxError",[v,l,i?k:r]),p.fireWith(m,[v,w]),j&&(n.trigger("ajaxComplete",[v,l]),--_.active||_.event.trigger("ajaxStop")))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var d,e,f,g,h,i,j,k,l=_.ajaxSetup({},b),m=l.context||l,n=l.context&&(m.nodeType||m.jquery)?_(m):_.event,o=_.Deferred(),p=_.Callbacks("once memory"),q=l.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!g)for(g={};b=pb.exec(f);)g[b[1].toLowerCase()]=b[2];b=g[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(l.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return d&&d.abort(b),c(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,l.url=((a||l.url||mb)+"").replace(nb,"").replace(sb,lb[1]+"//"),l.type=b.method||b.type||l.method||l.type,l.dataTypes=_.trim(l.dataType||"*").toLowerCase().match(na)||[""],null==l.crossDomain&&(i=tb.exec(l.url.toLowerCase()),l.crossDomain=!(!i||i[1]===lb[1]&&i[2]===lb[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(lb[3]||("http:"===lb[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=_.param(l.data,l.traditional)),K(ub,l,b,v),2===t)return v;j=l.global,j&&0===_.active++&&_.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!rb.test(l.type),e=l.url,l.hasContent||(l.data&&(e=l.url+=(kb.test(e)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=ob.test(e)?e.replace(ob,"$1_="+jb++):e+(kb.test(e)?"&":"?")+"_="+jb++)),l.ifModified&&(_.lastModified[e]&&v.setRequestHeader("If-Modified-Since",_.lastModified[e]),_.etag[e]&&v.setRequestHeader("If-None-Match",_.etag[e])),(l.data&&l.hasContent&&l.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",l.contentType),v.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+wb+"; q=0.01":""):l.accepts["*"]);for(k in l.headers)v.setRequestHeader(k,l.headers[k]);if(l.beforeSend&&(l.beforeSend.call(m,v,l)===!1||2===t))return v.abort();u="abort";for(k in{success:1,error:1,complete:1})v[k](l[k]);if(d=K(vb,l,b,v)){v.readyState=1,j&&n.trigger("ajaxSend",[v,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){v.abort("timeout")},l.timeout));try{t=1,d.send(r,c)}catch(w){if(!(2>t))throw w;c(-1,w)}}else c(-1,"No Transport");return v},getJSON:function(a,b,c){return _.get(a,b,c,"json")},getScript:function(a,b){return _.get(a,void 0,b,"script")}}),_.each(["get","post"],function(a,b){_[b]=function(a,c,d,e){return _.isFunction(c)&&(e=e||d,d=c,c=void 0),_.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),_.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){_.fn[b]=function(a){return this.on(b,a)}}),_._evalUrl=function(a){return _.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},_.fn.extend({wrapAll:function(a){var b;return _.isFunction(a)?this.each(function(b){_(this).wrapAll(a.call(this,b))}):(this[0]&&(b=_(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return _.isFunction(a)?this.each(function(b){_(this).wrapInner(a.call(this,b))}):this.each(function(){var b=_(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=_.isFunction(a);return this.each(function(c){_(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){_.nodeName(this,"body")||_(this).replaceWith(this.childNodes)}).end()}}),_.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},_.expr.filters.visible=function(a){return!_.expr.filters.hidden(a)};var yb=/%20/g,zb=/\[\]$/,Ab=/\r?\n/g,Bb=/^(?:submit|button|image|reset|file)$/i,Cb=/^(?:input|select|textarea|keygen)/i;_.param=function(a,b){var c,d=[],e=function(a,b){b=_.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=_.ajaxSettings&&_.ajaxSettings.traditional),_.isArray(a)||a.jquery&&!_.isPlainObject(a))_.each(a,function(){e(this.name,this.value)});else for(c in a)O(c,a[c],b,e);return d.join("&").replace(yb,"+")},_.fn.extend({serialize:function(){return _.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=_.prop(this,"elements");return a?_.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!_(this).is(":disabled")&&Cb.test(this.nodeName)&&!Bb.test(a)&&(this.checked||!ya.test(a))}).map(function(a,b){var c=_(this).val();return null==c?null:_.isArray(c)?_.map(c,function(a){return{name:b.name,value:a.replace(Ab,"\r\n")}}):{name:b.name,value:c.replace(Ab,"\r\n")}}).get()}}),_.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Db=0,Eb={},Fb={0:200,1223:204},Gb=_.ajaxSettings.xhr();a.ActiveXObject&&_(a).on("unload",function(){for(var a in Eb)Eb[a]()}),Y.cors=!!Gb&&"withCredentials"in Gb,Y.ajax=Gb=!!Gb,_.ajaxTransport(function(a){var b;return Y.cors||Gb&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++Db;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Eb[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Fb[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Eb[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h}},abort:function(){b&&b()}}:void 0}),_.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return _.globalEval(a),a}}}),_.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),_.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=_("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),Z.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Hb=[],Ib=/(=)\?(?=&|$)|\?\?/;_.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Hb.pop()||_.expando+"_"+jb++;return this[a]=!0,a}}),_.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Ib.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ib.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=_.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Ib,"$1"+e):b.jsonp!==!1&&(b.url+=(kb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||_.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Hb.push(e)),g&&_.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),_.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||Z;var d=ga.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=_.buildFragment([a],b,e),e&&e.length&&_(e).remove(),_.merge([],d.childNodes))};var Jb=_.fn.load;_.fn.load=function(a,b,c){if("string"!=typeof a&&Jb)return Jb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=_.trim(a.slice(h)),a=a.slice(0,h)),_.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&_.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?_("<div>").append(_.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},_.expr.filters.animated=function(a){return _.grep(_.timers,function(b){return a===b.elem}).length};var Kb=a.document.documentElement;_.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=_.css(a,"position"),l=_(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=_.css(a,"top"),i=_.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),_.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},_.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){_.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,_.contains(b,d)?(typeof d.getBoundingClientRect!==za&&(e=d.getBoundingClientRect()),c=P(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===_.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),_.nodeName(a[0],"html")||(d=a.offset()),d.top+=_.css(a[0],"borderTopWidth",!0),d.left+=_.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-_.css(c,"marginTop",!0),left:b.left-d.left-_.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||Kb;a&&!_.nodeName(a,"html")&&"static"===_.css(a,"position");)a=a.offsetParent;return a||Kb})}}),_.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;_.fn[b]=function(e){return qa(this,function(b,e,f){var g=P(b);return void 0===f?g?g[c]:b[e]:void(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f)},b,e,arguments.length,null)}}),_.each(["top","left"],function(a,b){_.cssHooks[b]=w(Y.pixelPosition,function(a,c){return c?(c=v(a,b),Qa.test(c)?_(a).position()[b]+"px":c):void 0})}),_.each({Height:"height",Width:"width"},function(a,b){_.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){_.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return qa(this,function(b,c,d){var e;return _.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?_.css(b,c,g):_.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),_.fn.size=function(){return this.length},_.fn.andSelf=_.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return _});var Lb=a.jQuery,Mb=a.$;return _.noConflict=function(b){return a.$===_&&(a.$=Mb),b&&a.jQuery===_&&(a.jQuery=Lb),_},typeof b===za&&(a.jQuery=a.$=_),_}),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.6.0";var y=x.each=x.forEach=function(a,b,d){if(null==a)return a;if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g=x.keys(a),e=0,f=g.length;f>e;e++)if(b.call(d,a[g[e]],g[e],a)===c)return;return a};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,x.property(b))},x.where=function(a,b){return x.filter(a,x.matches(b))},x.findWhere=function(a,b){return x.find(a,x.matches(b))},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);var d=-(1/0),e=-(1/0);return y(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;h>e&&(d=a,e=h)}),d},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);var d=1/0,e=1/0;return y(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;e>h&&(d=a,e=h)}),d},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d},x.sample=function(a,b,c){return null==b||c?(a.length!==+a.length&&(a=x.values(a)),a[x.random(a.length-1)]):x.shuffle(a).slice(0,Math.max(0,b))};var B=function(a){return null==a?x.identity:x.isFunction(a)?a:x.property(a)};x.sortBy=function(a,b,c){return b=B(b),x.pluck(x.map(a,function(a,d,e){return{value:a,index:d,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var C=function(a){return function(b,c,d){var e={};return c=B(c),y(b,function(f,g){var h=c.call(d,f,g,b);a(e,h,f)}),e}};x.groupBy=C(function(a,b,c){x.has(a,b)?a[b].push(c):a[b]=[c]}),x.indexBy=C(function(a,b,c){a[b]=c}),x.countBy=C(function(a,b){x.has(a,b)?a[b]++:a[b]=1}),x.sortedIndex=function(a,b,c,d){c=B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null!=a?null==b||c?a[0]:0>b?[]:h.call(a,0,b):void 0},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null!=a?null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0)):void 0},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.partition=function(a,b){var c=[],d=[];return y(a,function(a){(b(a)?c:d).push(a)}),[c,d]},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.contains(b,a)})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){for(var c=0,d=b.slice(),e=0,f=d.length;f>e;e++)d[e]===x&&(d[e]=arguments[c++]);for(;c<arguments.length;)d.push(arguments[c++]);return a.apply(this,d)}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:x.now(),g=null,f=a.apply(d,e),d=e=null};return function(){var j=x.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),d=e=null):g||c.trailing===!1||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=x.now()-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),f=e=null))};return function(){f=this,e=arguments,g=x.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return x.partial(b,a)},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=function(a){if(!x.isObject(a))return[];if(v)return v(a);var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},x.pairs=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},x.invert=function(a){for(var b={},c=x.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.constant=function(a){return function(){return a}},x.property=function(a){return function(b){return b[a]}},x.matches=function(a){return function(b){if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){
return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},x.now=Date.now||function(){return(new Date).getTime()};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null!=a){var c=a[b];return x.isFunction(c)?c.call(a):c}},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}.call(this),function(a,b){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(c,d,e){a.Backbone=b(a,e,c,d)});else if("undefined"!=typeof exports){var c=require("underscore");b(a,exports,c)}else a.Backbone=b(a,{},a._,a.jQuery||a.Zepto||a.ender||a.$)}(this,function(a,b,c,d){var e=a.Backbone,f=[],g=(f.push,f.slice);f.splice;b.VERSION="1.1.2",b.$=d,b.noConflict=function(){return a.Backbone=e,this},b.emulateHTTP=!1,b.emulateJSON=!1;var h=b.Events={on:function(a,b,c){if(!j(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,d){if(!j(this,"once",a,[b,d])||!b)return this;var e=this,f=c.once(function(){e.off(a,f),b.apply(this,arguments)});return f._callback=b,this.on(a,f,d)},off:function(a,b,d){var e,f,g,h,i,k,l,m;if(!this._events||!j(this,"off",a,[b,d]))return this;if(!a&&!b&&!d)return this._events=void 0,this;for(h=a?[a]:c.keys(this._events),i=0,k=h.length;k>i;i++)if(a=h[i],g=this._events[a]){if(this._events[a]=e=[],b||d)for(l=0,m=g.length;m>l;l++)f=g[l],(b&&b!==f.callback&&b!==f.callback._callback||d&&d!==f.context)&&e.push(f);e.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=g.call(arguments,1);if(!j(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&k(c,b),d&&k(d,arguments),this},stopListening:function(a,b,d){var e=this._listeningTo;if(!e)return this;var f=!b&&!d;d||"object"!=typeof b||(d=this),a&&((e={})[a._listenId]=a);for(var g in e)a=e[g],a.off(b,d,this),(f||c.isEmpty(a._events))&&delete this._listeningTo[g];return this}},i=/\s+/,j=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(i.test(c)){for(var f=c.split(i),g=0,h=f.length;h>g;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},k=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b);return}},l={listenTo:"on",listenToOnce:"once"};c.each(l,function(a,b){h[b]=function(b,d,e){var f=this._listeningTo||(this._listeningTo={}),g=b._listenId||(b._listenId=c.uniqueId("l"));return f[g]=b,e||"object"!=typeof d||(e=this),b[a](d,e,this),this}}),h.bind=h.on,h.unbind=h.off,c.extend(b,h);var m=b.Model=function(a,b){var d=a||{};b||(b={}),this.cid=c.uniqueId("c"),this.attributes={},b.collection&&(this.collection=b.collection),b.parse&&(d=this.parse(d,b)||{}),d=c.defaults({},d,c.result(this,"defaults")),this.set(d,b),this.changed={},this.initialize.apply(this,arguments)};c.extend(m.prototype,h,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(a){return c.clone(this.attributes)},sync:function(){return b.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return c.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,d){var e,f,g,h,i,j,k,l;if(null==a)return this;if("object"==typeof a?(f=a,d=b):(f={})[a]=b,d||(d={}),!this._validate(f,d))return!1;g=d.unset,i=d.silent,h=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=c.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in f&&(this.id=f[this.idAttribute]);for(e in f)b=f[e],c.isEqual(l[e],b)||h.push(e),c.isEqual(k[e],b)?delete this.changed[e]:this.changed[e]=b,g?delete l[e]:l[e]=b;if(!i){h.length&&(this._pending=d);for(var m=0,n=h.length;n>m;m++)this.trigger("change:"+h[m],this,l[h[m]],d)}if(j)return this;if(!i)for(;this._pending;)d=this._pending,this._pending=!1,this.trigger("change",this,d);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,c.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var d in this.attributes)b[d]=void 0;return this.set(b,c.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!c.isEmpty(this.changed):c.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?c.clone(this.changed):!1;var b,d=!1,e=this._changing?this._previousAttributes:this.attributes;for(var f in a)c.isEqual(e[f],b=a[f])||((d||(d={}))[f]=b);return d},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return c.clone(this._previousAttributes)},fetch:function(a){a=a?c.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=this,d=a.success;return a.success=function(c){return b.set(b.parse(c,a),a)?(d&&d(b,c,a),void b.trigger("sync",b,c,a)):!1},L(this,a),this.sync("read",this,a)},save:function(a,b,d){var e,f,g,h=this.attributes;if(null==a||"object"==typeof a?(e=a,d=b):(e={})[a]=b,d=c.extend({validate:!0},d),e&&!d.wait){if(!this.set(e,d))return!1}else if(!this._validate(e,d))return!1;e&&d.wait&&(this.attributes=c.extend({},h,e)),void 0===d.parse&&(d.parse=!0);var i=this,j=d.success;return d.success=function(a){i.attributes=h;var b=i.parse(a,d);return d.wait&&(b=c.extend(e||{},b)),c.isObject(b)&&!i.set(b,d)?!1:(j&&j(i,a,d),void i.trigger("sync",i,a,d))},L(this,d),f=this.isNew()?"create":d.patch?"patch":"update","patch"===f&&(d.attrs=e),g=this.sync(f,this,d),e&&d.wait&&(this.attributes=h),g},destroy:function(a){a=a?c.clone(a):{};var b=this,d=a.success,e=function(){b.trigger("destroy",b,b.collection,a)};if(a.success=function(c){(a.wait||b.isNew())&&e(),d&&d(b,c,a),b.isNew()||b.trigger("sync",b,c,a)},this.isNew())return a.success(),!1;L(this,a);var f=this.sync("delete",this,a);return a.wait||e(),f},url:function(){var a=c.result(this,"urlRoot")||c.result(this.collection,"url")||K();return this.isNew()?a:a.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},c.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=c.extend({},this.attributes,a);var d=this.validationError=this.validate(a,b)||null;return d?(this.trigger("invalid",this,d,c.extend(b,{validationError:d})),!1):!0}});var n=["keys","values","pairs","invert","pick","omit"];c.each(n,function(a){m.prototype[a]=function(){var b=g.call(arguments);return b.unshift(this.attributes),c[a].apply(c,b)}});var o=b.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,c.extend({silent:!0},b))},p={add:!0,remove:!0,merge:!0},q={add:!0,remove:!1};c.extend(o.prototype,h,{model:m,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return b.sync.apply(this,arguments)},add:function(a,b){return this.set(a,c.extend({merge:!1},b,q))},remove:function(a,b){var d=!c.isArray(a);a=d?[a]:c.clone(a),b||(b={});var e,f,g,h;for(e=0,f=a.length;f>e;e++)h=a[e]=this.get(a[e]),h&&(delete this._byId[h.id],delete this._byId[h.cid],g=this.indexOf(h),this.models.splice(g,1),this.length--,b.silent||(b.index=g,h.trigger("remove",h,this,b)),this._removeReference(h,b));return d?a[0]:a},set:function(a,b){b=c.defaults({},b,p),b.parse&&(a=this.parse(a,b));var d=!c.isArray(a);a=d?a?[a]:[]:c.clone(a);var e,f,g,h,i,j,k,l=b.at,n=this.model,o=this.comparator&&null==l&&b.sort!==!1,q=c.isString(this.comparator)?this.comparator:null,r=[],s=[],t={},u=b.add,v=b.merge,w=b.remove,x=!o&&u&&w?[]:!1;for(e=0,f=a.length;f>e;e++){if(i=a[e]||{},g=i instanceof m?h=i:i[n.prototype.idAttribute||"id"],j=this.get(g))w&&(t[j.cid]=!0),v&&(i=i===h?h.attributes:i,b.parse&&(i=j.parse(i,b)),j.set(i,b),o&&!k&&j.hasChanged(q)&&(k=!0)),a[e]=j;else if(u){if(h=a[e]=this._prepareModel(i,b),!h)continue;r.push(h),this._addReference(h,b)}h=j||h,!x||!h.isNew()&&t[h.id]||x.push(h),t[h.id]=!0}if(w){for(e=0,f=this.length;f>e;++e)t[(h=this.models[e]).cid]||s.push(h);s.length&&this.remove(s,b)}if(r.length||x&&x.length)if(o&&(k=!0),this.length+=r.length,null!=l)for(e=0,f=r.length;f>e;e++)this.models.splice(l+e,0,r[e]);else{x&&(this.models.length=0);var y=x||r;for(e=0,f=y.length;f>e;e++)this.models.push(y[e])}if(k&&this.sort({silent:!0}),!b.silent){for(e=0,f=r.length;f>e;e++)(h=r[e]).trigger("add",h,this,b);(k||x&&x.length)&&this.trigger("sort",this,b)}return d?a[0]:a},reset:function(a,b){b||(b={});for(var d=0,e=this.models.length;e>d;d++)this._removeReference(this.models[d],b);return b.previousModels=this.models,this._reset(),a=this.add(a,c.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),a},push:function(a,b){return this.add(a,c.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return this.add(a,c.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(){return g.apply(this.models,arguments)},get:function(a){return null!=a?this._byId[a]||this._byId[a.id]||this._byId[a.cid]:void 0},at:function(a){return this.models[a]},where:function(a,b){return c.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),c.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(c.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return c.invoke(this.models,"get",a)},fetch:function(a){a=a?c.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=a.success,d=this;return a.success=function(c){var e=a.reset?"reset":"set";d[e](c,a),b&&b(d,c,a),d.trigger("sync",d,c,a)},L(this,a),this.sync("read",this,a)},create:function(a,b){if(b=b?c.clone(b):{},!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var d=this,e=b.success;return b.success=function(a,c){b.wait&&d.add(a,b),e&&e(a,c,b)},a.save(null,b),a},parse:function(a,b){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(a instanceof m)return a;b=b?c.clone(b):{},b.collection=this;var d=new this.model(a,b);return d.validationError?(this.trigger("invalid",this,d.validationError,b),!1):d},_addReference:function(a,b){this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a),a.collection||(a.collection=this),a.on("all",this._onModelEvent,this)},_removeReference:function(a,b){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var r=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];c.each(r,function(a){o.prototype[a]=function(){var b=g.call(arguments);return b.unshift(this.models),c[a].apply(c,b)}});var s=["groupBy","countBy","sortBy","indexBy"];c.each(s,function(a){o.prototype[a]=function(b,d){var e=c.isFunction(b)?b:function(a){return a.get(b)};return c[a](this.models,e,d)}});var t=b.View=function(a){this.cid=c.uniqueId("view"),a||(a={}),c.extend(this,c.pick(a,v)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},u=/^(\S+)\s*(.*)$/,v=["model","collection","el","id","attributes","className","tagName","events"];c.extend(t.prototype,h,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(a,c){return this.$el&&this.undelegateEvents(),this.$el=a instanceof b.$?a:b.$(a),this.el=this.$el[0],c!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=c.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var d=a[b];if(c.isFunction(d)||(d=this[a[b]]),d){var e=b.match(u),f=e[1],g=e[2];d=c.bind(d,this),f+=".delegateEvents"+this.cid,""===g?this.$el.on(f,d):this.$el.on(f,g,d)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(c.result(this,"el"),!1);else{var a=c.extend({},c.result(this,"attributes"));this.id&&(a.id=c.result(this,"id")),this.className&&(a["class"]=c.result(this,"className"));var d=b.$("<"+c.result(this,"tagName")+">").attr(a);this.setElement(d,!1)}}}),b.sync=function(a,d,e){var f=x[a];c.defaults(e||(e={}),{emulateHTTP:b.emulateHTTP,emulateJSON:b.emulateJSON});var g={type:f,dataType:"json"};if(e.url||(g.url=c.result(d,"url")||K()),null!=e.data||!d||"create"!==a&&"update"!==a&&"patch"!==a||(g.contentType="application/json",g.data=JSON.stringify(e.attrs||d.toJSON(e))),e.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),e.emulateHTTP&&("PUT"===f||"DELETE"===f||"PATCH"===f)){g.type="POST",e.emulateJSON&&(g.data._method=f);var h=e.beforeSend;e.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",f),h?h.apply(this,arguments):void 0}}"GET"===g.type||e.emulateJSON||(g.processData=!1),"PATCH"===g.type&&w&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var i=e.xhr=b.ajax(c.extend(g,e));return d.trigger("request",d,i,e),i};var w=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),x={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};b.ajax=function(){return b.$.ajax.apply(b.$,arguments)};var y=b.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},z=/\((.*?)\)/g,A=/(\(\?)?:\w+/g,B=/\*\w+/g,C=/[\-{}\[\]+?.,\\\^$|#\s]/g;c.extend(y.prototype,h,{initialize:function(){},route:function(a,d,e){c.isRegExp(a)||(a=this._routeToRegExp(a)),c.isFunction(d)&&(e=d,d=""),e||(e=this[d]);var f=this;return b.history.route(a,function(c){var g=f._extractParameters(a,c);f.execute(e,g),f.trigger.apply(f,["route:"+d].concat(g)),f.trigger("route",d,g),b.history.trigger("route",f,d,g)}),this},execute:function(a,b){a&&a.apply(this,b)},navigate:function(a,c){return b.history.navigate(a,c),this},_bindRoutes:function(){if(this.routes){this.routes=c.result(this,"routes");for(var a,b=c.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(C,"\\$&").replace(z,"(?:$1)?").replace(A,function(a,b){return b?a:"([^/?]+)"}).replace(B,"([^?]*?)"),new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,b){var d=a.exec(b).slice(1);return c.map(d,function(a,b){return b===d.length-1?a||null:a?decodeURIComponent(a):null})}});var D=b.History=function(){this.handlers=[],c.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},E=/^[#\/]|\s+$/g,F=/^\/+|\/+$/g,G=/msie [\w.]+/,H=/\/$/,I=/#.*$/;D.started=!1,c.extend(D.prototype,h,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=decodeURI(this.location.pathname+this.location.search);var c=this.root.replace(H,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(E,"")},start:function(a){if(D.started)throw new Error("Backbone.history has already been started");D.started=!0,this.options=c.extend({root:"/"},this.options,a),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var d=this.getFragment(),e=document.documentMode,f=G.exec(navigator.userAgent.toLowerCase())&&(!e||7>=e);if(this.root=("/"+this.root+"/").replace(F,"/"),f&&this._wantsHashChange){var g=b.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=g.hide().appendTo("body")[0].contentWindow,this.navigate(d)}this._hasPushState?b.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!f?b.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=d;var h=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&h.hash&&(this.fragment=this.getHash().replace(E,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){b.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),D.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();return b===this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe))),b===this.fragment?!1:(this.iframe&&this.navigate(b),void this.loadUrl())},loadUrl:function(a){return a=this.fragment=this.getFragment(a),c.any(this.handlers,function(b){return b.route.test(a)?(b.callback(a),!0):void 0})},navigate:function(a,b){if(!D.started)return!1;b&&b!==!0||(b={trigger:!!b});var c=this.root+(a=this.getFragment(a||""));if(a=a.replace(I,""),this.fragment!==a){if(this.fragment=a,""===a&&"/"!==c&&(c=c.slice(0,-1)),this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),b.history=new D;var J=function(a,b){var d,e=this;d=a&&c.has(a,"constructor")?a.constructor:function(){return e.apply(this,arguments)},c.extend(d,e,b);var f=function(){this.constructor=d};return f.prototype=e.prototype,d.prototype=new f,a&&c.extend(d.prototype,a),d.__super__=e.prototype,d};m.extend=o.extend=y.extend=t.extend=D.extend=J;var K=function(){throw new Error('A "url" property or function must be specified')},L=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}};return b}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("spinner",b):a.Spinner=b()}(this,function(){"use strict";function a(a,b){var c,d=document.createElement(a||"div");for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=j.substring(0,j.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return l[e]||(m.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",m.cssRules.length),l[e]=1),e}function d(a,b){var c,d,e=a.style;for(b=b.charAt(0).toUpperCase()+b.slice(1),d=0;d<k.length;d++)if(c=k[d]+b,void 0!==e[c])return c;return void 0!==e[b]?b:void 0}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)void 0===a[d]&&(a[d]=c[d])}return a}function g(a,b){return"string"==typeof a?a:a[b%a.length]}function h(a){this.opts=f(a||{},h.defaults,n)}function i(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}m.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:k+" "+k,coordorigin:-j+" "+-j}),{width:k,height:k})}function h(a,h,i){b(m,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~h}),b(e(c("roundrect",{arcsize:d.corners}),{width:j,height:d.width,left:d.radius,top:-d.width>>1,filter:i}),c("fill",{color:g(d.color,a),opacity:d.opacity}),c("stroke",{opacity:0}))))}var i,j=d.length+d.width,k=2*j,l=2*-(d.width+d.length)+"px",m=e(f(),{position:"absolute",top:l,left:l});if(d.shadow)for(i=1;i<=d.lines;i++)h(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=d.lines;i++)h(i);return b(a,m)},h.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var j,k=["webkit","Moz","ms","O"],l={},m=function(){var c=a("style",{type:"text/css"});return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}(),n={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};h.defaults={},f(h.prototype,{spin:function(b){this.stop();var c=this,d=c.opts,f=c.el=e(a(0,{className:d.className}),{position:d.position,width:0,zIndex:d.zIndex});d.radius+d.length+d.width;if(e(f,{left:d.left,top:d.top,right:d.right}),b&&b.insertBefore(f,b.firstChild||null),f.setAttribute("role","progressbar"),c.lines(f,c.opts),!j){var g,h=0,i=(d.lines-1)*(1-d.direction)/2,k=d.fps,l=k/d.speed,m=(1-d.opacity)/(l*d.trail/100),n=l/d.lines;!function o(){h++;for(var a=0;a<d.lines;a++)g=Math.max(1-(h+(d.lines-a)*n)%l*m,d.opacity),c.opacity(f,a*d.direction+i,g,d);c.timeout=c.el&&setTimeout(o,~~(1e3/k))}()}return c},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(d,f){function h(b,c){return e(a(),{position:"absolute",width:f.length+f.width+"px",height:f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*k+f.rotate)+"deg) translate("+f.radius+"px,0)",borderRadius:(f.corners*f.width>>1)+"px"})}for(var i,k=0,l=(f.lines-1)*(1-f.direction)/2;k<f.lines;k++)i=e(a(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:j&&c(f.opacity,f.trail,l+k*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(i,e(h("#000","0 0 4px #000"),{top:"2px"})),b(d,b(i,h(g(f.color,k),"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}});var o=e(a("group"),{behavior:"url(#default#VML)"});return!d(o,"transform")&&o.adj?i():j=d(o,"animation"),h}),function(a,b){"object"==typeof exports?module.exports=b(require("spin.js")):"function"==typeof define&&define.amd?define("ladda",["spinner"],b):a.Ladda=b(a.Spinner)}(this,function(a){"use strict";function b(a){if("undefined"!=typeof a){if(/ladda-button/i.test(a.className)||(a.className+=" ladda-button"),a.hasAttribute("data-style")||a.setAttribute("data-style","expand-right"),!a.querySelector(".ladda-label")){var b=document.createElement("span");b.className="ladda-label",g(a,b)}var c,d=a.querySelector(".ladda-spinner");d||(d=document.createElement("span"),d.className="ladda-spinner"),a.appendChild(d);var f,i={start:function(){return c||(c=e(a)),a.setAttribute("disabled",""),a.setAttribute("data-loading",""),clearTimeout(f),c.spin(d),this.setProgress(0),this},startAfter:function(a){return clearTimeout(f),f=setTimeout(function(){i.start()},a),this},stop:function(){return window.navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.match(/Trident.*rv\:11\./)?(clearTimeout(f),setTimeout(function(){a.removeAttribute("disabled"),a.removeAttribute("data-loading")},170)):(a.removeAttribute("disabled"),a.removeAttribute("data-loading"),clearTimeout(f)),c&&(f=setTimeout(function(){c.stop()},1e3)),this},toggle:function(){return this.isLoading()?this.stop():this.start(),this},setProgress:function(b){b=Math.max(Math.min(b,1),0);var c=a.querySelector(".ladda-progress");0===b&&c&&c.parentNode?c.parentNode.removeChild(c):(c||(c=document.createElement("div"),c.className="ladda-progress",a.appendChild(c)),c.style.width=(b||0)*a.offsetWidth+"px")},enable:function(){return this.stop(),this},disable:function(){return this.stop(),a.setAttribute("disabled",""),this},isLoading:function(){return a.hasAttribute("data-loading")},remove:function(){clearTimeout(f),a.removeAttribute("disabled",""),a.removeAttribute("data-loading",""),c&&(c.stop(),c=null);for(var b=0,d=h.length;d>b;b++)if(i===h[b]){h.splice(b,1);break}}};return h.push(i),i}}function c(a,c){c=c||{};var d=[];"string"==typeof a?d=f(document.querySelectorAll(a)):"object"==typeof a&&"string"==typeof a.nodeName&&(d=[a]);for(var e=0,g=d.length;g>e;e++)!function(){var a=d[e];if("function"==typeof a.addEventListener){var f=b(a),g=-1;a.addEventListener("click",function(){f.startAfter(1),"number"==typeof c.timeout&&(clearTimeout(g),g=setTimeout(f.stop,c.timeout)),"function"==typeof c.callback&&c.callback.apply(null,[f])},!1)}}()}function d(){for(var a=0,b=h.length;b>a;a++)h[a].stop()}function e(b){var c,d,e=b.offsetHeight;0===e&&(e=parseFloat(window.getComputedStyle(b).height)),e>32&&(e*=.8),b.hasAttribute("data-spinner-size")&&(e=parseInt(b.getAttribute("data-spinner-size"),10)),b.hasAttribute("data-spinner-color")&&(c=b.getAttribute("data-spinner-color")),b.hasAttribute("data-spinner-lines")&&(d=parseInt(b.getAttribute("data-spinner-lines"),10));var f=.175*e,g=.4*f,h=7>f?2:3;return new a({color:c||"#999",lines:d||8,radius:f,length:g,width:h,zIndex:"auto",top:"auto",left:"auto",className:""})}function f(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b}function g(a,b){var c=document.createRange();c.selectNodeContents(a),c.surroundContents(b),a.appendChild(b)}var h=[];return{bind:c,create:b,stopAll:d}}),function(){"use strict";function a(a,b,c,d,e,f){b[a]&&(c.push(a),b[a]!==!0&&1!==b[a]||d.push(e+a+"/"+f))}function b(a,b,c,d,e){var f=d+b+"/"+e;require._fileExists(a.toUrl(f+".js"))&&c.push(f)}function c(a,b,d){var e;for(e in b)!b.hasOwnProperty(e)||a.hasOwnProperty(e)&&!d?"object"==typeof b[e]&&(!a[e]&&b[e]&&(a[e]={}),c(a[e],b[e],d)):a[e]=b[e]}var d=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(e){var f=e.config?e.config():{};return{version:"2.0.4",load:function(e,g,h,i){i=i||{},i.locale&&(f.locale=i.locale);var j,k,l,m,n,o=d.exec(e),p=o[1],q=o[4],r=o[5],s=[],t={},u="";if(o[5]?(p=o[1],j=p+r):(j=e,r=o[4],q=f.locale,q||(q=f.locale="undefined"==typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase())),i.isBuild){s.push(j),b(g,"root",s,p,r);var v=Array.isArray(q)?q:[q];for(k=0;k<v.length;k++){for(n=v[k].split("-"),l=0;l<n.length;l++)m=n[l],u+=(u?"-":"")+m,b(g,u,s,p,r);u=""}g(s,function(){h()})}else n=q.split("-"),g([j],function(b){var d,e=[];for(a("root",b,e,s,p,r),k=0;k<n.length;k++)d=n[k],u+=(u?"-":"")+d,a(u,b,e,s,p,r);g(s,function(){var a,d,f;for(a=e.length-1;a>-1&&e[a];a--)f=e[a],d=b[f],d!==!0&&1!==d||(d=g(p+f+"/"+r)),c(t,d);h(t)})})}}})}(),define("nls/common",{root:{error:"Ошибка",internal_error:"Во время выполнения произошла непредвиденная ошибка",sent_internal_error:"Сообщить об ошибке разработчику",letter_attentions:'Обратите внимание, что данное письмо будет отправлено компании-разработчику данного сервиса (ООО "БИФИТ-Сервис").',tab_work:"Рабочие",tab_exec:"Исполненные",tab_executed:"Исполненные",tab_draft:"Рабочие",tab_inbox:"Входящие",tab_sent:"Исходящие",tab_archived:"Архивные",tab_confirmed:"Подтвержденные",tab_for_consideration:"Для рассмотрения",tab_closed:"Закрытые",expand_filter:"Больше параметров фильтра",minimize_filter:"Скрыть фильтр",reset_filter:"Установить значения по умолчанию",confirm_ok:"Да",confirm_cancel:"Нет",confirm_close:"Закрыть",cal_days:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],cal_months:["ЯНВ","ФЕВ","МАР","АПР","МАЙ","ИЮН","ИЮЛ","АВГ","СЕН","ОКТ","НОЯ","ДЕК"],cal_lang_clear_date:"Очистить",cal_lang_set_btn:"Установить",net_error:"Ошибка подключения к банковскому серверу",net_forbidden:"Доступ к запрашиваемому ресурсу запрещен.",net_error_on_save:"{1}. Рекомендуем повторно отправить запрос.",bad_req_on_save:"{1}. Для устранения ошибки попробуйте отредактировать документ.",resave_btn:"Повторить попытку",lose_btn:"Отменить изменения",lose_new_doc_btn:"Удалить документ",toedit_btn:"Редактировать",mfo:"МФО получателя: ",account:"Счет получателя: ",amount:"Сумма: ",token:"OTP-токен",otp:"Одноразовый пароль",sms:"Получить SMS",token_serial:"Серийный номер",send:"Отправить",cancel:"Отменить",no_rights:"У Вас нет прав на {1} {2} - {3}",document:"документа",reference:"справочника",view:"просмотр",edit:"редактирование",create:"создание",ua_payment:"Платежное поручение",
bank_ua_payment_request:"Требования",ua_payment_request:"Требования",ua_recipients:"Получатели",pay_sheet:"Зарплатная ведомость",staff:"Сотрудники",card_prolongation:"Продление срока карт",assign_card_order:"Закрепление карт",fire_staff_order:"Увольнение сотрудника",ua_currency_payment:"SWIFT-платеж",ua_intrabank_currency_payment:"Платеж в пределах банка",ua_currency_sale:"Продажа",ua_currency_purchase:"Покупка",ua_currency_convert:"Конвертация",beneficiaries:"Бенефициары",swift:"Справочник SWIFT",ua_swift:"Справочник МФО",mobile_accounts:"Учетные записи",letter:"Письма",reg_ua_payment_div:"Выплата дивидендов",service_enterpreneur:"Обслуживание ФЛП",reg_ua_currency_sale:"Продажа валюты",reg_ua_payment_tax:"Уплата налогов и сборов",reg_reference:"Справочник ФЛП",electronic_contract:"Электронный контракт",monitoring:"Мониторинг",recall:"Отзывы",statements:"Выписка",overturns:"Обороты",budget:"Бюджет",budgeting:"Бюджетирование",budget_order:"Бюджетная роспись",budget_codes_ref:"Справочник статей",budget_report:"Отчет по бюджету",budget_item_report:"Отчет по строке",credits:"Ваши кредиты",deposit_menu:"Депозиты",deposits:"Ваши депозиты",deposit_order:"Поручение",deposit_offer:"Предложение",deposit_statement:"Выписка по деп. счету",confirm_losing_changes_msg:"Вы уверены, что хотите завершить редактирование документа? Все несохранённые данные будут потеряны.",refresh_time_confirmer:"Соединение с сервером будет автоматически прервано через {1} сек. Хотите продолжить работу в системе?",continue_btn:"Продолжить",exit_btn:"Выйти",attention:"ВНИМАНИЕ!",timeout:"Время ожидания ответа сервера истекло",info_title:"Информация",not_saved_doc_unload:"Документ не сохранен",changed_doc_unload:"Документ был изменен","export":"Экспорт",export_report_types:"Файл с разделителями(*.сsv)",export_ref_types:"Текстовые файлы (*.txt)",export_title:"Выберите директорию для сохранения файла экспорта",list_ua_docs:"Гривневые документы",list_pay_sheet:"Зарплата",list_currency_docs:"Валютные документы",file_save_successful:"Файл успешно сохранен",no_keys_storage:'<b>Не найдено хранилище ключей для "{1}".</b><br><br>Ошибка могла возникнуть по следующим причинам: <br>- Не верно указан путь к хранилищу с ключами клиентов. Для устранения ошибки выберите раздел <a href="#/settings/work-settings">Мои данные и настройки - Настройки работы</a> и проверьте правильность указания пути к хранилищу с ключами клиентов.<br>- Учетная запись либо ключ клиента для работы в системе заблокирован банковским администратором. Для устранения ошибки попытайтесь использовать другой ключ ЭЦП либо обратитесь в отдел технической поддержки, обслуживающего Вас банка.',no_privileges:"У Вас отсутствуют права на работу с данным типом документов",corp_cards_menu:"Корпоративные карты",corp_cards:"Карты",corp_cards_statements:"Выписка по счету",corp_cards_overturns:"Обороты",account_types_ref:{"-1":"текущий(бюдж)",1:"текущий",2:"транзитный",3:"корпоративный",9:"кредитный",10:"депозитный"},act_create:"Создание/изменение",act_view:"Просмотр",act_remove:"Удаление",act_import:"Импорт",act_sign:"Подпись"},uk:!0,en:!0}),define("nls/uk/common",{error:"Помилка",internal_error:"Під час виконання сталася неочікувана помилка",sent_internal_error:"Повідомити про помилку розробнику",letter_attentions:'Зверніть увагу, що даний лист буде відправлено компанії-розробнику даного сервісу (ТОВ "БІФІТ-Сервіс").',tab_work:"Робочi",tab_exec:"Виконанi",tab_executed:"Виконані",tab_draft:"Робочі",tab_inbox:"Вхідні",tab_sent:"Вихідні",tab_archived:"Архівні",tab_confirmed:"Підтверджені",tab_for_consideration:"Для розгляду",tab_closed:"Закриті",expand_filter:"Більше параметрів фільтра",minimize_filter:"Сховати фільтр",reset_filter:"Встановити значення за замовчуванням",confirm_ok:"Так",confirm_cancel:"Ні",confirm_close:"Закрити",cal_days:["Нд","Пн","Вт","Ср","Чт","Пт","Сб"],cal_months:["СІЧ","ЛЮТ","БЕР","КВІ","ТРА","ЧЕР","ЛИП","СЕР","ВЕР","ЖОВ","ЛИС","ГРУ"],cal_lang_clear_date:"Очистити",cal_lang_set_btn:"Встановити",net_error:"Помилка підключення до банківського сервера",net_forbidden:"Доступ до запитуваного ресурсу заборонений.",net_error_on_save:"{1}. Рекомендуємо повторно відправити запит.",bad_req_on_save:"{1}. Для усунення помилки спробуйте відредагувати документ.",resave_btn:"Повторити спробу",lose_btn:"Скасувати зміни",lose_new_doc_btn:"Видалити документ",toedit_btn:"Редагувати",mfo:"МФО отримувача: ",account:"Рахунок отримувача: ",amount:"Сума: ",otp:"Одноразовий пароль",sms:"Отримати SMS",token_serial:"Серійний номер",send:"Відправити",cancel:"Відмінити",no_rights:"У Вас немає прав на {1} {2} - {3}",document:"документа",reference:"довідника",view:"перегляд",edit:"редагування",create:"створення",ua_payment:"Платіжне доручення",bank_ua_payment_request:"Вимоги",ua_payment_request:"Вимоги",ua_recipients:"Отримувачі",pay_sheet:"Зарплатна відомість",staff:"Співробітники",card_prolongation:"Продовження дiї карток",assign_card_order:"Закрiплення карток",fire_staff_order:"Звiльнення співробітника",ua_currency_payment:"SWIFT-платіж",ua_intrabank_currency_payment:"Платіж у межах банку",ua_currency_sale:"Продаж",ua_currency_purchase:"Купівля",ua_currency_convert:"Конвертація",beneficiaries:"Бенефіціари",swift:"Довідник SWIFT",ua_swift:"Довідник МФО",mobile_accounts:"Облікові записи",letter:"Листи",reg_ua_currency_sale:"Продаж валюти",reg_ua_payment_tax:"Сплата податків та зборів",reg_ua_payment_div:"Виплата дивідендів",reg_reference:"Довідник ФОП",electronic_contract:"Електронний контракт",monitoring:"Моніторинг",statements:"Виписка",overturns:"Обороти",budget:"Бюджет",budgeting:"Бюджетування",budget_order:"Бюджетний розпис",budget_codes_ref:"Довідник статей",budget_report:"Звіт з бюджету",budget_item_report:"Звiт по рядку",credits:"Ваші кредити",deposit_menu:"Депозити",deposits:"Ваші депозити",deposit_order:"Доручення",deposit_offer:"Пропозиція",deposit_statement:"Виписка по деп. рахунку",confirm_losing_changes_msg:"Ви впевнені, що бажаєте завершити редагування документа? Всі незбережені дані будуть втрачені.",refresh_time_confirmer:"З'єднання з сервером буде автоматично перервано через {1} сек. Бажаєте продовжити роботу в системі?",continue_btn:"Продовжити",exit_btn:"Вийти",attention:"УВАГА!",timeout:"Час очікування відповіді сервера вичерпано",info_title:"Інформація",not_saved_doc_unload:"Документ не збережено",changed_doc_unload:"Документ був змінений","export":"Експорт",export_report_types:"Файл з роздільниками(*.сsv)",export_ref_types:"Текстові файли (*.txt)",export_title:"Оберіть директорію для збереження файла експорту",list_ua_docs:"Гривневі документи",list_pay_sheet:"Зарплата",list_currency_docs:"Валютні документи",service_enterpreneur:"Обслуговування ФОП",file_save_successful:"Файл успiшно збережений",no_keys_storage:'<b>Не знайдено сховище ключів для "{1}".</b><br><br>Помилка могла виникнути з наступних причин: <br>- Невірно вказаний шлях до сховища з ключами клієнтів. Для усунення помилки виберіть розділ <a href="#/settings/work-settings">Мої дані та налаштування - Налаштування роботи</a> та перевірте правильність вказаного шляху до сховища ключів клієнта.<br>- Ваш обліковий запис або ключ для роботи у системі заблоковано банківським адміністратором. Для усунення помилки спробуйте викорстати інший ключ ЕЦП або зверніться до відділу технічної підтримки банку, що Вас обслуговує.',no_privileges:"У Вас відсутні права на роботу з даним типом документів",corp_cards_menu:"Корпоративні картки",corp_cards:"Картки",corp_cards_statements:"Виписка по рахунку",corp_cards_overturns:"Обороти",account_types_ref:{"-1":"поточний(бюдж)",1:"поточний",2:"транзитний",3:"корпоративний",9:"кредитний",10:"депозитний"},act_create:"Створення/зміна",act_view:"Перегляд",act_remove:"Вилучення",act_import:"Імпорт",act_sign:"Підпис"}),define("nls/en/common",{error:"Error",internal_error:"Unexpected error during execution",sent_internal_error:"Report an error to developer",letter_attentions:'Please note that this letter will be sent to the company-developer of this service (LLC "BIFIT Service").',tab_work:"In progress",tab_exec:"Executed",tab_executed:"Executed",tab_draft:"In progress",tab_inbox:"Incoming",tab_sent:"Outbox",tab_archived:"Archived",tab_confirmed:"Confirmed",tab_for_consideration:"For consideration",tab_closed:"Closed",expand_filter:"More filter options",minimize_filter:"Hide filter",reset_filter:"Set default values",confirm_ok:"Yes",confirm_cancel:"No",confirm_close:"Close",cal_days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],cal_months:["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"],cal_lang_clear_date:"Clear",cal_lang_set_btn:"Set",net_error:"Failed to connect to bank server",net_forbidden:"Access to the requested resource is denied.",net_error_on_save:"{1}. Try to re-send the request.",bad_req_on_save:"{1}. To resolve this problem, try to edit the document.",resave_btn:"Try again",lose_btn:"Cancel changes",lose_new_doc_btn:"Delete document",toedit_btn:"Edit",mfo:"Recipient's MFO: ",account:"Recipient's account ",amount:"Amount: ",otp:"One-time password",sms:"Receive SMS",token_serial:"Serial number",send:"Send",cancel:"Cancel",no_rights:"You don't have right for {1} {2} - {3}",document:"document",reference:"directory",view:"view",edit:"edit",create:"create",ua_payment:"Payment order",bank_ua_payment_request:"Requests",ua_payment_request:"Requests",ua_recipients:"Recipients",pay_sheet:"Salary sheet",staff:"Employees",card_prolongation:"Card prolongation",assign_card_order:"Assigning cards",fire_staff_order:"Employee fire",ua_currency_payment:"SWIFT-payment",ua_intrabank_currency_payment:"Payment within the Bank",ua_currency_sale:"Sale",ua_currency_purchase:"Purchase",ua_currency_convert:"Convert",beneficiaries:"Beneficiaries",swift:"SWIFT directory",ua_swift:"MFO directory",mobile_accounts:"Accounts",letter:"Letters",reg_ua_currency_sale:"Currency sale",reg_ua_payment_tax:"Payment of taxes and fees",reg_ua_payment_div:"Dividend payment",reg_reference:"Entrepreneur directory",electronic_contract:"Electronic contract",monitoring:"Monitoring",statements:"Statement",overturns:"Turnovers",budget:"Budget",budgeting:"Budgeting",budget_order:"Budget List",budget_codes_ref:"Items Reference",budget_report:"Budget Report",budget_item_report:"Budget Item Report",credits:"Your credits",deposit_menu:"Deposits",deposits:"Your deposits",deposit_order:"Order",deposit_offer:"Offer",deposit_statement:"Deposit account statement",confirm_losing_changes_msg:"Are you sure you want to leave the document editing? All unsaved data will be lost.",refresh_time_confirmer:"Connection with server will be automatically terminated in {1} seconds. Do you want to continue working in the system?",continue_btn:"Continue",exit_btn:"Logout",attention:"ATTENTION!",timeout:"Server timeout expired",info_title:"Information",not_saved_doc_unload:"Document was not saved",changed_doc_unload:"Document was changed","export":"Export",export_report_types:"Comma-Separated Values file (*.csv)",export_ref_types:"Text files (*.txt)",export_title:"Select the directory for saving export file",list_ua_docs:"Hryvnia documents",list_pay_sheet:"Salary",list_currency_docs:"Currency documents",service_enterpreneur:"Service Entrepreneur",file_save_successful:"File has been successfully saved",no_keys_storage:'<b>The keystore wasn’t found for "{1}".</b><br><br>An error might be caused by the following reasons:<br>- The path to the keystore is wrong. To solve this problem choose the section <a href="#/settings/work-settings">My data and settings - Work settings</a> and check the path to the repository file with the keys of clients.<br>- Your account or key has been blocked by a bank administrator. To solve this problem try to use another EDS key or contact the bank department of technical support.',no_privileges:"You don't have privileges to work with this type of document",corp_cards_menu:"Corporate cards",corp_cards:"Cards",corp_cards_statements:"Statements for account",corp_cards_overturns:"Overturns",account_types_ref:{"-1":"current(budget)",1:"current",2:"transit",3:"corporate",9:"credit",10:"deposit"},act_create:"Create/Modify",act_view:"View",act_remove:"Remove",act_import:"Import",act_sign:"Sign"}),define("nls/validation",{root:{invalid_field_pattern:'Ошибка заполнения поля "{1}": {2}',invalid_row_pattern:'Ошибка заполнения поля "{1}" в строке {2}: {3}',invalid_list_pattern:'Ошибка заполнения поля "{1}" для {2}: {3}',error_title:"Ошибка",invalid_field_pattern_at_the_bank_side:'Ошибка заполнения поля "{1}" на стороне банка. Обратитесь в отдел технической поддержки, обслуживающего Вас банка.',invalid_fields_pattern_at_the_bank_side:"Ошибка заполнения полей {1} на стороне банка. Обратитесь в отдел технической поддержки, обслуживающего Вас банка.",required:"Поле обязательно для заполнения",required_field:'Поле "{1}" должно быть заполнено',minLength:"Длина поля должна быть не менее {1} символов",maxLength:"Длина поля должна быть не более {1} символов",length:"Длина поля должна быть {1} символов",length_extended:"Длина поля {1} для {2} должна быть {3} символов",length_range:"Длина поля {1} должна быть от {2} до {3} символов",mfo_not_found:"Банк с указанным МФО отсутствует в справочнике банков",empty_field:"Поле должно быть не заполнено",invalid_field:"Ошибка заполнения поля",invalid_value_in_field:"Недопустимое значение поля",invalid_character:"Поле содержит недопустимый символ < {1} >",positive_amount:"Значение поля должно быть больше нуля",incorrect_amount:"Некорректная сумма",incorrect_digest:"Поле должно содержать только цифры",incorrect_digest_extended:"Поле {1} для {2} должно содержать только цифры",calc_okpo:"Ошибка ключевания кода ЕГРПОУ, проверьте корректность кода ЕГРПОУ",calc_acc:"Ошибка ключевания счёта и МФО, проверьте корректность и соответствие счёта и МФО",incorrect_date:"Некорректная дата",rcpt_acc_eq_cln:"Счет получателя не должен совпадать со счетом отправителя",value_date_01:"Дата валютирования меньше даты документа",value_date_02:"Дата валютирования больше даты окончания действия документа",value_date_err_pattern:"Дата валютирования не может быть позднее {1} календарных дней после даты документа",expire_date_01:"Дата окончания действия документа меньше чем дата документа",expire_date_02:"Дата окончания действия документа не может быть позднее {1} календарных дней после даты документа",backdate:"Дата документа меньше чем разрешенная: {1}",futuredate:"Дата документа больше чем разрешенная: {1}",purch_bik_err:"Счета должны быть открыты в одном МФО. Перевыберите один из счетов",multiplyErrors:'Документ не может быть сохранен, потому что некоторые поля заполнены с ошибкой "{1}". Проверьте информацию в полях, отмеченных красным',replenishment_amount_can_not_be_less_than:"Сумма пополнения не может быть меньше",replenishment_amount_can_not_be_more_than:"Сумма пополнения не может быть больше",no_accounts_in_mfo:"Отсутствуют счета в указанном МФО банка клиента {1}",account_iban_error:"Должен быть заполнен либо счет бенефициара, либо IBAN-код бенефициара.",account_not_permission:"Нет прав на работу со счетом или он доступен только для просмотра документов.",account_invalid_type:"Счет клиента должен быть текущим.",not_allowed_symbol:'"Поле содержит недопустимый символ "{1}"'},uk:!0,en:!0}),define("nls/uk/validation",{invalid_field_pattern:'Помилка при заповненнi поля "{1}": {2}',invalid_row_pattern:'Помилка при заповненнi поля "{1}" у рядку {2}: {3}',invalid_list_pattern:'Помилка при заповненнi поля "{1}" для {2}: {3}',error_title:"Помилка",invalid_field_pattern_at_the_bank_side:'Помилка при заповненні поля "{1}" на стороні банку. Зверніться до відділу технічної підтримки банку, що Вас обслуговує',invalid_fields_pattern_at_the_bank_side:"Помилка при заповненні полів {1} на стороні банку. Зверніться до відділу технічної підтримки банку, що Вас обслуговує.",required:"Поле обов'язкове до заповнення",required_field:'Поле "{1}" повинно бути заповнено',minLength:"Довжина поля повинна бути не менше {1} символів",maxLength:"Довжина поля повинна бути не більше {1} символів",length:"Довжина поля повинна бути {1} символів",length_extended:"Довжина поля {1} для {2} повинна бути {3} символів",length_range:"Довжина поля {1} повинна бути від {2} до {3} символів",mfo_not_found:"Банк з зазначенним МФО відсутній у довіднику банків",empty_field:"Поле має бути пустим",invalid_field:"Помилка при заповненнi поля",invalid_value_in_field:"Неприпустиме значення поля",invalid_character:"Поле містить недопустимий символ < {1} >",positive_amount:"Сума у полi повинна бути бiльше за нуль",incorrect_amount:"Некоректна сума",incorrect_digest:"Поле має мiстити тiльки цифри",incorrect_digest_extended:"Поле {1} для {2} має мiстити тiльки цифри",calc_okpo:"Помилка ключування коду ЄДРПОУ, перевірте коректність коду ЄДРПОУ",calc_acc:"Помилка ключування рахунка та МФО, перевірте коректність та відповідність рахунка та МФО",incorrect_date:"Некоректна дата",rcpt_acc_eq_cln:"Рахунок отримувача не повинен співпадати з рахунком відправника",value_date_01:"Дата валютування менше дати документа",value_date_02:"Дата валютування більше дати закінчення дії документа",value_date_err_pattern:"Дата валютування не може бути пiзнiше {1} календарних днiв пiсля дати документа",expire_date_01:"Дата закiнчення дiї документа менше нiж дата документа",expire_date_02:"Дата закiнчення дiї документа не може бути пiзнiше {1} календарних днiв пiсля дати документа",backdate:"Дата документа менша нiж дозволена: {1}",futuredate:"Дата документа бiльша нiж дозволена: {1}",purch_bik_err:"Рахунки мають бути відкриті в одному МФО. Перевиберіть один з рахунків",multiplyErrors:'Документ не може бути збережений, тому що деякі поля заповнені з помилкою "{1}". Перевірте інформацію в полях, відмічених червоним',replenishment_amount_can_not_be_less_than:"Сума поповнення не може бути менше",replenishment_amount_can_not_be_more_than:"Сума поповнення не може бути більше",no_accounts_in_mfo:"Вiдсутнi рахунки в зазначеному МФО банка клiєнта {1}",account_iban_error:"Повинний бути заповненим або рахунок бенефiцiара, або IBAN-код бенефiцiара.",account_not_permission:"Немає прав на роботу з рахунком або він доступний тільки для перегляду документів.",account_invalid_type:"Рахунок отримувача повинен бути поточним.",not_allowed_symbol:'"Поле мiстить неприпустимий символ "{1}"'}),define("nls/en/validation",{invalid_field_pattern:'Error while filling field "{1}": {2}',invalid_row_pattern:'Error while filling field "{1}" at line {2}: {3}',invalid_list_pattern:'Error while filling field "{1}" for {2}: {3}',error_title:"Error",invalid_field_pattern_at_the_bank_side:'Error while filling field at the bank side "{1}". Contact the bank department of technical support.',invalid_fields_pattern_at_the_bank_side:"Filling fields error at the bank side {1}. Contact the bank department of technical support.",required:"Required field",required_field:'Field "{1}" must be filled',minLength:"Field length should not be less than {1} characters",maxLength:"Field length should not be more than {1} characters",length:"Field length should be {1} characters",length_extended:"Field length {1} for {2} should be {3} characters",length_range:"Field length {1} should be from {2} to {3} characters",mfo_not_found:"Bank with indicated MFO isn't present in banks reference",empty_field:"Field should not be filled",invalid_field:"Filling field error",invalid_value_in_field:"Invalid value in field",invalid_character:"The field contain invalid character < {1} >",positive_amount:"Field value must be more than zero",incorrect_amount:"Invalid amount",incorrect_digest:"Field should contain only digits",incorrect_digest_extended:"Field {1} for {2} must contain only digits",calc_okpo:"EDRPOU сode keying error, check the correctness of EDRPOU сode",calc_acc:"Account and MFO (Bank code) keying error, check the correctness and conformity of account and MFO",incorrect_date:"Invalid date",rcpt_acc_eq_cln:"Recipient's account should not match the sender's account",value_date_01:"Value date is less than the document date",value_date_02:"Value date is more than expiration date of the document",value_date_err_pattern:"Value date can be no later than {1} calendar days after the date of the document",expire_date_01:"Expiry date of the document is less than the document date",expire_date_02:"Expiry date of document can not be later than {1} calendar days after document date",backdate:"Document date is less than allowed: {1}",futuredate:"Document date is more than allowed: {1}",purch_bik_err:"This correspondent already exists in the directory",multiplyErrors:'Document could not be saved because some fields are filled with the error "{1}".  Check the information in the fields marked in red',replenishment_amount_can_not_be_less_than:"Replenish amount cannot be less than",replenishment_amount_can_not_be_more_than:"Replenish amount cannot be more than",no_accounts_in_mfo:"There are no accounts in the specified client's bank MFO {1}",account_iban_error:"Beneficiary's account or beneficiary's IBAN code must be filled in.",account_not_permission:"No permissions for work with account or it's available for viewing only.",account_invalid_type:"Recipient's account should be current.",not_allowed_symbol:'"Field contains an inadmissible character "{1}"'}),define("bifit",["jquery","underscore","backbone","ladda","i18n!nls/common","i18n!nls/validation"],function(a,b,c,d,e,f){"use strict";function g(a,c){return a>=32&&126>=a||a>=178&&180>=a||a>=184&&186>=a||a>=191&&255>=a||a>=1040&&1103>=a||-1!==b.indexOf(c,a)}var h=JSON.parse(localStorage.getItem("is_multi_client")),i={};i.settings={server_addr:""},i.createProcessButton=function(a){return d.create(a)},i.processButton=function(a){a.start()},i.clearProcessButton=function(b){b.stop();var c=a(b);c.find("span.ladda-label").html(c.attr("data-text"))},i.stopProcessButtons=function(){d.stopAll()},i.addLaddaToGlobal=function(){window.Ladda=d},i.showSubMenu=function(b){var c=a(b.target).parent().find(".sub-menu").stop();if(c.is(":hidden")){c.show();var d=function(b){return 0===a(b.target).closest(c).length&&(f(),b.preventDefault(),c.hide().prev().blur(),b.stopPropagation(),b.stopImmediatePropagation()),!1},e=function(){f(),c.hide().prev().blur()},f=function(){a(document).off("mousedown",d).off("mouseup",e)};a(document).on("mousedown",d).on("mouseup",e)}else c.hide()},i.str2date=function(a){var b=a.split(".");return new Date(b[2],b[1]-1,b[0])},i.str2dateTime=function(a){var b=a.split(" "),c=b[0].split("."),d=b[1].split(":");return new Date(c[2],c[1]-1,c[0],d[0],d[1],d[2],0)};var j=function(a){return 10>a?"0"+a:""+a};i.date2str=function(a){return j(a.getDate())+"."+j(1+a.getMonth())+"."+j(a.getFullYear())},i.dateTime2str=function(a,b){var c=i.date2str(a)+" "+j(a.getHours())+":"+j(a.getMinutes());return b&&(c+=":"+j(a.getSeconds())),c},i.getCurrentDate=function(){return new Date(parseInt(localStorage.getItem("current_date"),10))},i.changeFloatScale=function(a,b){if(!a)return a;var c=parseFloat(a);return isNaN(c)?"":c.toFixed(b).toString()},i.roundFloat=function(a,b,c){if(!a)return a;var d=Number(Math.round(a+"e"+b)+"e-"+b);return isNaN(d)?"":d.toFixed(c>b?c:b).toString()},i.changeFloatScaleWithoutRounding=function(a,b){var c=parseFloat(a);if(isNaN(c))return"";b=b>0?parseInt(b):0,c+="";var d=c.split("."),e=c.substr(c.indexOf("."),b+(0===b?0:1)),f=d[0]+(d.length>1?e:"");return parseFloat(f).toFixed(b)},i.bin2hex=function(a){var b,c,d,e="";for(a+="",b=0,c=a.length;c>b;b++)d=a.charCodeAt(b).toString(16),e+=d.length<2?"0"+d:d;return e};var k=function(a,b){var c=/(\d)((\d{3}?)+)$/;if(a){for(var d=a.split(".");c.test(d[0]);)d[0]=d[0].replace(c,"$1"+b+"$2");a=d[0]+(d.length>1?"."+d[1]:"")}return a};i.formatAmount=function(a,c,d){if(a&&(c=b.extend({decimallength:2,thousandseparator:" "},c),b.isString(a)&&(a=i.replaceAll(a,c.thousandseparator,""),a=parseFloat(a)),!isNaN(a))){var e="function"==typeof c.decimallength?c.decimallength.call(d):c.decimallength;return a=a.toFixed(e),k(a,c.thousandseparator)}return""},i._amountFormatter=function(a,c,d,e){var f;return b.isString(d)?f=b.findWhere(a.getThesaurus("currency").array,{currency:d}):e=d,i.formatAmount(c,{decimallength:(f||{}).decimals||e})},i.fromForm=function(b,c){c=c||[],c.push("id");var d,e,f,g,h,i;for(e={},h=a(b).serializeArray(),f=0,g=h.length;g>f;f++)d=h[f],i=d.name,-1===c.indexOf(i)&&(e[i]=d.value);return e},i.checkAccount=function(a,b){if(b&&6===b.length&&a){if(!a.match(/^\d{5,14}$/))return f.invalid_field;for(var c=[1,3,7,1,3,3,7,1,3,7,1,3,7,1,3,7,1,3,7],d=b.substring(0,5)+a,e=[],g=0;g<d.length;g++)e[g]=parseInt(d.charAt(g),10);var h=e[9];e[9]=0;var i=a.length;for(g=0;g<e.length;g++)i+=e[g]*c[g]%10;return i%=10,i*=7,i%=10,i!==h?f.calc_acc:void 0}},i.checkEgrpou=function(a){var b;if(a.toString().match(/^\d+$/)){if(a.length<5||a.length>5&&a.length<8||a.length>10)b=f.invalid_field;else if(5===a.length&&"99999"!==a)b=f.invalid_field;else if(8===a.length){for(var c=[],d=0;d<a.length;d++)c.push(parseInt(a.charAt(d),10));var e=function(a,b){for(var c=0,d=0;d<b.length;d++)c+=a[d]*b[d];return c%11},g=c[0]<3||c[0]>=6?[1,2,3,4,5,6,7]:[7,1,2,3,4,5,6],h=e(c,g);10===h&&(g=c[0]<3||c[0]>=6?[3,4,5,6,7,8,9]:[9,3,4,5,6,7,8],h=e(c,g),10===h&&(h=0)),h!==c[7]&&(b=f.calc_okpo)}}else b=f.incorrect_digest;return b},i.checkDateMatch=function(a){var b=!0;return b=a===i.date2str(new Date(i.str2date(a)))?/^(0[1-9]|[12][0-9]|3[01])[.](0[1-9]|1[012])[.](19|20)\d\d$/g.test(a):!1},i.getStoredItem=function(a){return"cookie"===localStorage.getItem("jsessionid_storage_type")?i.getCookie(a):sessionStorage.getItem(a)||void 0},i.storeItem=function(a,b){"cookie"===localStorage.getItem("jsessionid_storage_type")?i.setCookie(a,b):sessionStorage.setItem(a,b)},i.setCookie=function(a,b,c){c=c||{};var d=c.expires;if("number"==typeof d&&d){var e=new Date;e.setTime(e.getTime()+1e3*d),d=c.expires=e}d&&d.toUTCString&&(c.expires=d.toUTCString()),b=encodeURIComponent(b);var f=a+"="+b;for(var g in c)if(c.hasOwnProperty(g)){f+="; "+g;var h=c[g];h!==!0&&(f+="="+h)}document.cookie=f},i.getCookie=function(a){var b=document.cookie.match(new RegExp("(?:^|; )"+a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\^])/g,"\\$1")+"=([^;]*)"));return b?decodeURIComponent(b[1]):void 0},i.datePicker=function(c,d){d=b.extend({format:"dd.mm.yyyy",weekStart:1,language:i.getLocale(),orientation:"bottom auto",daysOfWeekHighlighted:"0,6",keyboardNavigation:!1,clearBtn:!0,autoclose:!0,todayHighlight:!0,showOnFocus:!1,startDate:"01.01.1990"},d),a(c[0]).closest("aside#filter").length&&(d=b.extend({container:"aside#filter"},d)),c.datepicker(d),i.onClickSpanDatePicker(c)},i.onClickSpanDatePicker=function(b){var c,d={};b.next().on("mousedown",function(b){var e=a(b.target).prev().attr("id");d[e]=a("div.datepicker-dropdown").length>0&&e===c}),b.next().on("click",function(b){var e=a(b.target).prev().attr("id");d[e]||(a(b.target).prev().datepicker("show"),c=e)})},i.getDateStr=function(a){return a.val()},i.setDateStr=function(a,b){a.val(b).change()};var l=function(b){var c=b.data,d=c.pages.triggerPoint,e=a(window).scrollTop();d>=e?c.renderPrevPage():a(document).height()-a(window).height()<=e+d&&c.renderNextPage()},m=function(a){var b=a.data,c=a.currentTarget.childNodes[0],d=b.pages.triggerPoint,e=c.style.top,f=parseInt(a.currentTarget.style.height,10);e=Math.abs(parseInt(e,10)),d>=e?b.renderPrevPage():c.clientHeight<=e+f+d&&b.renderNextPage()};i.infinityScrollPosition=function(c,d,e,f){var g=a(e.target).closest("tr").attr("id"),h=function(a){return"function"==typeof a.get?a.get("id"):a.id},i=b.find(d,function(a){return h(a)===g});if(!i)return{};var j=h(d[Math.floor(d.indexOf(i)/f.size)*f.size]),k=a(document).scrollTop();return j&&(k-=c.find("tr#"+j).position().top),{id:g,offset:k}},i.disposeInfinityScroll=function(){a(document).unbind("scroll",l)},i.infinityScroll=function(c,d,e,f,g){g=g||{},g.templateHelpers=g.templateHelpers||{},g.element=g.element||a(document),g.classgenerator=g.classgenerator||function(a){var b="";return a.check&&(b+=" selected"),b};var h=g.id_field||"id",j=function(a){for(var c=a*f.size,j=Math.min((a+1)*f.size,d.length),k="";j>c;c++){var l=d[c],m="<input type='checkbox' />";l.selected&&(m="<input type='checkbox' checked />");var n,o,p;"function"!=typeof l.toFormattedJSON&&"function"!=typeof l.toJSON||(p=l.cid,l=(l.toFormattedJSON||l.toJSON).call(l)),n=b.extend({checkbox:m,status_desc:""},l,g.templateHelpers),o=n[h]||l.cid||p,n.formatAmount=i.formatAmount;var q=e(n);if(q.indexOf("<tr")>-1)k+=q;else{var r=g.classgenerator(l);k+="<tr"+(r?" class='"+r+"'":"")+" id='"+o+"'>"+q+"</tr>"}}return j===d.length&&(f.end=Number.MIN_VALUE),k},k=function(){f.end!==Number.MIN_VALUE&&(f.end+=1,c.append(j(f.end)))},n=function(){if(f.start>0){f.start-=1;var b=a(j(f.start));c.prepend(b),g.element.scrollTop(g.element.scrollTop()+b.height()*f.size)}},o={pages:f,renderPrevPage:n,renderNextPage:k};if(g.parent?(g.parent.unbind("mousewheel",m).bind("mousewheel",o,m),g.parent.unbind("DOMMouseScroll",m).bind("DOMMouseScroll",o,m)):g.element.unbind("scroll",l).bind("scroll",o,l),g.position){var p=b.find(d,function(a){return"undefined"!=typeof a.get?a.get(h)===""+g.position.id:a[h]===g.position.id}),q=d.indexOf(p),r=Math.floor(q/f.size);if(r>1?(f.start=r-1,f.end=r-2,k(),k(),k()):(f.start=0,f.end=-1,k(),k()),q>=0){p=d[r*f.size];var s;s="function"==typeof p.get?d[r*f.size].get(h):d[r*f.size][h],s&&setTimeout(function(){var a=c.find("tr#"+s);a&&g.element.scrollTop(a.position().top+g.position.offset)},1)}}else f.start=0,f.end=-1,k()};var n=function(b,c){c.width(b.width()),b.find("thead:eq(0)>tr th").each(function(b){var d=(0|a(this).width())+"px";c.find("thead:eq(0)>tr th:eq("+b+")").width(d)}),c.removeClass("hidden")},o=function(a){var b=a.data;n(b.table,b.wrapper.children("table"))},p=function(b){var c=b.data,d=a(window).scrollTop(),e=c.wrapper;d>c.offset?(e.is(":hidden")&&n(c.table,e.children("table")),e.show()):e.hide()},q=function(a,b){a.data.wrapper.css({top:b})};i.fixedFooter=function(b){var c=a("<div class='summary'>").html(b.html());b.closest("table.list").after(c);var d=document.querySelector("div.summary");return d&&b.closest("table.list").css("margin-bottom",d.getBoundingClientRect().height+"px"),b.bind("footer:change",function(a,b){c.html(a.target.innerHTML)[b?"show":"hide"]()}),c},i.fixedHead=function(c,d,e){var f={position:"fixed",top:e||"5.08em","z-index":"10"},g=a("<div class='fix-head'>").css(f);c.parent().append(g);var h=c.attr("class")+" hidden",i=a("<table>").attr("class",h).append(c.find("thead").clone());g.append(i);var j={offset:d||0,wrapper:g,table:c};a(document).unbind("scroll",p),d&&a(document).bind("scroll",j,p),a(window).unbind("resize",o).bind("resize",j,o),c.bind("top:changed",j,q),b.defer(function(){n(j.table,g.children("table"))})},i.disposeFixedHead=function(){a(document).unbind("scroll",p),a(window).unbind("resize",o)},i.sprintf=function(){var a=arguments[0];if(a)for(var c=1;c<arguments.length;c++){var d=new RegExp("\\{"+c+"\\}","gi");a=a.replace(d,arguments[c])}else a=b.compact(arguments).toString();return a},i.replaceAll=function(a,b,c){return a.split(b).join(c)},i.escapeSpecialChars=function(a){return b.each(["\\",'"',"'"],function(b){a=i.replaceAll(a,b,"\\"+b)}),a},i.unEscapeSpecialChars=function(a){return b.each(["\\\\",'\\"',"\\'"],function(b){a=i.replaceAll(a,b,b.substr(1))}),a},i.setGroup=function(a,b){for(var c in b)b.hasOwnProperty(c)&&a.$("#"+c).val(b[c]);a.model.set(b,{silent:!0})},i.mapGroup=function(a,c,d,e){var f=function(a,b){return"undefined"!=typeof a.get?a.get(b):a[b]};e=e||{};var g={};for(var h in c)b.has(c,h)&&(g[h]=f(d,c[h]));if(a.model.set(g),!e.excludeView)for(h in g)g.hasOwnProperty(h)&&a[h]&&a[h].val(g[h]).change()},i.storageKeyWrapper=function(a){return localStorage.getItem("bid")+"."+localStorage.getItem("eid")+"."+a},i.setStorageData=function(a,b){localStorage.setItem(i.storageKeyWrapper(a),b)},i.getStorageData=function(a){return localStorage.getItem(i.storageKeyWrapper(a))},i.storageKeyDocWrapper=function(a){var b=i.storageKeyWrapper(a);
return h?localStorage.getItem("current_sub_client_id")+"."+b:b},i.setStorageDocData=function(a,b){localStorage.setItem(i.storageKeyDocWrapper(a),b)},i.getStorageDocData=function(a){return localStorage.getItem(i.storageKeyDocWrapper(a))},i.getLocale=function(){return localStorage.getItem("locale")||"uk"},i.setSelectionRange=function(a,b,c){var d=a[0];if(d.setSelectionRange)d.focus(),d.setSelectionRange(b,c||b);else if(d.createTextRange){var e=d.createTextRange();e.collapse(!0),e.moveEnd("character",c||b),e.moveStart("character",b),e.select()}},i.translate=function(c,d,e,f,g){var h=a.Deferred();g=g||i.getLocale();var j="apps/"+c+"/";return require([j+"nls/uk/"+c,j+"nls/en/"+c,j+"nls/"+c],function(a,c,i){var j={ru:i.root,uk:a,en:c},k=b.invert(j.uk)[d]||b.invert(j.en)[d]||b.invert(j.ru)[d],l=k?j[g][k]:d;e&&e.call(f,l),h.resolve(l)}),h.promise()};var r=function(a){return new Date((new Date).getTime()+parseInt(localStorage.getItem(a),10))};i.getServerDate=function(a){var b=r("time_delta");return a&&(b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.setMilliseconds(0)),b},i.getDbDate=function(){return r("db_time_delta")},i.contentEncode=function(a){for(var c="",d=a.order,e=0;e<d.length;e++){var f=d[e];if(b.isObject(f))for(var g=f.order,h=a.get(f.name),i=0;i<h.length;i++)for(var j=h[i],k=0;k<g.length;k++){var l=g[k];c+=f.name+"."+i+"."+l+"="+j[l]+"\n"}else c+=f+"="+a.get(f)+"\n"}return c},i.parseStrToByte=function(a){for(var b,c=[],d=0;d<a.length;d++)b=a.charCodeAt(d),c.push((65280&b)>>>8),c.push(255&b);return c},i.getContent=function(a,b){return a.get?a.get(b):a[b]},i.removeThousandSeparator=function(a){var b=" ";return a.split(b).join("")},i.convertByRules=function(c,d,e,f){if(b.contains(e,c.target.id))return!1;var g=a(c.target).getUnformattedValue();return d.hasOwnProperty(c.target.id)&&(g=d[c.target.id](g,f)),g},i.getAmountConverterRule=function(a){return function(b){return b?parseFloat(b).toFixed(a):""}},i.doExit=function(b){var c=i.settings.server_addr+"/logout;jsessionid="+i.getStoredItem("JSESSIONID");return a.post(c),b&&b.clear(),i.storeItem("JSESSIONID",""),i.storeItem("CSRF_TOKEN",""),localStorage.setItem("logout",Math.random()),localStorage.setItem("life_for",""),localStorage.setItem("current_sub_client_id",""),window.onbeforeunload=function(){},SignPluginServices.closeSession()},i.getKeyFromEvent=function(a){return a=b.isString(a)?a:a.id,a.toLowerCase()},i.selectMenuElement=function(b){var c=a(b).closest("li");c.toggleClass("opened").toggleClass("closed"),c.siblings().toggleClass("closed");var d=a(b).attr("class").split(" ")[1]||"",e=a.parseJSON(i.getStorageData("opened_menu_list"))||{};a(c).hasClass("opened")?e[d]="opened":delete e[d],i.setStorageData("opened_menu_list",JSON.stringify(e))},i.utf8_decode_win1251=function(a){for(var b="",c=0,d={1111:191,1110:179,1108:186,1169:180,1105:184,1031:175,1030:178,1028:170,1168:165,1025:168,8470:185,171:171,187:187},e=0;e<a.length;e++)c=a.charCodeAt(e),b+=g(c,t)?c>127?c>1039&&1104>c?String.fromCharCode(c-848):String.fromCharCode(d[c]):a.charAt(e):" ";return b},i.utf8_decode_cp1125=function(a){for(var b="",c=0,d={1111:249,1110:247,1108:245,1169:243,1105:251,1031:248,1030:246,1028:244,1168:242,1025:240,8470:252},e=0;e<a.length;e++)c=a.charCodeAt(e),g(c,t)||(b+=" "),c>127?d[c]?b+=String.fromCharCode(d[c]):c>1039&&1088>c?b+=String.fromCharCode(c-912):c>1087&&1104>c&&(b+=String.fromCharCode(c-864)):b+=a.charAt(e);return b},i.formatPhone=function(a){return a.substring(0,4)+" ("+a.substring(4,6)+") "+a.substring(6,9)+"-"+a.substring(9,11)+"-"+a.substring(11,13)},i.formatShortCard=function(a){return a.substring(0,4)+"*"+a.substr(-4)},i.formatShortDate=function(a){return a.substring(3,5)+"/"+a.substring(8)},i.stringFromCharCode=function(a){for(var b,c=new Uint8Array(a),d=32768,e=0,f="";e<c.length;)b=c.subarray(e,Math.min(e+d,c.length)),f+=String.fromCharCode.apply(null,b),e+=d;return f},i.loadAttachContent=function(b,c,d){var e=a.Deferred(),f=new XMLHttpRequest;f.open("POST",i.settings.server_addr+"/attach/"+b+"/"+c+"/"+d+";jsessionid="+i.getStoredItem("JSESSIONID")),f.responseType="arraybuffer",f.setRequestHeader("X-CSRF-TOKEN",i.getStoredItem("CSRF_TOKEN")),f.onload=function(){200===f.status?e.resolve({id:d,content:new Uint8Array(f.response)}):e.reject({id:d})},f.onerror=function(){e.reject({id:d})},f.send();var g=e.promise();return g.cancelLoading=function(){f.abort()},g},i.checkAttachExtension=function(a,c){if(c){var d=a.split(".");if(d.length>1){var e=d[d.length-1];if(!b.contains(c.toLowerCase().split(","),e.toLowerCase()))return!1}}return!0},i.checkUnsupportedSymbols=function(a){var c={};return b.each(a,function(a,d){if(b.isString(a))for(var e=0;e<a.length;e++)if(!g(a.charCodeAt(e),s)){c[d]=i.sprintf(f.invalid_character,a.charAt(e));break}}),b.isEmpty(c)?null:c};var s=[9,10,13,151,165,168,170,175,1105,1025,1028,1030,1031,1108,1110,1111,1168,1169,8470,8216,8211,8222,171,8217,8220,1118,160,8221,187],t=[9,10,13,151,165,168,170,175,1105,1025,1028,1030,1031,1108,1110,1111,1168,1169,8470,171];return i}),define("dialogUtils",["jquery","bifit","i18n!nls/common"],function(a,b,c){"use strict";var d={close:'<button type="button" class="ok cancel action primary" data-action="close">'+c.confirm_close+"</button>",ok:'<button type="button" class="ok action primary" data-action="ok">'+c.confirm_ok+"</button>",cancel:'<button type="button" class="cancel action" data-action="cancel">'+c.confirm_cancel+"</button>"},e=function(){},f=function(a,b){return function(){a=a||e,a.call(this),clearInterval(b)}},g=function(b,c,e,f){var g=i.wrapper(),h=a(g).append(b),j=function(b){a(window).off("keypress",k),a(window).off("keyup",l),i.disposeWrapper(g),b&&b.call(e||null)},k=function(a){switch(a.preventDefault(),a.keyCode){case 13:j(c.ok||c.close);break;case 27:j(c.cancel||c.close);break;case 0:case 32:32===a.charCode&&j(c.ok||c.close)}return!1},l=function(b){return b.preventDefault(),a(window).off("keyup",l),!1};a(window).on("keypress",k).on("keyup",l);var m=function(b){j(c[a(b.target).attr("data-action")])};for(var n in c)if(c.hasOwnProperty(n)){var o=a(d[n]).appendTo(b).click(m),p=(f||{})[n];p&&o.html(p)}h.addClass("show"),a(b).find("a").click(function(){j()})},h=function(b,d,e){var f=a("<div>").addClass("box");return a("<div>").addClass("exit").click(function(){f.find(e?"button.ok":"button.cancel").click()}).appendTo(f),a("<div>").addClass("title").html(d||c.attention).appendTo(f),a("<div>").addClass("message").html(b).appendTo(f),f},i={};return i.wrapper=function(){var a=document.createElement("div");return a.className="modal",document.body.appendChild(a),a},i.disposeWrapper=function(a){document.body.removeChild(a||document.querySelector("div.modal"))},i.confirm=function(a,b,c,d,f,i){g(h(a,null,i),{ok:b||e,cancel:c||e},d,f)},i.timer=function(a,b,c,d,e,i){var j,k=h(a()),l=k.find("div.message");return k.addClass("timer-js"),j=setInterval(function(){b()?l.html(a()):clearInterval(j)},500),g(k,{ok:f(c,j),cancel:f(d,j)},e,i),j},i.getTimerWrapper=function(){var a=document.body.querySelector("div.box.timer-js");return a?a.parentNode:null},i.alert=function(a,b,c,d){g(h(a,d),{close:b||e},c)},i}),function(a,b){if("function"==typeof define&&define.amd)define("backbone.wreqr",["backbone","underscore"],function(a,c){return b(a,c)});else if("undefined"!=typeof exports){var c=require("backbone"),d=require("underscore");module.exports=b(c,d)}else b(a.Backbone,a._)}(this,function(a,b){"use strict";var c=a.Wreqr,d=a.Wreqr={};return a.Wreqr.VERSION="1.3.6",a.Wreqr.noConflict=function(){return a.Wreqr=c,this},d.Handlers=function(a,b){var c=function(a){this.options=a,this._wreqrHandlers={},b.isFunction(this.initialize)&&this.initialize(a)};return c.extend=a.Model.extend,b.extend(c.prototype,a.Events,{setHandlers:function(a){b.each(a,function(a,c){var d=null;b.isObject(a)&&!b.isFunction(a)&&(d=a.context,a=a.callback),this.setHandler(c,a,d)},this)},setHandler:function(a,b,c){var d={callback:b,context:c};this._wreqrHandlers[a]=d,this.trigger("handler:add",a,b,c)},hasHandler:function(a){return!!this._wreqrHandlers[a]},getHandler:function(a){var b=this._wreqrHandlers[a];if(b)return function(){return b.callback.apply(b.context,arguments)}},removeHandler:function(a){delete this._wreqrHandlers[a]},removeAllHandlers:function(){this._wreqrHandlers={}}}),c}(a,b),d.CommandStorage=function(){var c=function(a){this.options=a,this._commands={},b.isFunction(this.initialize)&&this.initialize(a)};return b.extend(c.prototype,a.Events,{getCommands:function(a){var b=this._commands[a];return b||(b={command:a,instances:[]},this._commands[a]=b),b},addCommand:function(a,b){var c=this.getCommands(a);c.instances.push(b)},clearCommands:function(a){var b=this.getCommands(a);b.instances=[]}}),c}(),d.Commands=function(a,b){return a.Handlers.extend({storageType:a.CommandStorage,constructor:function(b){this.options=b||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this),a.Handlers.prototype.constructor.apply(this,arguments)},execute:function(a){a=arguments[0];var c=b.rest(arguments);this.hasHandler(a)?this.getHandler(a).apply(this,c):this.storage.addCommand(a,c)},_executeCommands:function(a,c,d){var e=this.storage.getCommands(a);b.each(e.instances,function(a){c.apply(d,a)}),this.storage.clearCommands(a)},_initializeStorage:function(a){var c,d=a.storageType||this.storageType;c=b.isFunction(d)?new d:d,this.storage=c}})}(d,b),d.RequestResponse=function(a,b){return a.Handlers.extend({request:function(a){return this.hasHandler(a)?this.getHandler(a).apply(this,b.rest(arguments)):void 0}})}(d,b),d.EventAggregator=function(a,b){var c=function(){};return c.extend=a.Model.extend,b.extend(c.prototype,a.Events),c}(a,b),d.Channel=function(c){var d=function(b){this.vent=new a.Wreqr.EventAggregator,this.reqres=new a.Wreqr.RequestResponse,this.commands=new a.Wreqr.Commands,this.channelName=b};return b.extend(d.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(a,b){return this._connect("vent",a,b),this},connectCommands:function(a,b){return this._connect("commands",a,b),this},connectRequests:function(a,b){return this._connect("reqres",a,b),this},_connect:function(a,c,d){if(c){d=d||this;var e="vent"===a?"on":"setHandler";b.each(c,function(c,f){this[a][e](f,b.bind(c,d))},this)}}}),d}(d),d.radio=function(a,b){var c=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};b.extend(c.prototype,{channel:function(a){if(!a)throw new Error("Channel must receive a name");return this._getChannel(a)},_getChannel:function(b){var c=this._channels[b];return c||(c=new a.Channel(b),this._channels[b]=c),c},_proxyMethods:function(){b.each(["vent","commands","reqres"],function(a){b.each(d[a],function(b){this[a][b]=e(this,a,b)},this)},this)}});var d={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},e=function(a,c,d){return function(e){var f=a._getChannel(e)[c];return f[d].apply(f,b.rest(arguments))}};return new c}(d,b),a.Wreqr}),function(a,b){if("function"==typeof define&&define.amd)define("backbone.babysitter",["backbone","underscore"],function(a,c){return b(a,c)});else if("undefined"!=typeof exports){var c=require("backbone"),d=require("underscore");module.exports=b(c,d)}else b(a.Backbone,a._)}(this,function(a,b){"use strict";var c=a.ChildViewContainer;return a.ChildViewContainer=function(a,b){var c=function(a){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),b.each(a,this.add,this)};b.extend(c.prototype,{add:function(a,b){var c=a.cid;return this._views[c]=a,a.model&&(this._indexByModel[a.model.cid]=c),b&&(this._indexByCustom[b]=c),this._updateLength(),this},findByModel:function(a){return this.findByModelCid(a.cid)},findByModelCid:function(a){var b=this._indexByModel[a];return this.findByCid(b)},findByCustom:function(a){var b=this._indexByCustom[a];return this.findByCid(b)},findByIndex:function(a){return b.values(this._views)[a]},findByCid:function(a){return this._views[a]},remove:function(a){var c=a.cid;return a.model&&delete this._indexByModel[a.model.cid],b.any(this._indexByCustom,function(a,b){return a===c?(delete this._indexByCustom[b],!0):void 0},this),delete this._views[c],this._updateLength(),this},call:function(a){this.apply(a,b.tail(arguments))},apply:function(a,c){b.each(this._views,function(d){b.isFunction(d[a])&&d[a].apply(d,c||[])})},_updateLength:function(){this.length=b.size(this._views)}});var d=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return b.each(d,function(a){c.prototype[a]=function(){var c=b.values(this._views),d=[c].concat(b.toArray(arguments));return b[a].apply(b,d)}}),c}(a,b),a.ChildViewContainer.VERSION="0.1.11",a.ChildViewContainer.noConflict=function(){return a.ChildViewContainer=c,this},a.ChildViewContainer}),function(a,b){if("function"==typeof define&&define.amd)define("marionette",["backbone","underscore","backbone.wreqr","backbone.babysitter"],function(c,d){return a.Marionette=b(a,c,d)});else if("undefined"!=typeof exports){var c=require("backbone"),d=require("underscore");require("backbone.wreqr"),require("backbone.babysitter");module.exports=b(a,c,d)}else a.Marionette=b(a,a.Backbone,a._)}(this,function(a,b,c){"use strict";function d(a,b){var c=new Error(a);throw c.name=b||"Error",c}var e=a.Marionette,f=b.Marionette={};f.VERSION="2.1.0",f.noConflict=function(){return a.Marionette=e,this},f.Deferred=b.$.Deferred;var g=Array.prototype.slice;return f.extend=b.Model.extend,f.getOption=function(a,b){if(a&&b){var c;return c=a.options&&void 0!==a.options[b]?a.options[b]:a[b]}},f.proxyGetOption=function(a){return f.getOption(this,a)},f.normalizeMethods=function(a){var b={};return c.each(a,function(a,d){c.isFunction(a)||(a=this[a]),a&&(b[d]=a)},this),b},f.normalizeUIKeys=function(a,b){return"undefined"!=typeof a?(c.each(c.keys(a),function(c){var d=/@ui\.[a-zA-Z_$0-9]*/g;c.match(d)&&(a[c.replace(d,function(a){return b[a.slice(4)]})]=a[c],delete a[c])}),a):void 0},f.actAsCollection=function(a,b){var d=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];c.each(d,function(d){a[d]=function(){var a=c.values(c.result(this,b)),e=[a].concat(c.toArray(arguments));return c[d].apply(c,e)}})},f.triggerMethod=function(){function a(a,b,c){return c.toUpperCase()}var b=/(^|:)(\w)/gi,d=function(d){var e,f="on"+d.replace(b,a),g=this[f];return c.isFunction(g)&&(e=g.apply(this,c.tail(arguments))),c.isFunction(this.trigger)&&this.trigger.apply(this,arguments),e};return d}(),f.MonitorDOMRefresh=function(a){function d(a){a._isShown=!0,f(a)}function e(a){a._isRendered=!0,f(a)}function f(a){a._isShown&&a._isRendered&&g(a)&&c.isFunction(a.triggerMethod)&&a.triggerMethod("dom:refresh")}function g(c){return b.$.contains(a,c.el)}return function(a){a.listenTo(a,"show",function(){d(a)}),a.listenTo(a,"render",function(){e(a)})}}(document.documentElement),function(a){function b(a,b,e,f){var g=f.split(/\s+/);c.each(g,function(c){var f=a[c];f||d('Method "'+c+'" was configured as an event handler, but does not exist.'),a.listenTo(b,e,f)})}function e(a,b,c,d){a.listenTo(b,c,d)}function f(a,b,d,e){var f=e.split(/\s+/);c.each(f,function(c){var e=a[c];a.stopListening(b,d,e)})}function g(a,b,c,d){a.stopListening(b,c,d)}function h(a,b,d,e,f){b&&d&&(c.isFunction(d)&&(d=d.call(a)),c.each(d,function(d,g){c.isFunction(d)?e(a,b,g,d):f(a,b,g,d)}))}a.bindEntityEvents=function(a,c,d){h(a,c,d,e,b)},a.unbindEntityEvents=function(a,b,c){h(a,b,c,g,f)},a.proxyBindEntityEvents=function(b,c){return a.bindEntityEvents(this,b,c)},a.proxyUnbindEntityEvents=function(b,c){return a.unbindEntityEvents(this,b,c)}}(f),f.Callbacks=function(){this._deferred=f.Deferred(),this._callbacks=[]},c.extend(f.Callbacks.prototype,{add:function(a,b){var d=c.result(this._deferred,"promise");this._callbacks.push({cb:a,ctx:b}),d.then(function(c){b&&(c.context=b),a.call(c.context,c.options)})},run:function(a,b){this._deferred.resolve({options:a,context:b})},reset:function(){var a=this._callbacks;this._deferred=f.Deferred(),this._callbacks=[],c.each(a,function(a){this.add(a.cb,a.ctx)},this)}}),f.Controller=function(a){this.options=a||{},c.isFunction(this.initialize)&&this.initialize(this.options)},f.Controller.extend=f.extend,c.extend(f.Controller.prototype,b.Events,{destroy:function(){var a=g.call(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(a)),this.triggerMethod.apply(this,["destroy"].concat(a)),this.stopListening(),this.off(),this},triggerMethod:f.triggerMethod,getOption:f.proxyGetOption}),f.Object=function(a){this.options=c.extend({},c.result(this,"options"),a),this.initialize(this.options)},f.Object.extend=f.extend,c.extend(f.Object.prototype,{initialize:function(){},destroy:function(){this.triggerMethod("before:destroy"),this.triggerMethod("destroy"),this.stopListening()},triggerMethod:f.triggerMethod,getOption:f.proxyGetOption,bindEntityEvents:f.proxyBindEntityEvents,unbindEntityEvents:f.proxyUnbindEntityEvents}),c.extend(f.Object.prototype,b.Events),f.Region=function(a){if(this.options=a||{},this.el=this.getOption("el"),this.el=this.el instanceof b.$?this.el[0]:this.el,this.el||d('An "el" must be specified for a region.',"NoElError"),this.$el=this.getEl(this.el),this.initialize){var c=g.apply(arguments);this.initialize.apply(this,c)}},c.extend(f.Region,{buildRegion:function(a,b){return c.isString(a)?this._buildRegionFromSelector(a,b):a.selector||a.el||a.regionClass?this._buildRegionFromObject(a,b):c.isFunction(a)?this._buildRegionFromRegionClass(a):void d("Improper region configuration type. Please refer to http://marionettejs.com/docs/marionette.region.html#region-configuration-types")},_buildRegionFromSelector:function(a,b){return new b({el:a})},_buildRegionFromObject:function(a,d){var e=a.regionClass||d,f=c.omit(a,"selector","regionClass");a.selector&&!f.el&&(f.el=a.selector);var g=new e(f);return a.parentEl&&(g.getEl=function(d){if(c.isObject(d))return b.$(d);var e=a.parentEl;return c.isFunction(e)&&(e=e()),e.find(d)}),g},_buildRegionFromRegionClass:function(a){return new a}}),c.extend(f.Region.prototype,b.Events,{show:function(a,b){this._ensureElement();var d=b||{},e=a!==this.currentView,f=!!d.preventDestroy,g=!!d.forceShow,h=!!this.currentView,i=!f&&e;i&&this.empty();var j=e||g;return j?(a.once("destroy",c.bind(this.empty,this)),a.render(),h&&this.triggerMethod("before:swap",a),this.triggerMethod("before:show",a),c.isFunction(a.triggerMethod)?a.triggerMethod("before:show"):this.triggerMethod.call(a,"before:show"),this.attachHtml(a),this.currentView=a,h&&this.triggerMethod("swap",a),this.triggerMethod("show",a),c.isFunction(a.triggerMethod)?a.triggerMethod("show"):this.triggerMethod.call(a,"show"),this):this},_ensureElement:function(){c.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),this.$el&&0!==this.$el.length||d('An "el" '+this.$el.selector+" must exist in DOM")},getEl:function(a){return b.$(a)},attachHtml:function(a){this.el.innerHTML="",this.el.appendChild(a.el)},empty:function(){var a=this.currentView;if(a)return this.triggerMethod("before:empty",a),this._destroyView(),this.triggerMethod("empty",a),delete this.currentView,this},_destroyView:function(){var a=this.currentView;a.destroy&&!a.isDestroyed?a.destroy():a.remove&&a.remove()},attachView:function(a){return this.currentView=a,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this},getOption:f.proxyGetOption,triggerMethod:f.triggerMethod}),f.Region.extend=f.extend,f.RegionManager=function(a){var b=a.Controller.extend({constructor:function(b){this._regions={},a.Controller.call(this,b)},addRegions:function(a,b){c.isFunction(a)&&(a=a.apply(this,arguments));var d={};return c.each(a,function(a,e){c.isString(a)&&(a={selector:a}),a.selector&&(a=c.defaults({},a,b));var f=this.addRegion(e,a);d[e]=f},this),d},addRegion:function(b,d){var e,f=c.isObject(d),g=c.isString(d),h=!!d.selector;return e=g||f&&h?a.Region.buildRegion(d,a.Region):c.isFunction(d)?a.Region.buildRegion(d,a.Region):d,this.triggerMethod("before:add:region",b,e),this._store(b,e),this.triggerMethod("add:region",b,e),e},get:function(a){return this._regions[a]},getRegions:function(){return c.clone(this._regions)},removeRegion:function(a){var b=this._regions[a];return this._remove(a,b),b},removeRegions:function(){var a=this.getRegions();return c.each(this._regions,function(a,b){this._remove(b,a)},this),a},emptyRegions:function(){var a=this.getRegions();return c.each(a,function(a){a.empty()},this),a},destroy:function(){return this.removeRegions(),a.Controller.prototype.destroy.apply(this,arguments)},_store:function(a,b){this._regions[a]=b,this._setLength()},_remove:function(a,b){this.triggerMethod("before:remove:region",a,b),b.empty(),b.stopListening(),delete this._regions[a],this._setLength(),this.triggerMethod("remove:region",a,b)},_setLength:function(){this.length=c.size(this._regions)}});return a.actAsCollection(b.prototype,"_regions"),b}(f),f.TemplateCache=function(a){this.templateId=a},c.extend(f.TemplateCache,{templateCaches:{},get:function(a){var b=this.templateCaches[a];return b||(b=new f.TemplateCache(a),this.templateCaches[a]=b),b.load()},clear:function(){var a,b=g.call(arguments),c=b.length;if(c>0)for(a=0;c>a;a++)delete this.templateCaches[b[a]];else this.templateCaches={}}}),c.extend(f.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var a=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(a),this.compiledTemplate},loadTemplate:function(a){var c=b.$(a).html();return c&&0!==c.length||d('Could not find template: "'+a+'"',"NoTemplateError"),c},compileTemplate:function(a){return c.template(a)}}),f.Renderer={render:function(a,b){a||d("Cannot render the template since its false, null or undefined.","TemplateNotFoundError");var c;return(c="function"==typeof a?a:f.TemplateCache.get(a))(b)}},f.View=b.View.extend({constructor:function(a){c.bindAll(this,"render"),this.options=c.extend({},c.result(this,"options"),c.isFunction(a)?a.call(this):a),this.events=this.normalizeUIKeys(c.result(this,"events")),c.isObject(this.behaviors)&&new f.Behaviors(this),b.View.apply(this,arguments),f.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled)},getTemplate:function(){return this.getOption("template")},serializeModel:function(a){return a.toJSON.apply(a,g.call(arguments,1))},mixinTemplateHelpers:function(a){a=a||{};var b=this.getOption("templateHelpers");return c.isFunction(b)&&(b=b.call(this)),c.extend(a,b)},normalizeUIKeys:function(a){var b=c.result(this,"ui"),d=c.result(this,"_uiBindings");return f.normalizeUIKeys(a,d||b)},configureTriggers:function(){if(this.triggers){var a={},b=this.normalizeUIKeys(c.result(this,"triggers"));return c.each(b,function(b,d){var e=c.isObject(b),f=e?b.event:b;a[d]=function(a){if(a){var c=a.preventDefault,d=a.stopPropagation,g=e?b.preventDefault:c,h=e?b.stopPropagation:d;g&&c&&c.apply(a),h&&d&&d.apply(a)}var i={view:this,model:this.model,collection:this.collection};this.triggerMethod(f,i)}},this),a}},delegateEvents:function(a){return this._delegateDOMEvents(a),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),this},_delegateDOMEvents:function(a){a=a||this.events,c.isFunction(a)&&(a=a.call(this)),a=this.normalizeUIKeys(a);var d={},e=c.result(this,"behaviorEvents")||{},f=this.configureTriggers();c.extend(d,e,a,f),b.View.prototype.delegateEvents.call(this,d)},undelegateEvents:function(){var a=g.call(arguments);return b.View.prototype.undelegateEvents.apply(this,a),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),this},onShowCalled:function(){},_ensureViewIsIntact:function(){if(this.isDestroyed){var a=new Error("Cannot use a view thats already been destroyed.");throw a.name="ViewDestroyedError",a}},destroy:function(){if(!this.isDestroyed){var a=g.call(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(a)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(a)),this.unbindUIElements(),this.remove(),this}},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var a=c.result(this,"_uiBindings");this.ui={},c.each(c.keys(a),function(b){var c=a[b];this.ui[b]=this.$(c)},this)}},unbindUIElements:function(){this.ui&&this._uiBindings&&(c.each(this.ui,function(a,b){delete this.ui[b]},this),this.ui=this._uiBindings,delete this._uiBindings)},triggerMethod:f.triggerMethod,normalizeMethods:f.normalizeMethods,getOption:f.proxyGetOption,bindEntityEvents:f.proxyBindEntityEvents,unbindEntityEvents:f.proxyUnbindEntityEvents}),f.ItemView=f.View.extend({constructor:function(){f.View.apply(this,arguments)},serializeData:function(){var a={};return this.model?a=c.partial(this.serializeModel,this.model).apply(this,arguments):this.collection&&(a={items:c.partial(this.serializeCollection,this.collection).apply(this,arguments)}),a},serializeCollection:function(a){return a.toJSON.apply(a,g.call(arguments,1))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var a=this.getTemplate();if(a!==!1){a||d("Cannot render the template since it is null or undefined.","UndefinedTemplateError");var b=this.serializeData();b=this.mixinTemplateHelpers(b);var c=f.Renderer.render(a,b,this);return this.attachElContent(c),this}},attachElContent:function(a){return this.$el.html(a),this},destroy:function(){return this.isDestroyed?void 0:f.View.prototype.destroy.apply(this,arguments)}}),f.CollectionView=f.View.extend({childViewEventPrefix:"childview",constructor:function(a){var b=a||{};this.sort=c.isUndefined(b.sort)?!0:b.sort,this._initChildViewStorage(),f.View.apply(this,arguments),this._initialEvents(),this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment(),this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.isBuffering=!1,this._triggerBeforeShowBufferedChildren(),this.attachBuffer(this,this.elBuffer),this._triggerShowBufferedChildren(),this.initRenderBuffer()},_triggerBeforeShowBufferedChildren:function(){this._isShown&&c.invoke(this._bufferedChildren,"triggerMethod","before:show")},_triggerShowBufferedChildren:function(){this._isShown&&(c.each(this._bufferedChildren,function(a){c.isFunction(a.triggerMethod)?a.triggerMethod("show"):f.triggerMethod.call(a,"show")}),this._bufferedChildren=[])},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(a){this.destroyEmptyView();var b=this.getChildView(a),c=this.collection.indexOf(a);this.addChild(a,b,c)},_onCollectionRemove:function(a){var b=this.children.findByModel(a);this.removeChildView(b),this.checkEmpty()},onShowCalled:function(){this.children.each(function(a){c.isFunction(a.triggerMethod)?a.triggerMethod("show"):f.triggerMethod.call(a,"show")})},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.triggerMethod("render",this),this},resortView:function(){this.render()},_sortViews:function(){var a=this.collection.find(function(a,b){var c=this.children.findByModel(a);return!c||c._index!==b},this);a&&this.resortView()},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren(),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this))},showCollection:function(){var a;this.collection.each(function(b,c){a=this.getChildView(b),this.addChild(b,a,c)},this)},showEmptyView:function(){var a=this.getEmptyView();if(a&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var c=new b.Model;this.addEmptyView(c,a),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.destroyChildren(),delete this._showingEmptyView)},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(a,b){var d=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");c.isFunction(d)&&(d=d.call(this));var e=this.buildChildView(a,b,d);this._isShown&&this.triggerMethod.call(e,"before:show"),this.children.add(e),this.renderChildView(e,-1),this._isShown&&this.triggerMethod.call(e,"show")},getChildView:function(a){var b=this.getOption("childView");return b||d('A "childView" must be specified',"NoChildViewError"),b},addChild:function(a,b,d){var e=this.getOption("childViewOptions");c.isFunction(e)&&(e=e.call(this,a,d));var f=this.buildChildView(a,b,e);return this._updateIndices(f,!0,d),this._addChildView(f,d),f},_updateIndices:function(a,b,c){this.sort&&(b?(a._index=c,this.children.each(function(b){b._index>=a._index&&b._index++})):this.children.each(function(b){b._index>=a._index&&b._index--}))},_addChildView:function(a,b){this.proxyChildEvents(a),this.triggerMethod("before:add:child",a),this.children.add(a),this.renderChildView(a,b),this._isShown&&!this.isBuffering&&(c.isFunction(a.triggerMethod)?a.triggerMethod("show"):f.triggerMethod.call(a,"show")),this.triggerMethod("add:child",a)},renderChildView:function(a,b){return a.render(),this.attachHtml(this,a,b),a},buildChildView:function(a,b,d){var e=c.extend({model:a},d);return new b(e)},removeChildView:function(a){return a&&(this.triggerMethod("before:remove:child",a),a.destroy?a.destroy():a.remove&&a.remove(),this.stopListening(a),this.children.remove(a),this.triggerMethod("remove:child",a),this._updateIndices(a,!1)),a},isEmpty:function(a){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(a,b){a.$el.append(b)},attachHtml:function(a,b,c){a.isBuffering?(a.elBuffer.appendChild(b.el),a._bufferedChildren.push(b)):a._insertBefore(b,c)||a._insertAfter(b)},_insertBefore:function(a,b){var c,d=this.sort&&b<this.children.length-1;return d&&(c=this.children.find(function(a){return a._index===b+1})),c?(c.$el.before(a.el),!0):!1},_insertAfter:function(a){this.$el.append(a.el)},_initChildViewStorage:function(){this.children=new b.ChildViewContainer},destroy:function(){return this.isDestroyed?void 0:(this.triggerMethod("before:destroy:collection"),this.destroyChildren(),this.triggerMethod("destroy:collection"),f.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(){var a=this.children.map(c.identity);return this.children.each(this.removeChildView,this),this.checkEmpty(),a},proxyChildEvents:function(a){var b=this.getOption("childViewEventPrefix");this.listenTo(a,"all",function(){var d=g.call(arguments),e=d[0],f=this.normalizeMethods(c.result(this,"childEvents"));d[0]=b+":"+e,d.splice(1,0,a),"undefined"!=typeof f&&c.isFunction(f[e])&&f[e].apply(this,d.slice(1)),this.triggerMethod.apply(this,d)},this)}}),f.CompositeView=f.CollectionView.extend({constructor:function(){f.CollectionView.apply(this,arguments);
},_initialEvents:function(){this.once("render",function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.sort&&this.listenTo(this.collection,"sort",this._sortViews))})},getChildView:function(a){var b=this.getOption("childView")||this.constructor;return b||d('A "childView" must be specified',"NoChildViewError"),b},serializeData:function(){var a={};return this.model&&(a=c.partial(this.serializeModel,this.model).apply(this,arguments)),a},render:function(){return this._ensureViewIsIntact(),this.isRendered=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this.triggerMethod("render",this),this},_renderChildren:function(){this.isRendered&&f.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var a={};a=this.serializeData(),a=this.mixinTemplateHelpers(a),this.triggerMethod("before:render:template");var b=this.getTemplate(),c=f.Renderer.render(b,a,this);this.attachElContent(c),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(a){return this.$el.html(a),this},attachBuffer:function(a,b){var c=this.getChildViewContainer(a);c.append(b)},_insertAfter:function(a){var b=this.getChildViewContainer(this);b.append(a.el)},getChildViewContainer:function(a){if("$childViewContainer"in a)return a.$childViewContainer;var b,e=f.getOption(a,"childViewContainer");if(e){var g=c.isFunction(e)?e.call(a):e;b="@"===g.charAt(0)&&a.ui?a.ui[g.substr(4)]:a.$(g),b.length<=0&&d('The specified "childViewContainer" was not found: '+a.childViewContainer,"ChildViewContainerMissingError")}else b=a.$el;return a.$childViewContainer=b,b},resetChildViewContainer:function(){this.$childViewContainer&&delete this.$childViewContainer}}),f.LayoutView=f.ItemView.extend({regionClass:f.Region,constructor:function(a){a=a||{},this._firstRender=!0,this._initializeRegions(a),f.ItemView.call(this,a)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),f.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.regionManager.destroy(),f.ItemView.prototype.destroy.apply(this,arguments))},addRegion:function(a,b){this.triggerMethod("before:region:add",a);var c={};return c[a]=b,this._buildRegions(c)[a]},addRegions:function(a){return this.regions=c.extend({},this.regions,a),this._buildRegions(a)},removeRegion:function(a){return this.triggerMethod("before:region:remove",a),delete this.regions[a],this.regionManager.removeRegion(a)},getRegion:function(a){return this.regionManager.get(a)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(a){var b=this,c={regionClass:this.getOption("regionClass"),parentEl:function(){return b.$el}};return this.regionManager.addRegions(a,c)},_initializeRegions:function(a){var b;this._initRegionManager(),b=c.isFunction(this.regions)?this.regions(a):this.regions||{};var d=this.getOption.call(a,"regions");c.isFunction(d)&&(d=d.call(this,a)),c.extend(b,d),this.addRegions(b)},_reInitializeRegions:function(){this.regionManager.emptyRegions(),this.regionManager.each(function(a){a.reset()})},getRegionManager:function(){return new f.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.listenTo(this.regionManager,"before:add:region",function(a){this.triggerMethod("before:add:region",a)}),this.listenTo(this.regionManager,"add:region",function(a,b){this[a]=b,this.triggerMethod("add:region",a,b)}),this.listenTo(this.regionManager,"before:remove:region",function(a){this.triggerMethod("before:remove:region",a)}),this.listenTo(this.regionManager,"remove:region",function(a,b){delete this[a],this.triggerMethod("remove:region",a,b)})}}),f.Behavior=function(a,b){function c(b,c){this.view=c,this.defaults=a.result(this,"defaults")||{},this.options=a.extend({},this.defaults,b),this.$=function(){return this.view.$.apply(this.view,arguments)},this.initialize.apply(this,arguments)}return a.extend(c.prototype,b.Events,{initialize:function(){},destroy:function(){this.stopListening()},triggerMethod:f.triggerMethod,getOption:f.proxyGetOption,bindEntityEvents:f.proxyBindEntityEvents,unbindEntityEvents:f.proxyUnbindEntityEvents}),c.extend=f.extend,c}(c,b),f.Behaviors=function(a,b){function c(a,e){e=c.parseBehaviors(a,e||b.result(a,"behaviors")),c.wrap(a,e,b.keys(d))}var d={setElement:function(a,c){return a.apply(this,b.tail(arguments,2)),b.each(c,function(a){a.$el=this.$el,a.el=this.el},this),this},destroy:function(a,c){var d=b.tail(arguments,2);return a.apply(this,d),b.invoke(c,"destroy",d),this},bindUIElements:function(a,c){a.apply(this),b.invoke(c,a)},unbindUIElements:function(a,c){a.apply(this),b.invoke(c,a)},triggerMethod:function(a,c){var d=b.tail(arguments,2);a.apply(this,d),b.each(c,function(b){a.apply(b,d)})},delegateEvents:function(c,d){var e=b.tail(arguments,2);return c.apply(this,e),b.each(d,function(b){a.bindEntityEvents(b,this.model,a.getOption(b,"modelEvents")),a.bindEntityEvents(b,this.collection,a.getOption(b,"collectionEvents"))},this),this},undelegateEvents:function(c,d){var e=b.tail(arguments,2);return c.apply(this,e),b.each(d,function(b){a.unbindEntityEvents(b,this.model,a.getOption(b,"modelEvents")),a.unbindEntityEvents(b,this.collection,a.getOption(b,"collectionEvents"))},this),this},behaviorEvents:function(c,d){var e={},f=b.result(this,"ui");return b.each(d,function(c,d){var g={},h=b.clone(b.result(c,"events"))||{},i=b.result(c,"ui"),j=b.extend({},f,i);h=a.normalizeUIKeys(h,j),b.each(b.keys(h),function(a){var e=new Array(d+2).join(" "),f=a+e,i=b.isFunction(h[a])?h[a]:c[h[a]];g[f]=b.bind(i,c)}),e=b.extend(e,g)}),e}};return b.extend(c,{behaviorsLookup:function(){throw new Error("You must define where your behaviors are stored.See https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.behaviors.md#behaviorslookup")},getBehaviorClass:function(a,d){return a.behaviorClass?a.behaviorClass:b.isFunction(c.behaviorsLookup)?c.behaviorsLookup.apply(this,arguments)[d]:c.behaviorsLookup[d]},parseBehaviors:function(a,d){return b.chain(d).map(function(d,e){var f=c.getBehaviorClass(d,e),g=new f(d,a),h=c.parseBehaviors(a,b.result(g,"behaviors"));return[g].concat(h)}).flatten().value()},wrap:function(a,c,e){b.each(e,function(e){a[e]=b.partial(d[e],a[e],c)})}}),c}(f,c),f.AppRouter=b.Router.extend({constructor:function(a){b.Router.apply(this,arguments),this.options=a||{};var c=this.getOption("appRoutes"),d=this._getController();this.processAppRoutes(d,c),this.on("route",this._processOnRoute,this)},appRoute:function(a,b){var c=this._getController();this._addAppRoute(c,a,b)},_processOnRoute:function(a,b){var d=c.invert(this.getOption("appRoutes"))[a];c.isFunction(this.onRoute)&&this.onRoute(a,d,b)},processAppRoutes:function(a,b){if(b){var d=c.keys(b).reverse();c.each(d,function(c){this._addAppRoute(a,c,b[c])},this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(a,b,e){var f=a[e];f||d('Method "'+e+'" was not found on the controller'),this.route(b,e,c.bind(f,a))},getOption:f.proxyGetOption}),f.Application=function(a){this._initializeRegions(a),this._initCallbacks=new f.Callbacks,this.submodules={},c.extend(this,a),this._initChannel()},c.extend(f.Application.prototype,b.Events,{execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(a){this._initCallbacks.add(a)},start:function(a){this.triggerMethod("before:start",a),this._initCallbacks.run(a,this),this.triggerMethod("start",a)},addRegions:function(a){return this._regionManager.addRegions(a)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(a){return this._regionManager.removeRegion(a)},getRegion:function(a){return this._regionManager.get(a)},getRegions:function(){return this._regionManager.getRegions()},module:function(a,b){var c=f.Module.getClass(b),d=g.call(arguments);return d.unshift(this),c.create.apply(c,d)},getRegionManager:function(){return new f.RegionManager},_initializeRegions:function(a){var b=c.isFunction(this.regions)?this.regions(a):this.regions||{};this._initRegionManager();var d=f.getOption(a,"regions");return c.isFunction(d)&&(d=d.call(this,a)),c.extend(b,d),this.addRegions(b),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this.listenTo(this._regionManager,"before:add:region",function(a){this.triggerMethod("before:add:region",a)}),this.listenTo(this._regionManager,"add:region",function(a,b){this[a]=b,this.triggerMethod("add:region",a,b)}),this.listenTo(this._regionManager,"before:remove:region",function(a){this.triggerMethod("before:remove:region",a)}),this.listenTo(this._regionManager,"remove:region",function(a,b){delete this[a],this.triggerMethod("remove:region",a,b)})},_initChannel:function(){this.channelName=c.result(this,"channelName")||"global",this.channel=c.result(this,"channel")||b.Wreqr.radio.channel(this.channelName),this.vent=c.result(this,"vent")||this.channel.vent,this.commands=c.result(this,"commands")||this.channel.commands,this.reqres=c.result(this,"reqres")||this.channel.reqres},triggerMethod:f.triggerMethod,getOption:f.proxyGetOption}),f.Application.extend=f.extend,f.Module=function(a,b,d){this.moduleName=a,this.options=c.extend({},this.options,d),this.initialize=d.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=b,this.startWithParent=!0,c.isFunction(this.initialize)&&this.initialize(a,b,this.options)},f.Module.extend=f.extend,c.extend(f.Module.prototype,b.Events,{initialize:function(){},addInitializer:function(a){this._initializerCallbacks.add(a)},addFinalizer:function(a){this._finalizerCallbacks.add(a)},start:function(a){this._isInitialized||(c.each(this.submodules,function(b){b.startWithParent&&b.start(a)}),this.triggerMethod("before:start",a),this._initializerCallbacks.run(a,this),this._isInitialized=!0,this.triggerMethod("start",a))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),c.each(this.submodules,function(a){a.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(a,b){this._runModuleDefinition(a,b)},_runModuleDefinition:function(a,d){if(a){var e=c.flatten([this,this.app,b,f,b.$,c,d]);a.apply(this,e)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new f.Callbacks,this._finalizerCallbacks=new f.Callbacks},triggerMethod:f.triggerMethod}),c.extend(f.Module,{create:function(a,b,d){var e=a,f=g.call(arguments);f.splice(0,3),b=b.split(".");var h=b.length,i=[];return i[h-1]=d,c.each(b,function(b,c){var g=e;e=this._getModule(g,b,a,d),this._addModuleDefinition(g,e,i[c],f)},this),e},_getModule:function(a,b,d,e,f){var g=c.extend({},e),h=this.getClass(e),i=a[b];return i||(i=new h(b,d,g),a[b]=i,a.submodules[b]=i),i},getClass:function(a){var b=f.Module;return a?a.prototype instanceof b?a:a.moduleClass||b:b},_addModuleDefinition:function(a,b,c,d){var e=this._getDefine(c),f=this._getStartWithParent(c,b);e&&b.addDefinition(e,d),this._addStartWithParent(a,b,f)},_getStartWithParent:function(a,b){var d;return c.isFunction(a)&&a.prototype instanceof f.Module?(d=b.constructor.prototype.startWithParent,c.isUndefined(d)?!0:d):c.isObject(a)?(d=a.startWithParent,c.isUndefined(d)?!0:d):!0},_getDefine:function(a){return!c.isFunction(a)||a.prototype instanceof f.Module?c.isObject(a)?a.define:null:a},_addStartWithParent:function(a,b,c){b.startWithParent=b.startWithParent&&c,b.startWithParent&&!b.startWithParentIsConfigured&&(b.startWithParentIsConfigured=!0,a.addInitializer(function(a){b.startWithParent&&b.start(a)}))}}),f}),define("app",["underscore","bifit","dialogUtils","backbone","marionette"],function(a,b,c,d,e){"use strict";var f=new e.Application;f.navigate=function(a,b){b=b||{},d.history.navigate(a,b)},f.multiClient=null,f.isMultiClient=function(){return null!==f.multiClient},f.checkIsMultiClient=function(){if(!this.isMultiClient())throw new Error("Supported only in MultiClient!")},f.checkIsNotMultiClient=function(){if(this.isMultiClient())throw new Error("Not supported in MultiClient!")};var g=function(a){var b=this.multiClient[a];if(!b)throw new Error("Property '"+a+"' must be initialized!!!");return b};f.getActiveClientsKeys=g.bind(f,"activeClientsKeys"),f.getClientsKeyStorages=g.bind(f,"clientsKeyStorages");var h;return f.getStorageEidToCId=function(){if(h)return h;h={};var b=f.getClientsKeyStorages();return a.each(f.getActiveClientsKeys(),function(c,d){var e=parseInt(d,10);a.each(c,function(a){var c=parseInt(a.ID,10);if(b[c]){var d=parseInt(a.EMPL_ID);h[d]=e}})}),h},f}),define("errorStorage",["underscore","backbone"],function(a,b){"use strict";var c=[],d=function(b,d){return a.find(c,function(a){return b===a.type&&(a.model.id||a.model.cid)===d})};return{add:function(a,d,e){c.push({model:a,type:d||a.type,href:e||b.history.fragment})},model:function(a,b){return(d(a,b)||{}).model},href:function(a,b){return(d(a,b)||{}).href},remove:function(b,d){c=a.reject(c,function(a){return b===a.type&&(a.model.id||a.model.cid)===d})}}}),function(a,b){if("object"==typeof exports){var c=require("underscore"),d=require("backbone");module.exports=b(c,d)}else"function"==typeof define&&define.amd&&define("backbone.picky",["underscore","backbone"],b)}(this,function(a,b){"option strict";return b.Picky=function(a,b){var c={};c.SingleSelect=function(a){this.collection=a},b.extend(c.SingleSelect.prototype,{select:function(a){a&&this.selected===a||(this.deselect(),this.selected=a,this.selected.select(),this.trigger("select:one",a))},deselect:function(a){this.selected&&(a=a||this.selected,this.selected===a&&(this.selected.deselect(),this.trigger("deselect:one",this.selected),delete this.selected))}}),c.MultiSelect=function(a){this.collection=a,this.selected={}},b.extend(c.MultiSelect.prototype,{select:function(a){this.selected[a.cid]||(this.selected[a.cid]=a,a.select(),d(this))},deselect:function(a){this.selected[a.cid]&&(delete this.selected[a.cid],a.deselect(),d(this))},selectAll:function(){this.each(function(a){a.select()}),d(this)},selectNone:function(){0!==this.selectedLength&&(this.each(function(a){a.deselect()}),d(this))},toggleSelectAll:function(){this.selectedLength===this.length?this.selectNone():this.selectAll()}}),c.Selectable=function(a){this.model=a},b.extend(c.Selectable.prototype,{select:function(){this.selected||(this.selected=!0,this.trigger("selected",this),this.collection&&this.collection.select(this))},deselect:function(){this.selected&&(this.selected=!1,this.trigger("deselected",this),this.collection&&this.collection.deselect(this))},toggleSelected:function(){this.selected?this.deselect():this.select()}});var d=function(a){a.selectedLength=b.size(a.selected);var c=a.selectedLength,d=a.length;return c===d?void a.trigger("select:all",a):0===c?void a.trigger("select:none",a):c>0&&d>c?void a.trigger("select:some",a):void 0};return c}(b,a),b.Picky}),define("models/base_model",["jquery","underscore","backbone","bifit","dialogUtils","errorStorage","i18n!nls/common","i18n!nls/validation","backbone.picky"],function(a,b,c,d,e,f,g,h){"use strict";var i=function(a){var c=b.filter(b.keys(a),function(a){return a===a.toUpperCase()||"attaches"===a});return b.pick.apply(this,[a].concat(c))};return c.Model.extend({initialize:function(){this._savedAttributes=a.extend(!0,{},this.attributes),this.on("sync",function(){this._issyncnow=!1,this._savedAttributes=this.toJSON()},this);var d=new c.Picky.Selectable(this);b.extend(this,d)},sync:function(a,d,f){f=f||{},this._issyncnow=!0;var h=function(a,b,c,g){d.trigger("model:completeSync",d,a,b,c),f.silent||(f.errorHandlers&&f.errorHandlers[c]?f.errorHandlers[c].call(this,d,f,g):b&&e.alert(b))};return f.statusCode={200:function(a){d._savedAttributes=b.clone(d.attributes),a.error?h(g.error,a.error,200):h("Ok",a.error,200)},400:function(a){h(g.error,a.responseText,400,a)},403:function(){h(g.error,g.net_forbidden,403)},500:function(a){h(g.error,a.responseText||g.net_error,500,a)},404:function(a){h(g.error,g.net_error,404,a)},0:function(a){h(g.error,g.net_error,0,a)}},c.sync(a,d,f)},isSyncNow:function(){return this._issyncnow},url:function(){var a=b.result(this,"urlRoot");return this.type&&(a+=this.type),this.isNew()||(a+="/"+this.id),a+this._session()},_session:function(){return";jsessionid="+d.getStoredItem("JSESSIONID")},loadTemplate:function(b){var c=this.urlRoot+this.type+"/create";return b&&(c+="/import"),a.getJSON(c+this._session(),function(a){this.set({DATE_DOC:a.D,NUM_DOC:a.N},{silent:!0})}.bind(this))},_errorWrapper:function(a,b){return d.sprintf(h.invalid_field_pattern,a,b)},_valueDateErrorWrapper:function(a){return d.sprintf(h.value_date_err_pattern,a)},revert:function(){this.trigger("revert"),this.set(this._savedAttributes)},isChanged:function(){return!b.isEqual(i(this._savedAttributes),i(this.toJSON()))},validateModel:function(a){var d,e=!this.preValidate;if(e&&c.Validation.bind({model:this},a),a&&"checkSymbols"in a)return d=a.checkSymbols?this.validate(a):this.validate(),!!d;if(d=this.validate(),e&&c.Validation.unbind({model:this}),!this._isValid)for(var f in d)if(b.has(d,f)){var g=d[f];this.nls&&this.nls["field_"+f]&&(g=this._errorWrapper(this.nls["field_"+f],g)),this.trigger("model:completeSync",this,h.error_title,g)}return this._isValid},toFormattedJSON:function(){var a=this.toJSON(),c=this.meta?this.meta.formattedFields:this.formattedFields[this.type];return b.each(c,function(b,c){a[c]=b.call(this)},this),a}})}),define("nls/reference",{root:{field_rcpt_bnk_name:"Наименование банка бенефициара",field_rcpt_name:"Наименование бенефициара",field_intermed_bnk_name:"Наименование банка-посредника",field_intermed_bnk_bic:"Идентификационный код банка-посредника",field_intermed_bnk_bic_type:"Тип идентификационного кода банка-посредника",field_intermed_bnk_country_code:"Код страны банка-посредника",field_intermed_bnk_country:"Страна банка-посредника",field_intermed_bnk_city:"Город банка-посредника",field_intermed_bnk_addr:"Адрес банка-посредника",field_rcpt_bnk_account:"Номер счета банка бенефициара",field_rcpt_bnk_bic:"Идентификационный код банка бенефициара",field_rcpt_bnk_bic_type:"Тип идентификационного кода банка бенефициара",field_rcpt_bnk_country_code:"Код страны банка бенефициара",field_rcpt_bnk_country:"Страна банка бенефициара",field_rcpt_bnk_city:"Город банка бенефициара",field_rcpt_bnk_addr:"Адрес банка бенефициара",field_rcpt_account:"Номер счета бенефициара",field_rcpt_country_code:"Код страны бенефициара",field_rcpt_country:"Страна бенефициара",field_rcpt_city:"Город бенефициара",field_rcpt_addr:"Адрес бенефициара",field_rcpt_bnk_iban:"IBAN-код банка бенефициара",field_bill:"Счет получателя",field_bic:"МФО банка получателя",field_inn:"ЕГРПОУ получателя",field_name:"Наименование получателя",field_note:"Примечание",invalid_swift:"Банк с кодом SWIFT {1} в справочнике банков не обнаружен",fetch_error:"Ошибка при получении справочника {1}",import_result_successful:"Успешно импортировано",import_result_failed:"Импорт не выполнен",import_result_partial:"Импорт выполнен частично",import_error:"Ошибка во время импорта справочника {1}",import_result_total_documents:"Обработано записей справочника: ",import_result_success_documents:"Успешно импортировано записей справочника: ",import_result_info:"импортировано записей справочника {1} из {2}",error_title:"Ошибка",swift:"SWIFT",ua_swift:"МФО",country:"countries",currency:"валют",staff:"сотрудников компании",ua_recipients:"получателей",beneficiaries:"бенефициаров",field__comments:"Назначение платежа",field__requisites:"Реквизиты",dubl_comments:"Такие реквизиты уже заданы",recipient_exists:"Такой корреспондент уже существует в справочнике",export_filter:"Записи на странице",export_all:"Все записи",several_accounts:"неск. счетов"},uk:!0,en:!0}),define("nls/uk/reference",{field_rcpt_bnk_name:"Найменування банку бенефіціара",field_rcpt_name:"Найменування бенефiцiара",field_intermed_bnk_name:"Найменування банку-посередника",field_intermed_bnk_bic:"Ідентифікаційний код банку-посередника",field_intermed_bnk_bic_type:"Тип ідентифікаційного коду банку-посередника",field_intermed_bnk_country_code:"Код країни банку-посередника",field_intermed_bnk_country:"Країна банку-посередника",field_intermed_bnk_city:"Місто банку-посередника",field_intermed_bnk_addr:"Адреса банку-посередника",field_rcpt_bnk_account:"Номер рахунку банку бенефіціара",field_rcpt_bnk_bic:"Идентификационный код банка бенефициара",field_rcpt_bnk_bic_type:"Тип ідентифікаційного коду банку бенефіціара",field_rcpt_bnk_country_code:"Код країни банку бенефіціара",field_rcpt_bnk_country:"Країна банку бенефіціара",field_rcpt_bnk_city:"Місто банку бенефіціара",field_rcpt_bnk_addr:"Адреса банку бенефіціара",field_rcpt_account:"Номер рахунку бенефiцiара",field_rcpt_country_code:"Код Країни бенефіціара",field_rcpt_country:"Країна бенефіціара",field_rcpt_city:"Місто бенефіціара",field_rcpt_addr:"Адреса бенефіціара",field_rcpt_bnk_iban:"IBAN-код банку бенефіціара",field_bill:"Рахунок отримувача",field_bic:"МФО банку отримувача",field_inn:"ЄДРПОУ отримувача",field_name:"Найменування отримувача",field_note:"Примітка",invalid_swift:"Банк з кодом SWIFT {1} в довіднику банків не виявлений",fetch_error:"Помилка при отриманні довідника {1}",import_result_successful:"Успішно імпортовано",import_result_failed:"Імпорт не виконано",import_result_partial:"Імпорт виконано частково",import_error:"Помилка під час імпорту довідника {1}",import_result_total_documents:"Оброблено записів довідника: ",import_result_success_documents:"Успішно імпортовано записів довідника: ",import_result_info:"імпортовано записів довідника {1} з {2}",error_title:"Помилка",swift:"SWIFT",ua_swift:"МФО",country:"країн",currency:"валют",staff:"працівників компанії",ua_recipients:"отримувачів",beneficiaries:"бенефіціарів",field__comments:"Призначення платежу",field__requisites:"Реквiзiти",dubl_comments:"Такі реквізити вже задані",recipient_exists:"Такий кореспондент вже існує у довіднику",export_filter:"Записи на сторінці",export_all:"Всі записи",several_accounts:"дек. рахунків"}),define("nls/en/reference",{field_rcpt_bnk_name:"Beneficiary's bank name",field_rcpt_name:"Beneficiary's name",field_intermed_bnk_name:"Intermediary bank name",field_intermed_bnk_bic:"Identification code of the intermediary bank",field_intermed_bnk_bic_type:"Type of the intermediary bank identification code",field_intermed_bnk_country_code:"Country code of intermediary bank",field_intermed_bnk_country:"Country of intermediary bank",field_intermed_bnk_city:"Intermediary bank city",field_intermed_bnk_addr:"Intermediary bank address",field_rcpt_bnk_account:"Beneficiary's bank account",field_rcpt_bnk_bic:"Identification code of the beneficiary's bank",field_rcpt_bnk_bic_type:"Type of beneficiary's bank identification code",field_rcpt_bnk_country_code:"Country code of beneficiary's bank",field_rcpt_bnk_country:"Country of beneficiary's bank",field_rcpt_bnk_city:"Beneficiary's bank city",field_rcpt_bnk_addr:"Beneficiary's bank address",field_rcpt_account:"Beneficiary's account",field_rcpt_country_code:"Country code of beneficiary",field_rcpt_country:"Beneficiary's country",field_rcpt_city:"Beneficiary's city",field_rcpt_addr:"Beneficiary's address",field_rcpt_bnk_iban:"Beneficiary's bank IBAN-code",field_bill:"Recipient's account",field_bic:"Recipient's bank MFO",field_inn:"Recipient's EDRPOU",field_name:"Recipient's name",field_note:"Note",invalid_swift:"Bank with SWIFT {1} not found in the banks directory",fetch_error:"Error while getting directory {1}",import_result_successful:"Successfully imported",import_result_failed:"Import is failed",import_result_partial:"Import is partly completed",import_error:"Directory import error {1}",import_result_total_documents:"Processed directory records: ",import_result_success_documents:"Successfully imported directory records: ",import_result_info:"imported directory records {1} of {2}",error_title:"Error",swift:"SWIFT",ua_swift:"МФО",country:"coutries",currency:"currencies",staff:"company employees",ua_recipients:"recipients",beneficiaries:"beneficiaries",field__comments:"Payment details",field__requisites:"Requisites",recipient_exists:"This correspondent already exists in the reference",dubl_comments:"Such requisites are already set",export_filter:"Records per page",export_all:"All records",several_accounts:"sev. accounts"}),define("models/reference",["underscore","backbone","bifit","models/base_model","i18n!nls/reference","i18n!nls/validation"],function(a,b,c,d,e,f){"use strict";return d.extend({nls:e,urlRoot:function(){return c.settings.server_addr+"/reference/"},rules:{ua_recipients:{name:{required:!0,minLength:3,maxLength:40},inn:{okpo:!0}},staff:{card_holder:{required:!0,minLength:1,maxLength:80},card_holder_inn:{required:!1,maxLength:14},sks_number:{required:!0,minLength:5,maxLength:16},card_currency:{required:!0,minLength:3,maxLength:3},resident_flag:{required:!0,minLength:1,maxLength:1},card_holder_tabn:{required:!1,maxLength:20},open_acc_date:{required:!1,maxLength:20}},staff_cards:{staff_id:{required:!0,minLength:1,maxLength:20},sks_number:{required:!1,maxLength:16},card_holder:{required:!0,minLength:1,maxLength:80},card_holder_inn:{required:!1,minLength:1,maxLength:14},card_currency:{required:!0,minLength:1,maxLength:3},card_holder_eng_name:{required:!0,maxLength:80},card_expiry_date:{required:!0},card_number:{required:!0,maxLength:16}},beneficiaries:{rcpt_bnk_name:{required:!0,minLength:3,maxLength:140},rcpt_name:{required:!0,minLength:3,maxLength:160},intermed_bnk_name:{required:!1,minLength:3,maxLength:140},intermed_bnk_bic:[{required:!1,maxLength:15},{fn:function(a,b,d){var g=d.intermed_bnk_bic_type,h=!1;if("SWIFT"===g&&a&&a.length>0){var i=d.intermed_bnk_bic_error;8!==a.length&&11!==a.length?h=f.invalid_field:i&&(h=c.sprintf(e.invalid_swift,a))}return h}}],intermed_bnk_bic_type:{required:!1,maxLength:8},intermed_bnk_country_code:{required:!1,maxLength:3},intermed_bnk_country:{required:!1,maxLength:40},intermed_bnk_city:{required:!1,maxLength:60},intermed_bnk_addr:{required:!1,maxLength:255},rcpt_bnk_account:{required:!1,maxLength:50},rcpt_bnk_bic:[{required:!1,maxLength:15},{fn:function(a,b,d){var g=d.rcpt_bnk_bic_type,h=!1;if("SWIFT"===g&&a&&a.length>0){var i=d.rcpt_bnk_bic_error;8!==a.length&&11!==a.length?h=f.invalid_field:i&&(h=c.sprintf(e.invalid_swift,a))}return h}}],rcpt_bnk_country_code:{required:!0,maxLength:3},rcpt_bnk_country:{required:!0,maxLength:40},rcpt_bnk_city:{required:!1,maxLength:60},rcpt_bnk_addr:{required:!1,maxLength:255},rcpt_account:[{maxLength:34},{fn:function(a,b,c){var d=a.trim(),e=c.rcpt_bnk_iban;return!e&&!d||e&&d?f.account_iban_error:void 0}}],rcpt_country_code:{required:!0,maxLength:3},rcpt_country:{required:!0,maxLength:40},rcpt_city:{required:!0,maxLength:60},rcpt_addr:{required:!0,maxLength:255},rcpt_bnk_iban:[{maxLength:35},{fn:function(a,b,c){var d=a.trim(),e=c.rcpt_account;return!d&&!e||d&&e?f.account_iban_error:void 0}}]},budget_codes_ref:{name:{required:!0,maxLength:255}}},formattedFields:{deposit_accounts:{amount:function(){return this._amountFormatter(this.get("amount"),this.get("deposit_currency"))},amount_uah:function(){return this._amountFormatter(this.get("amount_uah"),2)},percent_amount:function(){return this._amountFormatter(this.get("percent_amount"),this.get("deposit_currency"))},percent_amount_uah:function(){return this._amountFormatter(this.get("percent_amount_uah"),2)},init_amount:function(){return this._amountFormatter(this.get("init_amount"),this.get("deposit_currency"))},init_amount_uah:function(){return this._amountFormatter(this.get("init_amount_uah"),2)},replenishment_amount:function(){return this._amountFormatter(this.get("replenishment_amount"),this.get("deposit_currency"))}}},swift:{bic:{required:!0,maxLength:11},name:{required:!0,maxLength:105},city:{required:!1,maxLength:40},address:{required:!1,maxLength:255}},ua_swift:{code:{required:!0,maxLength:6},name:{required:!0,maxLength:40}},crecipients:{name:{required:!0,minLength:3,maxLength:40},okpo:{maxLength:10,okpo:!0},account:{required:!0,minLength:5,maxLength:14,digits:!0,calcAcc:"bank_mfo"},bank_mfo:[{required:!0,length:6,digits:!0},{fn:function(a,b,c){var d,e=c.rcpt_bnk_name;return e?delete c.rcpt_bnk_name:d=f.mfo_not_found,d}}],address:{required:!0,minLength:3,maxLength:80},payment_details:{required:!0,maxLength:160}},defaults:{idd:null},idAttribute:"idd",relatively:{beneficiaries:{rcpt_account:function(a,b){return b.get("rcpt_account")||b.get("rcpt_bnk_iban")}},deposit_accounts:{receiving_date:function(a){return c.str2date(a).getTime()},amount:function(a){return parseFloat(a)},rate:function(a){return parseFloat(a)},percent_amount:function(a){return parseFloat(a)},replenishment_amount:function(a){return parseFloat(a)}},deposit_rate_hist:{date_from:function(a){return c.str2date(a).getTime()},date_to:function(a){return c.str2date(a).getTime()}},credits:{credit_sum:function(a){return parseFloat(a)},credit_percent:function(a){return parseFloat(a)},receiving_date:function(a){return c.str2date(a).getTime()},compensate_date:function(a){return c.str2date(a).getTime()}},credit_indebtedness:{debt:function(a){return parseFloat(a)},overdue_debt:function(a){return parseFloat(a)},overdue_days:function(a){return parseInt(a)},debt_uah:function(a){return parseFloat(a)},overdue_debt_uah:function(a){return parseFloat(a)},debt_summary:function(a){return parseFloat(a)}},credit_rate_hist:{date_from:function(a){return c.str2date(a).getTime()},date_to:function(a){return c.str2date(a).getTime()},credit_percent:function(a){return parseFloat(a)}},credit_graph:{date_from:function(a){return c.str2date(a).getTime()},amount:function(a){return parseFloat(a)},max_amount:function(a){return parseFloat(a)},cont_num:function(a){return parseFloat(a)}},ua_swift:{code:function(a){return parseInt(a)}},crecipients:{okpo:function(a){return parseInt(a)},account:function(a){return parseInt(a)},bank_mfo:function(a){return parseInt(a)}},keys:{end_date:function(a){return c.str2date(a).getTime()},amount:function(a){return parseFloat(a)}},keys_history:{action_time:function(a){return c.str2dateTime(a)}},mkeys_history:{action_time:function(a){return c.str2dateTime(a)}},mkeys:{end_date:function(a){return c.str2date(a).getTime()}},limits:{amount:function(a){return parseFloat(a)},begin_date:function(a){return c.str2date(a).getTime()},end_date:function(a){return c.str2date(a).getTime()},total_amount:function(a){return parseFloat(a)}},sub_clients:{okpo:function(a){return parseInt(a)}},budget_item:{code:function(a){return parseFloat(a)},sum_limit:function(a){return parseFloat(a)},item_begin_date:function(a){return c.str2date(a).getTime()},item_end_date:function(a){return c.str2date(a).getTime()},on_processing:function(a){return parseFloat(a)},executed:function(a){return parseFloat(a)},rest:function(a){return parseFloat(a)},percent_of_execution:function(a){return parseFloat(a)}},staff:{open_acc_date:function(a){return c.str2date(a).getTime()}}},initialize:function(a){d.prototype.initialize.call(this),this.type=a.refType},enableValidation:function(){this.validation=this.rules[this.type]},compareTo:function(b,c){if(!c||!this.get(c))return-1;var d=this.get(c)||"",e=b.get(c)||"",f=(this.relatively[this.type]||{})[c]||a.identity;return d=f(d,this),e=f(e,b),"string"==typeof d?d.localeCompare(e):d===e?0:e>d?-1:1},parse:function(b){if("ua_recipients"===b.refType){var c=b.requisites,d=a.groupBy(c,"bill");b.bill=a.keys(d).length>1?e.several_accounts:c[0].bill}return b}})}),define("collections/thesaurus",["jquery","underscore","app","backbone","models/reference","i18n!nls/reference","bifit","dialogUtils"],function(a,b,c,d,e,f,g,h){
"use strict";var i=d.Collection.extend({model:e,id:"",initialize:function(a,b){this.id=b.id},url:function(){return g.settings.server_addr+"/reference/"+this.id+";jsessionid="+g.getStoredItem("JSESSIONID")}}),j=d.Collection.extend({referenceType:null,initialize:function(a,b){this.referenceType=b.type},url:function(){return g.settings.server_addr+"/reference/"+this.referenceType+";jsessionid="+g.getStoredItem("JSESSIONID")}}),k=function(b,c,d,e){var i=a.Deferred(),k=new j(null,{type:b}),l={data:d,error:function(){var a=g.sprintf(f.fetch_error,f[b]||b);e?e(a):h.alert(a),i.reject(a)},success:function(a){var b=a.toJSON();i.resolve(b)}};return c&&(l.emulateClientRequest=c.emulateClientRequest,l.currentSubClientKeyId=c.currentSubClientKeyId),k.fetch(l),i.promise()},l=["ua_swift","swift","ru_swift","ibank2id"],m={},n={};return n.loadStdThesaurus=function(a,b,c){return k(a,null,b,c)},n.loadClientThesaurus=function(a,b,d){return c.checkIsNotMultiClient(),k(a,null,b,d)},n.loadMultiClientThesaurus=function(a,b,d){return c.checkIsMultiClient(),k(a,null,b,d)},n.loadSubClientThesaurus=function(a,b,d,e){return c.checkIsMultiClient(),k(a,{emulateClientRequest:!0,currentSubClientKeyId:b},d,e)},n.getThesaurus=function(b,c){var d={loaded:!1,array:[],fetch:function(){}},e=m[b];if(c=void 0===c,e&&c)d.array=e.slice(0),d.loaded=!0,d.fetch=function(){return a.Deferred().resolve(d.array)};else{var j=new i({},{id:b});d.fetch=function(i){var k=a.Deferred();if(i=i||{},c&&l.indexOf(b)>=0&&i.data&&i.data.query&&(e=m[b+"."+i.data.query]),e&&c)d.array=e.slice(0),d.loaded=!0,k.resolve(d.array);else{var n=i.error;i.error=function(){var a=g.sprintf(f.fetch_error,f[b]||b);n?n(a):h.alert(a),k.reject()}.bind(this),i.success=function(a){var c=a.toJSON();l.indexOf(b)<0?m[b]=c:i.data&&i.data.query&&(m[b+"."+i.data.query]=c),d.array=c.slice(0),d.loaded=!0,k.resolve(d.array)},j.fetch(i)}return k}}return d},n.removeThesaurus=function(a){if(l.indexOf(a)<0)delete m[a];else for(var c in m)b.has(m,c)&&0===c.indexOf(a+".")&&n.removeThesaurus(c)},n.clear=function(){for(var a in m)b.has(m,a)&&n.removeThesaurus(a)},n.append=function(a){b.extend(m,a)},n}),function(a){"object"==typeof exports?module.exports=a(require("backbone"),require("underscore")):"function"==typeof define&&define.amd&&define("backboneValidation",["backbone","underscore"],a)}(function(a,b){return a.Validation=function(b){"use strict";var c={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},d={formatLabel:function(a,b){return j[c.labelFormatter](a,b)},format:function(){var a=Array.prototype.slice.call(arguments),b=a.shift();return b.replace(/\{(\d+)\}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:b})}},e=function(c,d,f){return d=d||{},f=f||"",b.each(c,function(b,g){c.hasOwnProperty(g)&&(b&&"object"==typeof b&&!(b instanceof Array||b instanceof Date||b instanceof RegExp||b instanceof a.Model||b instanceof a.Collection)?e(b,d,f+g+"."):d[f+g]=b)}),d},f=function(){var a=function(a){return b.reduce(b.keys(b.result(a,"validation")||{}),function(a,b){return a[b]=void 0,a},{})},f=function(a,c){var d=a.validation?b.result(a,"validation")[c]||{}:{};return(b.isFunction(d)||b.isString(d))&&(d={fn:d}),b.isArray(d)||(d=[d]),b.reduce(d,function(a,c){return b.each(b.without(b.keys(c),"msg"),function(b){a.push({fn:k[b],val:c[b],msg:c.msg})}),a},[])},h=function(a,c,e,g){return b.reduce(f(a,c),function(f,h){var i=b.extend({},d,k),j=h.fn.call(i,e,c,h.val,a,g);return j===!1||f===!1?!1:j&&!f?b.result(h,"msg")||j:f},"")},i=function(a,c){var d,f={},g=!0,i=b.clone(c),j=e(c);return b.each(j,function(b,c){d=h(a,c,b,i),d&&(f[c]=d,g=!1)}),{invalidAttrs:f,isValid:g}},j=function(c,d){return{preValidate:function(a,c){var d,e=this,f={};return b.isObject(a)?(b.each(a,function(a,b){d=e.preValidate(b,a),d&&(f[b]=d)}),b.isEmpty(f)?void 0:f):h(this,a,c,b.extend({},this.attributes))},isValid:function(a){var c=e(this.attributes);return b.isString(a)?!h(this,a,c[a],b.extend({},this.attributes)):b.isArray(a)?b.reduce(a,function(a,d){return a&&!h(this,d,c[d],b.extend({},this.attributes))},!0,this):(a===!0&&this.validate(),this.validation?this._isValid:!0)},validate:function(f,g){var h=this,j=!f,k=b.extend({},d,g),l=a(h),m=b.extend({},l,h.attributes,f),n=e(f||m),o=i(h,m);return h._isValid=o.isValid,b.each(l,function(a,b){var d=o.invalidAttrs.hasOwnProperty(b);d||k.valid(c,b,k.selector)}),b.each(l,function(a,b){var d=o.invalidAttrs.hasOwnProperty(b),e=n.hasOwnProperty(b);d&&(e||j)&&k.invalid(c,b,o.invalidAttrs[b],k.selector)}),b.defer(function(){h.trigger("validated",h._isValid,h,o.invalidAttrs),h.trigger("validated:"+(h._isValid?"valid":"invalid"),h,o.invalidAttrs)}),!k.forceUpdate&&b.intersection(b.keys(o.invalidAttrs),b.keys(n)).length>0?o.invalidAttrs:void 0}}},l=function(a,c,d){b.extend(c,j(a,d))},m=function(a){delete a.validate,delete a.preValidate,delete a.isValid},n=function(a){l(this.view,a,this.options)},o=function(a){m(a)};return{version:"0.9.1",configure:function(a){b.extend(c,a)},bind:function(a,d){d=b.extend({},c,g,d);var e=d.model||a.model,f=d.collection||a.collection;if("undefined"==typeof e&&"undefined"==typeof f)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";e?l(a,e,d):f&&(f.each(function(b){l(a,b,d)}),f.bind("add",n,{view:a,options:d}),f.bind("remove",o))},unbind:function(a,c){c=b.extend({},c);var d=c.model||a.model,e=c.collection||a.collection;d?m(d):e&&(e.each(function(a){m(a)}),e.unbind("add",n),e.unbind("remove",o))},mixin:j(null,c)}}(),g=f.callbacks={valid:function(a,b,c){a.$("["+c+'~="'+b+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(a,b,c,d){a.$("["+d+'~="'+b+'"]').addClass("invalid").attr("data-error",c)}},h=f.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},i=f.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",digits:"{0} must only contain digits",number:"{0} must be a number",email:"{0} must be a valid email",url:"{0} must be a valid url",inlinePattern:"{0} is invalid"},j=f.labelFormatters={none:function(a){return a},sentenceCase:function(a){return a.replace(/(?:^\w|[A-Z]|\b\w)/g,function(a,b){return 0===b?a.toUpperCase():" "+a.toLowerCase()}).replace(/_/g," ")},label:function(a,b){return b.labels&&b.labels[a]||j.sentenceCase(a,b)}},k=f.validators=function(){var a=String.prototype.trim?function(a){return null===a?"":String.prototype.trim.call(a)}:function(a){var b=/^\s+/,c=/\s+$/;return null===a?"":a.toString().replace(b,"").replace(c,"")},c=function(a){return b.isNumber(a)||b.isString(a)&&a.match(h.number)},d=function(c){return!(b.isNull(c)||b.isUndefined(c)||b.isString(c)&&""===a(c)||b.isArray(c)&&b.isEmpty(c))};return{fn:function(a,c,d,e,f){return b.isString(d)&&(d=e[d]),d.call(e,a,c,f)},required:function(a,c,e,f,g){var h=b.isFunction(e)?e.call(f,a,c,g):e;return h||d(a)?h&&!d(a)?this.format(i.required,this.formatLabel(c,f)):void 0:!1},acceptance:function(a,c,d,e){return"true"===a||b.isBoolean(a)&&a!==!1?void 0:this.format(i.acceptance,this.formatLabel(c,e))},min:function(a,b,d,e){return!c(a)||d>a?this.format(i.min,this.formatLabel(b,e),d):void 0},max:function(a,b,d,e){return!c(a)||a>d?this.format(i.max,this.formatLabel(b,e),d):void 0},range:function(a,b,d,e){return!c(a)||a<d[0]||a>d[1]?this.format(i.range,this.formatLabel(b,e),d[0],d[1]):void 0},length:function(a,c,d,e){return b.isString(a)&&a.length===d?void 0:this.format(i.length,this.formatLabel(c,e),d)},minLength:function(a,c,d,e){return!b.isString(a)||a.length<d?this.format(i.minLength,this.formatLabel(c,e),d):void 0},maxLength:function(a,c,d,e){return!b.isString(a)||a.length>d?this.format(i.maxLength,this.formatLabel(c,e),d):void 0},rangeLength:function(a,c,d,e){return!b.isString(a)||a.length<d[0]||a.length>d[1]?this.format(i.rangeLength,this.formatLabel(c,e),d[0],d[1]):void 0},oneOf:function(a,c,d,e){return b.include(d,a)?void 0:this.format(i.oneOf,this.formatLabel(c,e),d.join(", "))},equalTo:function(a,b,c,d,e){return a!==e[c]?this.format(i.equalTo,this.formatLabel(b,d),this.formatLabel(c,d)):void 0},pattern:function(a,b,c,e){return d(a)&&a.toString().match(h[c]||c)?void 0:this.format(i[c]||i.inlinePattern,this.formatLabel(b,e),c)}}}();return b.each(k,function(a,c){k[c]=b.bind(k[c],b.extend({},d,k))}),f}(b),a.Validation}),window.directive=function(){"use strict";function uniq(a){return a.filter(function(a,b,c){return-1===c.indexOf(a,b+1)})}function getScopeName(a){return"directive"+a.name.replace(/^./,function(a){return a.toUpperCase()})}function smartEval(value){try{value=eval("({"+value+"})")}catch(e){try{value=eval("("+value+")")}catch(e){}}return value}function execute(a){try{a()}catch(b){setTimeout(function(){throw b})}}function getAttributesObject(a){for(var b={},c=0;c<a.attributes.length;c++){var d=a.attributes[c];b[d.name]=smartEval(d.value)}return b}function directiveLoadedAction(a,b,c){var d=getScopeName(b);if(!a[d]){var e=a[d]={};b.onLoad&&execute(function(){b.onLoad.call(e,a,c)})}}function directiveAlteredAction(a,b,c){var d=getScopeName(b);a[d]&&b.onAlter&&execute(function(){b.onAlter.call(a[d],a,c)})}function directiveRemovedAction(a,b,c){var d=getScopeName(b);a[d]&&(b.onUnload&&execute(function(){b.onUnload.call(a[d],a,c)}),a[d]=void 0)}function classAdded(a,b){var c=directiveAliasList[b.toLowerCase()];c&&directiveLoadedAction(a,c,void 0)}function classRemoved(a,b){var c=directiveAliasList[b.toLowerCase()];c&&directiveRemovedAction(a,c,void 0)}function attributeAdded(a,b){var c=directiveAliasList[b.toLowerCase()];c&&directiveLoadedAction(a,c,smartEval(a.attributes[b].value))}function attributeRemoved(a,b){var c=directiveAliasList[b.toLowerCase()];c&&directiveRemovedAction(a,c,void 0)}function attributeChanged(a,b){var c=directiveAliasList[b.toLowerCase()];c&&directiveAlteredAction(a,c,smartEval(a.attributes[b].value))}function nodeAdded(a){var b=directiveAliasList[a.tagName.toLowerCase()];b&&(a.addEventListener("attributeChanged",function(){directiveAlteredAction(a,b,getAttributesObject(a))}),directiveLoadedAction(a,b,getAttributesObject(a)))}function nodeRemoved(a){var b=directiveAliasList[a.tagName.toLowerCase()];b&&directiveLoadedAction(a,b,getAttributesObject(a))}function nodeListAdded(a){var b,c;for(b=0;b<a.length;b++){var d=a[b];if(d.tagName&&nodeAdded(d),d.className){var e=d.className.split(" ").filter(function(a){return a.length});for(c=0;c<e.length;c++)classAdded(d,e[c])}if(d.attributes)for(c=0;c<d.attributes.length;c++)-1===ignoredAttributes.indexOf(d.attributes[c].name)&&attributeAdded(d,d.attributes[c].name)}for(b=0;b<a.length;b++){var d=a[b];for(b=0;b<a.length;b++)a[b].children&&nodeListAdded(a[b].children)}}function nodeListRemoved(a){var b,c;for(b=0;b<a.length;b++)a[b].children&&nodeListRemoved(a[b].children);for(b=0;b<a.length;b++){var d=a[b];if(d.tagName&&nodeRemoved(d),d.className){var e=d.className.split(" ").filter(function(a){return a.length});for(c=0;c<e.length;c++)classRemoved(d,e[c])}if(d.attributes)for(c=0;c<d.attributes.length;c++)-1===ignoredAttributes.indexOf(d.attributes[c].name)&&attributeRemoved(d,d.attributes[c].name)}}function classMutated(a){var b=uniq((a.oldValue||"").split(" ").filter(function(a){return a.length})),c=uniq((a.target.className||"").split(" ").filter(function(a){return a.length})),d={removedList:b.filter(function(a){return-1===c.indexOf(a)}),addedList:c.filter(function(a){return-1===b.indexOf(a)})};d.removedList.forEach(function(b){classRemoved(a.target,b)}),d.addedList.forEach(function(b){classAdded(a.target,b)})}function attributeMutated(a){-1===ignoredAttributes.indexOf(a.attributeName)&&(null===a.oldValue?attributeAdded(a.target,a.attributeName):a.target.attributes[a.attributeName]?attributeChanged(a.target,a.attributeName):attributeRemoved(a.target,a.attributeName))}function mutationRecordProcessor(a){switch(a.type){case"childList":nodeListAdded(a.addedNodes),nodeListRemoved(a.removedNodes);break;case"attributes":"class"===a.attributeName?classMutated(a):attributeMutated(a)}}var ignoredAttributes=["id","href","style","class","src"],prefixList=["data-","directive-",""],directiveAliasList={},directives={},oberverLaunched=!1;!function(a){"complete"===document.readyState?a():document.load=a()}(function(){var a;try{a=MutationObserver}catch(b){a=WebKitMutationObserver}new a(function(a){for(var b=0;b<a.length;b++)mutationRecordProcessor(a[b])}).observe(document.body,{childList:!0,attributes:!0,subtree:!0,attributeOldValue:!0}),nodeListAdded([document.body]),oberverLaunched=!0});var spaceRegex=/\s/;return function(a,b){if("string"!=typeof a||spaceRegex.test(a))throw new TypeError("Directive name should be a string without spaces");if(a=a.toLowerCase(),"function"==typeof b&&(b={load:b}),"[object Object]"!==b.toString())throw new TypeError("Directive config should be an common object");var c={name:a,onLoad:b.load||b.alter,onUnload:b.unload,onAlter:b.alter},d=prefixList.map(function(b){return b+a});return d.forEach(function(a){directiveAliasList[a]=c}),directives[a]=c,oberverLaunched&&(d.forEach(function(a){for(var b=document.body.querySelectorAll("."+a)||[],c=0;c<b.length;c++){var d=b[c];classAdded(d,a)}}),d.forEach(function(a){for(var b=document.body.querySelectorAll("["+a+"]")||[],c=0;c<b.length;c++){var d=b[c];attributeAdded(d,a)}}),d.forEach(function(a){for(var b=document.body.querySelectorAll(a)||[],c=0;c<b.length;c++){var d=b[c];nodeAdded(d)}})),a}.bind(this)}.call(window),define("libs/corner",function(){}),requirejs.config({baseUrl:"./js",paths:{jquery:"vendor/jquery/jquery",underscore:"vendor/underscore/underscore",marionette:"vendor/backbone.marionette/backbone.marionette","backbone.wreqr":"vendor/backbone.wreqr/backbone.wreqr","backbone.babysitter":"vendor/backbone.babysitter/backbone.babysitter",backbone:"vendor/backbone/backbone",backboneValidation:"vendor/backbone-validation/backbone-validation-amd","backbone.picky":"vendor/backbone.picky/backbone.picky",styles:"vendor/require-css/css","css-builder":"vendor/require-css/css-builder",normalize:"vendor/require-css/normalize",rivets:"vendor/rivets/rivets",sightglass:"vendor/sightglass/index",actionUtils:"libs/action_utils",backboneBifit:"libs/backbone_extends",base64:"libs/base64",canvasPrinter:"libs/canvas_printer",carousel:"libs/carousel",charsets:"libs/charsets",chosen:"libs/chosen",converterUtils:"libs/converter_utils",corner:"libs/corner",dialogUtils:"libs/dialog_utils",directives:"libs/directives",errorStorage:"libs/error_storage",formatter:"libs/formatter",gost34311:"libs/gost34.311",i18n:"libs/i18n",ladda:"libs/ladda",mdConverter:"libs/mdConverter",printUtils:"libs/print_utils",spinner:"libs/spin",text:"libs/text",thesaurusUtils:"libs/thesaurus_utils",bifit:"libs/utils",customConstants:"custom_constants",templates:"../templates",css:"../css"},shim:{underscore:{exports:"_"},backbone:{deps:["underscore","jquery"],exports:"Backbone"},backboneValidation:{deps:["backbone"]},carousel:{deps:["jquery"]},gost34311:{exports:"Gost34311"},chosen:{deps:["spinner"]},spinner:{exports:"Spinner"},ladda:{deps:["spinner"],exports:"Ladda"}}}),require([],function(){"use strict";requirejs.config({config:{baseUrl:(isCommonFirmware?localStorage.getItem("client_version")+"/":"")+"js/",i18n:{locale:localStorage.getItem("locale")||"uk"}}})}),require(["jquery","underscore","bifit","dialogUtils","collections/thesaurus","backbone","backboneValidation","libs/corner"],function(a,b,c,d,e,f){"use strict";function g(b){switch(a("#install-plugin-container, #without-plugin-ie, #without-plugin, #without-extension").addClass("hidden"),b){case SignPluginServices.ACTUAL_VERSION:case SignPluginServices.CAN_BE_UPDATED:a("div#select-action-container").removeClass("hidden");break;case SignPluginServices.NOT_INSTALLED:case SignPluginServices.NEED_TO_UPDATE:"Explorer"===BrowserDetect.browser?a("#install-plugin-container, #without-plugin-ie").removeClass("hidden"):a("#install-plugin-container, #without-plugin").removeClass("hidden");break;case SignPluginServices.NOT_INSTALLED_EXT:a("#install-plugin-container, #without-extension").removeClass("hidden")}}directive("scrollbox",function(a){var b=document.createElement("div");for(b.className="content",a.offsetWidth?b.style.width=a.offsetWidth+"px":b.style.width="100%",b.style.position="absolute";a.childNodes.length>0;)b.appendChild(a.childNodes[0]);a.appendChild(b);var c=document.createElement("div");c.className="scrollbar",a.appendChild(c);var d=0,e=function(e){var f=b.offsetHeight,g=a.clientHeight,h=g*Math.min(g/f,1);d-=e,d=Math.max(0,d),d=Math.min(f-g,d),b.style.top=Math.min(0,-d)+"px",c.style.height=h+"px",c.style.top=g*(d/f)+"px",c.style.display=g>=f?"none":"block"},f=function(a){a.preventDefault();var b=a.originalEvent||a,c=b.wheelDelta||-b.detail;return c=0>c?Math.max(c,-3):Math.min(c,3),e(6*c),!1};a.addEventListener("mousewheel",f),a.addEventListener("DOMMouseScroll",f),a.addEventListener("DOMAttrModified",function(){e(0)});var g=window.innerWidth||document.documentElement.offsetWidth;window.addEventListener("resize",function(){var a=window.innerWidth||document.documentElement.offsetWidth;e(a-g),g=a}),c.addEventListener("mousedown",function(c){var d=function(c){var d=b.offsetHeight,f=a.clientHeight,h=g-c.screenY,i=h/f;e(d*i),g=c.screenY},f=function(){a.style.webkitUserSelect=a.style.mozUserSelect=a.style.msUserSelect="",document.body.style.cursor="",window.removeEventListener("mousemove",d),window.removeEventListener("blur",f),window.removeEventListener("mouseup",f)};a.style.webkitUserSelect=a.style.mozUserSelect=a.style.msUserSelect="none",document.body.style.setProperty("cursor","pointer","important");var g=c.screenY;window.addEventListener("mousemove",d,!1),window.addEventListener("blur",f),window.addEventListener("mouseup",f)},!1),e(0)});var h={ru:"ru-RU",uk:"uk-UA",en:"en-US"},i=f.Router.extend({routes:{"":"start",":type":"proceed",":type/:param":"proceed"},initialize:function(){f.history.start({hashChange:!0})},start:function(){SignPluginServices.checkPlugin().done(function(b){a("section.main").show(),g(b)}).fail(function(){a("section.main").show(),setTimeout(function b(){SignPluginServices.checkPlugin().always(function(a){a!==SignPluginServices.ACTUAL_VERSION&&a!==SignPluginServices.CAN_BE_UPDATED&&(a===SignPluginServices.NEED_TO_UPDATE&&window.postMessage({sender:"websigner.plugin.js",disconnect:!0},"*"),setTimeout(b,500)),g(a)})},500)})},proceed:function(b,c){function d(){b="admin_key"===b?b:"new_"+b,require(["registry/"+b],function(b){a(".locales").hide(),SignPluginServices.openSession().then(function(){SignPluginServices.startScanner().then(function(){a("#content").html(new b({param:c}).render().el),a("section.main").show(),document.body.className+=" full"})})})}SignPluginServices.checkPlugin().then(function(){d()}).fail(function(){a("section.main").show(),setTimeout(function b(){SignPluginServices.checkPlugin().always(function(a){a===SignPluginServices.ACTUAL_VERSION||a===SignPluginServices.CAN_BE_UPDATED?d():(a===SignPluginServices.NEED_TO_UPDATE&&window.postMessage({sender:"websigner.plugin.js",disconnect:!0},"*"),setTimeout(b,500),g(a))})},500)})}});new i,a.ajaxSetup({beforeSend:function(a){a.setRequestHeader("Accept-Language",h[c.getLocale()]),c.getStoredItem("CSRF_TOKEN")&&a.setRequestHeader("X-CSRF-TOKEN",c.getStoredItem("CSRF_TOKEN"))},timeout:5e3,crossDomain:!0});var j=function(){e.clear(),window.location="/"};a(document).ajaxError(function(a,b){401===b.status&&j()})}),define("registry/main",function(){}),define("nls/registration",{root:{new_client_registration:"Регистрация нового клиента",my_key_is_active:"мой ключ активен, но срок его действия заканчивается",organization:"Организация",egrpou:"ЕГРПОУ",name:"Наименование на украинском языке",address:"Адрес на украинском языке",eng_name:"Наименование на английском языке",phone:"Телефон",block_word:"Блокировочное слово",for_voice_client_authentication:"для голосового подтверждения<br/>подлинности клиента",account_in_bank:"Счет в банке",key_owner:"Владелец ключа",position:"Должность в организации",email_cln:"E-mail",fax_cln:"Факс",eng_address:"Адрес на английском языке",sign_count:"Количество групп подписей под документами",allow_personal_data:"Я разрешаю обработку моих персональных данных",create_ecp_key:"Создать ключ ЭЦП","delete":"Удалить",not_necessarily:"необязательно",phone_code:"+380",mfo:"МФО",nomination:"Наименование",account:"Счет",currency:"Валюта",fio:"ФИО",fio_cln:"Ответственное лицо",registration_successful:"Регистрация успешно завершена. Для окончательной регистрации обратитесь в отделение Вашего банка.",dubl_accounts:"Данный счет уже присутствует в списке",new_key_registration:"Создание ключа ЭЦП",select_bank:"Банк",net_error:"Ошибка подключения к банковскому серверу",multiplyErrors:"Регистрация не может быть завершена, потому что заполнены не все обязательные поля. Проверьте информацию в полях, отмеченных красным цветом.",tooLongFio:"Длина фамилии, имени или отчества не должна превышать 50 символов.",registration_over_header:"Предварительная регистрация успешно завершена!",registration_over_message:"Для окончательной регистрации необходимо обратиться в отделение банка с распечатанным и заверенным сертификатом открытого ключа ЭЦП.",distance_change_key_over:"Процесс дистанционной замены ключа завершен. Для продолжения работы Вам необходимо повторно войти в систему с новым ключом.",creation_key_for_employee:"Создание ключа для сотрудника:",mfo_not_found:"Банк с указанным МФО отсутствует в справочнике банков",key_storage:"Хранилище ключа",key_storage_new:"Хранилище для нового ключа",choosing_current_key:"Шаг 1. Выбор текущего ключа",creating_new_key:"Шаг 2. Создание нового ключа",key_storage_label:"Файл с ключами ЭЦП",key_password:"Пароль",key_name_new:"Наименование для нового ключа",select:"Выбрать",admin_keys:"Управление ключами ЭЦП",storage_type:"Тип хранилища",file_storage:"Файл на диске",device_storage:"Аппаратное устройство",key_id:"ID ключа",key_status:"Статус",key_name:"Наименование ключа",print_key:"Печать",change_password:"Сменить пароль",change_alias:"Переименовать",remove_key:"Удалить",new_password:"Новый пароль",new_alias:"Новое наименование ключа",show_password:"Показать пароль",change:"Изменить",password_changing:"Изменение пароля",alias_changing:"Переименование ключа",save:"Сохранить",cancel:"Отмена",key_removing:"Удаление ключа из хранилища",remove_key_question:"Вы действительно хотите удалить ключ с ID {1} из хранилища?",yes:"Да",no:"Нет",next:"Далее",update:"Обновить",device_key_storage:"Хранилище ключей",device_password:"Пароль к устройству",password_min_length_error:"Минимальная длина пароля 6 символов",unlock_code_min_length_error:"Минимальная длина кода разблокировки 8 символов",device_name_min_length_error:"Минимальная длина наименования устройства 1 символ",initialize_device:"Инициализировать",initialize_error_1:"Перед использованием устройство необходимо проинициализировать. Вы можете сделать это сейчас или выбрать другое хранилище.",initialize_error_2:'Выбранный токен перед использованием необходимо проинициализировать. Вы можете сделать это при регистрации нового клиента или создании ключа ЭЦП без отметки "мой ключ активен, но срок его действия заканчивается".',device_initializing:"Инициализация устройства",initialize:"Инициализировать",password:"Пароль",unlock_code:"Код разблокировки",show_unlock_code:"Показать код разблокировки",device_name:"Имя устройства",pin_is_blocked_1:"Устройство заблокировано в результате неверного ввода пароля. Выберите другое хранилище.",pin_is_blocked_2:"Устройство заблокировано в результате неверного ввода пароля. Вы можете разблокировать устройство или выбрать другое хранилище.",puk_is_blocked:"Устройство заблокировано или возникла непредвиденная ошибка. Обратитесь в банк.",invalid_key_alias:"Данное имя уже присвоено другому ключу на выбранном хранилище. Не допускается использование одинаковых имен ключей.",password_too_simple:"Пароль слишком простой",unlock:"Разблокировать",device_unlocking:"Разблокировка токена",no_keys_error:"На выбранном устройстве не обнаружено ни одной пары ключей ЭЦП.","new":"Новый",current:"Текущий",confirm_key_replacement:'Вы действительно желаете сгенерировать новый ключ на USB-токене? Эти действия приведут к утере ключа с ID "{1}", который хранится в токене.',confirm_key_replacement_2:'Ключ с наименованием <strong>"{1}"</strong> уже присутствует в хранилище. Сохранить поверх него?',invalid_length_key_name:"Для выбранного устройства наименование не должно превышать 20 символов",unlock_code_error:"Неверный код розблокировки. Осталось попыток до блокирования устройства: ",nameless:"Безымянный",save_file_dialog_title:"Откройте хранилище ключей",back:"Назад",usb_token:"USB-токен",password_re_entering_error:"Ошибка при повторном вводе пароля",key_password_repeat:"Пароль еще раз",warning_message:'Внимание! Перед нажатием кнопки "Создать ключ ЭЦП" проверьте корректность введенных данных. Создание ключа ЭЦП является завершающим этапом регистрации, после чего все введенные данные будут отправлены в банк без возможности изменения.',empty_field:"Поле обязательно для заполнения. Проверьте информацию в полях, отмеченных красным.",start_typing_key:"Начинайте вводить наименование ключа"},uk:!0,en:!0}),define("nls/uk/registration",{new_client_registration:"Реєстрація нового клієнта",my_key_is_active:"мій ключ активний, але термін його дії завершується",organization:"Організація",egrpou:"ЄДРПОУ",name:"Найменування українською мовою",address:"Адреса українською мовою",eng_name:"Найменування англійською мовою",phone:"Телефон",block_word:"Блокувальне слово",for_voice_client_authentication:"для голосового підтвердження<br/>автентичності клієнта",account_in_bank:"Рахунок у банку",key_owner:"Власник ключа",position:"Посада в організації",email_cln:"E-mail",fax_cln:"Факс",eng_address:"Адреса англійською мовою",sign_count:"Кількість груп підписів під документами",allow_personal_data:"Я дозволяю обробку моїх персональних даних",create_ecp_key:"Створити ключ ЕЦП","delete":"Видалити",not_necessarily:"не обов'язково",phone_code:"+380",mfo:"МФО",nomination:"Найменування",account:"Рахунок",currency:"Валюта",fio:"ПІБ",fio_cln:"Відповідальна особа",registration_successful:"Реєстрація успішно завершена. Для остаточної реєстрації зверніться до відділення Вашого банку.",dubl_accounts:"Такий рахунок вже існує у списку",new_key_registration:"Створення ключа ЕЦП",select_bank:"Банк",net_error:"Помилка підключення до банківського сервера",multiplyErrors:"Реєстрація не може бути завершена, оскільки заповнені не всі обов'язкові поля. Перевірте інформацію в полях, відмічених червоним кольором.",tooLongFio:"Довжина прізвища, імені чи по-батькові не має бути більше ніж 50 символів.",registration_over_header:"Попередня реєстрація успішно завершена!",registration_over_message:"Для здійснення остаточної реєстрації необхідно звернутися до відділення банку з роздрукованим та завіреним сертифікатом відкритого ключа ЕЦП.",distance_change_key_over:"Процес дистанційної заміни ключа завершено. Для продовження роботи Вам необхідно повторно увійти в систему з новим ключем.",creation_key_for_employee:"Створення ключа для співробітника:",mfo_not_found:"Банк з зазначенним МФО відсутній у довіднику банків",key_storage:"Сховище ключа",key_storage_new:"Сховище для нового ключа",choosing_current_key:"Крок 1. Вибір поточного ключа",creating_new_key:"Крок 2. Створення нового ключа",key_storage_label:"Файл з ключами ЕЦП",key_password:"Пароль",key_name_new:"Найменування для нового ключа",select:"Вибрати",admin_keys:"Управління ключами ЕЦП",storage_type:"Тип сховища",file_storage:"Файл на диску",device_storage:"Апаратний пристрій",key_id:"ID ключа",key_status:"Статус",key_name:"Найменування ключа",print_key:"Друк",change_password:"Змінити пароль",change_alias:"Перейменувати",remove_key:"Видалити",new_password:"Новий пароль",new_alias:"Нове найменування ключа",show_password:"Показати пароль",change:"Змінити",password_changing:"Зміна паролю",alias_changing:"Перейменування ключа",save:"Зберегти",cancel:"Відмінити",key_removing:"Видалення ключа зі сховища",remove_key_question:"Ви дійсно бажаєте видалити ключ з ID {1} зі сховища?",yes:"Так",no:"Ні",next:"Далі",update:"Оновити",device_key_storage:"Сховище ключів",device_password:"Пароль до пристрою",password_min_length_error:"Мінімальна довжина пароля 6 символів",unlock_code_min_length_error:"Мінімальна довжина коду розблокування 8 символів",device_name_min_length_error:"Мінімальна довжина найменування пристрою 1 символ",initialize_device:"Ініціалізувати",initialize_error_1:"Перед використанням пристрій необхідно проініціалізувати. Ви можете зробити це зараз або обрати інше сховище.",initialize_error_2:'Обраний токен перед використанням необхідно проініціалізувати. Ви можете зробити це під час реєстрації нового клієнта або створення ключа ЕЦП без позначки "мій ключ активний, але термін його дії завершується".',device_initializing:"Ініціалізація пристрою",initialize:"Ініціалізувати",password:"Пароль",unlock_code:"Код розблокування",show_unlock_code:"Показати код розблокування",device_name:"Ім'я пристрою",pin_is_blocked_1:"Пристрій заблоковано внаслідок невірного вводу пароля. Оберіть інше сховище.",pin_is_blocked_2:"Пристрій заблоковано внаслідок невірного вводу пароля. Ви можете розблокувати пристрій або обрати інше сховище.",puk_is_blocked:"Пристрій заблоковано або виникла непередбачена помилка. Зверніться до банку.",invalid_key_alias:"Дане ім'я вже присвоєно іншому ключу на вибраному сховищі. Не допускається використання одинакових імен ключів.",
password_too_simple:"Пароль занадто простий",unlock:"Розблокувати",device_unlocking:"Розблокування токена",no_keys_error:"На вибраному пристрої не виявлено жодної пари ключів ЕЦП.","new":"Новий",current:"Поточний",confirm_key_replacement:'Ви дійсно бажаєте згенерувати новий ключ на USB-токені? Ці дії призведуть до втрати ключа з ID "{1}", який зберігається в токені.',confirm_key_replacement_2:'Ключ з найменуванням <strong>"{1}"</strong> вже присутнiй у сховищi. Зберегти поверх нього?',invalid_length_key_name:"Для обраного пристрою найменування не повинно перевищувати 20 символів",unlock_code_error:"Невірний код розблокування. Залишилося спроб до блокування пристрою: ",nameless:"Без назви",save_file_dialog_title:"Відкрийте сховище ключів",back:"Назад",usb_token:"USB-токен",password_re_entering_error:"Помилка при повторному введенні пароля",key_password_repeat:"Пароль ще раз",warning_message:'Увага! Перед тим, як натиснути кнопку "Створити ключ ЕЦП", перевірте коректність введених даних. Створення ключа ЕЦП є завершальним етапом реєстрації, після чого всі введені дані будуть відправлені в банк без можливості зміни.',empty_field:"Поле обов'язкове до заповнення. Перевірте інформацію в полях, відмічених червоним.",start_typing_key:"Починайте вводити найменування ключа"}),define("nls/en/registration",{new_client_registration:"New client registration",my_key_is_active:"my key is active, but it will expire soon",organization:"Organization",egrpou:"EDRPOU",name:"Name in Ukrainian",address:"Address in Ukrainian",eng_name:"Name in English",phone:"Phone",block_word:"Lock word",for_voice_client_authentication:"for voice confirmation <br/> of the client authenticity",account_in_bank:"Account in bank",key_owner:"Key owner",position:"Position in the organization",email_cln:"E-mail",fax_cln:"Fax",eng_address:"Address in English",sign_count:"Number of signature groups on documents",allow_personal_data:"I give the permit for my personal data processing",create_ecp_key:"Create EDS key","delete":"Delete",not_necessarily:"optional",phone_code:"+380",mfo:"MFO",nomination:"Name",account:"Account",currency:"Currency",fio:"Full name",fio_cln:"Contact person",registration_successful:"Registration is successfully completed. For final registration you need contact the bank office.",dubl_accounts:"This account already in the list",new_key_registration:"EDS key creation",select_bank:"Bank",net_error:"Failed to connect to bank server",multiplyErrors:"Registration can not be completed because the required fields are empty. Check the information in the fields marked in red.",tooLongFio:"Length of surname, first or last name should not be more than 50 characters.",registration_over_header:"Pre-registration is successfully completed!",registration_over_message:"For final registration you have to provide to the bank office with a printed and certified public EDS key Certificate.",distance_change_key_over:"The remote replacement process of key is completed. To continue you need to log in again with a new key.",creation_key_for_employee:"Creation of key for employee:",mfo_not_found:"Bank with indicated MFO isn't present in the banks directory",key_storage:"Key storage",key_storage_new:"Storage for new key",choosing_current_key:"Step 1. Selecting current key",creating_new_key:"Step 2. Creating a new key",key_storage_label:"File with EDS keys",key_password:"Password",key_name_new:"New key name",select:"Select",admin_keys:"EDS key management",storage_type:"Storage type",file_storage:"File storage",device_storage:"Hardware device",key_id:"Key ID",key_status:"Status",key_name:"Key name",print_key:"Print",change_password:"Change password",change_alias:"Rename",remove_key:"Delete",new_password:"New password",new_alias:"New key name",show_password:"Show password",change:"Change",password_changing:"Change password",alias_changing:"Rename key",save:"Save",cancel:"Cancel",key_removing:"Deleting of key from the storage",remove_key_question:"Are you sure you want to delete the key with ID {1} from the storage?",yes:"Yes",no:"No",next:"Next",update:"Update",device_key_storage:"Keys storage",device_password:"Device password",password_min_length_error:"Minimum password length is 6 characters",unlock_code_min_length_error:"Minimum length of unlock code is 8 characters",device_name_min_length_error:"Minimum length of device name is 1 character",initialize_device:"Initialize",initialize_error_1:"Before using the device, you must initialize it. You can do it now or choose another storage.",initialize_error_2:'Selected token should be initialized before using. You can do this at new client registration or EDS key creation without option "my key is active, but it will expire soon".',device_initializing:"Device initialization",initialize:"Initialize",password:"Password",unlock_code:"Unlock code",show_unlock_code:"Show unlock code",device_name:"Device name",pin_is_blocked_1:"Device is locked as a result of an incorrect password. Select another storage.",pin_is_blocked_2:"Device is locked as a result of an incorrect password. You can unlock the device or select another storage.",puk_is_blocked:"Device is locked or an unexpected error occurred. Contact your bank.",invalid_key_alias:"This name is already assigned to another key on selected storage. You can not use duplicate key names.",password_too_simple:"Password is too simple",unlock:"Unlock",device_unlocking:"Unlocking of token",no_keys_error:"There is no key pairs on the selected device.","new":"New",current:"Current",confirm_key_replacement:'Are you sure you want to generate a new key on USB-token? These actions will lead to the loss of key with ID "{1}", which is stored on the token.',confirm_key_replacement_2:'The key <strong>"{1}"</strong> already exists at the Key Store. Overwrite it?',invalid_length_key_name:"Name cannot exceed more then 20 characters for the selected device",unlock_code_error:"Unlock code is wrong. Before device blocking, you have attempts: ",nameless:"Unnamed",save_file_dialog_title:"Open a storage of keys",back:"Back",usb_token:"USB-token",password_re_entering_error:"Password re-entering error",key_password_repeat:"Re-enter password",warning_message:'Attention! Before clicking "Create EDS key" button, check the correctness of the entered information. Creating the EDS key is the final step of registration, after which all entered information will be sent to the bank without the possibility of change.',empty_field:"Required field. Check the information in the fields marked in red.",start_typing_key:"Start typing the key name"}),define("models/new_key",["jquery","underscore","backbone","bifit","models/base_model","i18n!nls/registration"],function(a,b,c,d,e,f){"use strict";var g=function(a){var b="";if(a&&localStorage.getItem("web.password.security_recommendation")){var c=new RegExp(localStorage.getItem("web.password.security_recommendation"));if(!c.test(a)){var d=localStorage.getItem("locale");d="uk"===d?"ua":d,b=localStorage.getItem("web.password.security_message_"+d)||f.password_too_simple}}else a&&a.length<6&&(b=f.password_min_length_error);return b};return e.extend({nls:f,validation:{key_owner_name:{required:!1,maxLength:90,fn:function(a){var c;return a&&b.each(a.split(" "),function(a){a.length>50&&(c=f.tooLongFio)}),c}},position:{required:!1,maxLength:160},system_id:{required:!0},key_name:{required:!0},key_password:{required:function(a,b,c){return"DEVICE"!==c.storage_type_id},fn:g},key_password_repeat:{required:function(a,b,c){return"DEVICE"!==c.storage_type_id},fn:function(a,b,c){return g(a)||(a!==c.key_password?f.password_re_entering_error:"")}}},_session:function(){return""}})}),define("registry/key_generator",["jquery","bifit","backbone","dialogUtils","i18n!nls/registration"],function(a,b,c,d,e){"use strict";return function(f,g,h){var i=function(){var j=f.get("key_name"),k=f.get("key_password"),l=f.get("storage_type_id"),m=f.get("key_storage"),n=f.get("key_registration_type")||"new";SignPluginServices.createNewKeyInStorage(l,m,j,k,n).then(function(a){if(!a||0===Object.keys(a).length)return void(h&&h());var c={pers_data_agreement:"1",subj_pub_key_info:b.bin2hex(Base64.decode(a.publ_key,!0)),message:b.bin2hex(Base64.decode(a.data,!0)),eds:b.bin2hex(Base64.decode(a.sign,!0)),creation_date:b.date2str(new Date),provider:a.provider};a.token_serial&&(c.token_serial=a.token_serial),a.dist_sign&&(c.dist_sign=b.bin2hex(Base64.decode(a.dist_sign,!0)),c.dist_data=b.bin2hex(Base64.decode(a.dist_data,!0)));var d=f.get("key_owner_name");if(d){var e=d.split(" ");e.length>0&&(c.last_name=e[0]),e.length>1&&(c.first_name=e[1]),e.length>2&&(c.middle_name=e[2])}f.set(c),g(f)}).fail(function(f){b.stopProcessButtons(),0===f.errorLevel&&6===f.errorCode&&d.confirm(b.sprintf(e.confirm_key_replacement_2,j),function(){b.processButton(b.createProcessButton(a("button#create_key")[0])),"FILE"===l?SignPluginServices.removeKeyFromFile(m,j).then(i,function(){SignPluginServices.forgetStorage()}):SignPluginServices.removeKeyFromSelectedStorage(j).then(i,function(){SignPluginServices.forgetStorage()})}),1===f.errorLevel&&28===f.errorCode&&(c.Validation.invalidField(this,"key_name",e.invalid_length_key_name),a("#key_name").addClass("error"))})};a.ajax({cache:!1,url:localStorage.getItem("bank_url")+"uweb/protected/auth"}).done(i).fail(function(){a("#net-error").html(prepareErrorMsg4Site()),b.stopProcessButtons()})}}),define("customConstants",[],function(){"use strict";return{PAYMENT_DETAILS_LENGTH:160,ACCOUNT_TYPES:["1","10"],NEED_SHOW_ACC_TYPE:!0,IS_AVAL:!0}}),define("text",["module"],function(a){"use strict";var b,c,d,e,f=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],g=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,h=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,i="undefined"!=typeof location&&location.href,j=i&&location.protocol&&location.protocol.replace(/\:/,""),k=i&&location.hostname,l=i&&(location.port||void 0),m={},n=a.config&&a.config()||{};return b={version:"2.0.7",strip:function(a){if(a){a=a.replace(g,"");var b=a.match(h);b&&(a=b[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:n.createXhr||function(){var a,b,c;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(b=0;3>b;b+=1){c=f[b];try{a=new ActiveXObject(c)}catch(d){}if(a){f=[c];break}}return a},parseName:function(a){var b,c,d,e=!1,f=a.indexOf("."),g=0===a.indexOf("./")||0===a.indexOf("../");return-1!==f&&(!g||f>1)?(b=a.substring(0,f),c=a.substring(f+1,a.length)):b=a,d=c||b,f=d.indexOf("!"),-1!==f&&(e="strip"===d.substring(f+1),d=d.substring(0,f),c?c=d:b=d),{moduleName:b,ext:c,strip:e}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,c,d,e){var f,g,h,i=b.xdRegExp.exec(a);return i?(f=i[2],g=i[3],g=g.split(":"),h=g[1],g=g[0],!(f&&f!==c||g&&g.toLowerCase()!==d.toLowerCase()||(h||g)&&h!==e)):!0},finishLoad:function(a,c,d,e){d=c?b.strip(d):d,n.isBuild&&(m[a]=d),e(d)},load:function(a,c,d,e){if(e.isBuild&&!e.inlineText)return void d();n.isBuild=e.isBuild;var f=b.parseName(a),g=f.moduleName+(f.ext?"."+f.ext:""),h=c.toUrl(g),m=n.useXhr||b.useXhr;!i||m(h,j,k,l)?b.get(h,function(c){b.finishLoad(a,f.strip,c,d)},function(a){d.error&&d.error(a)}):c([g],function(a){b.finishLoad(f.moduleName+"."+f.ext,f.strip,a,d)})},write:function(a,c,d,e){if(m.hasOwnProperty(c)){var f=b.jsEscape(m[c]);d.asModule(a+"!"+c,"define(function () { return '"+f+"';});\n")}},writeFile:function(a,c,d,e,f){var g=b.parseName(c),h=g.ext?"."+g.ext:"",i=g.moduleName+h,j=d.toUrl(g.moduleName+h)+".js";b.load(i,d,function(c){var d=function(a){return e(j,a)};d.asModule=function(a,b){return e.asModule(a,j,b)},b.write(a,i,d,f)},f)}},"node"===n.env||!n.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(c=require.nodeRequire("fs"),b.get=function(a,b,d){try{var e=c.readFileSync(a,"utf8");0===e.indexOf("\ufeff")&&(e=e.substring(1)),b(e)}catch(f){d(f)}}):"xhr"===n.env||!n.env&&b.createXhr()?b.get=function(a,c,d,e){var f,g=b.createXhr();if(g.open("GET",a,!0),e)for(f in e)e.hasOwnProperty(f)&&g.setRequestHeader(f.toLowerCase(),e[f]);n.onXhr&&n.onXhr(g,a),g.onreadystatechange=function(b){var e,f;4===g.readyState&&(e=g.status,e>399&&600>e?(f=new Error(a+" HTTP status: "+e),f.xhr=g,d(f)):c(g.responseText),n.onXhrComplete&&n.onXhrComplete(g,a))},g.send(null)}:"rhino"===n.env||!n.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?b.get=function(a,b){var c,d,e="utf-8",f=new java.io.File(a),g=java.lang.System.getProperty("line.separator"),h=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(f),e)),i="";try{for(c=new java.lang.StringBuffer,d=h.readLine(),d&&d.length()&&65279===d.charAt(0)&&(d=d.substring(1)),null!==d&&c.append(d);null!==(d=h.readLine());)c.append(g),c.append(d);i=String(c.toString())}finally{h.close()}b(i)}:("xpconnect"===n.env||!n.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(d=Components.classes,e=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),b.get=function(a,b){var c,f,g={},h=new FileUtils.File(a);try{c=d["@mozilla.org/network/file-input-stream;1"].createInstance(e.nsIFileInputStream),c.init(h,1,0,!1),f=d["@mozilla.org/intl/converter-input-stream;1"].createInstance(e.nsIConverterInputStream),f.init(c,"utf-8",c.available(),e.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),f.readString(c.available(),g),f.close(),c.close(),b(g.value)}catch(i){throw new Error((h&&h.path||"")+": "+i)}}),b}),define("text!templates/print/wrapper.tmpl",[],function(){return'<%\n    var pageWidth, pageWidthDecr, pageHeightDecr;\n    if (is_landscape_oriented) {\n        pageWidth = \'297mm\';\n        pageWidthDecr = \'296mm\';\n        pageHeightDecr = \'197mm\';\n    } else {\n        pageWidth = \'210mm\';\n        pageWidthDecr = \'209mm\';\n        pageHeightDecr = \'286mm\';\n    };\n%>\n<style>\n/* ------------------- ibank -------------------------*/\nhtml, body {\n    height: 100%;\n}\n\ndiv#actions-wrapper button.action.print.to-printer,\ndiv#actions-wrapper button.action.print.to-pdf {\n    position: relative;\n}\n\ndiv#actions-wrapper button.action.print.to-printer:disabled,\ndiv#actions-wrapper button.action.print.to-pdf:disabled {\n    padding: 0 2.7em 0 3.31em;\n}\n\ndiv#actions-wrapper button.action.print.to-printer span {\n    color: #ffffff;\n    font: inherit;\n}\n\nbutton.to-printer .spinner, button.to-pdf .spinner {\n    min-width: 1em;\n    right: 0.35em;\n}\n\nsection.main {\n    overflow-y: hidden;\n    min-height: 100%;\n    position: relative;\n}\n\narticle.main.loading {\n    position: absolute;\n}\n\narticle.main.loading div#doc-div,\narticle.main.loading div.doc-div.letter,\narticle.main div:not(.ready) div.doc-div.letter {\n    visibility: hidden;\n}\n\narticle.main div.ready div.doc-div.letter {\n    visibility: visible;\n}\n\nbody, section.main {\n    overflow-x: auto;\n}\n\nbody {\n    max-width: 100em;\n}\n\nh1 {\n    font-size: 2.25em;\n    font-weight: lighter;\n    margin-bottom: 1em;\n}\n\nsection.main, header.main {\n    border-right-width: 0.0625em;\n    border-right-style: solid;\n}\n\nheader.main, section.main, footer.main {\n    max-width: 1600px;\n    width: 100%;\n}\n\nheader.main {\n    display: flex;\n    align-items: flex-start;\n    border-bottom-width: 1px;\n    border-bottom-style: solid;\n    height: 5.25em;\n    position: fixed;\n    z-index: 999;\n    top: 0;\n    transform: translateZ(0);\n    will-change: transform;\n}\n /*С position: relative; не работает многостраничная печать.*/\n/*section.main {\n    position: relative;\n}*/\n\nsection.main aside#left {\n    height: 100%;\n    overflow: hidden;\n    position: fixed;\n    float: left;\n    width: 15.25em;\n    top: 0px;\n    transform: translateZ(0);\n    will-change: transform;\n    z-index: 100;\n}\n\nsection.main header.main div#actions-wrapper {\n    margin-left: 1.2em;\n}\n\naside#left div.menu {\n    height: 100%;\n    width: 100%;\n    display: block;\n}\n\ninput[type="checkbox"][checked=checked] + span.checkbox:after, input[type="checkbox"]:checked + span.checkbox:after {\n    content: "" !important;\n    display: inline-block;\n    height: 10px;\n    margin: 3px;\n    width: 10px;\n    z-index: 9;\n}\n\ninput[type="checkbox"], input[type="checkbox"] + span.checkbox {\n    display: inline-block;\n    height: 18px;\n    line-height: 18px;\n    vertical-align: text-top;\n    width: 18px;\n}\n\ninput[type=checkbox] + span.checkbox {\n    border-width: 1px;\n    border-style: solid;\n}\n\ninput[type=checkbox] {\n    opacity: 0;\n    position: absolute;\n    z-index: 50;\n}\n\nbutton {\n    border: 1px solid;\n    border-radius: 0.155em 0.155em 0.155em 0.155em;\n    display: inline-block;\n    font-family: \'Open Sans\',sans-serif;\n    font-size: 0.8125em;\n    font-weight: 500;\n    padding: 0.231em 0.615em;\n    text-align: center;\n    text-decoration: none;\n    text-transform: uppercase;\n}\n\nbutton:focus {\n    outline: none\n}\n\nbutton.primary:not(:disabled), button.primary:hover:not(:disabled) {\n    border-radius: 0.2em 0.2em 0.2em 0.2em;\n}\n\nsection.main header.main div#actions-wrapper button {\n    background-position: left center;\n    background-repeat: no-repeat;\n    font-family: "Open Sans",sans-serif;\n    font-size: 0.8125em;\n    font-weight: 600;\n    height: 3.539em;\n    padding: 0 1em 0 3.31em;\n}\n\nnav#tree {\n    padding-top: 7em !important;\n}\n\nheader.main, aside#left.exist {\n    box-shadow: 0 0 10px 1px rgba(168, 163, 163, 0.3);\n}\n\naside#left div.menu nav#tree {\n    height: 100%;\n}\n\n/* -------------------- wrapper ----------------------*/\nsection.doc-print {\n    background-color: #FAFAFA;\n    overflow-x: visible !important;\n}\n\nsection.doc-print article {\n    width: <%- pageWidth %>;\n    margin: 5.25em 17em 7em 17em;\n    text-align: left;\n}\n\nsection.doc-print div#doc-div, section.doc-print div.doc-div {\n    margin: 0 0 2em 0;\n    padding: 5mm 10mm 5mm 8mm;\n    background-color: #FFFFFF;\n    width: <%- pageWidthDecr %>;\n    min-height: <%- pageHeightDecr %>;\n    box-shadow: 0 0.077em 0.24em 0.005em #CCCCCC, inset 0 0.077em 0 0 rgba(255, 255, 255, 0.75);\n    border: 1px solid #D2D2D2;\n    border-radius: 0.155em 0.155em 0.155em 0.155em;\n    page-break-after: always;\n}\n\nsection.doc-print div[id^="doc-div-"] {\n    page-break-after: always;\n}\n\nsection.doc-print aside#left div.menu, section.doc-print aside#left div.menu ul li:not(:first-child) {\n    display: none;\n}\n\nsection.doc-print aside#left div.menu.exist {\n    display: block;\n}\n\nsection.doc-print aside#left div.menu ul li {\n    float: none;\n    padding: 0.5em 1em 0.5em 1.625em;\n}\n\nsection.doc-print aside#left div.menu ul li:not(:first-child) label {\n    display: block;\n    margin-left: 18px;\n}\n\nsection.doc-print aside#left div.menu ul li:not(:first-child) label input[type=\'checkbox\'],\nsection.doc-print aside#left div.menu ul li:not(:first-child) label input[type=\'checkbox\'] + span.checkbox {\n    margin-left:-22px;\n}\n\nsection.doc-print article div, section.doc-print div td, section.doc-print div th,\nsection.doc-print div span, section.doc-print div p, section.doc-print div h3 {\n    font-family: \'Times Roman\', \'Times New Roman\', Georgia, serif;\n    font-size: 10pt;\n    color: black;\n    word-wrap: break-word;\n    -ms-word-wrap: break-word;\n}\n\nsection.doc-print div#doc-div hr, section.doc-print div.doc-div hr {\n    border-top: dashed 1px;\n    margin: 5mm 0 5mm 0;\n}\n\nsection.doc-print header.main div#actions-wrapper ul:not(.popup) {\n    max-height: 5.25em;\n    overflow: visible;\n    float: left;\n}\n\nsection.doc-print header.main div#actions-wrapper li:not(.popup-li) {\n    display: none;\n    margin: 1.1875em 0.4375em 1.3125em;\n}\n\nsection.doc-print div.registry-item, section.doc-print table.details td {\n    word-wrap: break-word;\n    -ms-word-wrap: break-word;\n}\n\nsection.doc-print div.popup-wrapper {\n    position: relative;\n}\n\ndiv.popup-wrapper ul {\n    padding-bottom: 5px;\n}\n\ndiv.popup-wrapper ul.popup li.popup-li {\n    position: relative;\n    text-align: left;\n    font-size: 0.8125em;\n    width: 100%;\n    height: 25px;\n}\n\ndiv.popup-wrapper ul.popup li.popup-li a {\n    text-transform: none;\n    font-weight: normal;\n}\n\ndiv.popup-wrapper span.popup-arrow,\ndiv.popup-wrapper span.popup-arrow-border {\n    padding: 0;\n    height: auto;\n}\n\nsection.doc-print table {\n    position: relative;\n    left: 0;\n    top: 0;\n    z-index: 10;\n    width: 100%;\n    padding: 1mm;\n}\n\nsection.doc-print table.details {\n    table-layout: fixed;\n}\n\nsection.doc-print p {\n    margin-top: 10px;\n}\n\nsection.doc-print .centered, section.doc-print table.centered td {\n    text-align: center;\n}\n\nsection.doc-print .bordered, section.doc-print table.bordered td {\n    border: 1px solid black;\n}\n\nsection.doc-print .tbordered {\n    border-top: 1px solid black;\n}\n\nsection.doc-print .bbordered {\n    border-bottom: 1px solid black;\n}\n\nsection.doc-print .wbordered {\n    border-bottom: 1px solid #fafafa;\n    padding-right: 5px;\n}\n\nsection.doc-print .onright {\n    text-align: right;\n}\n\nsection.doc-print .onleft {\n    text-align: left;\n}\n\nsection.doc-print .onjustify {\n    text-align: justify;\n}\n\nsection.doc-print .padded,\nsection.doc-print table.padded td {\n    padding: 3px;\n}\n\nsection.doc-print .bold-text {\n    font-weight: bold;\n}\n\nsection.doc-print .bordered {\n    border: 1px solid black;\n}\n\nsection.doc-print .italic-text {\n    font-style: italic;\n}\n\nsection.doc-print .fleft {\n    float: left;\n}\n\nsection.doc-print .fright {\n    float: right;\n}\n\nsection.doc-print .hidden {\n    display: none;\n}\n\nsection.doc-print div:not([class="ua_payment"]) ~ .header {\n    font-size: larger;\n}\n\nsection.doc-print div:not([class="ua_payment"]) ~ .header {\n    font-size: inherit;\n}\n\nsection.doc-print table.bordered td {\n    border: 1px solid black;\n}\n\nsection.doc-print .print-info-table td {\n    padding: 1px;\n}\n\nsection.doc-print .doc-ident {\n    float: right;\n    padding: 0 10px\n}\n\nsection.doc-print #future-opers,\nsection.doc-print #opers {\n    font-size: smaller;\n}\n\nsection.doc-print div#reason {\n    text-decoration: underline;\n    text-align: justify;\n    word-wrap: break-word;\n}\n\nsection.doc-print .full-width {\n    width: 100%;\n}\n\nsection.doc-print table.serv-info-table {\n    margin-top: 3mm;\n    border-collapse: collapse;\n    border: 1px;\n    width: auto;\n    white-space: pre;\n}\n\nsection.doc-print div table.serv-info-table tr, section.doc-print div table.serv-info-table td {\n    font-family: Serif, \'Times New Roman\', serif;\n    font-size: 8pt;\n    font-weight: bolder;\n    padding: 0 1px;\n}\n\nsection.doc-print div.for-img {\n    position: relative;\n}\n\n.sign-subj-name {\n    display: none;\n}\nspan.checkbox {\n    margin-right: 3px;\n}\nbody table td {\n    padding: 5px !important;\n}\n.doc-ident {\n    margin: 1mm;\n}\n\ndiv#doc-div .print, div.doc-div .print {\n    height: 1050px;\n}\n\nsection.doc-print .canvas-print-container {\n    page-break-after: always;\n}\n\nsection.doc-print div#doc-div canvas, section.doc-print div.doc-div canvas {\n    border: 0.077em solid #D2D2D2;\n    border-radius: 0.155em 0.155em 0.155em 0.155em;\n    box-shadow: 0px 0.077em 0.24em 0.005em #CCC, 0px 0.077em 0px 0px rgba(255, 255, 255, 0.75) inset;\n    padding: 1.805em;\n    background-color: #FFFFFF;\n    width: 210mm;\n}\n\nsection.doc-print iframe.print-to-pdf {\n    width: 1px;\n    height: 1px;\n    border: none;\n}\n\n/*------------------- printer ------------------------*/\n@media print {\n    body {\n        overflow: visible;\n        height: <%- pageHeightDecr %> !important;\n        width: <%- pageWidthDecr %> !important;\n    }\n\n    section.doc-print div#doc-div canvas, section.doc-print div.doc-div canvas {\n        box-shadow: none;\n        border: none;\n        padding: 0;\n        border-radius: 0;\n    }\n\n    aside, header.main, footer, .empty {\n        display: none;\n    }\n\n    section.main {\n        border: none;\n    }\n\n    div#doc-div .view, div.doc-div .view {\n        display: none;\n    }\n\n    div#doc-div .print {\n        display: block;\n        transform: none;\n        -webkit-transform: none;\n        margin: 0 !important;\n        padding: 10mm !important;\n        width: 209mm;\n        height: 296mm;\n        page-break-after: always;\n    }\n\n    section.doc-print {\n        margin: 0 !important;\n        width: <%- pageWidth %>;\n    }\n\n    section.doc-print div#doc-div, section.doc-print div.doc-div {\n        position: relative !important;\n        width: <%- pageWidthDecr %>;\n        border: none;\n        left: 0;\n        top: 0;\n        margin: 0;\n        box-shadow: none;\n    }\n\n    section.doc-print article {\n        margin: 0 !important;\n        padding: 0 !important;\n    }\n\n    @page {\n        size: A4 <%- is_landscape_oriented ? \'landscape\': \'portrait\' %>;\n        margin: 0;\n        padding: 0 !important;\n        marks: none;\n    }\n\n    @-moz-document url-prefix() {\n        section.doc-print div#doc-div, section.doc-print div.doc-div {\n            width: <%- pageWidth %>;\n        }\n\n        div#doc-div .print, div.doc-div .print {\n            padding: 4mm !important;\n        }\n\n        @page {\n            margin: 0;\n        }\n    }\n}\n</style>\n\n<section class="doc-print main">\n    <header class="main">\n        <div class="logo-container">\n            <div class="logo-inner-container">\n                <a href="#/welcome" class="logo"></a>\n                <div class="bnk-name"><%- bnk_name %></div>\n            </div>\n        </div>\n        <div id="actions-wrapper">\n            <ul>\n                <% if (is_key_certificate) { %>\n                    <li style="display: list-item;">\n                        <% if (is_sertificate_security) { %>\n                            <button class="action print print-to-printer primary"><%- print %></button>\n                        <% } else { %>\n                            <button class="action print show-sub-menu primary" data-action="show-sub-menu">\n                                <%- print %>\n                            </button>\n                            <div class="popup-wrapper bottom sub-menu">\n                                <span class="popup-arrow"></span>\n                                <span class="popup-arrow-border"></span>\n                                <ul class="popup" style="white-space: nowrap">\n                                    <li class="popup-li"><a href="#" class="print-to-printer"><%- print %></a></li>\n                                    <li class="popup-li"><a href="#" class="print-to-pdf"><%- print_pdf %></a></li>\n                                </ul>\n                            </div>\n                        <% } %>\n                    </li>\n                    <li style="display: list-item;"><button class="action exit"><%- cancel %></button></li>\n                <% } else { %>\n                    <li style="display: list-item;"><button class="action print to-printer primary" data-spinner-size="33" data-spinner-color="#FFF" data-action="print"><span><%- print %></span></button></li>\n                    <li style="display: none;"><button class="action print to-pdf" data-action="print-pdf"><%- print_pdf %></button></li>\n                    <iframe class="print-to-pdf" name="print-to-pdf"/>\n                    <li style="display: list-item;"><button class="action exit"><%- cancel %></button></li>\n                <% } %>\n            </ul>\n        </div>\n    </header>\n    <aside id="left">\n        <div id=\'main-menu-list\' class="menu">\n            <nav id="tree" class="scrollbox">\n                <ul>\n                    <li><label><%- print_settings %></label></li>\n                    <li>\n                        <label for="two_copies">\n                            <input type="checkbox" id="two_copies" />\n                            <span class="checkbox"></span>\n                            <%- two_copies %>\n                        </label>\n                    </li>\n                    <li>\n                        <label for="bank_stamp">\n                            <input type="checkbox" id="bank_stamp" />\n                            <span class="checkbox"></span>\n                            <%- bank_stamp %>\n                        </label>\n                    </li>\n                    <li>\n                        <label for="service_info">\n                            <input type="checkbox" id="service_info" />\n                            <span class="checkbox"></span>\n                            <%- service_info %>\n                        </label>\n                    </li>\n                    <li>\n                        <label for="ecp_owner">\n                            <input type="checkbox" id="ecp_owner" />\n                            <span class="checkbox"></span>\n                            <%- ecp_owner %>\n                        </label>\n                    </li>\n                    <li>\n                        <label for="attachments_info">\n                            <input type="checkbox" id="attachments_info" />\n                            <span class="checkbox"></span>\n                            <%- attachments_info %>\n                        </label>\n                    </li>\n                    <li>\n                        <label for="bank_stamp_each_page">\n                            <input type="checkbox" id="bank_stamp_each_page" />\n                            <span class="checkbox"></span>\n                            <%- bank_stamp_each_page %>\n                        </label>\n                    </li>\n                    <li>\n                        <label for="bank_stamp_last_page">\n                            <input type="checkbox" id="bank_stamp_last_page" />\n                            <span class="checkbox"></span>\n                            <%- bank_stamp_last_page %>\n                        </label>\n                    </li>\n                </ul>\n            </nav>\n        </div>\n    </aside>\n    <article class="main">\n\n        <h1 class="empty">\n            <% if (typeof docHeader !== "undefined" && docHeader) { %>\n                <%- docHeader %>\n            <% } else { %>\n                <%- document_print %>\n            <% } %>\n        </h1>\n\n        <div id="doc-div"></div>\n    </article>\n</section>\n'}),define("nls/print",{root:{print:"Печать",print_pdf:"Печать в PDF",cancel:"Отмена",document_print:"Печать документа",cert:"Сертификат",print_settings:"Дополнительно добавить:",two_copies:"Вторую копию на страницу",bank_stamp:"Штамп банка",bank_stamp_each_page:"Штамп на каждой странице",bank_stamp_last_page:"Штамп на последней странице",ecp_owner:"Информацию о владельце ключа ЭЦП",service_info:"Служебную информацию",attachments_info:"Информация о вложениях"},uk:!0,en:!0}),define("nls/uk/print",{print:"Друк",print_pdf:"Друк в PDF",cancel:"Скасувати",document_print:"Друк документа",cert:"Сертифікат",print_settings:"Додатково додати:",two_copies:"Другу копію на сторінку",bank_stamp:"Штамп банка",bank_stamp_each_page:"Штамп на кожній сторінці",bank_stamp_last_page:"Штамп на останній сторінці",ecp_owner:"Інформацію про власника ключа ЕЦП",service_info:"Службову інформацію",attachments_info:"Інформація про вкладення"}),define("nls/en/print",{print:"Print",print_pdf:"Print in PDF",document_print:"Print the document",cancel:"Cancel",cert:"Certificate",print_settings:"Additionally added:",two_copies:"Two copies on page",
bank_stamp:"Bank stamp",bank_stamp_each_page:"Stamp on the each page",bank_stamp_last_page:"Stamp on the last page",ecp_owner:"EDS key owner's details",service_info:"Service info",attachments_info:"Attachments info"}),define("canvasPrinter",["underscore","jquery","bifit"],function(a,b,c){"use strict";var d={q:2,document:{},docWidth:710,docHeight:1050,_default:{padding:"2",margin:"1 3","font-size":10,"font-family":"Times New Roman","font-style":"","text-align":"left"},pages:{list:[],getPageByY:function(a){var b=Math.floor(a/d.docHeight),c=this.list[b];return c||(this.list.push(this.newPage()),c=this.list[b]),c},getNextPageY:function(a){var b=Math.floor(a/d.docHeight);return d.docHeight*(b+1)},newPage:function(){var a={},c=d.pages.list.length,e=b('<canvas width="'+d.docWidth*d.q+'" height="'+d.docHeight*d.q+'" class="print" id="print'+c+'">');return d.document.append(e),a.id=c,a.print=e[0].getContext("2d"),a.startY=d.docHeight*c,a.print.fillStyle="#FFF",a.print.fillRect(0*d.q,0*d.q,d.docWidth*d.q,d.docHeight*d.q),a.print.fillStyle="#000",a},prepareIEContent:function(){var b="";return a.each(this.list,function(a){b+="<img src='"+a.print.canvas.toDataURL("image/jpeg")+"' width=\""+d.docWidth+'" height="'+d.docHeight+'" class="print" id="print'+a.id+'"/>'}),b}},text:function(b,c,d,e){var f=e.width||this.docWidth-b,g=this.resolveCssProperty("padding",e),h=this.resolveTextX(b,f,g,e),i=c+g.top+e["font-size"],j=this.fillText(h,i,d||"",e);return e.border&&a.contains(["bottom","top","total"],e.border)&&(j+=this._printTextBorder(b,c,e["font-size"],f,g,e.border)),j+g.top+g.bottom},fillText:function(a,b,c,e){var f=this.pages.getPageByY(b),g=e["font-size"];return b-=f.startY,g>b&&(b=g,g*=2),this.setFont(e,d.q),f.print.fillText(c,a*d.q,b*d.q),g},resolveTextX:function(a,b,c,d){return"center"===d["text-align"]?a+b/2:"right"===d["text-align"]?a+b-c.right:a+c.left},resolveCssProperty:function(a,b){var c=(b[a]+"").split(" ");return{top:d.valueToPx(b[a+"-top"]||c[0]||0),right:d.valueToPx(b[a+"-right"]||c[1]||c[0]||0),bottom:d.valueToPx(b[a+"-bottom"]||c[2]||c[0]||0),left:d.valueToPx(b[a+"-left"]||c[3]||c[1]||c[0]||0)}},_printTextBorder:function(a,b,c,d,e,f){if("total"===f)return this.box(a,b,d,c+e.top+e.bottom),2;var g="top"===f?b:b+e.bottom+c+e.top;return this.underline(a,a+d,g),1},setFont:function(b,c){var d=b["font-style"]+" "+b["font-size"]*(c||1)+"pt "+b["font-family"];a.each(this.pages.list,function(a){a.print.font=d,a.print.textAlign=b["text-align"]})},line:function(a,b,c,e){var f=this.pages.getPageByY(c);return c-=f.startY,e-=f.startY,f.print.lineWidth=d.q/2,f.print.moveTo(a*d.q,c*d.q),f.print.lineTo(b*d.q,e*d.q),f.print.stroke(),d.q/2},underline:function(a,b,c){return this.line(a,b,c,c)},verticalLine:function(a,b,c){return this.line(a,a,b,c)},box:function(a,b,c,e){var f=this.pages.getPageByY(b);return b-=f.startY,f.print.lineWidth=d.q,f.print.rect(a*d.q,b*d.q,c*d.q,e*d.q),f.print.stroke(),e},clearRect:function(a,b,c,e){var f=this.pages.getPageByY(b);b-=f.startY,f.print.fillStyle="#FFF",f.print.fillRect(a*d.q,b*d.q,c*d.q,e*d.q),f.print.fillStyle="#000"},wrapText:function(a,b,c,d){var e=d.width,f=(c+"").trim().split(" "),g=f.length,h="",i=b,j=this.resolveCssProperty("padding",d),k=d["font-size"];a=this.resolveTextX(a,e,j,d);for(var l=0;g>l;l++){if(this.getTextWidth(f[l],d)>e){var m=this.getDividedWord(f[l],e,d);if(m.length>1){for(var n=0;n<m.length;n++)f.splice(l+1+n,0,m[n]);f.splice(l,1)}g=f.length}var o=h+f[l]+" ",p=this.getTextWidth(o,d);p>e?(k=this.fillText(a,b+k,h||"",d),b+=k+j.bottom,h=f[l]+" "):h=o}return k=this.fillText(a,b+k,h||"",d),b+=k+j.bottom,b-i},_resolveWidth:function(a,b){if("string"==typeof b&&"%"===b.charAt(b.length-1))return parseInt(b,10)/100*(this.docWidth-a);try{return d.valueToPx(b)}catch(c){return b}},getTextWidth:function(a,b,c){return c=c||1,this.setFont(b,c),this.pages.getPageByY(0).print.measureText(a).width/c},getDividedWord:function(a,b,c){for(var d=a.split(" "),e=[],f=0;f<d.length;f++)for(var g=d[f].length;this.getTextWidth(d[f],c)>b;g--)d[f+1]=d[f].substring(g-1)+(e[f]?e[f]:""),e[f]=d[f+1],d[f]=d[f].substr(0,g-1);return d},table:function(b,c,e,f){var g=this.resolveCssProperty("padding",f),h=a.map(e.colWidth,function(a){return d._resolveWidth(b+g.right,a+"%")}),i=c,j=function(a,b){return a+b};for(0===e.rows.length&&this.pages.getPageByY(c).id!==this.pages.getPageByY(c+(f.offset||0)).id&&(c=this.pages.getNextPageY(c));e.rows.length>0;){var k=this.printTable(b,c,e,h,g,f.offset);e.rows.splice(0,k.length-e.headerRows.length),e.rows.length>0?(c=this.pages.getNextPageY(c),this.clearRect(0,c,this.docWidth,d.docHeight)):c+=a.reduce(k,j,0)}return c-i},printTable:function(b,c,d,e,f,g){var h=[],i=c;try{a.each(d.headerRows,function(a){h.push(this.drawTableRow(b,c,a,e,f,a.options,0)),c+=h[h.length-1]}.bind(this))}catch(j){return this.clearRect(0,i-1,this.docWidth,c-i+j.rowHeight),[]}try{a.each(d.rows,function(a){h.push(this.drawTableRow(b,c,a,e,f,a.options,g||0)),c+=h[h.length-1]}.bind(this))}catch(j){return h.length<=d.headerRows.length+1?(this.clearRect(0,i-1,this.docWidth,c-i+j.rowHeight),[]):(this.clearRect(0,c,this.docWidth,j.rowHeight),h)}return h},drawTableRow:function(b,c,d,e,f,g,h){var i=0,j=b,k="none"!==g["table-border"],l=function(d){p+=this.wrapText(b+f.left,c+p+f.top,d,a.extend({},g,n.options||{},{width:e[m]-f.left-f.right}))}.bind(this);e=this.getCellWidth(d.cells,e);for(var m=0;m<d.cells.length;m++){var n=d.cells[m],o=this.pages.getPageByY(c).id,p=0;if(a.each(n.text,l),i=Math.max(p,i),b+=e[m],o!==this.pages.getPageByY(c+i+f.bottom+f.top+h).id)throw{rowHeight:i+f.bottom+f.top}}if(b=j,k)for(var q=0;q<d.cells.length;q++)this.box(b,c,e[q],i+f.bottom+f.top),b+=e[q];return i+f.bottom+f.top},getCellWidth:function(a,b){if(a.length===b.length)return b;for(var c=[],d=b.slice(),e=0;e<a.length&&d.length>0;e++){var f=a[e],g=d.shift();if(f.colspan&&!isNaN(f.colspan)&&f.colspan>1)for(var h=1;h<f.colspan;h++)g+=d.shift()||0;c.push(g)}return c},drawImage:function(a,b,c,e,f){var g=this.pages.getPageByY(b);b-=g.startY,e=e||c.width,f=f||c.height;try{g.print.drawImage(c,a*d.q,b*d.q,e*d.q,f*d.q)}catch(h){g.print.putImageData(c,a*d.q,b*d.q)}return f},copyImage:function(a,b,c,e){var f=this.pages.getPageByY(b);return b-=f.startY,f.print.getImageData(a*d.q,b*d.q,c*d.q,e*d.q)},valueToPx:function(a){if(!isNaN(a))return parseInt(a);if(a&&-1!==a.indexOf("mm"))return 3.78*parseFloat(a);throw"Wrong number format: "+a},manageShowStamp:function(b,e){var g=e.img,h=e.x-e.img.width/2,i=e.y-e.img.height/2;b?(e.clearPlace||(e.clearPlace=d.copyImage(h,i,g.width,g.height)),d.drawImage(h,i,g,g.width,g.height),d.text(h,e.y,c.date2str(new Date),a.extend({},f.defaultStyle,{"text-align":"center",width:g.width}))):d.drawImage(h,i,e.clearPlace,g.width,g.height),e.hidden=!b}},e=function(b){var c=function(b){return b=a.map(b,function(b){return a.isObject(b)&&!a.isArray(b)?b:(b=a.isArray(b)?b:[b],{text:b})})};this.options=d._default,this.data={colWidth:b,rows:[],headerRows:[]},this.createRow=function(b){return{cells:c(b),options:a.clone(this.options)}},this.row=function(){return this.data.rows.push(this.createRow(arguments)),this},this.header=function(){return this.data.headerRows.push(this.createRow(arguments)),this},this.style=function(b){return a.extend(this.options,b),this}},f={x:0,startX:0,y:0,maxLineHeight:0,defaultStyle:a.clone(d._default),page:{},close:function(b){this.page=this.page||b,this.page.css({width:"210mm",padding:"0",border:"0","background-color":"transparent","box-shadow":"none"});try{this.page.append(d.document)}catch(c){this.page.html(d.pages.prepareIEContent())}this.defaultStyle=a.clone(d._default)},TablePrinter:e,from:function(a,b){return f.x=d.valueToPx(a),f.startX=b?f.x:f.startX,f.y=d.valueToPx(b||f.y),f.maxLineHeight=b?0:f.maxLineHeight,f},footer:function(a){var b=d.pages.getPageByY(f.y).startY+d.docHeight-d.valueToPx(a);return f.from(f.startX,b)},text:function(b,c){c=a.extend({},f.defaultStyle,c),c.width=d._resolveWidth(f.x,c.width);var e=d.resolveCssProperty("margin",c),g=d.text(f.x+e.left,f.y+e.top,b,c)+e.top+e.bottom;return f.maxLineHeight=Math.max(f.maxLineHeight,g),f.x+=(c.width||d.getTextWidth(b,c))+e.right+e.left,f},stamp:function(){return f.stampPlace={x:f.x,y:f.y,url:localStorage.getItem("stamp_url"),clearPlace:null,img:null,hidden:!0},f},toggleStamp:function(b){if(f.stampPlace){var c=f.stampPlace;if(b=a.isUndefined(b)?c.hidden:b,!c.img&&b)return c.img=new Image,c.img.onload=f.toggleStamp.bind(this,!0),c.img.src=c.url,f;d.manageShowStamp(b,c),"Explorer"===BrowserDetect.browser&&this.page.html(d.pages.prepareIEContent())}return f},wrapText:function(b,c){c=a.extend({},f.defaultStyle,c),c.width=c.width||d.docWidth-f.x;var e=d.resolveCssProperty("margin",c);c.linePadding=e.top+e.bottom;var g=d.wrapText(f.x+e.left,f.y+e.top,b,c)+e.top+e.bottom;return f.maxLineHeight=Math.max(f.maxLineHeight,g),f.x+=c.width+e.right+e.left,f},nl:function(a){return f.y+=f.maxLineHeight+d.valueToPx(a||0),f.x=f.startX,f.maxLineHeight=0,f},newPage:function(){return d.pages.getPageByY(d.pages.getNextPageY(f.y)),f},style:function(b){return a.extend(f.defaultStyle,b),f},space:function(a){return f.x+=d.valueToPx(a),f},table:function(b,c){return f.y+=d.table(f.x,f.y,b.data,a.extend({},f.defaultStyle,c||{})),f}};return function(a,c,e,g){return d.document=b('<div class="canvas-print-container"></div>'),d.docWidth=c||d.docWidth,d.docHeight=e||d.docHeight,d.q=g||d.q,d.pages.list=[],f.page=a,f}});var JsPDF=function(a){"use strict";function b(b){var c={};this.subscribe=function(a,b,d){if("function"!=typeof b)return!1;c.hasOwnProperty(a)||(c[a]={});var e=Math.random().toString(35);return c[a][e]=[b,!!d],e},this.unsubscribe=function(a){for(var b in c)if(c[b][a])return delete c[b][a],!0;return!1},this.publish=function(d){if(c.hasOwnProperty(d)){var e=Array.prototype.slice.call(arguments,1),f=[];for(var g in c[d]){var h=c[d][g];try{h[0].apply(b,e)}catch(i){a.console}h[1]&&f.push(g)}f.length&&f.forEach(this.unsubscribe)}}}function c(g,h,i,j){var k={};"object"==typeof g&&(k=g,g=k.orientation,h=k.unit||h,i=k.format||i,j=k.compress||k.compressPdf||j),h=h||"mm",i=i||"a4",g=(""+(g||"P")).toLowerCase();var l,m,n,o,p,q,r,s,t,u=((""+i).toLowerCase(),!!j&&"function"==typeof Uint8Array),v=k.textColor||"0 g",w=k.drawColor||"0 G",x=k.fontSize||16,y=k.lineHeight||1.15,z=k.lineWidth||.200025,A=2,B=!1,C=[],D={},E={},F=0,G=[],H=[],I=[],J=[],K=[],L=0,M=0,N=0,O={title:"",subject:"",author:"",keywords:"",creator:""},P={},Q=new b(P),R=function(a){return a.toFixed(2)},S=function(a){return a.toFixed(3)},T=function(a){return("0"+parseInt(a)).slice(-2)},U=function(a){B?G[o].push(a):(N+=a.length+1,J.push(a))},V=function(){return A++,C[A]=N,U(A+" 0 obj"),A},W=function(){var a=2*G.length+1;a+=K.length;var b={objId:a,content:""};return K.push(b),b},X=function(){return A++,C[A]=function(){return N},A},Y=function(a){C[a]=N},Z=function(a){U("stream"),U(a),U("endstream")},$=function(){var b,d,e,f,g,h,i,j,k;for(i=a.adler32cs||c.adler32cs,u&&"undefined"==typeof i&&(u=!1),b=1;F>=b;b++){if(V(),j=(p=I[b].width)*m,k=(q=I[b].height)*m,U("<</Type /Page"),U("/Parent 1 0 R"),U("/Resources 2 0 R"),U("/MediaBox [0 0 "+R(j)+" "+R(k)+"]"),Q.publish("putPage",{pageNumber:b,page:G[b]}),U("/Contents "+(A+1)+" 0 R"),U(">>"),U("endobj"),d=G[b].join("\n"),V(),u){for(e=[],f=d.length;f--;)e[f]=d.charCodeAt(f);h=i.from(d),g=new Deflater(6),g.append(new Uint8Array(e)),d=g.flush(),e=new Uint8Array(d.length+6),e.set(new Uint8Array([120,156])),e.set(d,2),e.set(new Uint8Array([255&h,h>>8&255,h>>16&255,h>>24&255]),d.length+2),d=String.fromCharCode.apply(null,e),U("<</Length "+d.length+" /Filter [/FlateDecode]>>")}else U("<</Length "+d.length+">>");Z(d),U("endobj")}C[1]=N,U("1 0 obj"),U("<</Type /Pages");var l="/Kids [";for(f=0;F>f;f++)l+=3+2*f+" 0 R ";U(l+"]"),U("/Count "+F),U(">>"),U("endobj"),Q.publish("postPutPages")},_=function(a){a.objectNumber=V(),U("<</BaseFont/"+a.PostScriptName+"/Type/Font"),"string"==typeof a.encoding&&U("/Encoding/"+a.encoding),U("/Subtype/Type1>>"),U("endobj")},aa=function(){for(var a in D)D.hasOwnProperty(a)&&_(D[a])},ba=function(){Q.publish("putXobjectDict")},ca=function(){U("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),U("/Font <<");for(var a in D)D.hasOwnProperty(a)&&U("/"+a+" "+D[a].objectNumber+" 0 R");U(">>"),U("/XObject <<"),ba(),U(">>")},da=function(){aa(),Q.publish("putResources"),C[2]=N,U("2 0 obj"),U("<<"),ca(),U(">>"),U("endobj"),Q.publish("postPutResources")},ea=function(){Q.publish("putAdditionalObjects");for(var a=0;a<K.length;a++){var b=K[a];C[b.objId]=N,U(b.objId+" 0 obj"),U(b.content),U("endobj")}A+=K.length,Q.publish("postPutAdditionalObjects")},fa=function(a,b,c){E.hasOwnProperty(b)||(E[b]={}),E[b][c]=a},ga=function(a,b,c,d){var e="F"+(Object.keys(D).length+1).toString(10),f=D[e]={id:e,PostScriptName:a,fontName:b,fontStyle:c,encoding:d,metadata:{}};return fa(e,b,c),Q.publish("addFont",f),e},ha=function(){for(var a="helvetica",b="times",c="courier",d="normal",e="bold",f="italic",g="bolditalic",h="StandardEncoding",i="zapfdingbats",j=[["Helvetica",a,d],["Helvetica-Bold",a,e],["Helvetica-Oblique",a,f],["Helvetica-BoldOblique",a,g],["Courier",c,d],["Courier-Bold",c,e],["Courier-Oblique",c,f],["Courier-BoldOblique",c,g],["Times-Roman",b,d],["Times-Bold",b,e],["Times-Italic",b,f],["Times-BoldItalic",b,g],["ZapfDingbats",i]],k=0,l=j.length;l>k;k++){var m=ga(j[k][0],j[k][1],j[k][2],h),n=j[k][0].split("-");fa(m,n[0],n[1]||"")}Q.publish("addFonts",{fonts:D,dictionary:E})},ia=function(a){return a.foo=function(){try{return a.apply(this,arguments)}catch(b){var c=b.stack||"";~c.indexOf(" at ")&&(c=c.split(" at ")[1]);var d="Error in function "+c.split("\n")[0].split("<")[0]+": "+b.message;throw new Error(d)}},a.foo.bar=a,a.foo},ja=function(a,b){var c,d,e,f,g,h,i,j,k;if(b=b||{},e=b.sourceEncoding||"Unicode",g=b.outputEncoding,(b.autoencode||g)&&D[l].metadata&&D[l].metadata[e]&&D[l].metadata[e].encoding&&(f=D[l].metadata[e].encoding,!g&&D[l].encoding&&(g=D[l].encoding),!g&&f.codePages&&(g=f.codePages[0]),"string"==typeof g&&(g=f[g]),g)){for(i=!1,h=[],c=0,d=a.length;d>c;c++)j=g[a.charCodeAt(c)],j?h.push(String.fromCharCode(j)):h.push(a[c]),h[c].charCodeAt(0)>>8&&(i=!0);a=h.join("")}for(c=a.length;void 0===i&&0!==c;)a.charCodeAt(c-1)>>8&&(i=!0),c--;if(!i)return a;for(h=b.noBOM?[]:[254,255],c=0,d=a.length;d>c;c++){if(j=a.charCodeAt(c),k=j>>8,k>>8)throw new Error("Character at position "+c+" of string '"+a+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");h.push(k),h.push(j-(k<<8))}return String.fromCharCode.apply(void 0,h)},ka=function(a,b){return ja(a,b).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},la=function(){U("/Producer (JsPDF "+c.version+")");for(var a in O)O.hasOwnProperty(a)&&O[a]&&U("/"+a.substr(0,1).toUpperCase()+a.substr(1)+" ("+ka(O[a])+")");var b=new Date,d=b.getTimezoneOffset(),e=0>d?"+":"-",f=Math.floor(Math.abs(d/60)),g=Math.abs(d%60),h=[e,T(f),"'",T(g),"'"].join("");U(["/CreationDate (D:",b.getFullYear(),T(b.getMonth()+1),T(b.getDate()),T(b.getHours()),T(b.getMinutes()),T(b.getSeconds()),h,")"].join(""))},ma=function(){switch(U("/Type /Catalog"),U("/Pages 1 0 R"),s||(s="fullwidth"),s){case"fullwidth":U("/OpenAction [3 0 R /FitH null]");break;case"fullheight":U("/OpenAction [3 0 R /FitV null]");break;case"fullpage":U("/OpenAction [3 0 R /Fit]");break;case"original":U("/OpenAction [3 0 R /XYZ null null 1]");break;default:var a=""+s;"%"===a.substr(a.length-1)&&(s=parseInt(s)/100),"number"==typeof s&&U("/OpenAction [3 0 R /XYZ null null "+R(s)+"]")}switch(t||(t="continuous"),t){case"continuous":U("/PageLayout /OneColumn");break;case"single":U("/PageLayout /SinglePage");break;case"two":case"twoleft":U("/PageLayout /TwoColumnLeft");break;case"tworight":U("/PageLayout /TwoColumnRight")}r&&U("/PageMode /"+r),Q.publish("putCatalog")},na=function(){U("/Size "+(A+1)),U("/Root "+A+" 0 R"),U("/Info "+(A-1)+" 0 R")},oa=function(a,b){var c="string"==typeof b&&b.toLowerCase();if("string"==typeof a){var d=a.toLowerCase();e.hasOwnProperty(d)&&(a=e[d][0]/m,b=e[d][1]/m)}if(Array.isArray(a)&&(b=a[1],a=a[0]),c){switch(c.substr(0,1)){case"l":b>a&&(c="s");break;case"p":a>b&&(c="s")}"s"===c&&(n=a,a=b,b=n)}B=!0,G[++F]=[],I[F]={width:Number(a)||p,height:Number(b)||q},H[F]={},ra(F)},pa=function(){oa.apply(this,arguments),U(R(z*m)+" w"),U(w),0!==L&&U(L+" J"),0!==M&&U(M+" j"),Q.publish("addPage",{pageNumber:F})},qa=function(a){a>0&&F>=a&&(G.splice(a,1),I.splice(a,1),F--,o>F&&(o=F),this.setPage(o))},ra=function(a){a>0&&F>=a&&(o=a,p=I[a].width,q=I[a].height)},sa=function(a,b){var c;switch(a=void 0!==a?a:D[l].fontName,b=void 0!==b?b:D[l].fontStyle,void 0!==a&&(a=a.toLowerCase()),a){case"sans-serif":case"verdana":case"arial":case"helvetica":a="helvetica";break;case"fixed":case"monospace":case"terminal":case"courier":a="courier";break;case"serif":case"cursive":case"fantasy":default:a="times"}try{c=E[a][b]}catch(d){}return c||(c=E.times[b],null==c&&(c=E.times.normal)),c},ta=function(){B=!1,A=2,J=[],C=[],K=[],Q.publish("buildDocument"),U("%PDF-"+d),$(),ea(),da(),V(),U("<<"),la(),U(">>"),U("endobj"),V(),U("<<"),ma(),U(">>"),U("endobj");var a,b=N,c="0000000000";for(U("xref"),U("0 "+(A+1)),U(c+" 65535 f "),a=1;A>=a;a++){var e=C[a];U("function"==typeof e?(c+C[a]()).slice(-10)+" 00000 n ":(c+C[a]).slice(-10)+" 00000 n ")}return U("trailer"),U("<<"),na(),U(">>"),U("startxref"),U(b),U("%%EOF"),B=!0,J.join("\n")},ua=function(a){var b="S";return"F"===a?b="f":"FD"===a||"DF"===a?b="B":"f"!==a&&"f*"!==a&&"B"!==a&&"B*"!==a||(b=a),b},va=function(){for(var a=ta(),b=a.length,c=new ArrayBuffer(b),d=new Uint8Array(c);b--;)d[b]=a.charCodeAt(b);return c},wa=function(){return new Blob([va()],{type:"application/pdf"})},xa=ia(function(b,c){var d="dataur"===(""+b).substr(0,6)?"data:application/pdf;base64,"+btoa(ta()):0;switch(b){case void 0:return ta();case"save":if(navigator.getUserMedia&&(void 0===a.URL||void 0===a.URL.createObjectURL))return P.output("dataurlnewwindow");ya(wa(),c),"function"==typeof ya.unload&&a.setTimeout&&setTimeout(ya.unload,911);break;case"arraybuffer":return va();case"blob":return wa();case"bloburi":case"bloburl":return a.URL&&a.URL.createObjectURL(wa())||void 0;case"datauristring":case"dataurlstring":return d;case"dataurlnewwindow":var e=a.open(d);if(e||"undefined"==typeof safari)return e;case"datauri":case"dataurl":return a.document.location.href=d;default:throw new Error('Output type "'+b+'" is not supported.')}});switch(h){case"pt":m=1;break;case"mm":m=72/25.4000508;break;case"cm":m=72/2.54000508;break;case"in":m=72;break;case"px":m=96/72;break;case"pc":m=12;break;case"em":m=12;break;case"ex":m=6;break;default:throw"Invalid unit: "+h}P.internal={pdfEscape:ka,getStyle:ua,getFont:function(){return D[sa.apply(P,arguments)]},getFontSize:function(){return x},getLineHeight:function(){return x*y},write:function(a){U(1===arguments.length?a:Array.prototype.join.call(arguments," "))},getCoordinateString:function(a){return R(a*m)},getVerticalCoordinateString:function(a){return R((q-a)*m)},collections:{},newObject:V,newAdditionalObject:W,newObjectDeferred:X,newObjectDeferredBegin:Y,putStream:Z,events:Q,scaleFactor:m,pageSize:{get width(){return p},get height(){return q}},output:function(a,b){return xa(a,b)},getNumberOfPages:function(){return G.length-1},pages:G,out:U,f2:R,getPageInfo:function(a){var b=2*(a-1)+3;return{objId:b,pageNumber:a,pageContext:H[a]}},getCurrentPageInfo:function(){var a=2*(o-1)+3;return{objId:a,pageNumber:o,pageContext:H[o]}},getPDFVersion:function(){return d}},P.addPage=function(){return pa.apply(this,arguments),this},P.setPage=function(){return ra.apply(this,arguments),this},P.insertPage=function(a){return this.addPage(),this.movePage(o,a),this},P.movePage=function(a,b){if(a>b){for(var c=G[a],d=I[a],e=H[a],f=a;f>b;f--)G[f]=G[f-1],I[f]=I[f-1],H[f]=H[f-1];G[b]=c,I[b]=d,H[b]=e,this.setPage(b)}else if(b>a){for(var c=G[a],d=I[a],e=H[a],f=a;b>f;f++)G[f]=G[f+1],I[f]=I[f+1],H[f]=H[f+1];G[b]=c,I[b]=d,H[b]=e,this.setPage(b)}return this},P.deletePage=function(){return qa.apply(this,arguments),this},P.setDisplayMode=function(a,b,c){return s=a,t=b,r=c,this},P.text=function(a,b,c,d,e,f){function g(a){return a=a.split("	").join(Array(k.TabLen||9).join(" ")),ka(a,d)}"number"==typeof a&&(n=c,c=b,b=a,a=n),"string"==typeof a&&(a=a.match(/[\n\r]/)?a.split(/\r\n|\r|\n/g):[a]),"string"==typeof e&&(f=e,e=null),"string"==typeof d&&(f=d,d=null),"number"==typeof d&&(e=d,d=null);var h,i="",j="Td";if(e){e*=Math.PI/180;var o=Math.cos(e),p=Math.sin(e);i=[R(o),R(p),R(-1*p),R(o),""].join(" "),j="Tm"}d=d||{},"noBOM"in d||(d.noBOM=!0),"autoencode"in d||(d.autoencode=!0);var r="",s=this.internal.getCurrentPageInfo().pageContext;if(!0===d.stroke?s.lastTextWasStroke!==!0&&(r="1 Tr\n",s.lastTextWasStroke=!0):(s.lastTextWasStroke&&(r="0 Tr\n"),s.lastTextWasStroke=!1),"undefined"==typeof this._runningPageHeight&&(this._runningPageHeight=0),"string"==typeof a)a=g(a);else{if("[object Array]"!==Object.prototype.toString.call(a))throw new Error('Type of text must be string or Array. "'+a+'" is not recognized.');for(var t=a.concat(),u=[],w=t.length;w--;)u.push(g(t.shift()));var z=Math.ceil((q-c-this._runningPageHeight)*m/(x*y));if(z>=0&&z<u.length+1,f){var A,B,C,D=x*y,E=a.map(function(a){return this.getStringUnitWidth(a)*x/m},this);if(C=Math.max.apply(Math,E),"center"===f)A=b-C/2,b-=E[0]/2;else{if("right"!==f)throw new Error('Unrecognized alignment option, use "center" or "right".');A=b-C,b-=E[0]}B=b,a=u[0]+") Tj\n";for(var F=1,w=u.length;w>F;F++){var G=C-E[F];"center"===f&&(G/=2),a+=A-B+G+" -"+D+" Td ("+u[F],B=A+G,w-1>F&&(a+=") Tj\n")}}else a=u.join(") Tj\nT* (")}var H;return h||(H=R((q-c)*m)),U("BT\n/"+l+" "+x+" Tf\n"+x*y+" TL\n"+r+v+"\n"+i+R(b*m)+" "+H+" "+j+"\n("+a+") Tj\nET"),h&&this.text(h,b,c),this},P.lstext=function(a,b,c,d){for(var e=0,f=a.length;f>e;e++,b+=d)this.text(a[e],b,c)},P.line=function(a,b,c,d){return this.lines([[c-a,d-b]],a,b)},P.clip=function(){U("W"),U("S")},P.lines=function(a,b,c,d,e,f){var g,h,i,j,k,l,o,p,r,s,t;for("number"==typeof a&&(n=c,c=b,b=a,a=n),d=d||[1,1],U(S(b*m)+" "+S((q-c)*m)+" m "),g=d[0],h=d[1],j=a.length,s=b,t=c,i=0;j>i;i++)k=a[i],2===k.length?(s=k[0]*g+s,t=k[1]*h+t,U(S(s*m)+" "+S((q-t)*m)+" l")):(l=k[0]*g+s,o=k[1]*h+t,p=k[2]*g+s,r=k[3]*h+t,s=k[4]*g+s,t=k[5]*h+t,U(S(l*m)+" "+S((q-o)*m)+" "+S(p*m)+" "+S((q-r)*m)+" "+S(s*m)+" "+S((q-t)*m)+" c"));return f&&U(" h"),null!==e&&U(ua(e)),this},P.rect=function(a,b,c,d,e){ua(e);return U([R(a*m),R((q-b)*m),R(c*m),R(-d*m),"re"].join(" ")),null!==e&&U(ua(e)),this},P.triangle=function(a,b,c,d,e,f,g){return this.lines([[c-a,d-b],[e-c,f-d],[a-e,b-f]],a,b,[1,1],g,!0),this},P.roundedRect=function(a,b,c,d,e,f,g){var h=4/3*(Math.SQRT2-1);return this.lines([[c-2*e,0],[e*h,0,e,f-f*h,e,f],[0,d-2*f],[0,f*h,-(e*h),f,-e,f],[-c+2*e,0],[-(e*h),0,-e,-(f*h),-e,-f],[0,-d+2*f],[0,-(f*h),e*h,-f,e,-f]],a+e,b,[1,1],g),this},P.ellipse=function(a,b,c,d,e){var f=4/3*(Math.SQRT2-1)*c,g=4/3*(Math.SQRT2-1)*d;return U([R((a+c)*m),R((q-b)*m),"m",R((a+c)*m),R((q-(b-g))*m),R((a+f)*m),R((q-(b-d))*m),R(a*m),R((q-(b-d))*m),"c"].join(" ")),U([R((a-f)*m),R((q-(b-d))*m),R((a-c)*m),R((q-(b-g))*m),R((a-c)*m),R((q-b)*m),"c"].join(" ")),U([R((a-c)*m),R((q-(b+g))*m),R((a-f)*m),R((q-(b+d))*m),R(a*m),R((q-(b+d))*m),"c"].join(" ")),U([R((a+f)*m),R((q-(b+d))*m),R((a+c)*m),R((q-(b+g))*m),R((a+c)*m),R((q-b)*m),"c"].join(" ")),null!==e&&U(ua(e)),this},P.circle=function(a,b,c,d){return this.ellipse(a,b,c,c,d)},P.setProperties=function(a){for(var b in O)O.hasOwnProperty(b)&&a[b]&&(O[b]=a[b]);return this},P.setFontSize=function(a){return x=a,this},P.setFont=function(a,b){return l=sa(a,b),this},P.setFontStyle=P.setFontType=function(a){return l=sa(void 0,a),this},P.getFontList=function(){var a,b,c,d={};for(a in E)if(E.hasOwnProperty(a)){d[a]=c=[];for(b in E[a])E[a].hasOwnProperty(b)&&c.push(b)}return d},P.addFont=function(a,b,c){ga(a,b,c,"StandardEncoding")},P.setLineWidth=function(a){return U((a*m).toFixed(2)+" w"),this},P.setDrawColor=function(a,b,c,d){var e;return e=void 0===b||void 0===d&&a===b===c?"string"==typeof a?a+" G":R(a/255)+" G":void 0===d?"string"==typeof a?[a,b,c,"RG"].join(" "):[R(a/255),R(b/255),R(c/255),"RG"].join(" "):"string"==typeof a?[a,b,c,d,"K"].join(" "):[R(a),R(b),R(c),R(d),"K"].join(" "),U(e),this},P.setFillColor=function(a,b,c,d){var e;return void 0===b||void 0===d&&a===b===c?e="string"==typeof a?a+" g":R(a/255)+" g":void 0===d||"object"==typeof d?(e="string"==typeof a?[a,b,c,"rg"].join(" "):[R(a/255),R(b/255),R(c/255),"rg"].join(" "),d&&0===d.a&&(e=["255","255","255","rg"].join(" "))):e="string"==typeof a?[a,b,c,d,"k"].join(" "):[R(a),R(b),R(c),R(d),"k"].join(" "),U(e),this},P.setTextColor=function(a,b,c){if("string"==typeof a&&/^#[0-9A-Fa-f]{6}$/.test(a)){var d=parseInt(a.substr(1),16);a=d>>16&255,b=d>>8&255,c=255&d}return v=0===a&&0===b&&0===c||"undefined"==typeof b?S(a/255)+" g":[S(a/255),S(b/255),S(c/255),"rg"].join(" "),this},P.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},P.setLineCap=function(a){var b=this.CapJoinStyles[a];if(void 0===b)throw new Error("Line cap style of '"+a+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return L=b,U(b+" J"),this},P.setLineJoin=function(a){var b=this.CapJoinStyles[a];if(void 0===b)throw new Error("Line join style of '"+a+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return M=b,U(b+" j"),this},P.output=xa,P.save=function(a){P.output("save",a)},function(a){var b="addImage_",c=["jpeg","jpg","png"],d=function w(a){var b=this.internal.newObject(),c=this.internal.write,d=this.internal.putStream;if(a.n=b,c("<</Type /XObject"),c("/Subtype /Image"),c("/Width "+a.w),c("/Height "+a.h),a.cs===this.color_spaces.INDEXED?c("/ColorSpace [/Indexed /DeviceRGB "+(a.pal.length/3-1)+" "+("smask"in a?b+2:b+1)+" 0 R]"):(c("/ColorSpace /"+a.cs),a.cs===this.color_spaces.DEVICE_CMYK&&c("/Decode [1 0 1 0 1 0 1 0]")),c("/BitsPerComponent "+a.bpc),"f"in a&&c("/Filter /"+a.f),"dp"in a&&c("/DecodeParms <<"+a.dp+">>"),"trns"in a&&a.trns.constructor==Array){for(var e="",f=0,g=a.trns.length;g>f;f++)e+=a.trns[f]+" "+a.trns[f]+" ";c("/Mask ["+e+"]")}if("smask"in a&&c("/SMask "+(b+1)+" 0 R"),c("/Length "+a.data.length+">>"),d(a.data),c("endobj"),"smask"in a){var h="/Predictor 15 /Colors 1 /BitsPerComponent "+a.bpc+" /Columns "+a.w,i={w:a.w,h:a.h,cs:"DeviceGray",bpc:a.bpc,dp:h,data:a.smask};"f"in a&&(i.f=a.f),w.call(this,i)}a.cs===this.color_spaces.INDEXED&&(this.internal.newObject(),c("<< /Length "+a.pal.length+">>"),d(this.arrayBufferToBinaryString(new Uint8Array(a.pal))),c("endobj"))},e=function(){var a=this.internal.collections[b+"images"];for(var c in a)d.call(this,a[c])},g=function(){var a,c=this.internal.collections[b+"images"],d=this.internal.write;for(var e in c)a=c[e],d("/I"+a.i,a.n,"0","R")},h=function(b){return b&&"string"==typeof b&&(b=b.toUpperCase()),b in a.image_compression?b:a.image_compression.NONE},i=function(){var a=this.internal.collections[b+"images"];return a||(this.internal.collections[b+"images"]=a={},this.internal.events.subscribe("putResources",e),this.internal.events.subscribe("putXobjectDict",g)),a},j=function(a){var b=0;return a&&(b=Object.keys?Object.keys(a).length:function(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b}(a)),b},k=function(a){return"undefined"==typeof a||null===a},l=function(b){return"string"==typeof b&&a.sHashCode(b)},m=function(a){return-1===c.indexOf(a)},n=function(b){return"function"!=typeof a["process"+b.toUpperCase()]},o=function(a){return"object"===("undefined"==typeof a?"undefined":f(a))&&1===a.nodeType},p=function(a,b,c){if("IMG"===a.nodeName&&a.hasAttribute("src")){var d=""+a.getAttribute("src");if(!c&&0===d.indexOf("data:image/"))return d;!b&&/\.png(?:[?#].*)?$/i.test(d)&&(b="png")}if("CANVAS"===a.nodeName)var e=a;else{var e=document.createElement("canvas");e.width=a.clientWidth||a.width,e.height=a.clientHeight||a.height;var g=e.getContext("2d");if(!g)throw"addImage requires canvas to be supported by browser.";if(c){var h,i,j,k,l,m,n,o,p=Math.PI/180;"object"===("undefined"==typeof c?"undefined":f(c))&&(h=c.x,i=c.y,j=c.bg,c=c.angle),o=c*p,k=Math.abs(Math.cos(o)),l=Math.abs(Math.sin(o)),m=e.width,n=e.height,e.width=n*l+m*k,e.height=n*k+m*l,isNaN(h)&&(h=e.width/2),isNaN(i)&&(i=e.height/2),g.clearRect(0,0,e.width,e.height),g.fillStyle=j||"white",g.fillRect(0,0,e.width,e.height),g.save(),g.translate(h,i),g.rotate(o),g.drawImage(a,-(m/2),-(n/2)),g.rotate(-o),g.translate(-h,-i),g.restore()}else g.drawImage(a,0,0,e.width,e.height)}return e.toDataURL("png"==(""+b).toLowerCase()?"image/png":"image/jpeg")},q=function(a,b){var c;if(b)for(var d in b)if(a===b[d].alias){c=b[d];break}return c},r=function(a,b,c){return a||b||(a=-96,b=-96),0>a&&(a=-1*c.w*72/a/this.internal.scaleFactor),0>b&&(b=-1*c.h*72/b/this.internal.scaleFactor),0===a&&(a=b*c.w/c.h),0===b&&(b=a*c.h/c.w),[a,b]},s=function(a,b,c,d,e,f,g){var h=r.call(this,c,d,e),i=this.internal.getCoordinateString,j=this.internal.getVerticalCoordinateString;c=h[0],d=h[1],g[f]=e,this.internal.write("q",i(c),"0 0",i(d),i(a),j(b+d),"cm /I"+e.i,"Do Q")};a.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPERATION:"Seperation",DEVICE_N:"DeviceN"},a.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"},a.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},a.sHashCode=function(a){return Array.prototype.reduce&&a.split("").reduce(function(a,b){return a=(a<<5)-a+b.charCodeAt(0),a&a},0)},a.isString=function(a){return"string"==typeof a},a.extractInfoFromBase64DataURI=function(a){return/^data:([\w]+?\/([\w]+?));base64,(.+?)$/g.exec(a)},a.supportsArrayBuffer=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array},a.isArrayBuffer=function(a){return this.supportsArrayBuffer()?a instanceof ArrayBuffer:!1},a.isArrayBufferView=function(a){return this.supportsArrayBuffer()?"undefined"==typeof Uint32Array?!1:a instanceof Int8Array||a instanceof Uint8Array||"undefined"!=typeof Uint8ClampedArray&&a instanceof Uint8ClampedArray||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array:!1},a.binaryStringToUint8Array=function(a){for(var b=a.length,c=new Uint8Array(b),d=0;b>d;d++)c[d]=a.charCodeAt(d);return c},a.arrayBufferToBinaryString=function(a){if("TextDecoder"in window){var b=new TextDecoder("ascii");return b.decode(a)}this.isArrayBuffer(a)&&(a=new Uint8Array(a));for(var c="",d=a.byteLength,e=0;d>e;e++)c+=String.fromCharCode(a[e]);return c},a.arrayBufferToBase64=function(a){for(var b,c,d,e,f,g="",h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(a),j=i.byteLength,k=j%3,l=j-k,m=0;l>m;m+=3)f=i[m]<<16|i[m+1]<<8|i[m+2],b=(16515072&f)>>18,c=(258048&f)>>12,d=(4032&f)>>6,e=63&f,g+=h[b]+h[c]+h[d]+h[e];return 1==k?(f=i[l],b=(252&f)>>2,c=(3&f)<<4,g+=h[b]+h[c]+"=="):2==k&&(f=i[l]<<8|i[l+1],b=(64512&f)>>10,c=(1008&f)>>4,d=(15&f)<<2,g+=h[b]+h[c]+h[d]+"="),g},a.createImageInfo=function(a,b,c,d,e,f,g,h,i,j,k,l){var m={alias:h,w:b,h:c,cs:d,bpc:e,i:g,data:a};return f&&(m.f=f),i&&(m.dp=i),j&&(m.trns=j),k&&(m.pal=k),l&&(m.smask=l),m},a.addImage=function(a,b,d,e,g,r,t,u,v){if("string"!=typeof b){var w=r;r=g,g=e,e=d,d=b,b=w}if("object"===("undefined"==typeof a?"undefined":f(a))&&!o(a)&&"imageData"in a){var x=a;a=x.imageData,b=x.format||b,d=x.x||d||0,e=x.y||e||0,g=x.w||g,r=x.h||r,t=x.alias||t,u=x.compression||u,v=x.rotation||x.angle||v}if(isNaN(d)||isNaN(e))throw new Error("Invalid coordinates passed to JsPDF.addImage");var y,z=i.call(this);if(!(y=q(a,z))){var A;if(o(a)&&(a=p(a,b,v)),k(t)&&(t=l(a)),
!(y=q(t,z))){if(this.isString(a)){var B=this.extractInfoFromBase64DataURI(a);B?(b=B[2],a=atob(B[3])):137===a.charCodeAt(0)&&80===a.charCodeAt(1)&&78===a.charCodeAt(2)&&71===a.charCodeAt(3)&&(b="png")}if(b=(b||"JPEG").toLowerCase(),m(b))throw new Error("addImage currently only supports formats "+c+", not '"+b+"'");if(n(b))throw new Error("please ensure that the plugin for '"+b+"' support is added");if(this.supportsArrayBuffer()&&(a instanceof Uint8Array||(A=a,a=this.binaryStringToUint8Array(a))),y=this["process"+b.toUpperCase()](a,j(z),t,h(u),A),!y)throw new Error("An unkwown error occurred whilst processing the image")}}return s.call(this,d,e,g,r,y,y.i,z),this};var t=function(a){var b,c,d;if(255===!a.charCodeAt(0)||216===!a.charCodeAt(1)||255===!a.charCodeAt(2)||224===!a.charCodeAt(3)||!a.charCodeAt(6)==="J".charCodeAt(0)||!a.charCodeAt(7)==="F".charCodeAt(0)||!a.charCodeAt(8)==="I".charCodeAt(0)||!a.charCodeAt(9)==="F".charCodeAt(0)||0===!a.charCodeAt(10))throw new Error("getJpegSize requires a binary string jpeg file");for(var e=256*a.charCodeAt(4)+a.charCodeAt(5),f=4,g=a.length;g>f;){if(f+=e,255!==a.charCodeAt(f))throw new Error("getJpegSize could not find the size of the image");if(192===a.charCodeAt(f+1)||193===a.charCodeAt(f+1)||194===a.charCodeAt(f+1)||195===a.charCodeAt(f+1)||196===a.charCodeAt(f+1)||197===a.charCodeAt(f+1)||198===a.charCodeAt(f+1)||199===a.charCodeAt(f+1))return c=256*a.charCodeAt(f+5)+a.charCodeAt(f+6),b=256*a.charCodeAt(f+7)+a.charCodeAt(f+8),d=a.charCodeAt(f+9),[b,c,d];f+=2,e=256*a.charCodeAt(f)+a.charCodeAt(f+1)}},u=function(a){var b=a[0]<<8|a[1];if(65496!==b)throw new Error("Supplied data is not a JPEG");for(var c,d,e,f,g=a.length,h=(a[4]<<8)+a[5],i=4;g>i;){if(i+=h,c=v(a,i),h=(c[2]<<8)+c[3],(192===c[1]||194===c[1])&&255===c[0]&&h>7)return c=v(a,i+5),d=(c[2]<<8)+c[3],e=(c[0]<<8)+c[1],f=c[4],{width:d,height:e,numcomponents:f};i+=2}throw new Error("getJpegSizeFromBytes could not find the size of the image")},v=function(a,b){return a.subarray(b,b+5)};a.processJPEG=function(a,b,c,d,e){var f,g=this.color_spaces.DEVICE_RGB,h=this.decode.DCT_DECODE,i=8;return this.isString(a)?(f=t(a),this.createImageInfo(a,f[0],f[1],1==f[3]?this.color_spaces.DEVICE_GRAY:g,i,h,b,c)):(this.isArrayBuffer(a)&&(a=new Uint8Array(a)),this.isArrayBufferView(a)?(f=u(a),a=e||this.arrayBufferToBinaryString(a),this.createImageInfo(a,f.width,f.height,1==f.numcomponents?this.color_spaces.DEVICE_GRAY:g,i,h,b,c)):null)},a.processJPG=function(){return this.processJPEG.apply(this,arguments)}}(c.API);var ya=ya||function(a){if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var b=a.document,c=function(){return a.URL||a.webkitURL||a},d=b.createElementNS("http://www.w3.org/1999/xhtml","a"),e="download"in d,f=function(a){var b=new MouseEvent("click");a.dispatchEvent(b)},g=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),h=a.webkitRequestFileSystem,i=a.requestFileSystem||h||a.mozRequestFileSystem,j=function(b){(a.setImmediate||a.setTimeout)(function(){throw b},0)},k="application/octet-stream",l=0,m=500,n=function(b){var d=function(){"string"==typeof b?c().revokeObjectURL(b):b.remove()};a.chrome?d():setTimeout(d,m)},o=function(a,b,c){b=[].concat(b);for(var d=b.length;d--;){var e=a["on"+b[d]];if("function"==typeof e)try{e.call(a,c||a)}catch(f){j(f)}}},p=function(a){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\ufeff",a],{type:a.type}):a},q=function(b,j,m){m||(b=p(b));var q,r,s,t=this,u=b.type,v=!1,w=function(){o(t,"writestart progress write writeend".split(" "))},x=function(){if(r&&g&&"undefined"!=typeof FileReader){var d=new FileReader;return d.onloadend=function(){var a=d.result;r.location.href="data:attachment/file"+a.slice(a.search(/[,;]/)),t.readyState=t.DONE,w()},d.readAsDataURL(b),void(t.readyState=t.INIT)}if(!v&&q||(q=c().createObjectURL(b)),r)r.location.href=q;else{var e=a.open(q,"_blank");void 0==e&&g&&(a.location.href=q)}t.readyState=t.DONE,w(),n(q)},y=function(a){return function(){return t.readyState!==t.DONE?a.apply(this,arguments):void 0}},z={create:!0,exclusive:!1};return t.readyState=t.INIT,j||(j="download"),e?(q=c().createObjectURL(b),void setTimeout(function(){d.href=q,d.download=j,f(d),w(),n(q),t.readyState=t.DONE})):(a.chrome&&u&&u!==k&&(s=b.slice||b.webkitSlice,b=s.call(b,0,b.size,k),v=!0),h&&"download"!==j&&(j+=".download"),(u===k||h)&&(r=a),i?(l+=b.size,void i(a.TEMPORARY,l,y(function(a){a.root.getDirectory("saved",z,y(function(a){var c=function(){a.getFile(j,z,y(function(a){a.createWriter(y(function(c){c.onwriteend=function(b){r.location.href=a.toURL(),t.readyState=t.DONE,o(t,"writeend",b),n(a)},c.onerror=function(){var a=c.error;a.code!==a.ABORT_ERR&&x()},"writestart progress write abort".split(" ").forEach(function(a){c["on"+a]=t["on"+a]}),c.write(b),t.abort=function(){c.abort(),t.readyState=t.DONE},t.readyState=t.WRITING}),x)}),x)};a.getFile(j,{create:!1},y(function(a){a.remove(),c()}),y(function(a){a.code===a.NOT_FOUND_ERR?c():x()}))}),x)}),x)):void x())},r=q.prototype,s=function(a,b,c){return new q(a,b,c)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(a,b,c){return c||(a=p(a)),navigator.msSaveOrOpenBlob(a,b||"download")}:(r.abort=function(){var a=this;a.readyState=a.DONE,o(a,"abort")},r.readyState=r.INIT=0,r.WRITING=1,r.DONE=2,r.error=r.onwritestart=r.onprogress=r.onwrite=r.onabort=r.onerror=r.onwriteend=null,s)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||(void 0).content);for(var za in c.API)c.API.hasOwnProperty(za)&&("events"===za&&c.API.events.length?!function(a,b){var c,d,e;for(e=b.length-1;-1!==e;e--)c=b[e][0],d=b[e][1],a.subscribe.apply(a,[c].concat("function"==typeof d?[d]:d))}(Q,c.API.events):P[za]=c.API[za]);return ha(),l="F1",pa(i,g),Q.publish("initialized"),P}var d="1.3",e={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]},f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};return c.API={events:[]},c.version="1.0.0-trunk","function"==typeof define&&define.amd?define("JsPDF",[],function(){return c}):"undefined"!=typeof module&&module.exports?module.exports=c:a.JsPDF=c,c}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this);define("libs/jspdf",function(){}),define("registry/print",["jquery","underscore","customConstants","bifit","dialogUtils","text!templates/print/wrapper.tmpl","i18n!nls/print","i18n!nls/registration","canvasPrinter","libs/jspdf"],function(a,b,c,d,e,f,g,h,i){"use strict";var j={"01":"січня","02":"лютого","03":"березня","04":"квітня","05":"травня","06":"червня","07":"липня","08":"серпня","09":"вересня",10:"жовтня",11:"листопада",12:"грудня"};return{_createForm:function(){var e=a("<div id='reg-print-wrapper' class='modal show'>").appendTo(a("body").addClass("no-scroll")),i=a("<div id='reg-print-form'>").appendTo(e),j=b.extend({bnk_name:"",is_landscape_oriented:!1,is_key_certificate:!0,is_sertificate_security:c.CERTIFICATE_SECURITY_NEED_PRINT},g);i.html(b.template(f,j));var k=i.find("header.main");return"#admin_key"===window.location.hash?a("<h1 class='cert'>").html(g.cert).appendTo(k):a("<div class='help-info'>").html("<div id='help-info-header'>"+h.registration_over_header+"</div><div>"+h.registration_over_message+"</div>").appendTo(k),i.ready(function(){i.find(".exit").bind("click",function(){"#admin_key"===window.location.hash?e.remove():to_index()}),i.find(".print.show-sub-menu").bind("click",function(a){d.showSubMenu(a)}),i.find(".print-to-printer").bind("click",function(a){a.preventDefault(),window.print()}),i.find(".print-to-pdf").bind("click",function(b){b.preventDefault();var d=new JsPDF("p","mm","a4"),e=i.find("#print0")[0],f=e.toDataURL("image/jpeg",1);d.addImage(f,"JPEG",10,10,190,277);var g=a("div#doc-div div.security_info");if(c.CERTIFICATE_SECURITY_NEED_PRINT&&g.length>0){var h=0,j=function(){var b=g[h++].cloneNode(!0),c=b.style;c.position="relative",c.top=window.innerHeight+"px",document.body.appendChild(b);var e=a(b);e.width(760),e.height(1050),html2canvas(e,{background:"#FFFFFF",onrendered:function(a){document.body.removeChild(b),d.addImage(a.toDataURL("image/jpeg",1),"JPEG",0,0,210,297),h===g.length?d.save("certificate.pdf"):(d.addPage(),j())}})};d.addPage(),j()}else d.save("certificate.pdf")})}),i},_preparePublKey:function(a){a=a.toUpperCase();for(var b="",c=0,d=a.length;d>c;c+=2)b+=a[c]+a[c+1]+" ";return b},print:function(d,e){a.ajax({url:localStorage.getItem("bank_url")+"uweb/registry/cert_print_props"}).done(function(a){e=e||this._createForm();var f=new i(e.find("#doc-div")),g=10,h=10,k=d.get("creation_date").split("."),l=d.get("token_serial")||"Відсутній (звичайний носій)",m=function(a){return{width:a||"100%",border:"bottom"}},n=(b.findWhere(a,{idd:"certificate.print.bank_name"})||{}).value,o=(b.findWhere(a,{idd:"certificate.company.print.head"})||{}).value,p=(b.findWhere(a,{idd:"certificate.print.system_name"})||{}).value,q="true"===(b.findWhere(a,{idd:"certificate_security.can_print"})||{}).value;o?(f.from(h,g).style({"font-style":"bold","margin-bottom":3,"text-align":"right"}),b.each(o.split("^"),function(a){f.from(h,f.y).wrapText(a).nl()}),f.from(h,f.y).nl(15)):f.from(h,g).style({"font-style":"bold","margin-bottom":3,"text-align":"right"}).text("Додаток №2").nl().text("до Договору на обслуговування").nl().text('клієнтів у Системі "'+(p||"")+'"').nl().text('N ________ від "____" _________ 20___ р.').nl(15),f.from(h,f.y).style({"text-align":"center"}).text("СЕРТИФІКАТ ВІДКРИТОГО КЛЮЧА ЕЦП КЛІЄНТА").nl().text('У СИСТЕМІ "'+(p||"")+'"').nl(),n&&f.from(h,f.y).text(n).nl(),f.from(h,f.y).style({border:"bottom","font-style":"","margin-left":8}).space(250).text(k[0],{width:35}).text(j[k[1]],{width:65}).text(k[2],{width:50,"padding-left":0}).style({border:"none","margin-left":3}).text("p.",{"text-align":"left"}).nl().text("(Дата реєстрації відкритого ключа ЕЦП клієнта)",{style:"italic"}).nl().style({"text-align":"left","font-size":11,"padding-left":2,"padding-bottom":3}).text("1. Найменування організації").text(d.get("name_cln"),m()).nl().text("2. Юридична адреса").text(d.get("addr_cln"),m()).nl().text("3. Поштова адреса").text("",m()).nl().text("4. Найменування документа про реєстрацію, ким і коли виданий").text("",m()).nl().text("",m()).nl().text("5. Тел.").text(d.get("phone_cln"),m(200)).text("6. ЄДРПОУ").text(d.get("okpo"),m()).nl().text("7. Факс.").text(d.get("fax_cln"),m(200)).text("8. E-mail").text(d.get("email_cln"),m()).nl().text("9. Відомості про власника відкритого ключа ЕЦП").nl().space(15).text("Прізвище, Ім'я, По батькові").text(d.get("key_owner_name"),m()).nl().space(15).text("Посада").text(d.get("position"),m()).nl().space(15).text("Посвідчення особи").text("",m(400)).text("серія").text("",m()).nl().space(15).text("номер").text("",m(100)).text("ким виданий").text("",m()).nl().space(15).text("",m(300)).text('дата видачі "').text("",m(50)).text('"').text("",m(186)).text("року").nl().text("10. Примітки").text("",m()).nl(20).space(400).text("Особистий підпис",{"padding-top":8}).space(10).text("",{width:165,padding:"18",border:"total"}).nl().style({margin:"4 3"}).text("Відкритий ключ ЕЦП клієнта",{"font-style":"bold",padding:6,"text-align":"center"}).nl().text("Ідентифікатор ключа клієнта",{width:250}).text(d.get("id_key"),{width:200,border:"bottom","padding-left":10}).nl().text("Ідентифікатор смарт-карти клієнта",{width:250}).text(l,{width:200,border:"bottom","padding-left":10}).nl().text("Представлення відкритого ключа ЕЦП у шістнадцятковому вигляді").nl(15).space(25).wrapText(this._preparePublKey(d.get("publ_key")),{width:440,"font-family":"Courier New"}).nl().style({"font-size":10}).text("Група підпису*").text(d.get("sign_group"),m()).space(-300).text("(відповідно до картки підписів у банку)",{"text-align":"right"}).nl(-8).style({"font-size":9}).text("*вказати один з варіантів: 0 - без права підпису,1 - перший підпис, 2 - другий підпис, 3 - третій підпис, ..., 8 - восьмий підпис.").nl().text("Достовірність приведених даних підтверджую",{"font-style":"bold",padding:2}).nl(-10);var r=function(a,b,c,d,e,g){f.from(a,b).style({margin:"18 3"}).text(c).nl(8).style({"text-align":"center",border:"top"}).text("П.І.Б",{width:300}).nl().text("підпис",{width:300}).nl().style({border:"none","text-align":"left"}).text('"____" _____________ 20___ р.').nl().text(d,{border:"total",width:145,"padding-top":e||100,"padding-bottom":g||12,"text-align":"center"})};g=f.y,r(h,g,"Керівник організації","Відбиток печатки"),r(h+345,g,"Уповноважений представник банку","Відбиток печатки/штампу",92,20),f.from(f.x-90,f.y+100).text("банку"),f.close(),c.CERTIFICATE_SECURITY_NEED_PRINT&&q&&require(["text!registry/templates/print_security.tmpl",isDeveloperMode?"libs/html2canvas":"libs/html2canvas."+cfg.version.any],function(a){var c=window.location.protocol+"//"+window.location.host+"/print-logo/logo",f=b.template(a,b.extend({img_url:c,name_cln:"",okpo:"",phone_cln:""},d.attributes||d));e.find("div#doc-div").append(f)})}.bind(this))}}}),define("nls/document",{root:{confirm_delete_doc:"Вы действительно хотите удалить документ?",confirm_delete_many_doc:"Вы действительно хотите удалить выбранные документы?",confirm_unload_edit_page:"Эта страница просит вас подтвердить, что вы хотите уйти - при этом введённые вами данные могут не сохраниться",status:"Статус",group_view_sign:"Подпись документа № {1} на сумму {2} {3}",group_view_sign_2:"Подпись документа № {1}",group_view_copy:"Копирование документа № {1} на сумму {2} {3} в документ № {4}",group_view_copy_2:"Копирование документа № {1} в документ № {2}",group_view_delete:"Удаление документа № {1} на сумму {2} {3}",group_view_delete_2:"Удаление документа № {1}",group_view_import:"Импорт документа {1} на сумму {2} {3}",group_view_import_short:"Импорт документа {1}",group_view_confirm:"Подтверждение документа № {1} на сумму {2}",group_view_reject:"Отклонение документа № {1} на сумму {2}",group_view_delete_h1:"Удаление документов",group_view_sign_h1:"Подпись документов",group_view_copy_h1:"Копирование документов",group_view_import_h1:"Результат импорта документов",group_view_confirm_h1:"Подтверждение документов",group_view_reject_h1:"Отклонение документов",import_result_start_processing:"Начало обработки файла - ",import_result_end_processing:"Результат обработки файла: ",import_result_completed:"Импорт завершен ",import_result_total_files:"Всего обработано файлов: ",import_result_total_documents:"Обработано документов: ",import_result_success_documents:"Успешно импортировано документов: ",import_result_successful:"Успешно импортировано",import_result_failed:"Импорт не выполнен",import_result_partial:"Импорт выполнен частично",import_result_info:"импортировано документов {1} из {2}",save_comment:"Добавлен комментарий",delete_comment:"Удален комментарий",sign_delivery:"Синхронизация с банком",empty_list:"Отсутствуют документы, удовлетворяющие условиям фильтрации.",empty_list_desc:"Попытайтесь осуществить поиск документов по другим условиям.",list_load:"Получение списка документов...",to_list:"Вернуться к списку",error:"Ошибка",fetch_error:"Ошибка при получении списка документов",fetch_error_text:'У Вас отсутствуют права на работу с данным типом документов - "{1}". Обратитесь в отдел технический поддержки банка, который вас обслуживает.',fetch_history_error:"Ошибка при получении истории документа",fetch_import_error:"Ошибка при импорте документов.",fetch_recall_error:"Ошибка отзыва документа.",show_docs:"Показать список",hide_docs:"Скрыть",incorrect_import_file:'Файл не является файлом импорта документа "{1}" в формате {2}.',UAH:"грн",RUB:"руб",USD:"$",EUR:"€",recall_doc:"Укажите причину отзыва документа",flt_st:"В статусе &quot;{1}&quot;",cd_confirm_title:"Подтверждение",cd_choice:"Выберите удобный вам способ подтверждения:",cd_otp:"OTP-токен",cd_google:"Google Authenticator",cd_sms:"SMS",cd_lang:"Язык",cd_ua:"Украинский",cd_ru:"Русский",cd_ruT:"Русский транслитерация",cd_uaT:"Украинский транслитерация",cd_translit:"транслитерация",cd_confirm:"Подтвердить",cd_cancel:"Отмена",cd_to_way:"Выбрать другой способ",cd_send_sms:"Получить sms",cd_sms_title:"SMS-Подтверждение",cd_sms_1:"На ваш номер",cd_sms_2:"было отправлено sms с паролем подтверждения, введите код из sms в поле:",cd_otp_title:"OTP-Подтверждение",cd_otp_text:"Введите одноразовый пароль из вашего токена:",cd_google_title:"Google Authenticator",cd_google_text:'Введите пароль, сгенерированный приложением Google Authenticator и нажмите "Подтвердить".',cd_empty_text:"Подтверждение документа временно не доступно. Система поддерживает только подтверждение по sms.",recall_title:"Отозвать документ №{1} от {2} по причине",recall_reason:"Добровольный отзыв документа",recall_link_btn:"Отозвать",close_link_btn:"Закрыть",recall_already_exist:"Отзыв на документ уже существует",recall_error_msg:"Хотите удалить существующий отзыв и создать новый?",reject_doc_title:"Отвергнуть документ по причине",reject_docs_title:"Отвергнуть документы по причине",reject_link_btn:"Отвергнуть",client_not_found:"Невозможно идентифицировать клиента",client_with_name_not_found:"Клиент с наименованием {1} не найден",client_with_okpo_not_found:"Не найден клиент с таким ЕГРПОУ",cl_okpo:"ЕГРПОУ",cl_country_code:"Код страны",attach_load_error:'Ошибка при загрузке вложения "{1}"',attach_save_error:'Ошибка при сохранении вложения "{1}"',attach_delete_error:'Ошибка при удалении вложения "{1}"',attach_has_not_allowed_extension:"К документу прикреплены файлы с расширениями, которые не входят в список разрешенных ({1}). Удалите такие файлы и попробуйте подписать документ повторно",extensions_that_allowed_to_be_attached:"К документу могут быть прикреплены только файлы с расширением: {1}"},uk:!0,en:!0}),define("nls/uk/document",{confirm_delete_doc:"Ви дійсно бажаєте вилучити документ?",confirm_delete_many_doc:"Ви дійсно бажаєте вилучити обрані документи?",confirm_unload_edit_page:"Сторінка просить підтвердити, що ви хочете її покинути. Введені дані можуть бути не збережені.",status:"Статус",group_view_sign:"Підпис документа № {1} на суму {2} {3}",group_view_sign_2:"Підпис документа № {1}",group_view_copy:"Копіювання документа № {1} на суму {2} {3} в документ № {4}",group_view_copy_2:"Копіювання документа № {1} в документ № {2}",group_view_delete:"Видалення документа № {1} на суму {2} {3}",group_view_delete_2:"Видалення документа № {1}",group_view_import:"Імпорт документа {1} на суму {2} {3}",group_view_import_short:"Імпорт документа {1}",group_view_confirm:"Підтверждення документа № {1} на суму {2}",group_view_reject:"Відхилення документа № {1} на суму {2}",group_view_delete_h1:"Видалення документів",group_view_sign_h1:"Підпис документів",group_view_copy_h1:"Копіювання документів",group_view_import_h1:"Результат імпорту документів",group_view_confirm_h1:"Підтверждення документів",group_view_reject_h1:"Відхилення документів",import_result_start_processing:"Початок обробки файлу - ",import_result_end_processing:"Результат обробки файлу: ",import_result_completed:"Імпорт завершений ",import_result_total_files:"Усього оброблено файлів: ",import_result_total_documents:"Оброблено документів: ",import_result_success_documents:"Успішно імпортовано документів: ",import_result_successful:"Успішно імпортовано",import_result_failed:"Імпорт не виконано",import_result_partial:"Імпорт виконано частково",import_result_info:"імпортовано документів {1} з {2}",status_bar_time:"Дата/час",status_bar_status:"Статус",status_bar_subj:"ПIБ",status_bar_desc:"Опис",save_comment:"Додано коментар",delete_comment:"Коментар вилучений",sign_delivery:"Синхронізація з банком",empty_list:"Жоден документ не відповідає умовам фільтрації.",empty_list_desc:"Спробуйте здійснити пошук документів за іншими умовами.",list_load:"Отримання списку документів ...",to_list:"Повернутися до списку",error:"Помилка",fetch_error:"Помилка при отриманні списку документів",fetch_error_text:'У Вас відсутні права на роботу з даним типом документів - "{1}". Зверніться до відділу технічної підтримки банку, що Вас обслуговує.',fetch_history_error:"Помилка при отриманні історії документа",fetch_import_error:"Помилка під час імпорту документів.",fetch_recall_error:"Помилка відклику документа.",show_docs:"Показати список",hide_docs:"Сховати",incorrect_import_file:'Файл не є файлом імпорту документу "{1}" у форматі {2}.',UAH:"грн",RUB:"руб",USD:"$",EUR:"€",recall_doc:"Вкажіть причину відклика документа",flt_st:"У статусі &quot;{1}&quot;",cd_confirm_title:"Підтвердження",cd_choice:"Виберіть зручний вам спосіб підтвердження:",cd_otp:"OTP-токен",cd_google:"Google Authenticator",cd_sms:"SMS",cd_lang:"Мова",cd_ua:"Українська",cd_ru:"Російська",cd_ruT:"Російська транслітерація",cd_uaT:"Українська транслітерація",cd_translit:"транслітерація",cd_confirm:"Підтвердити",cd_cancel:"Відмінити",cd_to_way:"Обрати інший спосіб",cd_send_sms:"Отримати sms",cd_sms_title:"SMS-Підтвердження",cd_sms_1:"На ваш номер",cd_sms_2:"було надіслано sms з паролем підтвердження, введіть код з sms в полі:",cd_otp_title:"OTP-Підтвердження",cd_otp_text:"Введіть одноразовий пароль зі свого токену:",cd_google_title:"Google Authenticator",cd_google_text:'Введіть пароль, згенерований додатком Google Authenticator і натисніть "Підтвердити".',cd_empty_text:"Підтвердження документа тимчасово не доступно. Система підтримує тільки підтвердження по sms.",recall_title:"Відкликати документ №{1} від {2} по причині",recall_reason:"Добровільне відхилення документу",recall_link_btn:"Відкликати",close_link_btn:"Закрити",recall_already_exist:"Відкликання на документ вже існує",recall_error_msg:"Бажаєте вилучити існуюче відкликання та створити нове?",reject_doc_title:"Вiдхилити документ по причині",reject_docs_title:"Вiдхилити документи по причині",reject_link_btn:"Вiдхилити",client_not_found:"Неможливо ідентифікувати клієнта",client_with_name_not_found:"Клієнт з найменуванням {1} не знайдений",client_with_okpo_not_found:"Не знайдений клiєнт iз таким ЄДРПОУ",cl_okpo:"ЄДРПОУ",cl_country_code:"Код країни",attach_load_error:'Помилка при завантаженні вкладення "{1}"',attach_save_error:'Помилка при збереженні вкладення "{1}"',attach_delete_error:'Помилка при видаленні вкладення "{1}"',attach_has_not_allowed_extension:"До документа прикріплені файли з розширеннями, які не входять до списку дозволених ({1}). Вилучите такі файли та спробуйте підписати документ знову",extensions_that_allowed_to_be_attached:"До документа можуть бути прикріплені лише файли з розширенням: {1}"}),define("nls/en/document",{confirm_delete_doc:"Are you sure you want to delete the document?",confirm_delete_many_doc:"Are you sure you want to delete selected documents?",confirm_unload_edit_page:"This page is asking you to confirm that you want to leave - all entered data may not be saved",status:"Status",group_view_sign:"Signing of the document No{1} on amount {2} {3}",group_view_sign_2:"Signing of the document No{1}",group_view_copy:"Copying of the document No {1} at the amount {2} {3} to document No {4}",group_view_copy_2:"Copying of the document No {1} to document No {2}",group_view_delete:"Deleting of the document No{1} on amount {2} {3}",group_view_delete_2:"Deleting of the document No{1}",group_view_import:"Import of the document {1} on amount {2} {3}",group_view_import_short:"Import of document {1}",group_view_confirm:"Confirmation of the document No{1} on amount {2}",group_view_reject:"Rejecting of the document № {1} on amount {2}",group_view_delete_h1:"Deleting of documents",group_view_sign_h1:"Signing of documents",group_view_copy_h1:"Copying of documents",group_view_import_h1:"Result import of documents",group_view_confirm_h1:"Confirmation of documents",group_view_reject_h1:"Rejecting of documents",import_result_start_processing:"Start file processing - ",import_result_end_processing:"File processing result: ",import_result_completed:"Import completed ",import_result_total_files:"Total file processed: ",import_result_total_documents:"Processed documents: ",import_result_success_documents:"Successfully imported documents: ",import_result_successful:"Successfully imported",import_result_failed:"Import is failed",import_result_partial:"Import is partly completed",import_result_info:"imported documents {1} of {2}",save_comment:"Comment was added",delete_comment:"Comment was deleted",sign_delivery:"Synchronization with the bank",empty_list:"There are no documents that satisfy the filter conditions.",empty_list_desc:"Try searching the documents by other conditions.",list_load:"Loading of documents list…",to_list:"Back to the list",error:"Error",fetch_error:"Documents list getting error",fetch_error_text:'You don\'t have rights for work with this type of document - "{1}". Contact the technical support department of the bank, which serves you.',fetch_history_error:"Document history getting error",fetch_import_error:"Document import error.",fetch_recall_error:"Error of revocation document.",show_docs:"Show list",hide_docs:"Hide",incorrect_import_file:'File is not the import file of document "{1}" in the format {2}.',UAH:"hryv",RUB:"rub",USD:"$",EUR:"€",recall_doc:"Specify basis for document revocation",flt_st:"In status &quot;{1}&quot;",cd_confirm_title:"Confirmation",cd_choice:"Choose way of confirmation:",cd_otp:"OTP-token",cd_google:"Google Authenticator",cd_sms:"SMS",cd_lang:"Language",cd_ua:"Ukrainian",cd_ru:"Russian",cd_ruT:"Russian transliteration",cd_uaT:"Ukrainian transliteration",cd_translit:"transliteration",cd_confirm:"Confirm",cd_cancel:"Cancel",cd_to_way:"Select another way",cd_send_sms:"Receive sms",cd_sms_title:"SMS-Confirmation",cd_sms_1:"On your number",cd_sms_2:"was sent sms with confirmation password, enter password in the field:",cd_otp_title:"OTP-Confirmation",cd_otp_text:"Enter a one-time password from your token:",cd_google_title:"Google Authenticator",cd_google_text:'Enter the password generated by Google Authenticator app and click "Confirm".',cd_empty_text:"Confirmation of document is temporarily unavailable. The system supports only confirmation by sms.",recall_title:"Revoke the document No{1} from {2} with reason",recall_reason:"Voluntary recall of the document",recall_link_btn:"Revoke",close_link_btn:"Close",recall_already_exist:"Revocation of the document has been already created",recall_error_msg:"Do you want to delete an existing revocation and create a new one?",reject_doc_title:"Reject the document with reason",reject_docs_title:"Reject the documents with reason",reject_link_btn:"Reject",client_not_found:"Can't identify client",client_with_name_not_found:"Client with name {1} wasn't found",client_with_okpo_not_found:"Client with given EDRPOU is not found",cl_okpo:"EDRPOU",cl_country_code:"Country code",attach_load_error:'Error on load attachment "{1}"',attach_save_error:'Error on save attachment "{1}"',attach_delete_error:'Error on delete attachment "{1}"',attach_has_not_allowed_extension:"Some document attachments have extensions that are not included in the allowed list ({1}). Delete these attachments and try signing the document again",extensions_that_allowed_to_be_attached:"Extensions that allowed to be attached: {1}"}),define("text!apps/ua_payment/templates/confirm/way.tmpl",[],function(){return'<h2 class="confirm-title"><%- cd_confirm_title %></h2>\n<%- cd_choice %>\n\n<ul>\n    <li class="hidden" id=\'confirm-google\'>\n        <label>\n            <input type="checkbox" value="google"/>\n            <span class="checkbox"></span>\n            <%- cd_google %>\n        </label>\n    </li>\n    <li class="hidden" id=\'confirm-otp\'>\n        <label>\n            <input type="checkbox" value="otp"/>\n            <span class="checkbox"></span>\n            <%- cd_otp %>\n        </label>\n    </li>\n    <li class="hidden" id=\'confirm-sms\'>\n        <label>\n            <input type="checkbox" value="sms"/>\n            <span class="checkbox"></span>\n            <%- cd_sms %>\n        </label>\n    </li>\n</ul>\n\n<div class="hidden" id="select-lang">\n    <label for="lang"><%- cd_lang %></label>\n    <input id="lang" type=\'text\'/>\n</div>\n\n<br/>\n<button type="button" class="primary navigate"><%- cd_confirm %></button>\n<button type="button" class="exit"><%- cd_cancel %></button>\n'}),define("text!apps/ua_payment/templates/confirm/sms.tmpl",[],function(){return'<% if (has_way) { %>\n<a href="#" class="way"><%- cd_to_way %></a>\n<% } %>\n\n<h2 class="confirm-title"><%- cd_sms_title %></h2>\n<label for="sms-pswd"><%- cd_sms_1 %>&nbsp;<%- empl_phone %>&nbsp;<%- cd_sms_2 %></label>\n<input type="text" class="temp_pswd" id="sms-pswd"/>\n\n<br/>\n<button type="button" class="confirm primary"><%- cd_confirm %></button>\n<button type="button" class="resend"><%- cd_send_sms %></button>\n<button type="button" class="exit"><%- cd_cancel %></button>\n'}),define("text!apps/ua_payment/templates/confirm/otp.tmpl",[],function(){return'<% if (has_way) { %>\n<a href="#" class="way"><%- cd_to_way %></a>\n<% } %>\n\n<h2 class="confirm-title"><%- cd_otp_title %></h2>\n\n<label for="otp-pswd"><%- cd_otp_text %></label>\n<input type="text" class="temp_pswd" id="otp-pswd"/>\n<input type="text" class="temp_pswd" id="token-serial"/>\n\n<br/>\n<button type="button" class="confirm primary"><%- cd_confirm %></button>\n<button type="button" class="exit"><%- cd_cancel %></button>\n'}),define("text!apps/ua_payment/templates/confirm/google.tmpl",[],function(){return'<% if (has_way) { %>\n<a href="#" class="way"><%- cd_to_way %></a>\n<% } %>\n\n<h2 class="confirm-title"><%- cd_google_title %></h2>\n\n<label for="otp-pswd"><%- cd_google_text %></label>\n<input type="text" class="temp_pswd" id="otp-pswd"/>\n\n<br/>\n<button type="button" class="confirm primary"><%- cd_confirm %></button>\n<button type="button" class="exit"><%- cd_cancel %></button>\n'}),define("text!apps/ua_payment/templates/confirm/empty.tmpl",[],function(){return'<h2 class="confirm-title"><%- cd_confirm_title %></h2>\n<%- cd_empty_text %>\n<br/>\n<br/>\n<button type="button" class="exit"><%- cd_cancel %></button>\n'}),function(a){"use strict";function b(b){var c=document.body,d=b[0].offsetHeight,e=b[0].getBoundingClientRect().top,f=b.parent().find(".scrollbox"),g=f.height(),h=parseInt(f.css("top")),i=a(document).scrollTop()+d+e+g;i>c.scrollHeight?g!==h&&f.css("top",-g+"px"):g!==h&&f.css("top",d+"px")}var c,d=function(b){var c=a(b.target),d=a("ul.drop-down:visible");if(c.is("input")||c.is("span.drop-down")||c.is("div.multiselect *")){if(d.length>0){var e=c.closest("div.chosen").find("ul.drop-down")[0];d.each(function(){this!==e&&a(this).trigger("hide")})}}else c.is(".scrollbox")||c.is(".scrollbar")||(d.trigger("hide"),a(window).off("resize",f))},e=function(a){b(a)},f=function(a){clearTimeout(c),c=setTimeout(e,250,a.data)};a.fn.chosen=function(c){var e=!!c.data.selection,g=function(a,b){c.renderInput&&c.renderInput(a,c.data,b)},h=function(a,b){return"string"==typeof a?a:"undefined"!=typeof a.get?a.get(b):a[b]},i=function(b,c){var d="";if(a.isArray(c))for(var e=0;e<c.length;e++)e>0&&(d+=" "),d+=h(b,c[e]);else d=h(b,c);return d},j=function(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};return String(a).replace(/[&<>"'\/]/g,function(a){
return b[a]})};c=a.extend({render:function(a,b,d){var f=i(a,c.data.text);if(b&&0!==b.length){d=d||0;var g=j(f.substr(0,d)),k=j(f.substr(d,b.length)),l=j(f.substr(d+b.length));f=g+"<em>"+k+"</em>"+l}else f=j(f);if(c.accType&&a.type_desc&&(f+='<span class="acc-type-desc">'+a.type_desc+"</span>"),a.client_comment&&(f+="</br>"+j(a.client_comment)),e){a.client_comment&&(f='<div class="multiselect-comment">'+f+"</div>");var m=h(a,c.data.id),n=c.data.selection[m]?' checked="checked"':"";"all"===m&&c.data.all&&(f='<span style="font-weight: bold">'+h(a,"text")+"</span>"),f='<input type="checkbox"'+n+'/><span class="checkbox"></span>'+f}return a.client_comment?"<div>"+f+"</div>":f},strictCondition:function(a,b){return void 0!==a[b]},"class":"",width:"100%",duration:250,searchable:!0,strict:!1,ignoreCase:!0,inputId:!1,stripOptionSize:!0,maxHeight:200,pageSize:100,preloadText:"",data:{id:"",text:null,array:[]}},c);var k=function(a){var b=["/",".","*","+","?","|","(",")","[","]","{","}","\\","^","$"],c=new RegExp("(\\"+b.join("|\\")+")","g");return a.replace(c,"\\$1")},l={},m=function(){l={},a.each(c.data.array,function(a,b){l[h(b,c.data.id)]=b})};m();var n=function(a){a.show().slideDown(c.duration,function(){var b=a.closest("div.scrollbox");b.css("height",Math.min(a.height()+10,c.maxHeight)),b.css("z-index",20),b.attr("data-tmp","tmp_"+Math.random()),b.trigger("scrollbox-change")})},o=e?function(b,d,e){var f,h=a(b.target),i=h.is("li")?h:h.closest("li");if(h.is("input"))f=h.prop("checked");else{var j=i.find("input");f=!j.prop("checked"),j.prop("checked",f)}var k=i.data("id"),l=c.data.selection;f?"all"===k&&c.data.all?a.each(c.data.array,function(a,b){l[b[c.data.id]]=!0}):l[k]=!0:"all"===k&&c.data.all?a.each(c.data.array,function(a,b){delete l[b[c.data.id]]}):delete l[k],e.trigger("group:itemSelected",[k,c.data]),c.searchable||g(e,k),d.find("li").each(function(b,d){var e=a(d),f=e.data("id");e.find("input").prop("checked",!!c.data.selection[f])})}:function(b,d,e,g){d.trigger("hide").find(".current").removeClass("current");var h=a(b.target);h.is("li")||(h=h.closest("li")),d.find("span.marked").remove(),a(window).off("resize",f);var j=h.addClass("current").removeClass("hover").data("id");h.append(a("<span/>").addClass("marked"));var k=l[j],m=i(k,c.data.text),n=e.val();c.searchable?g(m):e.val(m).change(),e.trigger("chosen:select",[k,n])},p=function(){var a=c.data.selection;for(var b in a)a.hasOwnProperty(b)&&delete a[b]};return this.each(function(){function q(){var a=c.data.id,d=c.data.text,e=c.data.array;x.border=x.filteredArray.length?x.filteredArray.length:e.length;for(var f=x.border>c.pageSize?c.pageSize:x.border,g="",j=0;f>j&&x.lastElement<x.border;j++,x.lastElement++){var k,l,m=c.stripOptionSize?"ellipsis":"";if(c.searchable&&x.search){if(0===x.filteredArray.length)break;k=x.filteredArray[x.lastElement].model,k.parentClass&&(m+=" "+k.parentClass),l=c.render(k,r.val(),x.filteredArray[x.lastElement].pos)}else k=e[x.lastElement],k.parentClass&&(m+=" "+k.parentClass),l=c.render(k);l="<span>"+l+"</span>"||"&nbsp;",c.searchable||r.val()!==i(k,d)||(m+=" current",l+='<span class="marked"/>'),g+="<li data-id='"+h(k,a)+"' class='"+m+"'>"+l+"</li>"}g?(r.removeClass("empty"),u.append(g),u.find('input[checked="checked"]').removeAttr("checked").prop("checked",!0),x.search?u.addClass("search"):u.removeClass("search")):(r.addClass("empty"),u.removeClass("search")),n(u),x.isDropDownUpdated=!0,r.hasClass("expanded")&&b(r)}var r=a(this).attr({autocomplete:"off",readonly:!c.searchable}).addClass("select-box");c.searchable||r.on("focus",this.blur),r.bind("refresh",function(a,b){if(c.data.array=b.array,e&&(p(),c.data.array.length>1&&c.data.all)){var d={};d[c.data.id]="all",d.text=c.data.all,c.data.array.unshift(d)}m(),c.preloadText="";var f=r.data("spinner");f&&(f.stop(),r.removeData("spinner")),y(b.value||"")}),r.bind("choose",function(a,b){c.pageSize=c.data.array.length,y(b),c.searchable&&u.children().length>0&&u.children()[0].click()}),r.bind("choose:group",function(a,b){c.data.selection=b,g(r)}),r.bind("chooseById",function(a,b){c.pageSize=c.data.array.length,y(""),u.find('li[data-id="'+b+'"]').click()}),r.bind("empty",function(){y(""),e&&p()});var s=a("<div>",{width:r.width()&&r.outerWidth()?r.outerWidth():c.width,"class":"chosen"}).css("margin",r.css("margin"));c["class"]&&s.addClass(c["class"]);var t=r.is(":focus");r.wrap(s),t&&r.focus();var u=a("<ul>",{"class":"drop-down"}).hide();c.searchable?u.addClass("searchable"):u.addClass("selectonly non-searchable"),u.on("click","li",function(a){o(a,u,r,y)}).on("mouseover","li",function(b){var c=u.find("li.hover");c.length>0&&c.removeClass("hover"),a(b.target).closest("li").addClass("hover")}),r.keydown(function(b){if(9===b.keyCode)u.trigger("hide"),a(window).off("resize",f);else if(r.hasClass("expanded")){var c=u.find("li.hover");if(1===c.length){var d=u.closest("div.scrollbox"),e=d.get(0).directiveScrollbox;if(38!==b.keyCode||c.is("li:first-child"))if(40!==b.keyCode||c.is("li:last-child")){if(13===b.keyCode)return c.trigger("click"),!1}else c.removeClass("hover").next().addClass("hover"),e&&d.get(0).directiveScrollbox.scroll(-c.innerHeight());else c.removeClass("hover").prev().addClass("hover"),e&&e.scroll(c.innerHeight())}else u.children(":first").addClass("hover")}else u.trigger("show")});var v=e?"scrollbox multiselect":"scrollbox",w=a('<div class="'+v+'"></div>');r[0].offsetHeight&&w.css("top",r[0].offsetHeight),u.insertAfter(r).wrap(w),c.searchable?r.keyup(function(b){-1===a.inArray(b.keyCode,new Array(9,13,16,33,34,35,36,37,38,39,40))&&y(r.val()?r.val():"")}):r.after(a("<span/>").addClass("drop-down").on("click",function(a){d(a),r.is("[disabled]")||u.trigger("toggle")}));var x={search:"",filteredArray:[],border:0,lastElement:0,isDropDownUpdated:!0},y=function(a){if(r.val()!==a&&r.val(a).change(),a||(x.filteredArray=[],x.search="",x.lastElement=0),c.preloadText.length>0){u.html("<li class='spinner'><span>"+j(c.preloadText)+"</span></li>");var b={lines:8,length:0,color:"#AAA",corners:1,zIndex:100,width:6,radius:10,left:5,top:0,position:"relative"};return r.data("spinner",new Spinner(b).spin(u.find("li")[0])),void n(u)}if(c.searchable&&0!==a.length){var d,e=k(a);c.ignoreCase&&(d="i"),a=new RegExp(e,d)}var f=c.data.text,g=c.data.array;if(x.search="",x.filteredArray=[],a&&(x.lastElement=0),c.searchable&&a){x.search=a;for(var h=0;h<g.length;h++){var l=g[h],m=i(l,f),o=m.search(a);-1!==o&&x.filteredArray.push({model:l,pos:o})}}u.empty(),q()};e?(y(""),g(r)):y(r.val()),u.bind("drop-down-scroll-bottom",function(){x.isDropDownUpdated&&x.lastElement<x.border&&(x.isDropDownUpdated=!1,q())}),u.bind("show",function(){return u.is(":animated")||r.hasClass("expanded")||(b(r),r.addClass("expanded"),a(window).off("resize",f),a(window).on("resize",r,f),e&&c.searchable?y(""):n(u)),!1});var z=!1;u.bind("hide",function(){return z=!1,r.removeClass("expanded"),u.hide(),c.strict&&0!==r.val().length&&(c.strictCondition(l,r.val())||y("")),g(r),e&&r.trigger("chosen:group:selected"),!1}),u.bind("toggle",function(){r.hasClass("expanded")?(u.trigger("hide"),a(window).off("resize",f)):u.trigger("show")}),u.bind("mouseover",function(){z=!0}).bind("mouseout",function(){z=!1}),r.bind("change",function(a){z?a.stopPropagation():c.searchable&&y(r.val()||"")}),r.click(function(a){u.trigger(c.searchable?"show":"toggle")}),a(document).off("click",d).on("click",d)})},a.fn.disposeChosen=function(){return this.each(function(){var b=a(this);b.parent().children(":not(input.select-box)").remove(),0===a(".chosen").length&&a(document).off("click",d),b.removeAttr("readonly").removeClass("select-box").unwrap(),b.off("focus")})}}(jQuery),define("chosen",["spinner"],function(){}),define("commons/base_object/base_confirm",["jquery","underscore","marionette","i18n!nls/document","text!apps/ua_payment/templates/confirm/way.tmpl","text!apps/ua_payment/templates/confirm/sms.tmpl","text!apps/ua_payment/templates/confirm/otp.tmpl","text!apps/ua_payment/templates/confirm/google.tmpl","text!apps/ua_payment/templates/confirm/empty.tmpl","chosen"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=c.ItemView.extend({className:"step",events:{"click .exit":"close","click .way":"way","click .confirm":"confirmByMouseClick","keypress .temp_pswd":"confirmByKeyboard"},smsLang:null,initialize:function(a){this.obtainable=a.obtainable},close:function(a){a.preventDefault(),this.trigger("navigate","close")},way:function(a){a.preventDefault(),this.trigger("navigate","way")},confirmByKeyboard:function(a){13===a.keyCode&&this.confirm(this.getConfirmParams())},confirmByMouseClick:function(){this.confirm(this.getConfirmParams())},render:function(){return this.$el.html(b.template(i,d)),this},dispose:function(){this.remove()},getConfirmParams:function(){},confirm:function(a){},afterRender:function(){},beforeDispose:function(){}}),k=j.extend({className:"way",events:b.extend({"click .navigate":"navigate","click ul input":"uncheckOther"},j.prototype.events),uncheckOther:function(a){b.each(this.obtainable,function(b){a.target.value!==b&&this.$("li#confirm-"+b+" input").prop("checked",!1)},this),this.$("div#select-lang").toggleClass("hidden",!this.$("li#confirm-sms input").prop("checked"))},navigate:function(a){a.preventDefault(),this.trigger("navigate",this.$("li input:checked").val())},render:function(){return this.$el.html(b.template(e,d)),b.each(this.obtainable,function(a){this.$("li#confirm-"+a).removeClass("hidden")},this),this.$("input#lang").chosen({width:"14em",searchable:!1,data:{array:[d.cd_ru,d.cd_ua,d.cd_ruT,d.cd_uaT]}}).trigger("choose",d.cd_uaT),this},beforeDispose:function(){j.prototype.smsLang=this.$("input#lang").val()}}),l=j.extend({getConfirmParams:function(){return{otp_type:"otp",otp:this.$("#otp-pswd").val(),token_serial:this.$("#token-serial").val()}},render:function(){var a=b.extend({has_way:this.obtainable.length>1},d);return this.$el.html(b.template(g,a)),this.loadTokenSerials(function(a){var b=this.$("#token-serial").chosen({searchable:!1,width:"10em",data:{array:a,id:"token_serial",text:"token_serial"}}),c=this.getEmployeeTokenSerial();1===a.length?b.attr("disabled","disabled").trigger("chooseById",a[0].token_serial):c&&b.trigger("chooseById",c)}.bind(this)),this},loadTokenSerials:function(a){},getEmployeeTokenSerial:function(){}}),m=j.extend({getConfirmParams:function(){return{otp_type:"google",otp:this.$("#otp-pswd").val()}},render:function(){var a=b.extend({has_way:this.obtainable.length>1},d);return this.$el.html(b.template(h,a)),this}}),n=j.extend({events:b.extend({"click .resend":"send","input #sms-pswd":"onChangePassword"},j.prototype.events),getConfirmParams:function(){return{otp_type:"sms",otp:this.$("#sms-pswd").val()}},send:function(){var b=parseInt(+(this.getSendAgainTimeProp()||"0"),10)||0,c=this.$(".resend");b&&setTimeout(function(){c.removeAttr("disabled")},1e3*b),c.attr("disabled","disabled");var e=this.$("input:last");a.ajax({url:this.getUrl("sms"),type:"post",dataType:"json",data:{LANG:-1!==j.prototype.smsLang.indexOf(d.cd_ua)?"uk_UA":"ru_RU",IS_TRANSLIT:-1!==j.prototype.smsLang.indexOf(d.cd_translit)},error:function(b){a("<div class='errors'>"+b.responseText+"</div> ").insertAfter(e)}})},render:function(){var a=b.extend({has_way:this.obtainable.length>1,empl_phone:this.getMobilePhone()},d);return this.$el.html(b.template(f,a)),this.$("button.confirm").prop("disabled",!0),this.send(),this},afterRender:function(){this.$("#sms-pswd").focus()},onChangePassword:function(a){this.$("button.confirm").prop("disabled",!a.target.value.length)},getMobilePhone:function(){},getSendAgainTimeProp:function(){},getUrl:function(a){}}),o={empty:j,way:k,otp:l,sms:n,google:m},p=c.ItemView.extend({className:"confirm",initialize:function(a){this.obtainable=a.obtainable,this.map=o},to:function(a){this.step&&this.step.beforeDispose(),this.disposeStep(),this.step=this.createStep(a),this.$el.html(this.step.render().$el),this.step.afterRender(),this.step.on("navigate",this.navigate,this)},createStep:function(a){var b=this.getOptions()||{};return b.obtainable=this.obtainable,b.model=this.model,new a(b)},navigate:function(a,b){"close"===a||"finish"===a?this.trigger("dispose","close"===a,b):this.map.hasOwnProperty(a)&&this.to(this.map[a])},getOptions:function(){},render:function(){},afterRender:function(){this.step&&this.step.afterRender()},disposeStep:function(){this.step&&(this.step.off("navigate",this.navigate,this),this.step.dispose(),delete this.step)},dispose:function(){this.disposeStep(),this.remove()}});return p.SMSView=n,p.OTPView=l,p.GoogleView=m,p.STEP_VIEWS_MAP=o,p}),define("views/ext_auth",["jquery","underscore","bifit","commons/base_object/base_confirm","chosen"],function(a,b,c,d){"use strict";var e=["onSuccess","authTypes","emplPhone","emplTokenSerial","sendAgainTime","tokenSerials"],f=function(a){var b=localStorage.getItem("addr");switch(a){case"sms":return c.sprintf("{1}/sms;jsessionid={2}",b,c.getStoredItem("JSESSIONID"));case"confirm":return c.sprintf("{1}/auth;jsessionid={2}",b,c.getStoredItem("JSESSIONID"))}},g=function(b){this.$("div.errors").remove(),a.ajax({url:f("confirm"),type:"post",dataType:"json",data:JSON.stringify(b),success:function(){this.options.onSuccess()}.bind(this),error:function(b){a("<div class='errors'>"+b.responseText+"</div>").insertBefore(this.$("br:last"))}.bind(this)})},h=d.SMSView.extend({getMobilePhone:function(){return this.options.emplPhone},getSendAgainTimeProp:function(){return this.options.sendAgainTime},confirm:g,getUrl:f}),i=d.OTPView.extend({loadTokenSerials:function(a){a(this.options.tokenSerials)},getEmployeeTokenSerial:function(){return this.options.emplTokenSerial},confirm:g}),j=d.GoogleView.extend({confirm:g});return d.extend({initialize:function(a){d.prototype.initialize.call(this,a),this.options.extAuthData=a,this.map=b.extend(b.clone(d.STEP_VIEWS_MAP),{sms:h,otp:i,google:j})},createStep:function(a){var c=d.prototype.createStep.call(this,a);return b.each(e,function(a){c.options[a]=this.options.extAuthData[a]},this),c},render:function(){var a=this.options.extAuthData.authTypes;this.obtainable=b.intersection(b.keys(a[0]),b.keys(this.map));var c;switch(this.obtainable.length){case 0:c="empty";break;case 1:c="otp"===this.obtainable[0]?"otp":"way";break;default:c="way"}return this.to(this.map[c]),this}})}),define("text!templates/registry/unlock_device.tmpl",[],function(){return'<div class=\'modal-dialog\' id="unlock">\n    <div class="modal-header">\n        <div class="close"></div>\n        <h4><%- device_unlocking %></h4>\n    </div>\n\n    <div class="modal-body">\n        <div class=\'container\' id="unlock_code_container">\n            <div>\n                <label for="unlock_code"><%- unlock_code %></label>\n                <div class="input-language-container">\n                    <form autocomplete="off">\n                        <input id="unlock_code" type="password" maxlength="30" name=\'unlock_code\'\n                               autocomplete="off" tabindex=\'23\'/>\n                    </form>\n                    <div id="unlock_code_input_language" class="input-language"></div>\n                </div>\n            </div>\n            <br/>\n            <label>\n                <input type="checkbox"\n                       onchange="document.getElementById(\'unlock_code\').type = this.checked ? \'text\' : \'password\'"/>\n                <span class="checkbox"></span>\n                <span><%- show_unlock_code%></span>\n            </label>\n        </div>\n\n        <div class="container" id="password-change">\n            <div>\n                <label for="new_device_password"><%- new_password %></label>\n                <div class="input-language-container">\n                    <form autocomplete="off">\n                        <input class="fake-password" type="password" placeholder="Password"/>\n                        <input id="new_device_password" class="new-password" type="password" maxlength="30"\n                               name="new_device_password" autocomplete="off" tabindex="24"/>\n                    </form>\n                    <div id="new_device_password_input_language" class="input-language"></div>\n                </div>\n            </div>\n            <br/>\n            <div>\n                <label for="repeat_password"><%- key_password_repeat %></label>\n                <div class="input-language-container">\n                    <form autocomplete="off">\n                        <input class="fake-password" type="password" placeholder="Password"/>\n                        <input id="repeat_password" type="password" class="repeat-password" maxlength="30"\n                               autocomplete="off" tabindex="25"/>\n                    </form>\n                    <div id="repeat_password_input_language" class="input-language"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class="modal-footer">\n        <span style="width: 100%;">\n            <button type="button" id="save" class="action select primary"><%- unlock %></button>\n            <button type="button" id="cancel" class="action select"><%- cancel %></button>\n        </span>\n    </div>\n</div>'}),define("registry/base_storage_view",["jquery","underscore","backbone","marionette","text!templates/registry/unlock_device.tmpl","i18n!nls/registration","i18n!nls/validation","chosen"],function(a,b,c,d,e,f){"use strict";return d.LayoutView.extend({template:"",selectedDevice:"",isPasswordsEqual:!1,ui:{storageType:"#storage_type",deviceList:"#device-list",okButton:"button#password_ok",unlockDeviceButton:"button#unlock_device",keyList:"input#key_name",keyStorage:"input#key_storage",keyPassword:"input#key_password",keyPasswordInputLanguage:"div#key_password_input_language",keyPasswordRepeat:"input#key_password_repeat",keyPasswordRepeatInputLanguage:"div#key_password_repeat_input_language",devicePassword:"input#device_storage_password",devicePasswordInputLanguage:"div#device_storage_password_input_language",fileStorageElements:"div.file-storage-element",deviceStorageElements:"div.device-storage-element"},events:{"click button#unlock_device":"showUnlockDeviceDialog","click button#update-device-list":"updateDeviceList","chosen:select input#storage_type":"selectStorageType","chosen:select input#device-list":"selectDeviceFromList","blur input.repeat-password":"checkPasswordsEquality"},onShow:function(){this.initStorageTypes(),this.initDeviceList(),InputLangService.addInputLanguageListener(this.ui.keyPassword[0],this.ui.keyPasswordInputLanguage[0]),InputLangService.addInputLanguageListener(this.ui.devicePassword[0],this.ui.devicePasswordInputLanguage[0]),this.ui.keyPasswordRepeat[0]&&InputLangService.addInputLanguageListener(this.ui.keyPasswordRepeat[0],this.ui.keyPasswordRepeatInputLanguage[0])},addEnterKeyPressHandler:function(a,b){a.keypress(function(a){13===a.keyCode&&b()})},onBlurPasswordChange:function(){a("div.modal-dialog input.repeat-password").blur(function(b){this.checkPasswordsEquality(b,a("div.modal-dialog input.new-password"))}.bind(this))},initStorageTypes:function(){var a=[{id:"DEVICE",name:f.device_storage},{id:"FILE",name:f.file_storage}];this.ui.storageType.chosen({width:"34.3em",searchable:!1,data:{id:"id",text:"name",array:a}}).trigger("chooseById","FILE")},initDeviceList:function(){this.ui.deviceList.chosen({width:"28.1em",searchable:!1,data:{id:"id",text:"name",array:[]}})},initKeyList:function(){this.ui.keyList.chosen({width:"34.3em",data:{id:"id",text:"name",array:[]}})},selectStorageType:function(a,b){clearErrorMessage(),this.storageTypeId=b.id,this["DEVICE"===b.id?"changeUIAfterDeviceStorageTypeSelected":"changeUIAfterFileStorageTypeSelected"]()},changeUIAfterDeviceStorageTypeSelected:function(){this.ui.fileStorageElements.hide(),this.ui.deviceStorageElements.show(),this.ui.keyList.closest(".container").hide(),this.updateDeviceList()},changeUIAfterFileStorageTypeSelected:function(){this.ui.fileStorageElements.show(),this.ui.deviceStorageElements.hide(),this.ui.keyList.trigger("refresh",{array:[]}),this.ui.keyList.closest(".container").show(),this.ui.devicePassword.closest(".container").hide(),this.ui.unlockDeviceButton.hide(),this.ui.keyPassword.val("").change(),this.ui.keyStorage.val("")},notInitialisedDeviceSelected:function(){this.ui.devicePassword.closest(".container").hide(),this.ui.unlockDeviceButton.hide()},pinBlockedDeviceSelected:function(){var a="iToken"===this.selectedDevice.model;showErrorMessage(a?f.pin_is_blocked_1:f.pin_is_blocked_2),this.ui.unlockDeviceButton[a?"hide":"show"](),this.ui.devicePassword.closest(".container").hide()},pukBlockedDeviceSelected:function(){showErrorMessage(f.puk_is_blocked),this.ui.unlockDeviceButton.hide(),this.ui.devicePassword.closest(".container").hide()},initializedDeviceSelected:function(){this.ui.okButton.attr("disabled",!1),this.ui.devicePassword.attr("disabled",!1).val("").change(),this.ui.devicePassword.closest(".container").show(),this.ui.unlockDeviceButton.hide()},selectDeviceFromList:function(a,b){switch(SignPluginServices.forgetStorage(),this.selectedDevice=b,this.ui.keyList.closest(".container").hide(),clearErrorMessage(),b.state){case"initialized":this.initializedDeviceSelected();break;case"notInitialized":this.notInitialisedDeviceSelected();break;case"pinBlocked":this.pinBlockedDeviceSelected();break;default:this.pukBlockedDeviceSelected()}},updateDeviceList:function(){return SignPluginServices.getDeviceList().done(function(a){var c=[],d="",e=this.selectedDevice.id;b.each(a,function(a){a.deviceId===e&&(d=e);var b="notInitialized"===a.deviceState?f.nameless+"("+a.deviceSerialNumber+")":"";c.push({id:a.deviceId,name:f.usb_token+' "'+(a.deviceName||b)+'"',deviceName:a.deviceName,vendor:a.deviceVendor,model:a.deviceModel,state:a.deviceState})}),this.ui.deviceList.trigger("refresh",{array:c}),this.ui.deviceList.trigger("chooseById",d||a[0].deviceId)}.bind(this)).fail(function(a){showErrorMessage(a),this.ui.deviceList.trigger("refresh",{array:[]})}.bind(this))},showDialog:function(b,c){var d=a("<div class='modal registry-modal show'>").appendTo(a("body").addClass("no-scroll"));a(b).appendTo(d),a("div.modal-dialog div.close").bind("click",this.closeDialog.bind(this)),a("div.modal-dialog button#cancel").bind("click",this.closeDialog.bind(this)),a("div.modal-dialog button#save").bind("click",c),a(window).keypress(function(a){27===a.keyCode?this.closeDialog():13===a.keyCode&&a.preventDefault()}.bind(this))},closeDialog:function(){a("div.registry-modal").remove(),a("body").removeClass("no-scroll")},showUnlockDeviceDialog:function(){this.showDialog(b.template(e,f),this.unlockDevice.bind(this)),this.addEnterKeyPressHandler(a("div.modal-dialog#unlock input#new_device_password"),this.unlockDevice.bind(this)),this.onBlurPasswordChange();var c=a("div.modal-dialog#unlock input#unlock_code"),d=a("div.modal-dialog#unlock div#unlock_code_input_language");InputLangService.addInputLanguageListener(c[0],d[0]);var g=a("div.modal-dialog#unlock input#new_device_password"),h=a("div.modal-dialog#unlock div#new_device_password_input_language");InputLangService.addInputLanguageListener(g[0],h[0]);var i=a("div.modal-dialog#unlock input#repeat_password"),j=a("div.modal-dialog#unlock div#repeat_password_input_language");if(InputLangService.addInputLanguageListener(i[0],j[0]),!isCommonFirmware){var k=window.location.protocol+"//"+window.location.host+"/";loadPasswordSecurityProps(k).done(function(){this.addPasswordSecurityChecker("new_device_password")}.bind(this))}},addPasswordSecurityChecker:function(d){var e=function(){c.Validation.callbacks.valid(null,d)},f=function(a){c.Validation.callbacks.invalid(null,d,a),c.Validation.callbacks.showError(b.object([[d,a]]))};if(localStorage.getItem("web.password.security_recommendation")){var g=a("div.modal-dialog input#"+d);g.keyup(function(){checkPasswordSecurity(g.val(),e,f)})}},unlockDevice:function(){if(a("div.modal-dialog input.repeat-password").blur(),this.isPasswordsEqual){var b=a("div.modal-dialog#unlock input#new_device_password"),d=a("div.modal-dialog#unlock input#unlock_code");this.isDataValid(b,d)&&SignPluginServices.unlockDevice(this.selectedDevice.id,d.val(),b.val()).done(function(){this.closeDialog(),this.updateDeviceList()}.bind(this)).fail(function(e){20===e.errorCode?(this.closeDialog(),this.updateDeviceList()):(c.Validation.invalidField(this,"unlock_code",f.unlock_code_error+e.match(/\d+/)[0]),d.addClass("error").val("").change(),b.val("").change(),a("div.modal-dialog input.repeat-password").val("").change())}.bind(this))}},isDataValid:function(a,b,d){c.Validation.callbacks.valid(this,"new_device_password"),c.Validation.callbacks.valid(this,"unlock_code"),c.Validation.callbacks.valid(this,"device_name");var e=!0,g=function(b){c.Validation.invalidField(this,"new_device_password",b),a.addClass("error"),e=!1};return!isCommonFirmware&&localStorage.getItem("web.password.security_recommendation")?checkPasswordSecurity(a.val(),function(){},g):a.val().length<6&&g(f.password_min_length_error),b.length>0&&b.val().length<8&&(c.Validation.invalidField(this,"unlock_code",f.unlock_code_min_length_error),b.addClass("error"),e=!1),d&&d.val().length<1&&(c.Validation.invalidField(this,"device_name",f.device_name_min_length_error),d.addClass("error"),e=!1),e},changeUIAfterDeviceLogin:function(){this.ui.devicePassword.attr("disabled",!0),this.ui.okButton.attr("disabled",!0),clearErrorMessage()},checkPasswordsEquality:function(b,d){var e=a(b.currentTarget);return d||(d=this.$el.find("input.new-password")),d.val()!==e.val()?(c.Validation.invalidField(this,e.attr("id"),f.password_re_entering_error),this.isPasswordsEqual=!1,e.val("").change(),!1):(c.Validation.callbacks.valid(null,e.attr("id")),this.isPasswordsEqual=!0,!0)},updateDeviceListAndShowError:function(a){this.updateDeviceList().then(function(){b.contains(["pinBlocked","notInitialized"],this.selectedDevice.state)||showErrorMessage(a)}.bind(this))}})}),define("text!templates/registry/storage_for_new_key.tmpl",[],function(){return'<h2><%- key_storage_new %></h2>\n\n<div class=\'container\'>\n    <label for="storage_type"><%- storage_type %></label>\n    <input id="storage_type" type="text" tabindex="12" name=\'storage_type\'/>\n</div>\n\n<div class=\'container file-storage-element\'>\n    <span style="width: 100%;">\n        <label for="key_storage"><%- key_storage_label %></label>\n        <input id="key_storage" maxlength="90" disabled="disabled" type="text"\n               name=\'key_storage\' tabindex=\'13\'/>\n        <button type="button" id="select" class="action select small-registry-button"><%- select %></button>\n    </span>\n</div>\n\n<div class=\'container device-storage-element\'>\n    <span style="width: 100%;">\n        <label for="device-list"><%- device_key_storage %></label>\n        <input id="device-list" type="text" name=\'device-list-new\' tabindex=\'14\'/>\n        <button type="button" id="update-device-list"\n                class="action select small-registry-button"><%- update %></button>\n    </span>\n</div>\n\n<div class=\'container device-storage-element\'>\n    <div style="width: 100%; display: inline-block; margin-bottom: 0;">\n        <label for="device_storage_password"><%- device_password %></label>\n        <div class="input-language-container">\n            <form autocomplete="off" onkeypress="return arguments[0].which !== 13;">\n                <span class="left"><input class="fake-password" type="password" placeholder="Password"/></span>\n                <input id="device_storage_password" type="password" maxlength="30"\n                       name=\'device_storage_password\' autocomplete="off" tabindex=\'15\'/>\n            </form>\n            <div id="device_storage_password_input_language" class="input-language"></div>\n        </div>\n        <button type="button" id="password_ok" class="action select small-registry-button">OK</button>\n    </div>\n</div>\n\n<div class=\'container\'>\n    <label for="key_name"><%- key_name %></label>\n    <input id="key_name" type="text" name=\'key_name\' maxlength="40" tabindex=\'16\'/>\n</div>\n\n<div class=\'container file-storage-element\'>\n    <label for="key_password"><%- key_password %></label>\n    <div class="input-language-container">\n        <form autocomplete="off" onkeypress="return arguments[0].which !== 13;">\n            <span class="left"><input class="fake-password" type="password" placeholder="Password"/></span>\n            <input id="key_password" type="password" class="new-password" maxlength="30" name="key_password"\n                   autocomplete="off" tabindex="17"/>\n        </form>\n        <div id="key_password_input_language" class="input-language"></div>\n    </div>\n</div>\n\n<div class=\'container file-storage-element\'>\n    <label for="key_password_repeat"><%- key_password_repeat %></label>\n    <div class="input-language-container">\n        <form autocomplete="off" onkeypress="return arguments[0].which !== 13;">\n            <span class="left"><input class="fake-password" type="password" placeholder="Password"/></span>\n            <input id="key_password_repeat" type="password" class="repeat-password" maxlength="30"\n                   name="key_password_repeat" autocomplete="off" tabindex="18"/>\n        </form>\n        <div id="key_password_repeat_input_language" class="input-language"></div>\n    </div>\n</div>\n\n<div class=\'container warning-message\'>\n    <%- warning_message %>\n</div>\n\n<!-- Я разрешаю обработку моих персональных данных -->\n<div class="container dependent">\n    <label>\n        <input type=\'checkbox\' id=\'personal_data_checkbox\'/>\n        <span class=\'checkbox\'></span>\n        <%- allow_personal_data %>\n    </label>\n</div>\n\n<div class="container" id="actions">\n    <button type=\'button\' id=\'initialize_device\' class=\'primary\' style="display: none"><%- initialize_device %></button>\n    <button type=\'button\' id=\'unlock_device\' class=\'primary\' style="display: none"><%- unlock %></button>\n    <button type=\'button\' id=\'create_key\' class=\'primary dependent dependent-new\' disabled=\'disabled\'\n            data-spinner-size=\'33\' data-spinner-color=\'#FFF\'><%- create_ecp_key %></button>\n</div>\n'}),define("text!templates/registry/initialize_device.tmpl",[],function(){return'<div class=\'modal-dialog\' id="initialize">\n    <div class="modal-header">\n        <div class="close"></div>\n        <h4><%- device_initializing %></h4>\n    </div>\n\n    <div class="modal-body">\n        <div class=\'container\' id="device_name_container">\n            <div>\n                <label for="device_name"><%- device_name %></label>\n                <input id="device_name" type="text" name=\'device_name\' maxlength="40" tabindex=\'20\'/>\n            </div>\n        </div>\n\n        <div class=\'container\' id="password-change">\n            <div>\n                <label for="new_device_password"><%- password %></label>\n                <div class="input-language-container">\n                    <form autocomplete="off">\n                        <input class="fake-password" type="password" placeholder="Password"/>\n                        <input id="new_device_password" class="new-password" type="password" maxlength="30"\n                               name="new_device_password" autocomplete="off" tabindex="21"/>\n                    </form>\n                    <div id="new_device_password_input_language" class="input-language"></div>\n                </div>\n            </div>\n            <br/>\n            <div>\n                <label for="repeat_password"><%- key_password_repeat %></label>\n                <div class="input-language-container">\n                    <form autocomplete="off">\n                        <input class="fake-password" type="password" placeholder="Password"/>\n                        <input id="repeat_password" type="password" class="repeat-password" maxlength="30"\n                               autocomplete="off" tabindex="22"/>\n                    </form>\n                    <div id="repeat_password_input_language" class="input-language"></div>\n                </div>\n            </div>\n        </div>\n\n        <% if (!isIntegra) { %>\n            <div class=\'container\' id="unlock_code_container">\n                <div>\n                    <label for="unlock_code"><%- unlock_code %></label>\n                    <div class="input-language-container">\n                        <form autocomplete="off">\n                            <input id="unlock_code" type="password" maxlength="30" name=\'unlock_code\'\n                                   autocomplete="off" tabindex=\'23\'/>\n                        </form>\n                        <div id="unlock_code_input_language" class="input-language"></div>\n                    </div>\n                </div>\n                <br/>\n                <label>\n                    <input type="checkbox"\n                           onchange="document.getElementById(\'unlock_code\').type = this.checked ? \'text\' : \'password\'"/>\n                    <span class="checkbox"></span>\n                    <span><%- show_unlock_code%></span>\n                </label>\n            </div>\n        <% } %>\n    </div>\n\n    <div class="modal-footer">\n        <span style="width: 100%;">\n            <button type="button" id="save" class="action select primary"><%- initialize %></button>\n            <button type="button" id="cancel" class="action select"><%- cancel %></button>\n        </span>\n    </div>\n</div>';
}),define("registry/storage_for_new_key",["jquery","underscore","backbone","marionette","bifit","dialogUtils","registry/base_storage_view","text!templates/registry/storage_for_new_key.tmpl","text!templates/registry/initialize_device.tmpl","i18n!nls/registration","i18n!nls/validation"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";return g.extend({template:b.template(h,j),ui:b.extend({personalDataCheckbox:"#personal_data_checkbox",createKeyButton:"button#create_key",initDeviceButton:"button#initialize_device"},g.prototype.ui),events:b.extend({"input @ui.keyPassword":"onInputKeyPassword","input @ui.keyPasswordRepeat":"onInputKeyPassword","change input#personal_data_checkbox":"personalDataChanged","click button#initialize_device":"showInitializeDeviceDialog","click button#create_key":"generateKey","click button#select":"selectKeyStoragePath","click button#password_ok":"selectDevice","change #key_name":"checkupKeyLength"},g.prototype.events),onBeforeShow:function(){this.$el.html(this.template),this.bindUIElements()},onShow:function(){g.prototype.onShow.call(this),this.initKeyList(),this.addEnterKeyPressHandler(this.ui.devicePassword,this.selectDevice.bind(this)),a("#my_key_is_active").prop("checked")&&(this.ui.personalDataCheckbox.prop("checked",!0),this.personalDataChanged())},onInputKeyPassword:function(b){var d=b.target.id;if(localStorage.getItem("web.password.security_recommendation")){var e=a(b.target).val();this.model.set(d,e,{silent:!0});var f=this.model.preValidate(d,e);if(f){var g={};g[d]=f,c.Validation.callbacks.invalid(null,d,f),c.Validation.callbacks.showError(g)}else c.Validation.callbacks.valid(null,d)}},personalDataChanged:function(){this.ui.personalDataCheckbox.is(":checked")?this.ui.createKeyButton.attr("disabled","DEVICE"===this.storageTypeId?!this.ui.okButton.attr("disabled"):!1):this.ui.createKeyButton.attr("disabled",!0)},showInitializeDeviceDialog:function(){var c="iToken"===this.selectedDevice.model,d=b.extend({isIntegra:c},j);this.showDialog(b.template(i,d),this.initializeDevice.bind(this)),this.addEnterKeyPressHandler(a("div.modal-dialog input#unlock_code"),this.initializeDevice.bind(this)),this.onBlurPasswordChange();var e=a("div.modal-dialog input#new_device_password"),f=a("div.modal-dialog div#new_device_password_input_language");InputLangService.addInputLanguageListener(e[0],f[0]);var g=a("div.modal-dialog input#repeat_password"),h=a("div.modal-dialog div#repeat_password_input_language");if(InputLangService.addInputLanguageListener(g[0],h[0]),!c){var k=a("div.modal-dialog input#unlock_code"),l=a("div.modal-dialog div#unlock_code_input_language");InputLangService.addInputLanguageListener(k[0],l[0])}if(!isCommonFirmware){var m=window.location.protocol+"//"+window.location.host+"/";loadPasswordSecurityProps(m).done(function(){this.addPasswordSecurityChecker("new_device_password")}.bind(this))}},initializeDevice:function(){if(a("div.modal-dialog input.repeat-password").blur(),this.isPasswordsEqual){var b=a("div.modal-dialog#initialize input#device_name"),c=a("div.modal-dialog#initialize input#new_device_password"),d=a("div.modal-dialog#initialize input#unlock_code");this.isDataValid(c,d,b)&&SignPluginServices.initializeDevice(this.selectedDevice.id,c.val(),d.val(),b.val()).then(function(){this.closeDialog(),this.updateDeviceList()}.bind(this))}},selectDevice:function(){var a=this.ui.devicePassword.val();SignPluginServices.selectDevice(this.selectedDevice.id,a).done(function(a){function c(a){return{id:a.keyId,name:a.alias,active:a.active}}function d(a,b){return a.name.localeCompare(b.name)}this.model.set("device_vendor",this.selectedDevice.vendor),this.changeUIAfterDeviceLogin();var e=b.chain(a.answer).map(c).sort(d).value();"AUTHOR"===this.selectedDevice.vendor?(this.keysOnTheAuthorToken=e,this.ui.keyList.trigger("refresh",{array:[]}),this.ui.keyList.val(this.selectedDevice.deviceName)):this.ui.keyList.trigger("refresh",{array:e})}.bind(this)).fail(function(a){this.updateDeviceListAndShowError(a)}.bind(this))},changeUIAfterDeviceLogin:function(){g.prototype.changeUIAfterDeviceLogin.call(this),this.ui.keyList.closest(".container").show(),this.ui.createKeyButton.attr("disabled",!this.ui.personalDataCheckbox.is(":checked"))},changeUIAfterDeviceStorageTypeSelected:function(){g.prototype.changeUIAfterDeviceStorageTypeSelected.call(this),this.ui.createKeyButton.attr("disabled",!0)},changeUIAfterFileStorageTypeSelected:function(){g.prototype.changeUIAfterFileStorageTypeSelected.call(this),this.ui.createKeyButton.attr("disabled",!this.ui.personalDataCheckbox.is(":checked")),this.ui.createKeyButton.show(),this.ui.personalDataCheckbox.parent().show(),this.ui.initDeviceButton.hide()},generateKey:function(){if(clearErrorMessage(),this.model.set("storage_type_id",this.storageTypeId),"DEVICE"===this.storageTypeId&&"AUTHOR"===this.selectedDevice.vendor&&2===this.keysOnTheAuthorToken.length){var a=b.findWhere(this.keysOnTheAuthorToken,{active:!1});f.confirm(e.sprintf(j.confirm_key_replacement,a.id),this.trigger.bind(this,"generateKey",this.isKeyStorageSelected.bind(this)),!1,this)}else this.trigger("generateKey",this.isKeyStorageSelected.bind(this))},isKeyStorageSelected:function(){return"FILE"!==this.storageTypeId||this.model.get("key_storage")?!0:(c.Validation.invalidField(this,"key_storage",k.required),this.ui.keyStorage.addClass("error"),!1)},selectKeyStoragePath:function(){var a={title:j.save_file_dialog_title,defaultFileName:"keys.dat",fileMask:'{"text":"(*.dat)","pattern":"*.dat"}',fileType:"dat",overwritePrompt:!1};SignPluginServices.openSaveFileDialog(a).done(function(a){var b=replaceFileExtension(a.answer.filePath,"dat");this.ui.keyStorage.val(b),this.model.set("key_storage",b),c.Validation.callbacks.valid(this,"key_storage"),this.addKeysFromFileToList(b)}.bind(this))},addKeysFromFileToList:function(a){clearErrorMessage(),SignPluginServices.getKeyListFromFile(a).then(function(a){function c(a){return{id:a.keyId,name:a.alias}}function d(a,b){return a.name.localeCompare(b.name)}var e=b.chain(a).map(c).sort(d).value();this.ui.keyList.trigger("refresh",{array:e})}.bind(this)).fail(function(){this.ui.keyList.trigger("refresh",{array:[]})}.bind(this))},selectStorageType:function(a,b){this.clearValidationErrors(),g.prototype.selectStorageType.call(this,a,b)},clearValidationErrors:function(){a("div.errors").remove(),clearErrorMessage(),c.Validation.callbacks.valid(this,"key_name"),c.Validation.callbacks.valid(this,"key_password"),c.Validation.callbacks.valid(this,"key_password_repeat"),c.Validation.callbacks.valid(this,"key_storage")},selectDeviceFromList:function(a,b){this.clearValidationErrors(),g.prototype.selectDeviceFromList.call(this,a,b)},notInitialisedDeviceSelected:function(){g.prototype.notInitialisedDeviceSelected.call(this),showErrorMessage(j.initialize_error_1),this.ui.initDeviceButton.show(),this.ui.personalDataCheckbox.parent().hide(),this.ui.createKeyButton.hide()},pinBlockedDeviceSelected:function(){g.prototype.pinBlockedDeviceSelected.call(this),this.blockedDeviceSelected()},pukBlockedDeviceSelected:function(){g.prototype.pukBlockedDeviceSelected.call(this),this.blockedDeviceSelected()},blockedDeviceSelected:function(){this.ui.createKeyButton.hide(),this.ui.initDeviceButton.hide(),this.ui.personalDataCheckbox.parent().hide()},initializedDeviceSelected:function(){g.prototype.initializedDeviceSelected.call(this),this.ui.initDeviceButton.hide(),this.ui.createKeyButton.show(),this.ui.createKeyButton.attr("disabled",!0),this.ui.personalDataCheckbox.parent().show()},checkupKeyLength:function(b){var c=a(b.target).val();if(c.length>=40){var d=c.substr(0,40);a(b.target).val(d)}}})}),define("text!templates/registry/key_storage_for_authorize.tmpl",[],function(){return'<h2 style="padding: 0; margin: 0;"><%- choosing_current_key %></h2>\n\n<div class=\'container dependent-reverse\'>\n    <label for="storage_type"><%- storage_type %></label>\n    <input id="storage_type" type="text" tabindex="7" name=\'storage_type\' />\n</div>\n\n<div class=\'container file-storage-element\'>\n    <span style="width: 100%;">\n        <label for="key_storage"><%- key_storage %></label>\n        <input id="key_storage" maxlength="90" disabled="disabled" type="text"\n           name=\'key_storage\' tabindex=\'8\'/>\n        <button type="button" id="select" class="action select small-registry-button"><%- select %></button>\n    </span>\n</div>\n\n<div class=\'container device-storage-element\'>\n    <span style="width: 100%;">\n        <label for="device-list"><%- device_key_storage %></label>\n        <input id="device-list" type="text" name=\'device-list\' tabindex=\'14\'/>\n        <button type="button" id="update-device-list"\n                class="action select small-registry-button"><%- update %></button>\n    </span>\n</div>\n\n<div class=\'container device-storage-element\'>\n    <div style="width: 100%; display: inline-block; margin-bottom: 0;">\n        <label for="device_storage_password"><%- device_password %></label>\n        <div class="input-language-container">\n            <form autocomplete="off" onkeypress="return arguments[0].which !== 13;">\n                <span class="left"><input class="fake-password" type="password" placeholder="Password"/></span>\n                <input id="device_storage_password" type="password" maxlength="30"\n                       name=\'device_storage_password\' autocomplete="off" tabindex=\'14\'/>\n            </form>\n            <div id="device_storage_password_input_language" class="input-language"></div>\n        </div>\n        <button type="button" id="password_ok" class="action select small-registry-button">OK</button>\n    </div>\n</div>\n\n<div class=\'container\'>\n    <label for="key_name"><%- key_name %></label>\n    <input id="key_name" type="text" tabindex="9" name=\'key_name\' />\n</div>\n\n<div class=\'container file-storage-element\'>\n    <label for="key_password"><%- key_password %></label>\n    <div class="input-language-container">\n        <form autocomplete="off" onkeypress="return arguments[0].which !== 13;">\n            <span class="left"><input class="fake-password" type="password" placeholder="Password"/></span>\n            <input id="key_password" type="password" name=\'key_password\' maxlength="30"\n                   autocomplete="off" tabindex=\'10\'/>\n        </form>\n        <div id="key_password_input_language" class="input-language"></div>\n    </div>\n</div>\n\n<div class="container" id="actions">\n    <button type=\'button\' id=\'unlock_device\' class=\'primary\' style="display: none"><%- unlock %></button>\n    <button type=\'button\' id=\'next\' class=\'primary\' disabled=\'disabled\'\n            data-spinner-size=\'33\' data-spinner-color=\'#FFF\'><%- next %></button>\n</div>\n\n'}),define("registry/key_storage_for_authorize",["jquery","underscore","backbone","marionette","registry/base_storage_view","text!templates/registry/key_storage_for_authorize.tmpl","i18n!nls/registration"],function(a,b,c,d,e,f,g){"use strict";return e.extend({template:b.template(f),templateHelpers:g,ui:b.extend({keyList:"#key_name",nextButton:"button#next"},e.prototype.ui),events:b.extend({"click button#password_ok":"showDeviceKeyList","click button#select":"selectFileStorage","click button#next":"authorizeWithActiveKey"},e.prototype.events),onShow:function(){e.prototype.onShow.call(this),this.initKeyList(!1),this.addEnterKeyPressHandler(this.ui.devicePassword,this.showDeviceKeyList.bind(this))},showDeviceKeyList:function(){var a=this.ui.devicePassword.val();SignPluginServices.getKeyListFromDevice(this.selectedDevice.id,a).done(function(a){function c(a){return{id:a.keyId,name:a.alias,active:a.active}}function d(a,b){return a.name.localeCompare(b.name)}if(0===a.length)showErrorMessage(g.no_keys_error);else{var e=b.chain(a).map(c).sort(d).value();if(this.ui.keyList.trigger("refresh",{array:e}),1===b.size(e))this.ui.keyList.trigger("chooseById",b.first(e).id);else if("AUTHOR"===this.selectedDevice.vendor){var f=b.findWhere(e,{active:!0});this.ui.keyList.trigger("chooseById",f.id)}else this.ui.keyList.trigger("chooseById","");this.changeUIAfterDeviceLogin()}}.bind(this)).fail(function(a){this.updateDeviceListAndShowError(a)}.bind(this))},changeUIAfterDeviceLogin:function(){e.prototype.changeUIAfterDeviceLogin.call(this),"AUTHOR"!==this.selectedDevice.vendor&&this.ui.keyList.closest(".container").show(),this.ui.nextButton.attr("disabled",!1)},changeUIAfterDeviceStorageTypeSelected:function(){this.ui.nextButton.attr("disabled",!0),e.prototype.changeUIAfterDeviceStorageTypeSelected.call(this)},changeUIAfterFileStorageTypeSelected:function(){e.prototype.changeUIAfterFileStorageTypeSelected.call(this),this.ui.keyList.trigger("refresh",{array:[]}),this.ui.nextButton.attr("disabled",!0).show()},selectFileStorage:function(){SignPluginServices.selectFile().done(function(a){this.ui.keyStorage.val(a),this.storagePath=a,this.showFileKeyList()}.bind(this))},showFileKeyList:function(){clearErrorMessage(),SignPluginServices.getKeyListFromFile(this.storagePath).done(function(a){function c(a){return{id:a.keyId,name:a.alias}}function d(a,b){return a.name.localeCompare(b.name)}var e=b.chain(a).map(c).sort(d).value();this.ui.nextButton.attr("disabled",!1),this.ui.keyList.trigger("refresh",{array:e}),1===b.size(e)?this.ui.keyList.trigger("chooseById",b.first(e).id):this.ui.keyList.trigger("chooseById","")}.bind(this)).fail(function(a){showErrorMessage(a)})},authorizeWithActiveKey:function(){var a="FILE"===this.storageTypeId,c={name:this.ui.keyList,password:this.ui[a?"keyPassword":"devicePassword"]},d={storage:a?this.storagePath:this.selectedDevice.id,password:c.password.val(),alias:c.name.val(),storageType:this.storageTypeId};b.each(c,function(a){a.removeClass("error")}),""===c.name.val()||""===c.password.val()?(showErrorMessage(g.empty_field),b.each(c,function(a){a.val()||a.addClass("error")})):this.trigger("authorize",d)},notInitialisedDeviceSelected:function(){e.prototype.notInitialisedDeviceSelected.call(this),showErrorMessage(g.initialize_error_2),this.ui.nextButton.hide()},pinBlockedDeviceSelected:function(){e.prototype.pinBlockedDeviceSelected.call(this),this.ui.nextButton.hide()},pukBlockedDeviceSelected:function(){e.prototype.pukBlockedDeviceSelected.call(this),this.ui.nextButton.hide()},initializedDeviceSelected:function(){e.prototype.initializedDeviceSelected.call(this),this.ui.nextButton.attr("disabled",!0).show()}})}),define("text!templates/registry/bank_and_client_info.tmpl",[],function(){return'<!-- Выбор банка -->\n<div class="container dependent">\n    <label for="system_id"><%- select_bank %></label>\n    <input id="system_id" type="text" name="system_id" tabindex="1"/>\n</div>\n\n<h2 class="inverse-dependent" id="step2"><%- creating_new_key %></h2>\n\n<!-- Информация о владельце ключа -->\n<h2 style="padding:0; margin: 0;"><%- key_owner %></h2>\n<div class=\'container\'>\n    <label for="key_owner_name"><%- fio %></label>\n    <input id="key_owner_name" maxlength="90" type="text" placeholder="<%- not_necessarily %>" tabindex="2"\n           name=\'key_owner_name\'/>\n</div>\n\n<div class=\'container\'>\n    <label for="position"><%- position %></label>\n    <input id="position" maxlength="160" type="text" placeholder="<%- not_necessarily %>" tabindex="3"\n           name=\'position\'/>\n</div>\n'}),define("registry/client_info_view",["jquery","underscore","marionette","text!templates/registry/bank_and_client_info.tmpl","i18n!nls/registration","chosen"],function(a,b,c,d,e){"use strict";return c.ItemView.extend({template:b.template(d),templateHelpers:e,initialize:function(a){this.model=a.model,this.employee=a.employee,this.isNewKey="new"===a.registrationType},onShow:function(){if(this.$(".dependent")[this.isNewKey?"show":"hide"](),this.$(".inverse-dependent")[[this.isNewKey?"hide":"show"]](),isCommonFirmware){var b=[],c={2:"name_ru",3:"name_ua"}[""+getLocale()];for(var d in cfg.banks)cfg.banks.hasOwnProperty(d)&&b.push({id:d,name:cfg.banks[d][c]});this.model.set("system_id",""),this.$("#system_id").chosen({searchable:!1,width:"34.3em",data:{array:b,id:"id",text:"name"}}),this.$("#system_id").bind("chosen:select",function(a,b){this.model.set("system_id",b.id,{validate:!0}),localStorage.setItem("bid",b.id),localStorage.setItem("bank_url",cfg.banks[b.id].url),loadPasswordSecurityProps(cfg.banks[b.id].url)}.bind(this)).trigger("chooseById",localStorage.getItem("bid"))}else{var e=window.location.protocol+"//"+window.location.host+"/";localStorage.setItem("bank_url",e),loadPasswordSecurityProps(e),this.$("#system_id").parent().hide(),a.ajax({url:localStorage.getItem("bank_url")+"uweb/registry/system_id"}).done(function(a){this.model.set("system_id",a.system_id,{validate:!0})}.bind(this))}!this.isNewKey&&this.employee&&(this.$("#key_owner_name").val(this.employee.empl_name),this.$("#position").val(this.employee.position),this.$("#key_owner_name, #position").attr("disabled",!0))}})}),define("text!templates/registry/new_key.tmpl",[],function(){return'<div id="form-edit">\n    <div class="grey-container">\n        <h1><strong><%- new_key_registration %></strong></h1>\n    </div>\n\n    <div class="grey-container">\n        <label class="top_label">\n            <input type="checkbox" id="my_key_is_active"/>\n            <span class="checkbox"></span>\n            <%- my_key_is_active %>\n        </label>\n\n        <!-- Выбор банка + информация о клиенте -->\n        <div id="bank-and-client-info" class="form-margin-top"></div>\n    </div>\n\n\n    <!-- Выбор хранилища для нового ключа или текущего ключа\n         при выставленном флаге "Мой ключ активен ..." -->\n    <div class="grey-container">\n        <div id="select-storage" class="dependent-reverse"></div>\n        <div class="clearfix"></div>\n    </div>\n\n    <div id="net-error"></div>\n</div>\n'}),define("libs/multi_client_utils",["app","jquery","underscore","bifit","dialogUtils","collections/thesaurus","i18n!nls/common"],function(a,b,c,d,e,f,g){"use strict";function h(a){var c=b.Deferred();return c.resolve(a),c.promise()}var i={};i.scanKeysDirectory=function(d){var e=b.Deferred();if(d){var f=function(b,g){var h=d+"/"+b[g];SignPluginServices.selectFileStorage(h).done(function(b){c.each(b.answer,function(b){a.multiClient.clientsKeyStorages[b.keyId]={storageType:"FILE",storage:h,alias:b.alias}})}).always(function(){g<b.length-1?f(b,g+1):e.resolve()})};SignPluginServices.listDir(d).done(function(b){a.multiClient.clientsKeyStorages=a.multiClient.clientsKeyStorages||{},f(b,0)}).fail(function(){e.resolve()})}else e.resolve();return e},i.scanUsbKeys=function(){var d=b.Deferred(),e=function(b,f){var g=b[f].deviceId;SignPluginServices.getKeyListFromDevice(g,"",2).done(function(b){c.each(b,function(b){a.multiClient.clientsKeyStorages[b.keyId]={storageType:"DEVICE",storage:g,alias:b.alias}})}).always(function(){f<b.length-1?e(b,f+1):d.resolve()})};return SignPluginServices.getDeviceList().done(function(b){a.multiClient.clientsKeyStorages=a.multiClient.clientsKeyStorages||{},e(b,0)}).fail(function(){d.resolve()}),d},i.getClientKeyIds=function(){return b.ajax({url:d.settings.server_addr+"/get_client_key_ids;jsessionid="+d.getStoredItem("JSESSIONID")}).then(function(b){a.multiClient.activeClientsKeys=c.groupBy(b,function(a){return a.CID})})},i.useKey=function(c){var d=(a.multiClient.clientsKeyStorages||{})[c];return d?SignPluginServices.initKey(d.storage,"",d.alias,d.storageType,2):b.Deferred().reject()},i.useMultiClientKey=function(){var a=JSON.parse(localStorage.getItem("auth_key_info"));return SignPluginServices.initKey(a.storage,"",a.keyAlias,a.storageType,2).then(function(a){SignPluginServices.getPluginInstance().info=a})},i.fillClientKeysByCID=function(){a.multiClient.defaultClientKeysByCID={},a.multiClient.clientKeysByCID={},c.each(a.multiClient.activeClientsKeys,function(b){var d=c.filter(b,function(b){return(a.multiClient.clientsKeyStorages||{})[b.ID]});if(d.length>0){var e=d[0].CID;a.multiClient.defaultClientKeysByCID[e]=d[0],a.multiClient.clientKeysByCID[e]=d}})},i.isClientKeyActive=function(b){if(a.multiClient.defaultClientKeysByCID[b]){var c=d.str2date(d.date2str(new Date)),e=d.str2date(a.multiClient.defaultClientKeysByCID[b].END_DATE);return e>=c}return!1},i.getKeysListLocatedMultiClient=function(b){var d=null,e=(a.multiClient.activeClientsKeys||{})[b],f=a.multiClient.clientsKeyStorages;return e&&f&&(d=c.filter(e,function(a){return!c.isEmpty(f[a.ID])}),d=c.sortBy(d,function(a){return a.GR})),d},i.ajax=function(c){var e;if(c.currentSubClientKeyId)e=c.currentSubClientKeyId;else{var f=c.currentSubClientId||a.multiClient.currentSubClientId;e=a.multiClient.defaultClientKeysByCID[f].ID}return i.getAuthorizationHeader(e).then(function(a){var e=c.beforeSend;return c.beforeSend=function(b){var c={ru:"ru-RU",uk:"uk-UA",en:"en-US"};return b.setRequestHeader("Accept-Language",c[d.getLocale()]),b.setRequestHeader("authorization",a),b.setRequestHeader("emulateClientRequest","true"),d.getStoredItem("CSRF_TOKEN")&&b.setRequestHeader("X-CSRF-TOKEN",d.getStoredItem("CSRF_TOKEN")),e?e.apply(this,arguments):void 0},c.url=c.url.split(";jsessionid")[0],b.ajax(c)})},i.loadSubClientData=function(i,j,k){if(!(a.multiClient.defaultClientKeysByCID||{})[i])return a.multiClient.subClientIdForWhichDataIsLoaded="",e.alert(d.sprintf(g.no_keys_storage,j)),b.Deferred().reject();if(a.multiClient.currentSubClientId=i,localStorage.setItem("current_sub_client_id",i),a.multiClient.currentSubClientName=j,a.multiClient.subClientIdForWhichDataIsLoaded===i)return h(null);k&&k.emulateClientRequest||(k=c.extend({emulateClientRequest:!0},k));var l=function(a,b,d){var e=f.getThesaurus("system_props").array;c.each(e,function(b){c.findWhere(a,{name:b.name})||a.push(b)}),c.each(b,function(b){var e=c.findWhere(d,{branch_id:b.branch_id});if(e){var f=e.bik;c.findWhere(a,{name:f+"."+b.name})||(b.name=f+"."+b.name,a.push(b))}}),f.append({client_props:a})};return f.getThesaurus("clients",!1).fetch(k).then(function(){return f.getThesaurus("client_props",!1).fetch(c.extend({data:{fields:"1,3"}},k)).then(function(a){return f.getThesaurus("accs_info",!1).fetch(k).then(function(d){var e=c.chain(d).map(c.property("mfo")).uniq().value().join("','");if(e){var g="[0] in ('"+e+"') && [4] == NULL",h=c.extend({data:{query:g}},k);return b.when(f.getThesaurus("branch_properties",!1).fetch(h),f.loadStdThesaurus("bank_branches",{query:g})).then(function(b,c){return l(a,b,c)})}return[]})})}).then(function(){a.multiClient.subClientIdForWhichDataIsLoaded=i})},i.loadTemplate=function(a,b,c){return i.ajax({currentSubClientId:b,url:c.urlRoot+c.type+"/create"+(a?"/import":"")})};var j={};return i.getAuthorizationHeader=function(a){var b=j[a];return b?h(b):i.useKey(a).then(function(){var c=getTimeStamp(),d=localStorage.getItem("certificate_password"),e=Base64.encode(d+c);return SignPluginServices.signData(e).then(function(e){var f=localStorage.getItem("finger_print_server_seed");return SignPluginServices.getFingerPrint(f).then(function(g){return b='Certificate password="'+d+'",mclientAuth="false",key-id="'+e.key_id+'",timestamp="'+c+'",signature="'+e.sign+'",serverSeed="'+f+'",fingerPrint="'+g.answer.fingerPrint+'",deviceLocalIp="'+(g.answer.ip||"")+'"',j[a]=b,b})})})},i.getDefaultEmployees=function(){var b={};return c.each(a.multiClient.defaultClientKeysByCID,function(a,c){b[c]=a.EMPL_ID}),b},i}),define("thesaurusUtils",["jquery","underscore","app","backbone","bifit","collections/thesaurus"],function(a,b,c,d,e,f){"use strict";var g={},h={},i=function(){(b.isEmpty(h)||c.isMultiClient())&&(h={},b.each(f.getThesaurus("client_props").array,function(a){h[a.name]=a}))};return g.getClientProp=function(a,b){i();var c=h[a];return!b||c&&"client_props"===c.refType||(c=h[b+"."+a]||c),c?c.value:""},g.firstPropOf=function(){i();var a=b.find(arguments,function(a){return b.has(h,a)});return a?h[a].value:""},g}),require(["jquery","underscore","backbone","marionette","app","bifit","dialogUtils","libs/multi_client_utils","collections/thesaurus","thesaurusUtils","i18n!nls/validation","i18n!nls/common","backboneValidation"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(a){a.setRequestHeader("Cache-Control","max-age=0"),a.setRequestHeader("Cache-Control","no-cache"),a.setRequestHeader("Cache-Control","no-store"),a.setRequestHeader("Cache-Control","must-revalidate"),a.setRequestHeader("Pragma","no-cache"),a.setRequestHeader("If-Modified-Since","Thu, 01 Jan 1970 00:00:01 GMT"),a.setRequestHeader("Expires","0")}c.View.prototype.refreshElements=function(){for(var a in this.elements)if(b.has(this.elements,a)){var c=this.elements[a];this[c]=this.$(a)}},c.View.prototype.html=function(a){return this.$el.html(a.el||a),this.refreshElements(),this.el};var n=c.sync,o=[],p=function(a){var b=o.indexOf(a);-1!==b&&o.splice(b,1)},q=function(a,b,c){var d=c.error;c.error=function(a){p(a),404===a.status?(c.statusCode||{}).hasOwnProperty(a.status)||g.alert(l.net_error):200===a.status&&"401"===a.getResponseHeader("resp_code")&&f.getStoredItem("JSESSIONID")&&(f.storeItem("JSESSIONID",""),f.storeItem("CSRF_TOKEN",""),localStorage.setItem("sessionClosed",JSON.stringify({code:"unauthorized"})),localStorage.setItem("logout",Math.random()),window.location=window.location.href.split("#")[0]),d&&d.apply(this,arguments)};var h=c.success;if(c.success=function(a,b,d){function i(a){e.isMultiClient()?(g.alert(a),e.trigger("toggleCanChooseItem",!0)):(localStorage.setItem("sessionClosed",JSON.stringify({msg:a})),e.trigger("global:exit"))}p(d);var j=d.getResponseHeader("resp_code");return 200===d.status&&"403"===j?void(f.getStoredItem("JSESSIONID")&&(c.statusHandlers&&c.statusHandlers[j]||i)(a.error)):void(h&&h.apply(this,arguments))},"read"===a&&c.abortPending){for(var i=o.length-1;i>=0;i--){var j=o[i].readyState;j>0&&4>=j&&(4!==j&&o[i].abort(),o.splice(i,1))}var k=n.apply(this,arguments);return o.push(k),k}return n.apply(this,arguments)};c.sync=function(a,c,d){if(d=d||{},!d.emulateClientRequest)return q(a,c,d);d=b.extend({url:c.url().split(";jsessionid")[0]},d);var g;if(d.currentSubClientKeyId)g=d.currentSubClientKeyId;else{var i=e.multiClient.currentSubClientId;g=e.multiClient.defaultClientKeysByCID[i].ID}return h.getAuthorizationHeader(g).then(function(b){var e=d.beforeSend;return d.beforeSend=function(a){var c={ru:"ru-RU",uk:"uk-UA",en:"en-US"};return a.setRequestHeader("Accept-Language",c[f.getLocale()]),a.setRequestHeader("authorization",b),a.setRequestHeader("emulateClientRequest","true"),m(a),f.getStoredItem("CSRF_TOKEN")&&a.setRequestHeader("X-CSRF-TOKEN",f.getStoredItem("CSRF_TOKEN")),e?e.apply(this,arguments):void 0},q(a,c,d)})};var r=d.Region.prototype.show;d.Region.prototype.show=function(a,b){return"article#content"===this.options.el&&delete this.options.expectedType,r.call(this,a,b)};var s=function(a){a.removeClass("error").closest("div:not(.chosen)").find(".error-tooltip").remove()},t=function(){var b=a("div.errors, .error, span.error-tooltip");if(b.length>0&&Math.abs(a("html").scrollTop()-b.offset().top)>40){var c=b.offset().top-a("header.main").height();a("html, body").animate({scrollTop:c},"slow")}},u=function(b,d){var e=a("<div>").addClass("errors"),f=d&&d instanceof c.View,g=f?d.$("div#form-edit"):a("div#form-edit");if(0===g.length&&(g=f?d.$("form"):a("form")),g.length>0){var h=g.find(".errors");h.length&&h.remove();var i=g.find("h1");i.length>0?e.insertAfter(i):g.prepend(e)}e.text(b)},v=function(c,d){if(c=c||{}){var e={},g={};if(b.each(c,function(a,b){"fieldErrorOnTheBankSide"===a?e[b]=a:g[b]=a}),b.isEmpty(e)){if(!b.isEmpty(g)){var h=b.map(b.countBy(g),function(a,b){return{count:a,text:b}}),i=b.max(h,function(a){return a.count});1===i.count?i={}:u(f.sprintf(((d||{}).nls||{}).multiplyErrors||k.multiplyErrors,i.text),(d||{}).view),b.each(g,function(b,c){if(b&&b!==i.text){var e=a("#"+c);if(e.length){var g=e.closest("div:not(.chosen)");g.find(".error-tooltip").remove(),g.append('<span class="error-tooltip"><p>'+b+"</p></span>")}else((d||{}).nls||{}).hasOwnProperty("field_"+c)&&u(f.sprintf(k.invalid_field_pattern,d.nls["field_"+c],b),(d||{}).view)}})}}else if(a(".error").removeClass("error"),1===b.keys(e).length)u(f.sprintf(k.invalid_field_pattern_at_the_bank_side,d.nls["field_"+b.keys(e)[0]]),null);else{var j=b.map(e,function(a,b){return'"'+d.nls["field_"+b]+'"'}).join(", ");u(f.sprintf(k.invalid_fields_pattern_at_the_bank_side,j),null)}}},w=function(b,c,d){var e=b&&b.$?b.$("#"+c):a("#"+c);e.length>0&&!e.is(":disabled")&&e.addClass("error")},x=function(a,c){var d=f.checkUnsupportedSymbols(c);return b.each(d,function(b,c){w(a,c,b)}),d};c.Validation.configure({labelFormatter:"none"}),b.extend(c.Validation.callbacks,{valid:function(b,c){s(a("#"+c))},invalid:w,showError:function(a,b){v(a,b)},showGlobalError:function(a){v({any:a,other:a},{nls:{multiplyErrors:a}})}});var y=c.Validation.bind;b.extend(c.Validation,{bind:function(b,c){if(c=c||{},y(b,c),b&&b.model){var d=b.model.validate;b.model.validate=function(e){a("div.errors").remove();var f;return f=e&&"checkSymbols"in e?x(b,b.model.attributes):x(b,arguments[0]||b.model.attributes)||d.call(b.model,arguments[0],arguments[1]),f&&!c.silent&&(v(f,{nls:b.model.nls||b.nls,view:b},b),t()),f}}}}),c.Validation.invalidField=function(a,b,d){c.Validation.callbacks.invalid(a,b,d);var e={};e[b]=d,c.Validation.callbacks.showError(e)},b.extend(c.Validation.messages,k),b.extend(c.Validation.validators,{date:function(a){var b;return a&&!f.checkDateMatch(a)&&(b=k.incorrect_date),b},dateDoc:function(a){var b=this.date(a);if(!b&&a){var c=f.getServerDate(!0).getTime(),d=f.str2date(a).getTime(),e=parseInt(+j.getClientProp("documents.work.backdate"),10)||0,g=parseInt(+j.getClientProp("documents.work.futuredate"),10)||0;c-864e5*e>d?b=f.sprintf(k.backdate,f.date2str(new Date(c-864e5*e))):d>c+864e5*g&&(b=f.sprintf(k.futuredate,f.date2str(new Date(c+864e5*g))))}return b},digits:function(a){var b;return a&&!a.toString().match(/^\d+$/)&&(b=k.incorrect_digest),b},clientInfo:function(a,b,c){var d,e=i.getThesaurus("clients").array[0];return e[c||"name_cln"]!==a&&(d=k.invalid_field),d},okpo:function(a){var b;return b=a?f.checkEgrpou(a):k.required},calcAcc:function(a,b,c,d,e){return f.checkAccount(a,e[c])},requiredForEdit:function(a,b,c,d){var e;return d.isNew()||(e=this.required(a,b,c,d)),e},numDocRequired:function(a,b,c,d){var e;return!d.isNumDocGenerationFailed&&d.isNew()||(e=this.required(a,b,c,d)),e},checkPositive:function(a){var b;return a&&0>=a&&(b=k.positive_amount),b}})}),define("backboneBifit",function(){});var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a,b){var c,d,e,f,g,h,i,j="",k=0;for(b||(a=Base64.utf8_encode(a));k<a.length;)"string"==typeof a?(c=a.charCodeAt(k++),d=a.charCodeAt(k++),e=a.charCodeAt(k++)):(c=a[k++],d=a[k++],e=a[k++]),f=c>>2,g=(3&c)<<4|d>>4,h=(15&d)<<2|e>>6,i=63&e,isNaN(d)?h=i=64:isNaN(e)&&(i=64),j=j+this._keyStr.charAt(f)+this._keyStr.charAt(g)+this._keyStr.charAt(h)+this._keyStr.charAt(i);return j},decode:function(a,b){var c,d,e,f,g,h,i,j="",k=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");k<a.length;)f=this._keyStr.indexOf(a.charAt(k++)),g=this._keyStr.indexOf(a.charAt(k++)),h=this._keyStr.indexOf(a.charAt(k++)),i=this._keyStr.indexOf(a.charAt(k++)),c=f<<2|g>>4,d=(15&g)<<4|h>>2,e=(3&h)<<6|i,j+=String.fromCharCode(c),64!=h&&(j+=String.fromCharCode(d)),64!=i&&(j+=String.fromCharCode(e));return b||(j=Base64._utf8_decode(j)),j},encodeImg:function(a){for(var b,c,d,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f="",g=0,h=a.length;h>g;){if(b=255&a.charCodeAt(g++),g==h){f+=e.charAt(b>>2),f+=e.charAt((3&b)<<4),f+="==";break}if(c=a.charCodeAt(g++),g==h){f+=e.charAt(b>>2),f+=e.charAt((3&b)<<4|(240&c)>>4),f+=e.charAt((15&c)<<2),f+="=";break}d=a.charCodeAt(g++),f+=e.charAt(b>>2),f+=e.charAt((3&b)<<4|(240&c)>>4),f+=e.charAt((15&c)<<2|(192&d)>>6),f+=e.charAt(63&d)}return f},utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),
b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},_utf8_decode:function(a){var b,c,d,e,f="",g=0;for(b=c=d=0;g<a.length;)b=a.charCodeAt(g),128>b?(f+=String.fromCharCode(b),g++):b>191&&224>b?(d=a.charCodeAt(g+1),f+=String.fromCharCode((31&b)<<6|63&d),g+=2):(d=a.charCodeAt(g+1),e=a.charCodeAt(g+2),f+=String.fromCharCode((15&b)<<12|(63&d)<<6|63&e),g+=3);return f}};define("base64",function(){}),define("registry/new_key",["jquery","underscore","backbone","marionette","bifit","dialogUtils","collections/thesaurus","models/new_key","registry/key_generator","registry/print","views/ext_auth","registry/storage_for_new_key","registry/key_storage_for_authorize","registry/client_info_view","text!templates/registry/new_key.tmpl","i18n!nls/registration","backboneBifit","chosen","base64"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){"use strict";return d.LayoutView.extend({className:"doc-wrapper new-client",template:b.template(o),templateHelpers:p,regions:{keyStorageRegion:"#select-storage",clientInfoRegion:"#bank-and-client-info"},events:{"click input#my_key_is_active":"myKeyIsActiveChanged"},ui:{systemId:"input#system_id",createKey:"button#create_key",myKeyIsActive:"input#my_key_is_active",personalDataCheckbox:"input#personal_data_checkbox",keyStorageCurrent:"input#key_storage",keyList:"input#key_name",keyStoragePath:"input#key_storage",netError:"div#net-error"},initialize:function(a){this.model=new h,this.autoGenerate=a.param,c.Validation.bind(this)},onRender:function(){return this.ui.myKeyIsActive.prop("checked",!0),this.myKeyIsActiveChanged(),b.contains(["new_by_prototype_arm","distance_change_key"],this.autoGenerate)&&(this.model.set({key_registration_type:this.autoGenerate},{validate:!1}),this.ui.personalDataCheckbox.prop("checked",!0),this.ui.createKey.attr("disabled",!1),this.ui.myKeyIsActive.attr("disabled",!0),a("a.tolist").hide(),this.loadEmployeeInfo()),this},loadEmployeeInfo:function(){var a=localStorage.getItem("kid");this.model.set({active_key_id:a},{validate:!1});var b={data:{query:"[0] == "+a,fields:"1,2,3,5"}};e.settings.server_addr=localStorage.getItem("addr"),g.getThesaurus("empl_info").fetch(b).then(function(a){this.showNextRegistryStep(a[0])}.bind(this))},onSuccessLogin:function(){e.stopProcessButtons();var b=Array.apply(null,{length:32}).map(function(){return 0}),c=Base64.encode(b,!0);SignPluginServices.signData(c).then(function(b){if(sessionStorage.setItem("dist_sign",b.sign),window.extAuthData){a("body").toggleClass("ext-auth",!0);var c={ru:"ru-RU",uk:"uk-UA",en:"en-US"};a.ajaxSetup({beforeSend:function(a){a.setRequestHeader("Accept-Language",c[e.getLocale()]),e.getStoredItem("CSRF_TOKEN")&&a.setRequestHeader("X-CSRF-TOKEN",e.getStoredItem("CSRF_TOKEN"))}}),a('<section class="ext-auth"></section>').insertAfter(a("div#form-edit"));var f=d.Region.extend({el:"section.ext-auth"}),g=new f,h=window.extAuthData,i=this.loadEmployeeInfo.bind(this);h.onSuccess=function(){a("section.ext-auth").remove(),a("body").toggleClass("ext-auth",!1),i()};var j=new k(h);j.on("dispose",function(){j.off("dispose"),j.dispose(),a("section.ext-auth").remove(),a("body").toggleClass("ext-auth",!1),localStorage.setItem("life_for",""),SignPluginServices.closeSession()}),g.show(j)}else this.loadEmployeeInfo()}.bind(this))},authorizeWithActiveKey:function(c){var d=this.onSuccessLogin.bind(this),f=e.createProcessButton(a("button#next")[0]);e.processButton(f),e.addLaddaToGlobal();var g=function(a){SignPluginServices.getKeyList().done(function(f){2===f.answer.length?authorize(b.extend(c,{alias:c.alias+"-future"}),function(a){processLogin(a,function(a){showErrorMessage(a),e.stopProcessButtons()},function(){SignPluginServices.activateKey().then(function(){d()})})}):(showErrorMessage(a),e.stopProcessButtons())}.bind(this))};authorize(c,function(a){processLogin(a,g,d)})},getRegistrationDataFromForm:function(){var a=["key_owner_name","position","key_name","key_password","key_password_repeat","storage_type"],c={};return b.each(a,function(a){c[a]=this.$("#"+a).val()},this),c},generateKey:function(b){var c=this.ui.myKeyIsActive.is(":checked");if(this.model.set(this.getRegistrationDataFromForm(),{validate:!0}),!this.model.get("key_registration_type")){var d=c?"new_by_prototype_reg":"new";this.model.set({key_registration_type:d},{validate:!1})}if(this.model.isValid()&&b()){var h=e.createProcessButton(a("button#create_key")[0]);e.processButton(h);var k=function(){e.doExit(g),e.clearProcessButton(h)};this.ui.netError.empty(),i(this.model,function(b){b.url=c?localStorage.getItem("bank_url")+"uweb/protected/registry/key_reg_by_prototype;jsessionid="+e.getStoredItem("ACTIVE_KEY_JSESSIONID"):localStorage.getItem("bank_url")+"uweb/registry/key",b.save(null,{success:function(b,d){SignPluginServices.saveNewKeyInStorage(b.get("storage_type_id"),d.id_key,b.get("system_id"),b.get("key_storage")).then(function(){b.set("publ_key",d.publ_key),c?"distance_change_key"===this.autoGenerate?(f.alert(p.distance_change_key_over,to_index),e.doExit(g)):this.printLatestKey(b):j.print(b)}.bind(this)).always(function(){e.clearProcessButton(h),a("button#create_key").attr("disabled",!0)})}.bind(this),error:function(b,d){e.clearProcessButton(h),d.responseText?f.alert(d.responseText):a("#net-error").html(prepareErrorMsg4Site()),b.revert(),c&&e.doExit(g).then(function(){window.location=window.location.href.split("#")[0]})},validate:!1,silent:!0})}.bind(this),k)}},printLatestKey:function(c){var d=localStorage.getItem("bank_url")+"uweb/registry/print_info";a.post(d,JSON.stringify({key_id:c.get("id_key")}),function(a){var d={get:function(a){return d[a]}};b.extend(d,c.attributes,a),j.print(d),e.doExit(g)}.bind(this),"json")},myKeyIsActiveChanged:function(){this.changeGoBackHandler("to-main"),this.ui.myKeyIsActive.is(":checked")?(this.clientInfoRegion.empty(),this.keyStorageAuthView=new m({model:this.model}),this.listenTo(this.keyStorageAuthView,"authorize",this.authorizeWithActiveKey),this.keyStorageRegion.show(this.keyStorageAuthView)):(this.clientInfoView=new n({model:this.model,registrationType:"new"}),this.clientInfoRegion.show(this.clientInfoView),this.keyStorageNewView=new l({model:this.model}),this.keyStorageRegion.show(this.keyStorageNewView),this.listenTo(this.keyStorageNewView,"generateKey",this.generateKey))},showNextRegistryStep:function(a){this.changeGoBackHandler("to-prev-step"),this.clientInfoView=new n({model:this.model,employee:a,registrationType:"from-active-key"}),this.clientInfoRegion.show(this.clientInfoView),this.keyStorageNewView=new l({model:this.model}),this.keyStorageRegion.show(this.keyStorageNewView),this.listenTo(this.keyStorageNewView,"generateKey",this.generateKey),e.storeItem("ACTIVE_KEY_JSESSIONID",e.getStoredItem("JSESSIONID")),e.storeItem("JSESSIONID","")},showPrevRegistryStep:function(){this.changeGoBackHandler("to-main"),this.keyStorageAuthView=new m({model:this.model}),this.listenTo(this.keyStorageAuthView,"authorize",this.authorizeWithActiveKey),this.keyStorageRegion.show(this.keyStorageAuthView),this.ui.myKeyIsActive.prop("checked",!0),this.clientInfoRegion.empty(),e.doExit(g)},changeGoBackHandler:function(b){a("a.tolist").prop("onclick",null).unbind("click").click(function(){"to-main"===b?window.location=window.location.href.split("#")[0]:this.showPrevRegistryStep()}.bind(this))}})}),define("models/new_client",["jquery","underscore","backbone","bifit","models/base_model","i18n!nls/validation","i18n!nls/registration"],function(a,b,c,d,e,f,g){"use strict";var h=function(a){var b="";if(a&&localStorage.getItem("web.password.security_recommendation")){var c=new RegExp(localStorage.getItem("web.password.security_recommendation"));if(!c.test(a)){var d=localStorage.getItem("locale");d="uk"===d?"ua":d,b=localStorage.getItem("web.password.security_message_"+d)||g.password_too_simple}}else a&&a.length<6&&(b=g.password_min_length_error);return b};return e.extend({nls:g,validation:{okpo:{okpo:!0},name_cln:{required:!0,maxLength:40},addr_cln:{required:!0,maxLength:80},ordering_customer:{required:!1,maxLength:40},address_latin:{required:!1,maxLength:80},fio_cln:{required:!0,maxLength:160},phone_cln:{required:!0,maxLength:19},lock_word:{required:!0,minLength:1,maxLength:20},fax_cln:{required:!1,maxLength:40},email_cln:{required:!1,maxLength:200},sign_count:{required:!0,minLength:1,maxLength:1,digits:!0},mfo:[{required:!0,length:6,digits:!0},{fn:function(a){return"undefined"==typeof MfoList||MfoList[a]?void 0:f.invalid_field}}],account:[{required:!0,minLength:5,maxLength:14,digits:!0},{fn:function(a,b,c){return d.checkAccount(a,c.mfo)}}],currency:{required:!0,length:3},key_owner_name:{required:!1,maxLength:90,fn:function(a){var c;return a&&b.each(a.split(" "),function(a){a.length>50&&(c=g.tooLongFio)}),c}},position:{required:!1,maxLength:160},key_name:{required:!0},key_password:{required:function(a,b,c){return"DEVICE"!==c.storage_type_id},fn:h},key_password_repeat:{required:function(a,b,c){return"DEVICE"!==c.storage_type_id},fn:function(a,b,c){return h(a)||(a!==c.key_password?g.password_re_entering_error:"")}}},_session:function(){return""}})}),define("models/new_client_account",["jquery","underscore","backbone","bifit","models/base_model","i18n!nls/validation"],function(a,b,c,d,e,f){"use strict";return e.extend({validation:{mfo:[{required:!0,length:6,digits:!0},{fn:function(a){return"undefined"==typeof MfoList||MfoList[a]?void 0:f.invalid_field}}],account:[{required:!0,minLength:5,maxLength:14,digits:!0},{fn:function(a,b,c){return d.checkAccount(a,c.mfo)}}],currency:{required:!0,length:3},bank_name:{required:!0,minLength:3,maxLength:40}}})}),define("text!templates/registry/new_client.tmpl",[],function(){return'<div id="form-edit">\n\n    <div class="grey-container">\n        <h1><strong><%- new_client_registration %></strong></h1>\n    </div>\n\n    <div class="grey-container">\n        <h2><%- organization %></h2>\n\n        <div class="container">\n            <div class="left okpo__container">\n                <label for="okpo"><%- egrpou %></label>\n                <input id="okpo" class="okpo" name="okpo" maxlength="10" type="text" tabindex="1"/>\n            </div>\n            <div class="right">\n                <label for="name_cln"><%- name %></label>\n                <input id="name_cln" class="name" name="name_cln" maxlength="40" type="text" tabindex="2"/>\n            </div>\n        </div>\n\n        <div class="container">\n            <label for="addr_cln"><%- address %></label>\n            <textarea class="deletable" id="addr_cln" name="addr_cln" maxlength="80" rows="3" tabindex="3"></textarea>\n        </div>\n\n        <div class="container">\n            <label for="ordering_customer"><%- eng_name %></label>\n            <input id="ordering_customer" class="name" maxlength="40" type="text" name="ordering_customer"\n                   placeholder="<%- not_necessarily %>"/>\n        </div>\n        <div class="container">\n            <label for="address_latin"><%- eng_address %></label>\n            <textarea class="deletable" id="address_latin" name="address_latin" maxlength="80" rows="3"\n                      placeholder="<%- not_necessarily %>"></textarea>\n        </div>\n\n        <div class="container">\n            <label for="fio_cln"><%- fio_cln %></label>\n            <input id="fio_cln" class="name" maxlength="160" type="text" name="fio_cln" placeholder="<%- fio %>"\n                   tabindex="4"/>\n        </div>\n\n        <div class="container clearfix">\n            <div class="left">\n                <label for="phone_cln"><%- phone %></label>\n                <input id="phone_cln" maxlength="40" type="text" name="phone_cln" placeholder="<%- phone_code %>"\n                       tabindex="5"/>\n            </div>\n            <div class="right">\n                <label for="lock_word"><%- block_word %></label>\n                <input id="lock_word" maxlength="20" type="text" name="lock_word" tabindex="6"/>\n                <label class="description"><%= for_voice_client_authentication %></label>\n            </div>\n        </div>\n\n        <div class="container clearfix">\n            <div class="left">\n                <label for="fax_cln"><%- fax_cln %></label>\n                <input id="fax_cln" maxlength="40" type="text" name="fax_cln" placeholder="<%- not_necessarily %>"/>\n            </div>\n            <div class="right">\n                <label for="email_cln"><%- email_cln %></label>\n                <input id="email_cln" maxlength="200" type="text" name="email_cln"\n                       placeholder="<%- not_necessarily %>"/>\n            </div>\n        </div>\n\n        <div class="left">\n            <%- sign_count %>\n            <div class="sign_count_wrap">\n                <input type="text" maxlength="1" class="sign_count" id="sign_count" name="sign_count"/>\n            </div>\n        </div>\n        <div class="clearfix"></div>\n    </div>\n\n    <div class="grey-container">\n        <h2><%- account_in_bank %></h2>\n\n        <div id="static_accounts_block">\n            <div id="accounts"></div>\n\n            <div class="container">\n                <div class="right">\n                    <label for="bank_name"><%- nomination %></label>\n                    <input type="text" id="bank_name" class="bank_name" name="bank_name" disabled="disabled"/>\n                </div>\n                <span>\n                    <label for="mfo"><%- mfo %></label>\n                    <input type="text" id="mfo" class="mfo" name="mfo" maxlength="6" tabindex="7"/>\n                </span>\n            </div>\n            <div class="container">\n                <div class="left">\n                    <label for="account"><%- account %></label>\n                    <input type="text" id="account" class="account" name="account" maxlength="14" tabindex="8"/>\n                </div>\n                <div class="left">\n                    <label for="currency"><%- currency %></label>\n                    <input type="text" id="currency" class="currency" name="currency" tabindex="9"/>\n                </div>\n                <div class="right">\n                    <button type="button" id="remove_account" class="action remove"></button>\n                    <button type="button" id="add_account" class="primary action add"></button>\n                </div>\n            </div>\n        </div>\n        <div class="clearfix"></div>\n    </div>\n\n    <div class="grey-container">\n        <h2><%- key_owner %></h2>\n\n        <div class="container">\n            <label for="key_owner_name"><%- fio %></label>\n            <input id="key_owner_name" maxlength="90" type="text" placeholder="<%- not_necessarily %>"\n                   name="key_owner_name" tabindex="10"/>\n        </div>\n\n        <div class="clearfix">\n            <label for="position"><%- position %></label>\n            <input id="position" maxlength="160" type="text" placeholder="<%- not_necessarily %>" name="position"\n                   tabindex="11"/>\n        </div>\n    </div>\n\n    <div id="select-storage-for-new-key" class="grey-container clearfix"></div>\n\n    <div id="net-error"></div>\n\n</div>\n'}),define("text!templates/registry/static_account.tmpl",[],function(){return'<div class=\'container\'>\n    <div class="left">\n        <label for="mfo_<%- idx %>"><%- mfo %></label>\n        <input type="text" id="mfo_<%- idx %>" class="mfo" disabled="disabled"/>\n    </div>\n    <div class="right">\n        <label for="bank_name_<%- idx %>"><%- nomination %></label>\n        <input type="text" id="bank_name_<%- idx %>" class="bank_name" disabled="disabled"/>\n    </div>\n</div>\n<div class=\'container\'>\n    <div class="left">\n        <label for="account_<%- idx %>"><%- account %></label>\n        <input type="text" id="account_<%- idx %>" class="account" name=\'account\' disabled="disabled"/>\n    </div>\n    <div class="left">\n        <label for="currency_<%- idx %>"><%- currency %></label>\n        <input type="text" id="currency_<%- idx %>" class="currency" name=\'currency\' disabled="disabled"/>\n    </div>\n    <div class="right">\n        <button type="button" id="remove_account_<%- idx %>" class="action remove"/>\n    </div>\n</div>\n'}),function(a){"use strict";function b(a){var b={};if(void 0===a.selectionStart){a.focus();var c=document.selection.createRange();b.length=c.text.length,c.moveStart("character",-a.value.length),b.end=c.text.length,b.start=b.end-b.length}else b.start=a.selectionStart,b.end=a.selectionEnd,b.length=b.end-b.start;return b}function c(a,b,c){if(void 0===a.selectionStart){a.focus();var d=a.createTextRange();d.collapse(!0),d.moveEnd("character",c),d.moveStart("character",b),d.select()}else a.selectionStart=b,a.selectionEnd=c}function d(a,b){var c=/(\d)((\d{3}?)+)$/;if(a){for(var d=a.split(g);c.test(d[0]);)d[0]=d[0].replace(c,"$1"+b+"$2");a=d[0]+(d.length>1?g+d[1]:"")}return a}function e(a,b){return a.split(b).join("")}function f(a,f,h){function i(a,b){a=new String(a);var c=a.split(g);if(0===+b)return c[0];var d=c[1]||"";return d.length<b?d+=new Array(b-d.length+1).join("0"):d.length>b&&(d=d.substring(0,b)),c[0]+g+d}function j(a){return a=i(a,f.decimallength),d(a,f.thousandseparator)}function k(a,b){return a.substring(0,b).split(f.thousandseparator).length-1}function l(a,b){return{start:b.start-k(a,b.start),end:b.end-k(a,b.end)}}function m(a,b,c){return a.substring(0,c.start)+b+a.substring(c.end)}function n(a,b,c){for(var d=b.start+c.length,e=0,g=0;d>g;)a.charAt(e)!==f.thousandseparator&&g++,e++;return e}function o(a,b,c){var d={start:a.start,end:a.end};if(d.end-d.start)return d;var e=b.split(g),h=b.indexOf(g),i=e[0].length===f.maxlength,j=i||d.start>h||c===g&&d.start===h;j&&d.end++;var k=i&&c!=g&&d.start===h;return k&&(d.start++,d.end++),d}function p(a,b,c){var d={start:a.start,end:a.end};if(d.end-d.start>0)return d;var e=b.indexOf(g),f=46===c,h=f?1:-1,i=f?d.start:d.start-1;e===i&&(d.start=d.start+h,d.end=d.end+h);var j=f?"end":"start";return d[j]=d[j]+h,d}function q(d,i){var k=i?d:"";if(!r.test(k))return!1;k=","===k?g:k;var q=a.val(),s=e(q,f.thousandseparator),t=l(q,b(a[0]));if(i)t=o(t,s,k);else{if(!parseFloat(s))return a.val(""),a.trigger("input"),!1;t=p(t,s,d)}var u=m(s,k,t);if(!h.test(u))return!1;var v=j(u);a.val(v);var w=n(v,t,k);c(a[0],w,w),a.trigger("input")}var r=/^[0-9.,]*$/;return{handleInsertedSymbol:function(a){q(a,!0)},handleDeletion:function(a){q(a,!1)},toFixed:i}}var g=".",h={oneline_textarea:{keyset:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],reverse:!0,maxlength:160,trimonblur:!0,removeParagraphs:!0},number:{keyset:[48,49,50,51,52,53,54,55,56,57],reverse:!1},amount:{keyset:[48,49,50,51,52,53,54,55,56,57],reverse:!1,maxlength:10,decimallength:2,thousandseparator:" "},phone:{mask:"+380 (99) 999-99-99",placeholder:"_",completed:null,shiftR:!0,shiftL:!0,definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"}},date:{mask:"99.99.9999",placeholder:" ",partialFilling:!0,notDeletePlaceholder:!0,shiftR:!1,shiftL:!1,notSelectionOnFocus:!0,definitions:{9:"[0-9]"}},special_date:{mask:"AA.99.9999",placeholder:" ",partialFilling:!0,notDeletePlaceholder:!0,shiftR:!1,shiftL:!1,definitions:{9:"[0-9]",A:"[A-Z0-9]"}},text:{keyset:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],reverse:!0},text_latin:{keyset:[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122]},text_latin_up:{keyset:[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90]},text_cyrillic:{keyset:[1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1072,1073,1074,1075,1076,1077,1078,1079,1080,1081,1082,1083,1084,1085,1086,1087,1088,1089,1090,1091,1092,1093,1094,1095,1096,1097,1098,1099,1100,1101,1102,1103,1105,1025]},text_cyrillic_up:{keyset:[1040,1041,1042,1043,1044,1045,1046,1047,1048,1049,1050,1051,1052,1053,1054,1055,1056,1057,1058,1059,1060,1061,1062,1063,1064,1065,1066,1067,1068,1069,1070,1071,1025]},text_ua:{keyset:[1028,1030,1031,1108,1110,1111,1168,1169]},special_symbols:{keyset:[10,13,32,39,40,41,43,44,45,46,47,58,63,96]},special_symbols_without_line_break:{keyset:[32,39,40,41,43,44,45,46,47,58,63,96]},special_symbols_ext:{keyset:[37,38,180,8470]},space_symbol:{keyset:[32]},custom_symbols:{keyset:[33,34,35,36,42,59,60,61,62,64,91,92,93,94,95,123,124,125,126,136]}};a.fn.getUnformattedValue=function(){var a=this.data("formatter-data");return a&&"amount"===a.type?e(this.val(),a.thousandseparator):this.val()},a.fn.formatter=function(g,i){var j;if(a.isArray(g)){var k=[];a.each(g,function(b,c){a.merge(k,h[c].keyset)}),j=a.extend({},h[g[0]],{keyset:k})}else j=h[g];i=a.extend({},j,i);var l,m,n,o,p,q,r;if(i.keyset){var s="";s+=i.reverse?"[":"^[";for(var t=0;t<i.keyset.length;t++){var u=i.keyset[t],v=String.fromCharCode(u);13===u&&(v="\\r"),10===u&&(v="\\n"),s+=v}s+="]",i.reverse||(s+=i.maxlength?"{0,"+i.maxlength+"}":"*","amount"===g&&i.decimallength>0&&(s+="(\\.\\d{0,"+i.decimallength+"})?"),s+="$"),l=new RegExp(s,i.reverse?"g":"")}return i.mask&&(p=[],q=null,r=i.definitions,n=o=i.mask.length,a.each(i.mask.split(""),function(a,b){"?"===b?(o--,n=a):r[b]?(p.push(new RegExp(r[b])),null===q&&(q=p.length-1)):p.push(null)})),this.each(function(){var h,j,k,s,t,u,v,w,x,y,z=a(this);if(i.mask&&(j=a.map(i.mask.split(""),function(a){return"?"!==a?r[a]?i.placeholder:a:void 0}),k=z.val(),s=function(a){do a++;while(o>a&&!p[a]);return a},t=function(a){do a--;while(a>=0&&!p[a]);return a},u=function(a,b){var c,d;if(!(0>a))for(c=a,d=s(b);o>c;c++)if(p[c]){if(!(o>d&&p[c].test(j[d])))break;j[c]=j[d],j[d]=i.placeholder,d=s(d)}},v=function(a){var b,c,d,e;for(b=a,c=i.placeholder;o>b;b++)if(p[b]){if(d=s(b),e=j[b],j[b]=c,!(o>d&&p[d].test(e)))break;c=e}},w=function(a,d,e){return 0===a.length||a.is(":hidden")?void 0:"number"!=typeof d?b(a[0]):(e="number"==typeof e?e:d,void c(a[0],d,e))},x=function(a,b){var c;for(c=a;b>c&&o>c;c++)p[c]&&(j[c]=i.placeholder)},y=function(){z.val(j.join(""))},h=function(a){var b,c,d,e=z.val(),f=-1;for(b=0,d=0;o>b;b++)if(p[b]){for(j[b]=i.placeholder;d++<e.length;)if(c=e.charAt(d-1),p[b].test(c)||i.notDeletePlaceholder&&c===i.placeholder){j[b]=c,f=b;break}}else j[b]===e.charAt(d)&&b!==n&&(d++,f=b);return a?y():n>f+1&&!i.partialFilling?(z.val(""),x(0,o)):(y(),z.val(z.val().substring(0,f+1))),n?b:q}),"oneline_textarea"===g){var A=z[0].offsetHeight-z[0].clientHeight,B=z[0].scrollHeight,C=0,D=_.debounce(function(){C=window.pageYOffset,z.css("height","auto");var a=z[0].scrollHeight;a>0&&(z.css("height",a+A),0!==C&&(window.scrollTo(0,C+(a-B)),B=a))},200),E=_.debounce(function(){var a=b(z[0]);-1!==z.val().search(/\n/)&&(z.val(z.val().replace(/\n/g,"")),c(z[0],a.start-2,a.start-2))},100);z.css({"box-sizing":"border-box",resize:"none",overflow:"hidden"}),z.on("keydown change",D),i.removeParagraphs&&z.on("keypress change",E)}var F=z.data("formatter-data");if(F){z.removeData("formatter-data"),z.unbind("paste",F.paste),z.unbind("keypress",F.format),z.unbind("keydown",F.keydownEvent),z.unbind("drop",F.paste),i.mask&&z.unbind("focus",F.focus);for(var G=0;G<F.blur.length;G++)z.unbind("blur",F.blur[G])}if(F={type:g,thousandseparator:i.thousandseparator},"amount"===g)var H=new f(z,i,l);F.keydownEvent=function(b){var c,d=a(b.target),e=b.keyCode;if(9===e)return!0;if(8===e||46===e){if(i.mask){c=w(d);var f=c.start,h=c.end;return h-f===0&&(f=46!==e?t(f):h=s(f-1),h=46===e?s(h):h),x(f,h),i.shiftL&&u(f,h-1),y(),w(d,Math.max(q,i.shiftL||46!==e||c.end-c.start!==0?f:s(f))),b.preventDefault(),!1}return"amount"===g?(H.handleDeletion(e),b.preventDefault(),!1):!0}},F.format=function(b){var c=a(b.target),d=b.keyCode,e=b.which;if(!b.shiftKey&&d>=34&&40>=d&&e!==d)return!0;if(8===d||9===d||46===d&&0===e)return!0;var f;if((b.ctrlKey||b.metaKey)&&97===e)return!0;if((b.ctrlKey||b.metaKey)&&(99===e||118===e||120===e))return!0;if(i.mask){f=w(c);var h,k,l;if(b.ctrlKey||b.altKey||b.metaKey||32>e)return!0;if(e)return f.end-f.start!==0&&(x(f.start,f.end),i.shiftL&&u(f.start,f.end-1),y(),w(c,Math.max(q,f.start))),h=s(f.start-1),o>h&&(k=String.fromCharCode(e),p[h].test(k)&&(i.shiftR&&v(h),j[h]=k,y(),l=s(h),w(c,l),i.completed&&l>=o&&i.completed.call(c))),b.preventDefault(),!1}if("amount"===g)return H.handleInsertedSymbol(String.fromCharCode(e)),b.preventDefault(),!1;if(i.maxlength&&c.val().length===i.maxlength)return b.preventDefault(),!1;if(i.keyset){var m=i.keyset.indexOf(b.which);if(i.reverse&&m>=0||!i.reverse&&0>m)return b.preventDefault(),!1}return!0},F.blur=[],i.decimallength&&F.blur.push(function(){var a=e(z.val(),i.thousandseparator);a=parseFloat(a),a=isNaN(a)?"":H.toFixed(a,i.decimallength),a=d(a,i.thousandseparator),z.val(a),a!==(z.data("prev-value")||"")&&z.change()}),i.trimonblur&&F.blur.push(function(){var a=z.val().replace(/^\s+|\s+$/g,"");z.val(a).change()}),i.mask&&(F.blur.push(function(){h(),z.val()!==k&&z.change()}),F.focus=function(){clearTimeout(m),k=z.val(),m=setTimeout(function(){var a,c;i.notSelectionOnFocus&&(a=b(z[0])),c=h(),y(),a&&0===a.length?w(z,a.start):c===i.mask.length?w(z,0,c):w(z,c)},10)}),F.paste=function(){var b=z.val();return setTimeout(function(){if(i.mask){var c=h(!0);w(z,c),i.completed&&c===z.val().length&&i.completed.call(z)}else{var f=z.val();f=f.replace(/[\u0009]/g," "),"amount"===g&&(f=e(f,i.thousandseparator)),i.reverse?f=f.replace(l,""):l.test(f)||(f=b),i.reverse&&i.maxlength&&f.length>i.maxlength&&(f=f.substring(0,i.maxlength)),"amount"===g&&(f=d(f,i.thousandseparator)),z.val(f).trigger(a.Event("input"))}},0),!0},i.mask&&z.bind("focus",F.focus),z.bind("paste",F.paste),z.attr("disabled")&&!i.allowDisabled||z.attr("readonly")||(z.bind("keypress",this,F.format),z.bind("keydown",this,F.keydownEvent)),z.bind("drop",F.paste);for(var I=0;I<F.blur.length;I++)z.bind("blur",F.blur[I]);z.bind("change",function(){var b=a(this);b.data("prev-value",b.val())}),z.data("formatter-data",F),i.mask&&h()})}}(jQuery),define("formatter",function(){}),define("registry/new_client",["jquery","underscore","backbone","marionette","bifit","dialogUtils","collections/thesaurus","models/new_client","models/new_client_account","registry/print","registry/key_generator","registry/storage_for_new_key","text!templates/registry/new_client.tmpl","text!templates/registry/static_account.tmpl","i18n!nls/registration","backboneBifit","chosen","formatter","base64"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";var p,q=["mfo","account","currency","bank_name"];return d.LayoutView.extend({className:"doc-wrapper new-client",template:b.template(m),templateHelpers:o,regions:{keyStorageRegion:"#select-storage-for-new-key"},events:{"click button#add_account":"addAccount","click button#remove_account":"clearAccount"},ui:{mfo:"#mfo",bankName:"#bank_name",currency:"#currency",account:"#account"},initialize:function(){this.model=new h,c.Validation.bind(this)},onRender:function(){if(this.keyStorageView=new l({model:this.model}),this.keyStorageRegion.show(this.keyStorageView),this.listenTo(this.keyStorageView,"generateKey",this.generateKey),this.initCurrency(),this.initSignCount(),isCommonFirmware){var c=function(){if(6===this.ui.mfo.val().length){var a=MfoList[this.ui.mfo.val()];if(a){var b={2:"name_ru",3:"name_ua"}[""+getLocale()];this.ui.bankName.val(cfg.banks[a][b]),this.model.set("system_id",a),localStorage.setItem("bid",a),localStorage.setItem("bank_url",cfg.banks[a].url),loadPasswordSecurityProps(cfg.banks[a].url),p={url:cfg.banks[a].url+"uweb/reference/bank_branches",data:{query:"[4] == NULL"}}}}}.bind(this);this.ui.mfo.bind("input change",c),this.ui.mfo.formatter("number",{maxlength:6})}else{var d=window.location.protocol+"//"+window.location.host+"/";localStorage.setItem("bank_url",d),loadPasswordSecurityProps(d),p={url:d+"uweb/reference/bank_branches",data:{query:"[4] == NULL"}},g.getThesaurus("bank_branches").fetch(p).done(function(a){this.ui.mfo.chosen({data:{array:a,id:"bik",text:"bik"},searchable:!1,width:"5.5em","class":"mfo"}),this.ui.mfo.bind("chosen:select",function(c){var d=b.find(a,function(a){return a.bik===c.target.value});this.ui.bankName.val(d.name)}.bind(this))}.bind(this)),a.ajax({url:localStorage.getItem("bank_url")+"uweb/registry/system_id"}).done(function(a){this.model.set("system_id",a.system_id)}.bind(this))}return this.$("#phone_cln").formatter("phone"),this.$("#okpo").formatter("number",{maxlength:10}),this.ui.account.formatter("number",{maxlength:14}),this},initCurrency:function(){this.ui.currency.chosen({data:{array:["UAH","USD","EUR","RUB"]},searchable:!1,width:70,"class":"currency"}).trigger("choose","UAH")},initSignCount:function(){this.$("#sign_count").formatter("number",{maxlength:1}),this.$("#sign_count").chosen({data:{array:["1","2","3","4","5","6","7","8"]},searchable:!1,width:"3em","class":"sign_count"}).trigger("choose","1")},_getAccData:function(){var a={};return b.each(q,function(b){a[b]=this.$("#"+b).val()},this),a},_processAccount:function(a){a=a||this._getAccData();var d=this.model.get("accounts")||[],e=b.some(d,function(c){return b.isEqual(c,a)}),f=e?"invalid":"valid",g=e?o.dubl_accounts:"";return b.each(q,function(a){c.Validation.callbacks[f](null,a,g)}),c.Validation.callbacks.showError({account:g},{nls:o}),e},_checkMfo:function(){var d=a.Deferred();return c.Validation.callbacks.valid(null,"mfo"),g.getThesaurus("bank_branches").fetch(p).then(function(a){var e=b.any(a,function(a){return a.bik===this.ui.mfo.val()}.bind(this));e?d.resolve():(c.Validation.callbacks.invalid(null,"mfo",o.mfo_not_found),c.Validation.callbacks.showError({mfo:o.mfo_not_found}),d.reject())}.bind(this)),d},addAccount:function(d){d.preventDefault(),this._checkMfo().done(function(){var d=new i,e={},f={};b.each(q,function(a){e[a]=this.$("#"+a),f[a]=e[a].val()},this),d.set(f);var g={model:d};c.Validation.bind(g);var h=!d.isValid(!0);if(c.Validation.unbind(g),h=h||this._processAccount(f))return!1;var j=this.model.get("accounts")||[],k=j.length,l=a("<div>").html(b.template(n,b.extend({idx:k},o)));if(b.each(q,function(a){l.find("."+a).val(d.get(a))}),l.find("#remove_account_"+k).click(function(){for(var a=-1,c=0;c<j.length;c++)if(b.isEqual(j[c],d.attributes)){a=c;break}j.splice(a,1),l.remove(),isCommonFirmware&&0===j.length&&e.mfo.disposeChosen()}),this.$("#accounts").append(l),j.push(f),this.model.set("accounts",j),e.account.val(""),e.currency.trigger("choose","UAH"),isCommonFirmware&&1===j.length){var m=b.filter(b.keys(MfoList),function(a){return MfoList[a]===localStorage.getItem("bid")});e.mfo.chosen({searchable:!1,width:"5.5em",data:{array:m},"class":"mfo"}),e.mfo.bind("chosen:select",function(){e.mfo.change()})}return!1}.bind(this))},clearAccount:function(a){a.preventDefault();var d=this.model.get("accounts");if(d&&d.length>0){var e=d[d.length-1];d.splice(d.length-1,1),this.$("div#accounts>div:last").remove(),isCommonFirmware&&0===d.length?(this.ui.mfo.disposeChosen(),this.ui.mfo.val(e.mfo)):this.ui.mfo.trigger("choose",e.mfo),this.ui.account.val(e.account),this.ui.currency.trigger("choose",e.currency),this.ui.bankName.val(e.bank_name)}else this.ui.currency.trigger("empty"),this.$("#mfo,#account,#bank_name,#mfo").val("");b.each(q,function(a){c.Validation.callbacks.valid(null,a)})},getRegistrationDataFromForm:function(){var a=["okpo","name_cln","addr_cln","ordering_customer","address_latin","fio_cln","phone_cln","lock_word","fax_cln","email_cln","sign_count","mfo","account","currency","key_owner_name","position","key_name","key_password","key_password_repeat","storage_type"],c={};return b.each(a,function(a){c[a]=this.$("#"+a).val()},this),c},generateKey:function(d){if(this.model.set(this.getRegistrationDataFromForm(),{validate:!0}),this.model.isValid()&&d()&&!this._processAccount()){var h=e.createProcessButton(a("button#create_key")[0]);
e.processButton(h),k(this.model,function(d){d.set({date_input:e.date2str(new Date)}),d.set("phone_cln",d.get("phone_cln").replace(/[\(\)\s\-]+/g,"")),d.get("sign_count")&&d.set("sign_count",(parseInt(d.get("sign_count"),10)-1).toString()),b.each(["mfo","account","currency","key_name","key_password"],function(a){d.unset(a,{silent:!0})});d.get("accounts")||[];g.getThesaurus("bank_branches").fetch(p).then(function(f){var g=a.Deferred(),h=e.date2str(new Date),i=d.get("accounts")||[];return i.push(this._getAccData()),d.set("accounts",i),f=b.groupBy(f,"bik"),b.each(i,function(a,b){return f[a.mfo]?(g.resolve(),a.branch_id=f[a.mfo][0].branch_id,void(a.create_date=h)):(c.Validation.callbacks.invalid(null,"mfo",o.mfo_not_found),c.Validation.callbacks.showError({mfo:o.mfo_not_found}),d.unset("accounts",{silent:!0}),i.splice(b,1),d.set("accounts",i),void g.reject())}),g}.bind(this)).done(function(){d.url=localStorage.getItem("bank_url")+"uweb/registry/client",d.save(null,{success:function(b,c){SignPluginServices.saveNewKeyInStorage(b.get("storage_type_id"),c.id_key,b.get("system_id"),b.get("key_storage")).then(function(){b.set("publ_key",c.publ_key),j.print(b)}).always(function(){e.clearProcessButton(h),a("button#create_key").attr("disabled",!0)})},error:function(b,c){e.clearProcessButton(h),c.responseText?f.alert(c.responseText):a("#net-error").html(prepareErrorMsg4Site()),b.unset("accounts",{silent:!0})},validate:!1,silent:!0})}).fail(function(){d.unset("accounts",{silent:!0}),e.clearProcessButton(h)})}.bind(this))}}})}),define("registry/device_keys_list_collection",["backbone"],function(a){"use strict";return a.Collection.extend({model:a.Model.extend({}),initialize:function(){this.sortedInfo={field:"keyId",order:"desc"}},compareValues:function(a,b){return a>b?1:b>a?-1:0},compareLocaleValues:function(a,b){return a.localeCompare(b)},comparator:function(a,b){var c=this.sortedInfo.field,d=a.get(c),e=b.get(c),f=0;return"keyId"===c&&(f=this.compareValues(d,e)),"alias"===c&&(f=this.compareLocaleValues(d,e)),"desc"===this.sortedInfo.order?-f:f}})}),define("libs/group_opers_utils",["jquery","underscore"],function(a,b){return{prepareTable:function(){b.each(this.collection.selected,function(a){var b=a.id,c=this.collection.get(b);this.collection.deselect(a),c&&(c.select(),this.$("tbody tr#"+b).addClass("selected"),this.$("tbody tr.selected input").prop("checked",!0))}.bind(this))},markOne:function(a){a.model.toggleSelected(),a.$el.closest("tr").toggleClass("selected"),this.$("th.check input").attr("checked",!1),this.postModelMark()},markAll:function(b){a(b.target).is(":checked")?(this.$("tbody tr").addClass("selected").find("input").prop("checked",!0),this.collection.selectAll()):(this.$("tbody tr").removeClass("selected").find("input").prop("checked",!1),this.collection.selectNone()),this.postModelMark()}}}),define("commons/base_object/base_list_view",["jquery","underscore","app","backbone","spinner","marionette","bifit","libs/group_opers_utils"],function(a,b,c,d,e,f,g,h){"use strict";return f.CompositeView.extend({childViewContainer:"tbody",className:"doc-list",templateHelpers:{isMultiClient:c.isMultiClient},childEvents:{selectItem:"selectItem"},events:{"click span.sortable":"resortTable"},ui:{table:"table.list",SPIN_WRAPPER:"span.sortable"},initialize:function(a){this.selectedTab=a.selectedTab,this.listenTo(this.collection,"sort",this.stopSpinner)},hideStatusColumn:function(a){a=a||"executed",this.selectedTab&&this.selectedTab===a&&(this.$el.find("th.status").css("display","none"),this.$el.find("td.status").css("display","none"))},getActiveTabStatus:function(){return this.selectedTab},resortView:function(){this._renderChildren(),this.hideStatusColumn("executed"),this.stopSpinner(),h.prepareTable.call(this)},onRender:function(){this.initSortableStyles(),this.initTableHead(),g.fixedFooter(this.ui.table.find("tfoot.summary td")),c.mainLayout.content.trigger("content:reloaded"),this.hideStatusColumn("executed")},removeSpaceUnderTable:function(){this.ui.table.css({"margin-bottom":this.ui.table.next().outerHeight()}),this.ui.summaryFooterTd.closest("tfoot").remove()},initTableHead:function(){g.fixedHead(this.ui.table,null,c.mainLayout.content.getTopPosition()),this.on("top:changed",function(a){this.ui.table.trigger("top:changed",a)}.bind(this))},initSortableStyles:function(){var a=this.collection.sortedInfo,b="table.list thead span.sortable[data-field='"+(a.field||a.fields[this.collection.id])+"']";this.$(b).addClass(a.getOrderDesc(this.collection.id))},selectItem:function(a,b){this.trigger("show-item-view",b.model)},stopSpinner:function(){this.spinner&&this.spinner.stop()},resortTable:function(b){var c=a(b.target),d=c.attr("data-field");this.showSpinner(d);var e=c.hasClass("asc")?"desc":"asc";this.$("thead span.desc, thead span.asc").removeClass("desc asc"),c.addClass(e);var f=this.collection.sortedInfo;f.fields&&(f.fields[this.collection.id]=d,f.currentOrders[this.collection.id]="desc"===e?2:1),setTimeout(function(){this.sortCollection(d,e)}.bind(this),50)},showSpinner:function(b){this.stopSpinner();var c=a("span.sortable[data-field = "+b+"]:visible:last"),d={width:3,radius:5,lines:8,length:0,color:"#AAA",corners:1,left:null,right:"-10px"};this.spinner=new e(d).spin(),c[0].appendChild(this.spinner.el)},sortCollection:function(a,b){this.collection.sortBy(a,b)},destroyChildren:function(){var a=this.getChildViewContainer(this);return a[0].innerHTML="",f.CompositeView.prototype.destroyChildren.call(this)}})}),define("text!templates/registry/device_key_list.tmpl",[],function(){return'<table class="list">\n    <thead class="widescreen">\n    <tr>\n        <th class="id">\n            <span class="sortable" data-field="keyId"><%- key_id %></span>\n        </th>\n        <% if (isTokenAuthor) { %>\n            <th class="key-state sortable">\n                <span class="sortable" data-field="status"><%- key_status %></span>\n            </th>\n        <% } else { %>\n            <th class="key-name">\n                <span class="sortable" data-field="alias"><%- key_name %></span>\n            </th>\n        <% } %>\n    </tr>\n    </thead>\n    <tbody></tbody>\n</table>\n'}),define("text!templates/registry/device_key_list_item.tmpl",[],function(){return'<td class="key-id widescreen"><%- keyId %></td>\n<% if (isTokenAuthor) { %>\n    <td class="key-alias widescreen"> <%- status %></td>\n<% } else { %>\n    <td class="key-alias widescreen"><%- alias %></td>\n<% } %>\n'}),define("registry/device_key_list_view",["jquery","underscore","marionette","spinner","commons/base_object/base_list_view","text!templates/registry/device_key_list.tmpl","text!templates/registry/device_key_list_item.tmpl","i18n!nls/registration"],function(a,b,c,d,e,f,g,h){"use strict";var i=c.ItemView.extend({template:b.template(g),templateHelpers:h,tagName:"tr",triggers:{click:"selectItem"},initialize:function(a){b.extend(this.templateHelpers,{isTokenAuthor:a.isTokenAuthor}),this.model.set("status",this.model.get("active")?h.current:h["new"])}});return c.CompositeView.extend({childViewContainer:"tbody",className:"key-list",template:b.template(f),templateHelpers:h,childView:i,childViewOptions:{isTokenAuthor:null},events:{"click .sortable":"resortTable"},childEvents:{selectItem:"selectItem"},initialize:function(a){b.extend(this.templateHelpers,{isTokenAuthor:a.isTokenAuthor}),this.childViewOptions.isTokenAuthor=a.isTokenAuthor,this.listenTo(this.collection,"sort",function(){this.stopSpinner(),this._renderChildren()})},onShow:function(){this.$el.find("[data-field="+this.collection.sortedInfo.field+"]").addClass(this.collection.sortedInfo.order)},resortTable:function(b){var c=a(b.target),d=c.attr("data-field");this.showSpinner(d);var e=c.hasClass("asc")?"desc":"asc";this.$(".desc, .asc").removeClass("desc asc"),c.addClass(e),this.collection.sortedInfo.field=d,this.collection.sortedInfo.order=e,setTimeout(function(){this.collection.sort()}.bind(this),50)},showSpinner:function(b){this.stopSpinner();var c=a("span.sortable[data-field = "+b+"]:visible:last"),e={width:3,radius:5,lines:8,length:0,color:"#AAA",corners:1,left:null,right:"-10px"};this.spinner=new d(e).spin(),c[0].appendChild(this.spinner.el)},stopSpinner:function(){this.spinner&&this.spinner.stop()},selectItem:function(a,b){this.$("tr").removeClass("selected"),a.$el.closest("tr").toggleClass("selected");var c={id:b.model.get("keyId"),name:b.model.get("alias")};this.trigger("select-key",c)}})}),define("text!templates/registry/admin_key.tmpl",[],function(){return'<div id="form-edit">\n    <div class="grey-container">\n        <h1><strong><%- admin_keys %></strong></h1>\n    </div>\n    \n    <div id="admin-key-wrapper" class="grey-container">\n        <div>\n            <label for="storage_type"><%- storage_type %></label>\n            <input id="storage_type" type="text" name="storage_type" tabindex="1"/>\n        </div>\n\n        <div class="container file-storage-element">\n            <span style="width: 100%;">\n                <label for="key_storage"><%- key_storage %></label>\n                <input id="key_storage" disabled="disabled" type="text" name="key_storage" tabindex="2"/>\n                <button type="button" id="select" class="action select small-registry-button"><%- select %></button>\n            </span>\n        </div>\n\n        <div class="container device-storage-element">\n            <span>\n                <label for="device-list"><%- device_key_storage %></label>\n                <input id="device-list" type="text" name="device-list" tabindex="14"/>\n                <button type="button" id="update-device-list"\n                        class="action select small-registry-button"><%- update %></button>\n            </span>\n        </div>\n\n        <div class="container device-storage-element">\n            <div style="width: 100%; display: inline-block; margin-bottom: 0;">\n                <label for="device_storage_password"><%- device_password %></label>\n                <div class="input-language-container">\n                    <form autocomplete="off" onkeypress="return arguments[0].which !== 13;">\n                        <span class="left"><input class="fake-password" type="password" placeholder="Password"/></span>\n                        <input id="device_storage_password" type="password" maxlength="30"\n                               name="device_storage_password" autocomplete="off" tabindex="14"/>\n                    </form>\n                    <div id="device_storage_password_input_language" class="input-language"></div>\n                </div>\n                <button type="button" id="password_ok" class="action select small-registry-button">OK</button>\n            </div>\n        </div>\n\n        <div class="container">\n            <label for="key_name"><%- key_name %></label>\n            <input id="key_name" type="text" name="key_name" tabindex="3"/>\n        </div>\n\n        <div id="device-key-list-container" class="device-storage-element"></div>\n\n        <div class="file-storage-element">\n            <div style="width: 100%; display: inline-block; margin-bottom: 0;">\n                <label for="key_password"><%- key_password %></label>\n                <div class="input-language-container">\n                    <form autocomplete="off" onkeypress="return arguments[0].which !== 13;">\n                        <span class="left"><input class="fake-password" type="password" placeholder="Password"/></span>\n                        <input id="key_password" type="password" name="key_password" maxlength="30"\n                               autocomplete="off" tabindex="4"/>\n                    </form>\n                    <div id="key_password_input_language" class="input-language"></div>\n                </div>\n                <button type="button" id="password_ok_file" class="action select small-registry-button">OK</button>\n            </div>\n        </div>\n    </div>\n\n\n    <div class="container" id="actions">\n        <button type="button" id="unlock_device" class="primary" style="display: none"><%- unlock %></button>\n        <div class="actions-buttons-container">\n            <div class="flex-container">\n                <button type="button" disabled="disabled" id="change_password"\n                        class="action primary admin-action"><%- change_password %>\n                </button>\n                <button type="button" disabled="disabled" id="print_key"\n                        class="action admin-action"><%- print_key %>\n                </button>\n                <button type="button" disabled="disabled" id="change_alias"\n                        class="action admin-action"><%- change_alias%>\n                </button>\n                <button type="button" disabled="disabled" id="remove_key"\n                        class="action admin-action"><%- remove_key %>\n                </button>\n            </div>\n        </div>\n    </div>\n\n    <div id="net-error"></div>\n</div>\n'}),define("text!templates/registry/change_password.tmpl",[],function(){return'<div class=\'modal-dialog\'>\n    <div class="modal-header">\n        <div class="close"></div>\n        <h4><%- password_changing %></h4>\n    </div>\n\n    <div class="modal-body">\n        <div class=\'container\' id="password-change">\n            <div>\n                <label for="new_password"><%- new_password %></label>\n                <div class="input-language-container">\n                    <form autocomplete="off">\n                        <input type="password" class="fake-password" placeholder="Password"/>\n                        <input id="new_password" type="password" class="new-password" maxlength="30"\n                               autocomplete="off" tabindex="4"/>\n                    </form>\n                    <div id="new_password_input_language" class="input-language"></div>\n                </div>\n            </div>\n            <br/>\n            <div>\n                <label for="repeat_password"><%- key_password_repeat %></label>\n                <div class="input-language-container">\n                    <form autocomplete="off">\n                        <input type="password" class="fake-password" placeholder="Password"/>\n                        <input id="repeat_password" type="password" class="repeat-password" maxlength="30"\n                               autocomplete="off" tabindex="5"/>\n                    </form>\n                    <div id="repeat_password_input_language" class="input-language"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class="modal-footer">\n        <span style="width: 100%;">\n            <button type="button" id="save" class="action select primary"><%- save %></button>\n            <button type="button" id="cancel" class="action select"><%- cancel %></button>\n        </span>\n    </div>\n</div>'}),define("text!templates/registry/change_alias.tmpl",[],function(){return'<div class=\'modal-dialog\'>\n    <div class="modal-header">\n        <div class="close"></div>\n        <h4><%- alias_changing %></h4>\n    </div>\n\n    <div class="modal-body">\n        <div class=\'container\' id="alias-change">\n            <label for="new_alias"><%- new_alias %></label>\n            <input id="new_alias" type="text" name=\'new_alias\' maxlength="40" tabindex=\'1\'/>\n        </div>\n    </div>\n\n    <div class="modal-footer">\n        <span style="width: 100%;">\n            <button type="button" id="save" class="action select primary"><%- save %></button>\n            <button type="button" id="cancel" class="action select"><%- cancel %></button>\n        </span>\n    </div>\n</div>'}),define("text!templates/registry/remove_key.tmpl",[],function(){return'<div class=\'modal-dialog\'>\n    <div class="modal-header">\n        <h4><%- key_removing %></h4>\n    </div>\n\n    <div class="modal-body">\n        <div class=\'container\' id="remove-key">\n            <span><%- message %></span>\n        </div>\n    </div>\n\n    <div class="modal-footer">\n        <span style="width: 100%;">\n            <button type="button" id="save" class="action select primary"><%- yes %></button>\n            <button type="button" id="cancel" class="action select"><%- no %></button>\n        </span>\n    </div>\n</div>'}),define("registry/admin_key",["jquery","underscore","backbone","marionette","bifit","registry/print","registry/device_keys_list_collection","registry/key_storage_for_authorize","registry/device_key_list_view","text!templates/registry/admin_key.tmpl","text!templates/registry/change_password.tmpl","text!templates/registry/change_alias.tmpl","text!templates/registry/remove_key.tmpl","i18n!nls/registration","i18n!nls/validation","backboneBifit","base64"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";return h.extend({className:"doc-wrapper admin-key",template:b.template(j),changePassTemplate:b.template(k,n),changeAliasTemplate:b.template(l,n),templateHelpers:n,storagePath:"",selectedKey:{},printKeyInfo:{},ui:b.extend({actions:"button.admin-action",actionsContainer:".actions-buttons-container",keyPasswordOk:"button#password_ok_file",changePasswordBtn:"button#change_password",printButton:"button#print_key"},h.prototype.ui),events:b.extend({"chosen:select input#key_name":"selectNewKeyHandler","input input#key_name":"onChangeNewKeyName","click #password_ok_file":"onKeyPasswordOk","click #change_password":"showChangePasswordDialog","click #change_alias":"showChangeAliasDialog","click #remove_key":"showRemoveKeyDialog","click #print_key":"printKeyCertificate"},h.prototype.events),regions:{deviceKeyListRegion:"#device-key-list-container"},onRender:function(){h.prototype.onShow.call(this),this.addEnterKeyPressHandler(this.ui.keyPassword,this.onKeyPasswordOk.bind(this))},selectNewKeyHandler:function(a,c){this.selectedKey=b.clone(c),this.ui.actions.attr("disabled",!0),this.keyPasswordElementsDisabled(!1)},onChangeNewKeyName:function(){this.ui.actions.attr("disabled",!0),this.keyPasswordElementsDisabled(!1)},showFileKeyList:function(){clearErrorMessage(),SignPluginServices.getKeyListFromFile(this.storagePath).done(function(a){function c(a){return{id:a.keyId,name:a.alias}}function d(a,b){return a.name.localeCompare(b.name)}var e=b.chain(a).map(c).sort(d).value();this.ui.keyList.trigger("refresh",{array:e}),1===b.size(e)?this.ui.keyList.trigger("chooseById",b.first(e).id):this.ui.keyList.trigger("chooseById",""),this.ui.keyList.attr("placeholder",n.start_typing_key),this.keyPasswordElementsDisabled(!1)}.bind(this)).fail(function(a){showErrorMessage(a),this.ui.keyList.trigger("refresh",{array:[]}).trigger("choose"),this.keyPasswordElementsDisabled(!0)}.bind(this))},onKeyPasswordOk:function(){"disabled"!==this.ui.keyPasswordOk.attr("disabled")&&(this.ui.keyPasswordOk.attr("disabled",!0),this.ui.keyList.removeClass("error"),this.selectedKey.password=this.ui.keyPassword.val(),this.selectedKey.name=this.ui.keyList.val(),this.selectedKey.password&&this.selectedKey.name?this.testKey(this.storagePath,"").done(function(){this.ui.actions.attr("disabled",!1),this.keyPasswordElementsDisabled(!0)}.bind(this)).fail(function(){this.ui.keyPassword.addClass("error"),this.keyPasswordElementsDisabled(!1)}.bind(this)):(this.selectedKey.password||this.ui.keyPassword.addClass("error"),this.selectedKey.name||this.ui.keyList.addClass("error"),this.keyPasswordElementsDisabled(!1),showErrorMessage(n.empty_field)))},testKey:function(c,d){return clearErrorMessage(),SignPluginServices.signDataForAdminKey(this.storageTypeId,c,d,this.selectedKey.name,this.selectedKey.password).then(function(c){var d=a.Deferred();return a.ajax({type:"POST",dataType:"json",data:JSON.stringify(c),url:getBankUrl(c.system_id)+"uweb/registry/test_key",success:function(a){this.printKeyInfo=b.extend(c,a),d.resolve()}.bind(this),error:function(a){d.reject(),showErrorMessage(b.contains([400,500],a.status)?a.responseText:prepareErrorMsg4Site())}}),d}.bind(this),function(a){showErrorMessage(a),this.ui.keyList.addClass("error")}.bind(this))},selectDeviceFromList:function(a,b){this.deviceKeyListRegion.empty(),this.ui.actions.attr("disabled",!0),this.ui.actionsContainer.show(),h.prototype.selectDeviceFromList.call(this,a,b)},showDeviceKeyList:function(){var a=this.ui.devicePassword.val();this.ui.actions.attr("disabled",!0),SignPluginServices.getKeyListFromDevice(this.selectedDevice.id,a).done(function(a){var b="AUTHOR"===this.selectedDevice.vendor,c=new i({collection:new g(a),isTokenAuthor:b});this.deviceKeyListRegion.show(c),this.listenTo(c,"select-key",function(a){this.selectedKey=a,this.ui[b?"printButton":"actions"].attr("disabled",!1)}.bind(this)),this.changeUIAfterDeviceLogin()}.bind(this)).fail(function(a){this.updateDeviceListAndShowError(a)}.bind(this))},changeUIAfterDeviceLogin:function(){h.__super__.changeUIAfterDeviceLogin.call(this),this.ui.changePasswordBtn.attr("disabled",!1)},selectStorageType:function(a,b){this.ui.actions.attr("disabled",!0),this.ui.actionsContainer.show(),h.__super__.selectStorageType.call(this,a,b)},changeUIAfterFileStorageTypeSelected:function(){h.__super__.changeUIAfterFileStorageTypeSelected.call(this),this.ui.keyList.trigger("refresh",{array:[]}),this.deviceKeyListRegion.empty(),this.keyPasswordElementsDisabled(!0)},pinBlockedDeviceSelected:function(){h.__super__.pinBlockedDeviceSelected.call(this),this.ui.actionsContainer.hide()},pukBlockedDeviceSelected:function(){h.__super__.pukBlockedDeviceSelected.call(this),this.ui.actionsContainer.hide()},notInitialisedDeviceSelected:function(){h.__super__.notInitialisedDeviceSelected.call(this),showErrorMessage(n.initialize_error_2),this.ui.actionsContainer.hide()},showChangePasswordDialog:function(){this.showDialog(this.changePassTemplate,this.saveChangedPassword.bind(this));var b=a("div.modal-dialog input#new_password");this.addEnterKeyPressHandler(b,this.saveChangedPassword.bind(this));var c=a("div.modal-dialog div#new_password_input_language");InputLangService.addInputLanguageListener(b[0],c[0]);var d=a("div.modal-dialog input#repeat_password"),e=a("div.modal-dialog div#repeat_password_input_language");if(InputLangService.addInputLanguageListener(d[0],e[0]),this.onBlurPasswordChange(),!isCommonFirmware||"DEVICE"!==this.storageTypeId){var f=window.location.protocol+"//"+window.location.host+"/";loadPasswordSecurityProps(f).done(function(){this.addPasswordSecurityChecker("new_password")}.bind(this))}},showChangeAliasDialog:function(){this.showDialog(this.changeAliasTemplate,this.saveChangedAlias.bind(this));var b=a("div.modal-dialog input#new_alias");this.selectedKey.name.length>=40?b.val(this.selectedKey.name.substr(0,40)):b.val(this.selectedKey.name),this.addEnterKeyPressHandler(b,this.saveChangedAlias.bind(this))},showRemoveKeyDialog:function(){var a=b.template(m,b.extend(n,{message:e.sprintf(n.remove_key_question,this.selectedKey.id)}));this.showDialog(a,this.removeKeyFromStorage.bind(this))},showInvalidKeyAliasError:function(b){0===b.errorLevel&&6===b.errorCode?(this.closeDialog(),showErrorMessage(n.invalid_key_alias)):1===b.errorLevel&&28===b.errorCode&&(c.Validation.invalidField(this,"new_alias",n.invalid_length_key_name),a("div.modal-dialog input#new_alias").addClass("error"))},saveChangedAlias:function(){var b=a("div.modal-dialog input#new_alias").val();return b?void("DEVICE"===this.storageTypeId?SignPluginServices.changeKeyAliasInDevice(this.selectedDevice.id,this.ui.devicePassword.val(),this.selectedKey.name,b).then(function(){this.closeDialog(),this.showDeviceKeyList()}.bind(this)).fail(function(a){this.showInvalidKeyAliasError(a)}.bind(this)):SignPluginServices.changeKeyAliasInFile(this.storagePath,this.selectedKey.name,this.selectedKey.password,b).then(function(){this.closeDialog(),this.showFileKeyList()}.bind(this)).fail(function(a){this.showInvalidKeyAliasError(a)}.bind(this))):(c.Validation.invalidField(this,"new_alias",o.required),void a("div.modal-dialog input#new_alias").addClass("error"))},saveChangedPassword:function(){if(a("div.modal-dialog input.repeat-password").blur(),this.isPasswordsEqual){var b=a("div.modal-dialog input#new_password"),d=b.val(),e=this.isPasswordsEqual,f=function(a){c.Validation.invalidField(this,"new_password",a),b.addClass("error"),e=!1};isCommonFirmware&&"DEVICE"===this.storageTypeId||!localStorage.getItem("web.password.security_recommendation")?d.length<6&&f(n.password_min_length_error):checkPasswordSecurity(d,function(){},f),e&&(this.closeDialog(),"DEVICE"===this.storageTypeId?SignPluginServices.changeStoragePassword(this.selectedDevice.id,this.ui.devicePassword.val(),d).then(function(){this.selectDeviceFromList(null,this.selectedDevice)}.bind(this)):SignPluginServices.changeKeyPassword(this.storagePath,this.selectedKey.name,this.selectedKey.password,d).then(function(){this.showFileKeyList()}.bind(this)))}},removeKeyFromStorage:function(){this.closeDialog(),"DEVICE"===this.storageTypeId?SignPluginServices.removeKeyFromDevice(this.selectedDevice.id,this.ui.devicePassword.val(),this.selectedKey.name).then(function(){this.showDeviceKeyList()}.bind(this)).fail(function(a){SignPluginServices.forgetStorage().then(function(){showErrorMessage(a)})}):SignPluginServices.removeKeyFromFile(this.storagePath,this.selectedKey.name).then(function(){this.showFileKeyList()}.bind(this)).fail(function(a){SignPluginServices.forgetStorage().then(function(){showErrorMessage(a)})})},printKeyCertificate:function(){var a=function(){this.printKeyInfo.get=function(a){return this[a]},f.print(this.printKeyInfo)}.bind(this);"DEVICE"===this.storageTypeId?this.testKey(this.selectedDevice.id,this.ui.devicePassword.val()).done(a):a()},keyPasswordElementsDisabled:function(a){this.ui.keyPasswordOk.attr("disabled",a),this.ui.keyPassword.attr("disabled",a).val("").change()}})});