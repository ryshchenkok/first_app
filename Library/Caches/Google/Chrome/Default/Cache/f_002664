define("commons/base_object/document/group_opers_document_controller",["jquery","underscore","bifit","app","dialogUtils","thesaurusUtils","libs/multi_client_utils","actionUtils","collections/thesaurus","commons/base_object/document/document_controller","commons/base_object/document/confirm_reason_view","i18n!nls/document"],function(a,b,c,d,e,f,g,h,i,j,k,l){return j.extend({getListViewOptions:function(){return j.prototype.getListViewOptions.call(this)},addListViewListeners:function(a){j.prototype.addListViewListeners.call(this,a),this.listenTo(a,"update-actions",this.updateActions)},updateActions:function(a){d.mainLayout.actionBar.show(this.createActionBar(a))},COPY_GROUP:function(){var e=new this.Model({type:this.docType}),f=b.groupBy(this.collection.selected,function(a){return a.get("owner_id")}),h=0,j=this,k=b.size(f),m=b.keys(f),n=!1,o=this.showGroupList(l.group_view_copy_h1,{stopOperation:function(){n=!0},entityType:"documents",operationType:"copying"}),p=function(){if(k>h&&!n){var q=m[h++],r=f[q],s=d.isMultiClient()?g.loadTemplate(!1,q,e):e.loadTemplate();s.done(function(e){var f,h=[],k=function(a,b){var d,e=j.getWorkContent(a).NUM_DOC,f=b||e+"/C",g=j.getCurrencyName(a.getCurrency());return d=a.getFAmount()?c.sprintf(l.group_view_copy,e,a.getFAmount(),g,f):c.sprintf(l.group_view_copy_2,e,f)},m=0,s=function(){if(!n)if(m<h.length){var a=h[m++];a.on("model:completeSync",s),a.save({},{silent:!0,emulateClientRequest:d.isMultiClient()})}else p()},t=b.size(r);if(d.isMultiClient()){var u=b.findWhere(i.getThesaurus("sub_clients").array,{client_id:q}),v=r[0].attributes,w=(u||{}).name_cln||v.CLN_NAME||v.PAYER_NAME||v.SENDER,x={statusHandlers:{403:function(a){b.each(r,function(b){var c=k(b);o.add(b,c),b.trigger("model:completeSync",b,l.error,a,403)})}}};f=g.loadSubClientData(q,w,x)}else f=a.Deferred().resolve();f.then(function(){var a=function(b){var c=r[b],d=j.getWorkContent(c),f=d.NUM_DOC;j.prepareContent4Save(j.prepareContent4Create(d)).then(function(d){d.NUM_DOC=""+(e.N?e.N++:f+"/C");var g=new j.Model(d,{silent:!0}),i=k(c,d.NUM_DOC);return j.isAccountsForCreateAction()?(o.add(g,i),h.push(g),void(b===t-1?s():b%100===0?setTimeout(a.bind(this,++b),0):a(++b))):(o.add(g,i),void g.trigger("model:completeSync",g,j.getNoAccErrorText()))})};a(0)})})}};p()},DELETE_GROUP:function(){var a=this.collection.selected,c=function(){var c=!1,e=this.group(function(a,b){this.addModelToGroupView(a,b,"delete")}.bind(this),l.group_view_delete_h1,a,{stopOperation:function(){c=!0},entityType:"documents",operationType:"deleting"}),f=b.pluck(e.children,"model"),g=0,h=function(){if(g<f.length&&!c){var a=f[g++];d.isMultiClient()&&(d.multiClient.currentSubClientId=a.get("owner_id"));var e={statusHandlers:{403:function(a){h()}}};a.destroy(b.extend(e,{silent:!0,wait:!0,emulateClientRequest:d.isMultiClient(),success:function(){a.trigger("model:completeSync",a,"Ok"),h()},error:function(){h()}}))}};h()},f=1===b.keys(a).length?l.confirm_delete_doc:l.confirm_delete_many_doc;e.confirm(f,c,!1,this)},SIGN_GROUP:function(){var e=this.collection.urlRoot+this.docType+"/sign/",i=";jsessionid="+c.getStoredItem("JSESSIONID"),j=b.values(this.collection.selected),k=0,m=!1,n=function(){if(k<j.length&&!m){var o=j[k++],p=o.get("attaches");if(!b.isEmpty(p))for(var q=f.getClientProp("documents.attachments.extensions"),r=0;r<p.length;r++)if(!c.checkAttachExtension(p[r].name,q))return o.trigger("model:completeSync",o,l.error,c.sprintf(l.attach_has_not_allowed_extension,q)),void n();var s=b.isEmpty(p)?a.when():this.loadAndSetAttachesContent(o),t=s.then(function(){var a=this.signData(o);return{content:this.prepare4Sign(a),id:o.get("id")}}.bind(this),function(a){o.trigger("model:completeSync",o,l.error,c.sprintf(l.attach_load_error,a.name)),n()}),u=function(b){SignPluginServices.signData(b.content).then(function(c){a.ajax({type:"POST",dataType:"json",url:e+b.id+i,data:JSON.stringify({id:b.id,sign:c.sign,timestamp:c.timestamp}),success:function(a){o.set(a,{silent:!0}),o.trigger("model:completeSync",o,"Ok","",200),n()},error:function(a){o.trigger("model:completeSync",o,l.error,a.responseText,a.status),n()}})})},v=function(a,c){var d=b.contains(["2","2002","3004"],o.get("status"));if(d||a===w.length)return o.trigger("model:completeSync",o,"Ok","",200),void n();var f=parseInt(o.get("sign_groups_mask"));return h.hasSignOfGroup(f,w[a].GR)?void v(a+1,c):void g.useKey(w[a].ID).then(function(){SignPluginServices.signData(c.content).then(function(b){g.ajax({type:"POST",dataType:"json",url:e+c.id,data:JSON.stringify({id:c.id,sign:b.sign,timestamp:b.timestamp}),currentSubClientKeyId:w[a].ID,success:function(b){return o.set(b,{silent:!0}),b.error&&a<w.length-1?(o.trigger("model:completeSync",o,l.error,b.error,200),void n()):void v(a+1,c)},error:function(a){o.trigger("model:completeSync",o,l.error,a.responseText,a.status),n()}})})})};if(d.isMultiClient())if(-1===this.docType.indexOf("budget")){var w=g.getKeysListLocatedMultiClient(o.get("owner_id"));t.then(v.bind(this,0))}else g.useMultiClientKey().then(function(){t.then(u)});else t.then(u)}}.bind(this);this.group(function(a,b){this.addModelToGroupView(a,b,"sign"),j.length===b.children.length&&n()}.bind(this),l.group_view_sign_h1,j,{stopOperation:function(){m=!0},entityType:"documents",operationType:"signing"})},addModelToGroupView:function(a,b,d){var e,f=a.get("NUM_DOC"),g=a.getFAmount(),h="";g?(e="sign"===d?l.group_view_sign:l.group_view_delete,h=c.sprintf(e,f,g,this.getCurrencyName(a.getCurrency()))):(e="sign"===d?l.group_view_sign_2:l.group_view_delete_2,h=c.sprintf(e,f)),b.add(a,h)},REJECT_GROUP:function(){var a=new k({el:e.wrapper(),templateHelpers:{maxLength:200,title:l[1===this.collection.selectedLength?"reject_doc_title":"reject_docs_title"],ok_button_name:l.reject_link_btn,cancel_button_name:l.close_link_btn}}).render();a.on("confirm",this.groupRejectRequest,this)},groupRejectRequest:function(d){var e=b.values(this.collection.selected),f=0,g=!1,h=function(){if(f<e.length&&!g){var b=e[f++];a.ajax({type:"PUT",contentType:"application/json",data:d||"",url:this.collection.urlRoot+this.docType+"/"+b.get("id")+"/reject"+b._session(),success:function(a){b.set(a,{silent:!0}),a.error?b.trigger("model:completeSync",b,l.error,a.error,200):b.trigger("model:completeSync",b,"Ok","",200),h()}.bind(this),error:function(a){b.trigger("model:completeSync",b,"documentNls.error",a.responseText,a.status),h()}.bind(this)})}}.bind(this);this.group(function(a,b){var d=a.get("NUM_DOC");b.add(a,c.sprintf(l.group_view_reject,d)),e.length===b.children.length&&h()},l.group_view_reject_h1,e,{stopOperation:function(){g=!0},entityType:"documents",operationType:"rejecting"})},prepareDeferredForModelsFetch:function(c){var d=a.Deferred(),e=b.values(this.collection.selected),f=0,g=function(){if(f<this.collection.selectedLength){var a=e[f++];!c||c(a)?(this.listenToOnce(a,"model:completeSync",function(){g()}),a.fetch()):g()}else d.resolve()}.bind(this);return g(),d},PRINT_GROUP:function(a){a.stopPropagation(),this.printDocs(b.values(this.collection.selected))},printDocs:function(){}})}),define("apps/ua_currency_convert/nls/base_ua_currency_convert",{root:{no_cur_accs:"Невозможно создать документ. Отсутствуют два текущих счета в разных иностранных валютах.",no_uah_accs:"Невозможно создать документ. Отсутствует текущий счет в национальной валюте.",number:"Номер",date:"Дата",purchase_account:"Счет зачисления",amount:"Сумма",currency:"Валюты обмена",status:"Статус",payer:"Плательщик",cc:"Конвертация валюты",ua_currency_convert:"Конвертация валюты",ua_currency_convert_list:"Конвертация валюты",name:"Наименование",egrpou:"ЕГРПОУ",mfo:"МФО",addr:"Адрес",from_our_acc:"с нашего валютного счета",on_bnk_acc:"на счет банка N",and_sale:"и продать",ask_to_by:"просим купить",currency_acc:" наш валютный счет",get_from:"поручаем списать с",comission:"Комиссию",reason:"Основания",valid_till:"Действительно до",hrn_sum:"сумму в ",in_bank:"в банке",enroll:"и зачислить на",in_case:"При невозможности исполнения заявления просим вернуть валюту на счет N",not_ua_acount_for_mfo:"Отсутствуют права на работу с гривневыми счетами в МФО {1}",not_acount_for_cur:"Отсутствуют права на работу со счетами в выбранной валюте",not_acount_for_cur_for_mfo:"Отсутствуют права на работу со счетами в выбранной валюте в МФО {1}",asc_to_change:"Прошу обменять",rate:"Курс",amount_in:"Сумму в",from_account:"co счета",to_currency:"на валюту",enroll_to_account:"зачислить на",enroll_to_account2:"Зачислить на",purchase_reason:"Основания для обмена",commission:"Комиссия, %",cln_employee:"Уполномоченный сотрудник компании",phone:"Телефон",date_doc:"Дата документа",number_doc:"Номер",validity:"Срок действия",to_bank_account:"на счет банка",transf_kind_0:"обязуемся перечислить",transf_kind_1:"поручаем банку списать",transfer_kind_myself:"обязуюсь перечислить на",transfer_kind_bank:"поручаю банку списать",rate0:"по курсу",rate0_label:"по курсу",rate1:"по курсу уполномоченного банка",debit_from_account:"Списать со счета",commission_placeholder:"по тарифам банка",cln_employee_fio_placeholder:"ФИО (необяз.)",cln_employee_phone_placeholder:"тел. (необяз.)",num_doc_placeholder:"автонумер.",date_doc_placeholder:"текущая",not_required_placeholder:"необяз.",empty_amounts_field:"Укажите либо продаваемую, либо покупаемую сумму",field_NUM_DOC:"Номер документа",field_DATE_DOC:"Дата документа",field_CLN_OKPO:"ЕГРПОУ клиента",field_CLN_NAME:"Наименование клиента",field_CLN_ADDR:"Адрес клиента",field_CLN_PHONE:"Контактный телефон клиента",field_CLN_EMPLOYEE_FIO:"Ф.И.О. ответственного сотрудника клиента",field_CLN_EMPLOYEE_PHONE:"Контактный телефон ответственного сотрудника клиента",field_PURCHASE_REASON:"Основание для купли иностранной валюты",field_BNK_NAME:"Наименование уполномоченного банка",field_BNK_MFO:"МФО уполномоченного банка",field_BNK_ADDR:"Адрес уполномоченного банка",field_SALE_SUM:"Сумма гривен для купли иностранной валюты",field_SALE_CURRENCY:"Код продаваемой иностранной валюты",field_SALE_BNK_ACCOUNT:"Транзитный счет банка",field_PURCHASE_SUM:"Сумма покупаемой иностранной валюты",field_PURCHASE_CURRENCY:"Код покупаемой иностранной валюты",field_PURCHASE_ACCOUNT:"Счет клиента для зачисления покупаемой иностранной валюты",field_COMMISSION:"Комиссия уполномоченного банка",field_EXPIRY_DATE:"Срок действия Заявления",field_TRANSFER_KIND:"Вариант перечисления суммы в гривне для покупки валюты",field_SALE_RATE_KIND:"Вариант выбора курса продажи иностранной валюты",field_SALE_RATE:"Курс продажи иностранной валюты",field_RETURN_ACCOUNT:"Счет клиента для возврата иностранной валюты",field_COMMISSION_ACCOUNT:"Счет списания комиссии уполномоченного банка",field_COMMISSION_BNK_ACCOUNT:"Счет зачисления комиссии уполномоченного банка",footer_s_template:"{1} {2} {3} из {4}",footer_selected_sin:"Выбрано",footer_selected_pl:"Выбрано",footer_1_doc:"заявление",footer_1_doc_pl:"заявление",footer_2_4_docs:"заявления",footer_5_0_docs:"заявлений",transfer_acc_key_count_error:"Ошибка ключевания транзитного счета банка",commission_bnk_account_keying_error:"Документ не может быть сохранен, потому что возникла ошибка ключевания счета банка для зачисления комиссии.",no_account_for_bnk_commission:"Документ не может быть сохранен, потому что не задан счет банка для зачисления комиссии."},uk:!0,en:!0}),define("apps/ua_currency_convert/nls/ua_currency_convert",["underscore","apps/ua_currency_convert/nls/base_ua_currency_convert"],function(a,b){return{root:a.extend({},b.root,{ua_currency_convert:"Заявление о конвертации валюты",ua_currency_convert_list:"Заявление о конвертации валюты",ask_for_sale:"Просим продать",ask_for_purchase:"и купить",one_exch_item:" за 1 ",sale_acc_label:"Необходимую сумму поручаем Банку списать со счета",purchase_acc_label:"и перечислить купленную валюту на счет",return_acc_label:"Неиспользованные средста просим вернуть на счет",commission_acc_label:"Поручаем Банку списать комиссию со счета",transit_kind:"Обязуемся перечислить",same_currency_accounts:"Выбраны счета с одинаковой валютой",rate1_label:"по курсу уполномоченного банка",cur_acc:"Валютный счет",amount:"Сумма",curr:"Валюта",purchase_reason:"Основание для покупки",field_CLN_PHONES:"Контактный телефон клиента",field_CLN_EMPLOYEE_FIO:"Ф.И.О. ответственного сотрудника",field_CLN_EMPLOYEE_PHONE:"Контактный телефон ответственного сотрудника",field_PURCHASE_REASON:"Цель покупки иностранной валюты за другую валюту",field_BNK_NAME:"Наименование уполномоченного банка клиента",field_SALE_SUM:"Сумма продажи иностранной валюты",field_SALE_ACCOUNT:"Счет клиента для списания продаваемой иностранной валюты",field_PURCHASE_SUM:"Сумма покупки иностранной валюты",field_PURCHASE_CURRENCY:"Буквенный код покупаемой иностранной валюты",field_PURCHASE_RATE_KIND:"Вариант выбора курса покупки иностранной валюты",field_PURCHASE_RATE:"Курс покупки иностранной валюты",field_SALE_CURRENCY:"Буквенный код продаваемой иностранной валюты",field_COMMISSION:"Процент отчисляемой комиссии",field_EXPERIENCE_DATE:"Срок действия Заявления",field_CURRENCY_DATE:"Дата валютирования",field_PURCHASE_BNK_NAME:"Наименование банка, в котором открыт счет клиента для зачисления покупаемой иностранной валюты",field_PURCHASE_BNK_MFO:"МФО банка, в котором открыт счет клиента для зачисления покупаемой иностранной валюты",field_SALE_BNK_NAME:"Наименование банка, в котором открыт счет клиента для списания продаваемой иностранной валюты",field_SALE_BNK_MFO:"МФО банка, в котором открыт счет клиента для списания продаваемой иностранной валюты",field_TRANSIT_ACCOUNT:"Транзитный счет для перечисления суммы, необходимой для покупки",field_TRANSIT_BNK_NAME:"Наименование банка, в котором открыт транзитный счет для перечисления суммы, необходимой для покупки",field_TRANSIT_BNK_MFO:"МФО банка, в котором открыт транзитный счет для перечисления суммы, необходимой для покупки",field_TRANSIT_BNK_ADDR:"Адрес банка с транзитным счетом",field_COMMISSION_ACCOUNT:"Гривневый счет для списания комиссии",field_COMMISSION_BNK_NAME:"Наименование банка, в котором открыт гривневый счет для списания комиссии",field_COMMISSION_BNK_MFO:"МФО банка, в котором открыт гривневый счет для списания комиссии",field_COMMISSION_BNK_ADDR:"Адрес банка с коммиссионным счетом",field_TRANSIT_KIND:"Способ перечисления суммы на покупку",field_CLN_OKPO:"Код ЕГРПОУ клиента",field_RETURN_ACCOUNT:"Счет для возврата валюты"}),uk:!0,en:!0}}),define("apps/ua_currency_convert/nls/uk/base_ua_currency_convert",{no_cur_accs:"Неможливо створити документ. Вiдсутнi два поточнi рахунки у рiзних iноземних валютах.",no_uah_accs:"Неможливо створити документ. Вiдсутнiй поточний рахунок в нацiональнiй валютi.",number:"Номер",date:"Дата",purchase_account:"Рахунок зарахування",amount:"Сума",currency:"Валюти обміну",status:"Статус",payer:"Платник",cc:"Конвертація валюти",ua_currency_convert:"Конвертація валюти",ua_currency_convert_list:"Конвертація валюти",name:"Найменування",egrpou:"ЄДРПОУ",mfo:"МФО",addr:"Адреса",from_our_acc:"з нашого валютного рахунку",on_bnk_acc:"на рахунок банку N",and_sale:"і продати",ask_to_by:"просимо купити",currency_acc:"наш валютний рахунок",get_from:"доручаємо списати з",comission:"Комісію",reason:"Підстави",valid_till:"Дійсно до",hrn_sum:"суму в ",in_bank:"в банку",enroll:"і зарахувати на",in_case:"При неможливості виконання заяви просимо повернути валюту на рахунок N",not_ua_acount_for_mfo:"Відсутні права на роботу з гривневими рахунками в МФО {1}",not_acount_for_cur:"Відсутні права на роботу з рахунками в обраній валюті",not_acount_for_cur_for_mfo:"Відсутні права на роботу з рахунками в обраній валюті в МФО {1}",asc_to_change:"Прошу обміняти",rate:"Курс",amount_in:"Суму в",from_account:"з рахунку",to_currency:"на валюту",enroll_to_account:"зарахувати на",enroll_to_account2:"Зарахувати на",purchase_reason:"Підстави для обміну",commission:"Комісія, %",cln_employee:"Уповноважений співробітник компанії",phone:"Телефон",date_doc:"Дата документа",number_doc:"Номер",validity:"Термін дії",to_bank_account:"на рахунок банку",transf_kind_0:"зобов'язуємося перерахувати",transf_kind_1:"доручаємо банку списати",transfer_kind_myself:"зобов'язуюсь перерахувати на",transfer_kind_bank:"доручаю банку списати",rate0:"за курсом",rate0_label:"за курсом",rate1:"за курсом уповноваженого банку",debit_from_account:"Списати з рахунку",commission_placeholder:"за тарифами банку",cln_employee_fio_placeholder:"ПІБ (не обов'яз.)",cln_employee_phone_placeholder:"тел. (не обов'яз.)",num_doc_placeholder:"автонумер.",date_doc_placeholder:"поточна",not_required_placeholder:"не обов'яз.",empty_amounts_field:"Вкажіть або суму, що продається, або що купується",field_DATE_DOC:"Дата документа",field_NUM_DOC:"Номер",field_CLN_OKPO:"ЄДРПОУ клієнта",field_CLN_NAME:"Найменування клиента",field_CLN_ADDR:"Адреса клієнта",field_CLN_PHONE:"Контактний телефон клієнта",field_CLN_EMPLOYEE_FIO:"П.І.Б. уповноваженого співробітника клієнта",field_CLN_EMPLOYEE_PHONE:"Контактний телефон уповноваженого співробітника клієнта",field_PURCHASE_REASON:"Підстава для купівлі іноземної валюти",field_BNK_NAME:"Найменування уповноваженого банку",field_BNK_MFO:"МФО уповноваженого банку",field_BNK_ADDR:"Адрес уповноваженого банку",field_SALE_SUM:"Сума гривень для купівлі іноземної валюти",field_SALE_CURRENCY:"Код іноземної валюти, що продається",field_SALE_BNK_ACCOUNT:"Транзитний рахунок банку",field_PURCHASE_SUM:"Сума іноземної валюти, що купується",field_PURCHASE_CURRENCY:"Код іноземної валюти, що купується",field_PURCHASE_ACCOUNT:"Рахунок клієнта для зарахування іноземної валюти, що купується",field_COMMISSION:"Комісія уповноваженого банку",field_EXPIRY_DATE:"Термін дії Заяви",field_TRANSFER_KIND:"Варіант перерахування суми у гривні для покупки валюти",field_SALE_RATE_KIND:"Варіант вибору курса продажу іноземної валюти",field_SALE_RATE:"Курс продажу іноземної валюти",field_RETURN_ACCOUNT:"Рахунок клієнта для повернення іноземної валюти",field_COMMISSION_ACCOUNT:"Рахунок списання комісії уповноваженого банку",field_COMMISSION_BNK_ACCOUNT:"Рахунок зарахування комісії уповноваженого банку",footer_s_template:"{1} {2} {3} з {4}",footer_selected_sin:"Обрана",footer_selected_pl:"Обрано",footer_1_doc:"заява",footer_1_doc_pl:"заява",footer_2_4_docs:"заяви",footer_5_0_docs:"заяв",transfer_acc_key_count_error:"Помилка ключування транзитного рахунку банку",commission_bnk_account_keying_error:"Документ не може бути збережений, тому що виникла помилка ключування рахунку банку для зарахування комісії.",no_account_for_bnk_commission:"Документ не може бути збережений, тому що не заданий рахунок банку для зарахування комісії."}),define("apps/ua_currency_convert/nls/uk/ua_currency_convert",["underscore","apps/ua_currency_convert/nls/uk/base_ua_currency_convert"],function(a,b){return a.extend({},b,{ua_currency_convert:"Заява про конвертацiю валюти",ua_currency_convert_list:"Заява про конвертацiю валюти",ask_for_sale:"Просимо продати",ask_for_purchase:"та купити",one_exch_item:" за 1 ",sale_acc_label:"Необхiдну суму доручаємо Банку списати з рахунку",purchase_acc_label:"та зарахувати куплену валюту на рахунок",return_acc_label:"Невикористанi кошти просимо повернути на рахунок",commission_acc_label:"Доручаємо Банку списати комiсiю з рахунку",transit_kind:"Зобов'язуємося перерахувати",same_currency_accounts:"Обрано рахунки з однаковою валютою",rate1_label:"за курсом уповноваженого банку",cur_acc:"Валютний рахунок",amount:"Сума",curr:"Валюта",purchase_reason:"Підстава для купівлі",field_CLN_PHONES:"Контактний телефон клієнта",field_CLN_EMPLOYEE_FIO:"П.І.Б. відповідального співробітника",field_CLN_EMPLOYEE_PHONE:"Контактний телефон відповідального співробітника",field_PURCHASE_REASON:"Підстава для купівлі іноземної валюти за іншу валюту",field_BNK_NAME:"Найменування уповноваженого банку клієнта",field_SALE_SUM:"Сума продажу іноземної валюти",field_SALE_ACCOUNT:"Рахунок клієнта для списання продаваної іноземної валюти",field_PURCHASE_SUM:"Сума купівлі іноземної валюти",field_PURCHASE_CURRENCY:"Буквений код іноземної валюти, що купується",field_PURCHASE_RATE_KIND:"Варіант вибору курсу купівлі іноземної валюти",field_PURCHASE_RATE:"Курс купівлі іноземної валюти",field_SALE_CURRENCY:"Буквений код продаваної іноземної валюти",field_COMMISSION:"Відсоток сплачуваної комісії",field_EXPERIENCE_DATE:"Термін дії Заяви",field_CURRENCY_DATE:"Дата валютування",field_PURCHASE_BNK_NAME:"Найменування банку, у якому відкритий рахунок клієнта для зарахування іноземної валюти, що купується",field_PURCHASE_BNK_MFO:"МФО банку, у якому відкритий рахунок клієнта для зарахування іноземної валюти, що купується",field_SALE_BNK_NAME:"Найменування банку, у якому відкритий рахунок клієнта для списання продаваної іноземної валюти",field_SALE_BNK_MFO:"МФО банку, у якому відкритий рахунок клієнта для списання продаваної іноземної валюти",field_TRANSIT_ACCOUNT:"Транзитний рахунок для перерахування суми, необхідної для купівлі",field_TRANSIT_BNK_NAME:"Найменування банку, у якому відкритий транзитний рахунок для перерахування суми, необхідної для купівлі",field_TRANSIT_BNK_MFO:"МФО банку, у якому відкритий транзитний рахунок для перерахування суми, необхідної для купівлі",field_TRANSIT_BNK_ADDR:"Адреса банку з транзитним рахунком",field_COMMISSION_ACCOUNT:"Гривневий рахунок для списання комісії",field_COMMISSION_BNK_NAME:"Найменування банку, у якому відкритий гривневий рахунок для списання комісії",field_COMMISSION_BNK_MFO:"МФО банку, у якому відкритий гривневий рахунок для списання комісії",field_COMMISSION_BNK_ADDR:"Адреса банку з комісійним рахунком",field_TRANSIT_KIND:"Спосіб перерахування суми на покупку",field_CLN_OKPO:"Код ЄДРПОУ клiєнта",field_RETURN_ACCOUNT:"Рахунок для повернення валюти"})}),define("apps/ua_currency_convert/nls/en/base_ua_currency_convert",{no_cur_accs:"Unable to create a document. Current accounts in different foreign currency are missing.",no_uah_accs:"Unable to create a document. Current account in national currency is missing.",number:"Number",date:"Date",purchase_account:"Account for crediting",amount:"Amount",currency:"Exchanged currencies",status:"Status",payer:"Payer",cc:"Currency conversion",ua_currency_convert:"Currency conversion",ua_currency_convert_list:"Currency conversions",name:"Name",egrpou:"EDRPOU",mfo:"MFO",addr:"Address",from_our_acc:"from our currency account",on_bnk_acc:"on bank account No",and_sale:"and sell",ask_to_by:"ask to buy",currency_acc:" our currency account",get_from:"order to write-off from",comission:"Comission",reason:"Bases",valid_till:"Valid till",hrn_sum:"Amount in ",in_bank:"in bank",enroll:"and transfer to",in_case:"In case of impossibility of order execution ask to return currency to the account No",not_ua_acount_for_mfo:"There are no rights for working with hryvnia accounts in MFO {1}",not_acount_for_cur:"There are no rights for working with accounts in selected currency",not_acount_for_cur_for_mfo:"There are no rights for working with accounts in selected currency in MFO {1}",asc_to_change:"Request to exchange",rate:"Rate",amount_in:"Amount in",from_account:"from account",to_currency:"to currency",enroll_to_account:"transfer to",enroll_to_account2:"Transfer to",purchase_reason:"Bases for exchange",commission:"Commission, %",cln_employee:"Authorized employee of the company",phone:"Phone",date_doc:"Document date",number_doc:"Number",validity:"Validity",to_bank_account:"on bank account",transf_kind_0:"зобов'язуємося перерахувати",transf_kind_1:"доручаємо банку списати",transfer_kind_myself:"зобов'язуюсь перерахувати на",transfer_kind_bank:"доручаю банку списати",rate0:"за курсом",rate0_label:"за курсом",rate1:"за курсом уповноваженого банку",debit_from_account:"PF tax write-off from the account",commission_placeholder:"according to the bank tariffs",cln_employee_fio_placeholder:"Full name (optional)",cln_employee_phone_placeholder:"phone (optional)",num_doc_placeholder:"autonum.",date_doc_placeholder:"current",not_required_placeholder:"optional",empty_amounts_field:"Specify either selling or purchasing amount",field_NUM_DOC:"Document number",field_DATE_DOC:"Document date",field_CLN_OKPO:"Client's EDRPOU",field_CLN_NAME:"Client's name",field_CLN_ADDR:"Client address",field_CLN_PHONE:"Client's phone number",field_CLN_EMPLOYEE_FIO:"Responsible employee's full name",field_CLN_EMPLOYEE_PHONE:"Employee's phone number",field_PURCHASE_REASON:"Basis for foreign currency purchase",field_BNK_NAME:"Authorized bank name ",field_BNK_MFO:"MFO of authorized bank",field_BNK_ADDR:"Address of authorized bank",field_SALE_SUM:"Amount in hryvnia for foreign currency purchase",field_SALE_CURRENCY:"Code of foreign currency that is sold",field_SALE_BNK_ACCOUNT:"Bank transit account",field_PURCHASE_SUM:"Amount of foreign currency that is purchased",field_PURCHASE_CURRENCY:"Code of foreign currency that is purchased",field_PURCHASE_ACCOUNT:"Client's account for transfer foreign currency that is purchased",field_COMMISSION:"Commission of authorized bank",field_EXPIRY_DATE:"Order validity period",field_TRANSFER_KIND:"Transfer kind of amount in national currency for currency purchase",field_SALE_RATE_KIND:"Foreign currency sale rate option",field_SALE_RATE:"Foreign currency sale rate",field_RETURN_ACCOUNT:"Client's account for hryvnia return",field_COMMISSION_ACCOUNT:"Account of authorized bank for debiting commission",field_COMMISSION_BNK_ACCOUNT:"Account for crediting commission of authorized bank",footer_s_template:"{1} {2} {3} of {4}",footer_selected_sin:"Selected",footer_selected_pl:"Selected",footer_1_doc:"order",footer_1_doc_pl:"orders",footer_2_4_docs:"orders",footer_5_0_docs:"orders",transfer_acc_key_count_error:"Bank transit account keying error",commission_bnk_account_keying_error:"Document could not be saved because bank account to transfer of the commission keying error.",no_account_for_bnk_commission:"Document could not be saved because bank account to transfer of the commission is not set."}),define("apps/ua_currency_convert/nls/en/ua_currency_convert",["underscore","apps/ua_currency_convert/nls/en/base_ua_currency_convert"],function(a,b){return a.extend({},b,{ua_currency_convert:"Conversion Order",ua_currency_convert_list:"Conversion Orders",ask_for_sale:"Ask to sell",ask_for_purchase:"and buy",one_exch_item:" for 1 ",sale_acc_label:"We authorize to write off the required amount from the account",purchase_acc_label:"and transfer purchased currency to the account",return_acc_label:"We order the unused funds to return to the account",commission_acc_label:"We authorize the Bank the commission to",transit_kind:"Зобов'язуємося перерахувати",same_currency_accounts:"Accounts with the same currency are selected",rate1_label:"according to the exchange rate of the bank",rate0_label:"according to the exchange rate",cur_acc:"Currency account",amount:"Amount",curr:"Currency",purchase_reason:"Base for purchase",field_CLN_PHONES:"Client's phone number",field_CLN_EMPLOYEE_FIO:"Responsible employee's full name",field_CLN_EMPLOYEE_PHONE:"Employee's phone number",field_PURCHASE_REASON:"Reason of buying foreign currency for another currency",field_BNK_NAME:"Client's bank name",field_SALE_SUM:"Amount of foreign currency that is sold",field_SALE_ACCOUNT:"Client's account for debiting foreign currency that is sold",field_PURCHASE_SUM:"Amount of foreign currency that is purchased",field_PURCHASE_CURRENCY:"Literal code of currency that are purchasing",field_PURCHASE_RATE_KIND:"Foreign currency purchase rate option",field_PURCHASE_RATE:"Foreign currency purchase rate",field_SALE_CURRENCY:"Literal code of currency that are selling",field_COMMISSION:"Commission percent",field_EXPERIENCE_DATE:"Order validity period",field_CURRENCY_DATE:"Value date",field_PURCHASE_BNK_NAME:"Bank name where client's account for hryvnia transfer is opened",field_PURCHASE_BNK_MFO:"Bank MFO where client's account for hryvnia transfer is opened",field_SALE_BNK_NAME:"Bank name where client's account for debiting currency is opened",field_SALE_BNK_MFO:"Bank MFO where client's account for debiting currency is opened",field_TRANSIT_ACCOUNT:"Transit account for transfer of the amount required to buy",field_TRANSIT_BNK_NAME:"Bank name where transit account for transfer of purchasing amount is opened",field_TRANSIT_BNK_MFO:"Bank MFO where transit account for transfer of purchasing amount is opened",field_TRANSIT_BNK_ADDR:"Bank address where transit account is opened",field_COMMISSION_ACCOUNT:"Hryvnia account for debiting commission",field_COMMISSION_BNK_NAME:"Bank name where hryvnia account for debiting commission is opened",field_COMMISSION_BNK_MFO:"Bank MFO where hryvnia account for debiting commission is opened",field_COMMISSION_BNK_ADDR:"Bank address where commission account is opened",field_TRANSIT_KIND:"Way of transferring the sum that is purchased",field_CLN_OKPO:"Client's EDRPOU",field_RETURN_ACCOUNT:"Account for currency return"})}),define("apps/ua_currency_convert/ua_currency_convert_model",["jquery","underscore","bifit","thesaurusUtils","collections/thesaurus","appsPieces","models/base_document","i18n!nls/validation","i18n!apps/ua_currency_convert/nls/ua_currency_convert","backboneValidation"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=function(){var a="documents.bank_rate_choice.hide";return"true"===d.firstPropOf(a)};return g.extend({type:"ua_currency_convert",nls:i,defaults:{status:"",status_desc:"",status_color:"000000",DATE_DOC:"",NUM_DOC:"",CLN_NAME:"",CLN_PHONES:"",CLN_ADDR:"",CLN_EMPLOYEE_FIO:"",CLN_EMPLOYEE_PHONE:"",CLN_OKPO:"",BNK_NAME:"",BNK_MFO:"",BNK_ADDR:"",PURCHASE_SUM:"",PURCHASE_CURRENCY:"",PURCHASE_RATE:"",PURCHASE_ACCOUNT:"",PURCHASE_BNK_NAME:"",PURCHASE_BNK_MFO:"",PURCHASE_REASON:"",SALE_SUM:"",SALE_CURRENCY:"",SALE_ACCOUNT:"",SALE_BNK_NAME:"",SALE_BNK_MFO:"",COMMISSION:"",EXPERIENCE_DATE:"",CURRENCY_DATE:"",PURCHASE_RATE_KIND:"",TRANSIT_ACCOUNT:"",TRANSIT_BNK_NAME:"",TRANSIT_BNK_MFO:"",TRANSIT_BNK_ADDR:"",COMMISSION_BNK_NAME:"",COMMISSION_BNK_MFO:"",COMMISSION_ACCOUNT:"",COMMISSION_BNK_ADDR:"",TRANSIT_KIND:"",RETURN_ACCOUNT:"",ATT_CNT:"0"},meta:b.extend({},g.prototype.meta,{relatively:b.extend({PURCHASE_SUM:function(a){return parseFloat(a)}},g.prototype.meta.relatively),amount:"PURCHASE_SUM",currency:"PURCHASE_CURRENCY",formattedFields:{SALE_SUM:function(){return this._amountFormatter(this.get("SALE_SUM"),this.get("SALE_CURRENCY"),4)},PURCHASE_SUM:function(){return this._amountFormatter(this.get("PURCHASE_SUM"),this.get("PURCHASE_CURRENCY"),4)},PURCHASE_RATE:function(){return this._amountFormatter(this.get("PURCHASE_RATE"),6)}}}),order:["DATE_DOC","NUM_DOC","CLN_NAME","CLN_PHONES","CLN_ADDR","CLN_EMPLOYEE_FIO","CLN_EMPLOYEE_PHONE","PURCHASE_REASON","BNK_NAME","BNK_MFO","BNK_ADDR","PURCHASE_SUM","PURCHASE_CURRENCY","PURCHASE_RATE","PURCHASE_ACCOUNT","PURCHASE_BNK_NAME","PURCHASE_BNK_MFO","SALE_SUM","SALE_CURRENCY","SALE_ACCOUNT","SALE_BNK_NAME","SALE_BNK_MFO","COMMISSION","EXPERIENCE_DATE","CURRENCY_DATE","PURCHASE_RATE_KIND","TRANSIT_ACCOUNT","TRANSIT_BNK_NAME","TRANSIT_BNK_MFO","COMMISSION_BNK_NAME","COMMISSION_BNK_MFO","COMMISSION_ACCOUNT","TRANSIT_BNK_ADDR","COMMISSION_BNK_ADDR","TRANSIT_KIND","CLN_OKPO","RETURN_ACCOUNT"],validation:{NUM_DOC:{numDocRequired:!0,maxLength:10},DATE_DOC:{dateDoc:!0},CLN_NAME:{required:!0,maxLength:40},CLN_OKPO:{required:!0,clientInfo:"okpo",minLength:8,maxLength:10,digits:!0},CLN_ADDR:{required:!0,maxLength:80},CLN_PHONES:{required:!0,maxLength:20},CLN_EMPLOYEE_FIO:{required:!1,maxLength:40},CLN_EMPLOYEE_PHONE:{required:!1,maxLength:20},PURCHASE_REASON:{required:!0,maxLength:550},BNK_NAME:{required:!0,maxLength:45},BNK_MFO:{required:!0,length:6,digits:!0},BNK_ADDR:{required:!0,maxLength:80},SALE_SUM:{fn:function(a,b,c){var d;if(a)if(/^\d{1,10}\.\d{0,4}$/.test(a)){var e=parseFloat(a);1e-4>e?d=h.positive_amount:e>99999999999.9999&&(d=h.incorrect_amount)}else d=h.incorrect_amount;else c.PURCHASE_SUM||(d=i.empty_amounts_field);return d}},SALE_CURRENCY:{required:!0,length:3},TRANSIT_KIND:{required:!0,maxLength:70,fn:function(a){var c=["Обязуемся перечислить","Зобов'язуємося перерахувати","Доручаємо перерахувати","Поручаем перечислить"];
return b.contains(c,a)?void 0:h.invalid_field}},SALE_ACCOUNT:{required:!0,minLength:5,maxLength:14,digits:!0,fn:function(a,c,d){var e,g=b.where(f.getAccounts(["1"],!0)[d.SALE_CURRENCY],{account:a});if(b.isEmpty(g))return e=h.invalid_field;var i=b.any(g,function(a){return a.permissions>0});return i||(e=h.account_not_permission),e}},PURCHASE_RATE_KIND:{required:!0,maxLength:30,fn:function(a){return b.contains(["по курсу","за курсом"],a)||!j()&&b.contains(["по курсу уполномоченного банка","за курсом уповноваженого банку","по курсу банка","за курсом банку"],a)?void 0:h.invalid_field}},PURCHASE_RATE:{fn:function(a,b,c){var d;if(a)if(/^\d{1,4}\.\d{0,6}$/.test(a)){var e=parseFloat(a);1e-6>e?d=h.positive_amount:e>9999.9999999&&(d=h.incorrect_amount)}else d=h.incorrect_amount;else"по курсу"!==c.PURCHASE_RATE_KIND&&"за курсом"!==c.PURCHASE_RATE_KIND||(d=h.required);return d}},PURCHASE_SUM:{fn:function(a,b,c){var d;if(a)if(/^\d{1,10}\.\d{0,4}$/.test(a)){var e=parseFloat(a);1e-4>e?d=h.positive_amount:e>9999999999.9999&&(d=h.incorrect_amount)}else d=h.incorrect_amount;else c.SALE_SUM?"по курсу"!==c.PURCHASE_RATE_KIND&&"за курсом"!==c.PURCHASE_RATE_KIND||(d=h.required):d=i.empty_amounts_field;return d}},PURCHASE_CURRENCY:{required:!0,length:3,fn:function(a,b,c){return a===c.SALE_CURRENCY?i.same_currency_accounts:void 0}},PURCHASE_ACCOUNT:{required:!0,minLength:5,maxLength:14,digits:!0,fn:function(a,c,d){var e,g=b.where(f.getAccounts(["1"],!0)[d.PURCHASE_CURRENCY],{account:a});if(b.isEmpty(g))return e=h.invalid_field;var i=b.any(g,function(a){return a.permissions>0});return i||(e=h.account_not_permission),e}},RETURN_ACCOUNT:{required:!0,minLength:5,maxLength:14,digits:!0},COMMISSION_ACCOUNT:{required:!0,minLength:5,maxLength:14,digits:!0,fn:function(a){var c,d=b.where(f.getAccounts(["1"],!0).UAH,{account:a});if(b.isEmpty(d))return c=h.invalid_field;var e=b.any(d,function(a){return a.permissions>0});return e||(c=h.account_not_permission),c}},PURCHASE_BNK_NAME:{required:!0,maxLength:45,fn:function(a,b,c){return c.BNK_NAME!==a?h.invalid_field:void 0}},PURCHASE_BNK_MFO:{required:!0,maxLength:6,fn:function(a,b,c){return c.BNK_MFO!==a?h.invalid_field:void 0}},SALE_BNK_NAME:{required:!0,maxLength:45,fn:function(a,b,c){return c.BNK_NAME!==a?h.invalid_field:void 0}},SALE_BNK_MFO:{required:!0,maxLength:6,fn:function(a,b,c){return c.BNK_MFO!==a?h.invalid_field:void 0}},EXPERIENCE_DATE:{fn:function(a,b,d){var e,f=d.DATE_DOC;if(f&&a)if(c.checkDateMatch(a)){f=c.str2date(f),a=c.str2date(a);var g=a.getTime()-f.getTime();0>g?e=h.expire_date_01:Math.floor(g/1e3/60/60/24)>10&&(e=c.sprintf(h.expire_date_02,10))}else e=h.incorrect_date;return e}},CURRENCY_DATE:{fn:function(a,b,d){var e,f=d.DATE_DOC,g=d.EXPERIENCE_DATE;if(f&&a)if(c.checkDateMatch(a)){f=c.str2date(f),a=c.str2date(a);var i=a.getTime()-f.getTime();0>i?e=h.value_date_01:g&&g.length>0&&c.str2date(g).getTime()<a.getTime()?e=h.value_date_02:Math.floor(i/1e3/60/60/24)>90&&(e=this._valueDateErrorWrapper(90))}else e=h.incorrect_date;return e}},COMMISSION_BNK_NAME:{required:!0,maxLength:45,fn:function(a,b,c){return c.BNK_NAME!==a?h.invalid_field:void 0}},COMMISSION_BNK_MFO:{required:!0,maxLength:6,fn:function(a,b,c){return c.BNK_MFO!==a?h.invalid_field:void 0}},COMMISSION_BNK_ADDR:{required:!0,maxLength:80,fn:function(a,b,c){return c.BNK_ADDR!==a?h.invalid_field:void 0}},COMMISSION:{fn:function(a){return a&&!/^\d{5}\.\d{0,2}$/.test(a)?h.incorrect_amount:void 0}},OPER_TYPE:{fn:function(a){var b;return a&&"0"!==a&&"1"!==a&&(b=h.invalid_field),b}}}})}),define("text!templates/views/document/group-filter.tmpl",[],function(){return'<div class="group-checkbox" onmousedown="return false" onselectstart="return false">\n    <div class="popup-wrapper bottom sub-menu">\n        <ul class="popup filter">\n        </ul>\n    </div>\n</div>\n\n'}),define("commons/base_object/document/group_opers_doc_list_view",["jquery","underscore","app","bifit","services/doc_statuses","actionUtils","commons/base_object/base_list_view","text!templates/views/document/group-filter.tmpl","i18n!nls/document","libs/group_opers_utils"],function(a,b,c,d,e,f,g,h,i,j){"use strict";return g.extend({events:b.extend(g.prototype.events,{"click th.check input":"markAll","click div.group-checkbox a":"markByStatus","click div.group-checkbox":"toggleFilter"}),childEvents:b.extend(g.prototype.childEvents,{markOne:"markOne"}),footerNls:null,isAccountsForCreateAction:null,initialize:function(a){g.prototype.initialize.apply(this,arguments),this.isAccountsForCreateAction=a.isAccountsForCreateAction,"false"!==d.getStorageData("is_need_deselect_selected_items")&&b.each(this.collection.selected,function(a){this.collection.deselect(a)}.bind(this)),d.setStorageData("is_need_deselect_selected_items","true")},selectItem:function(a,b){g.prototype.selectItem.call(this,a,b),d.setStorageData("is_need_deselect_selected_items","false")},onRender:function(){g.prototype.onRender.call(this),this.prepareTable()},prepareTable:function(){j.prepareTable.call(this),this.initStatusSelector(),this.postModelMark()},initStatusSelector:function(){var c=b.uniq(b.map(this.collection.models,function(a){return a.get("status")})),f=b.intersection(c,["0","1","3004"]);if(f){if(f.length>1){var g=d.getLocale(),j=a(b.template(h,i)),k=j.find("ul");b.each(f,function(b){var c=parseInt(b,10),f=d.sprintf(i.flt_st,e.getLocalizedNameById(c,g)),h="st"+b;a("<li><a data-action='"+h+"' href='#'>"+f+"</a></li>").appendTo(k)}.bind(this)),this.$("table.list").find("th.check").append(j)}}else this.$("table.list").find("th.check, td.check").hide()},toggleFilter:function(b){b.stopPropagation();var c=a(b.target).find(".sub-menu"),d=function(){c.hide(),a("div.group-checkbox").removeClass("shadow"),a(document).unbind("click.filter-sub-menu")};return"block"===c.css("display")?d():(c.show(),this.$("div.group-checkbox").addClass("shadow"),a(document).bind("click.filter-sub-menu",d)),!0},markOne:j.markOne,markAll:j.markAll,markByStatus:function(c){c.preventDefault(),this.$(".group-checkbox .sub-menu").hide(),this.$("tbody tr").removeClass("selected"),this.$("tbody tr").find("input").prop("checked",!1),this.collection.selectNone();var d=a(c.target).attr("data-action");this.$("tbody tr."+d).addClass("selected"),this.$("tbody tr.selected input").prop("checked",!0);var e=this.collection.where({status:d.substr("st".length)});b.each(e,function(a){a.select()}),this.postModelMark()},postModelMark:function(){var a=this.collection.selectedLength>0,c=this.getAvailableActions(a),d=0;a&&b.each(this.collection.selected,function(a){c=b.intersection(c,f.getPossibleActions(a)),d+=parseFloat(a.getAmount())});var e=this.collection.length===this.collection.selectedLength;this.$("th.check input")[e?"removeClass":"addClass"]("some"),this.$("th.check input").prop("checked",a),this.trigger("update-actions",this.getPermittedActions(c)),this.changeFooter(d.toFixed(2))},getAvailableActions:function(a){var b;return a?(b=[f.DocumentAction.PRINT],(c.isMultiClient()||this.isAccountsForCreateAction)&&(b=b.concat([f.DocumentAction.SIGN,f.DocumentAction.COPY,f.DocumentAction.DELETE]))):(c.isMultiClient()||this.isAccountsForCreateAction)&&(b=[f.DocumentAction.CREATE,f.DocumentAction.IMPORT]),b},getPermittedActions:function(a){for(var c=["CREATE","IMPORT","PRINT","SIGN","COPY","DELETE","CONFIRM","TOGGLE","CFC_CONFIRM","CFC_REJECT","CFC_SIGN"],d=this.getDocumentTypeForActions(),e=[],g=0;g<c.length;g++){var h=c[g],i=b.contains(a,f.DocumentAction[h])&&f.isActionPermitted(h,d);i&&e.push(h+(b.contains(["CREATE","IMPORT"],h)?"":"_GROUP"))}return e},getDocumentTypeForActions:function(){return this.collection.options.document_type},changeFooter:function(a){if(this.footerNls){var b=this.$("tfoot.summary"),c=this.collection.selectedLength;if(b.length){b[c?"show":"hide"]();var e=c%100,f="footer_5_0_docs",g="footer_selected_pl";if(11>e||e>19){var h=c%10;1===h?(f=1===c?"footer_1_doc":"footer_1_doc_pl",g="footer_selected_sin"):h>1&&5>h&&(f="footer_2_4_docs")}var i=this.footerNls,j=d.sprintf(i.footer_s_template,i[g],c,i[f],this.collection.length,a);b.find("td").html(j).trigger("footer:change",c)}}}})}),define("commons/base_object/group_opers_list_item_view",["commons/base_object/base_list_item_view"],function(a){"use strict";return a.extend({triggers:{"click td:not(.check)":"selectItem"},events:{"click td.check input":function(a){this.trigger("markOne",a)}}})}),define("text!apps/ua_currency_convert/templates/ua_currency_convert_list.tmpl",[],function(){return'<table class="list ua_currency_convert">\n    <thead class="widescreen">\n    <tr>\n        <th class="attach">&nbsp;</th>\n        <th class="check">\n            <input type="checkbox"/>\n            <span class="checkbox"/>\n        </th>\n        <th class="number">\n            <span class="sortable" data-field="NUM_DOC"><%- number %></span>\n        </th>\n        <th class="date">\n            <span class="sortable" data-field="DATE_DOC"><%- date %></span>\n        </th>\n        <% if (isMultiClient()) { %>\n            <th class="payer ellipsis">\n                <span class="sortable" data-field="CLN_NAME"><%= payer %></span>\n            </th>\n        <% } %>\n        <th class="deposit_account">\n            <span class="sortable" data-field="SALE_ACCOUNT"><%- cur_acc %></span>\n        </th>\n        <th class="amount">\n            <span class="sortable" data-field="PURCHASE_SUM"><%- amount %></span>\n        </th>\n        <th class="currency">\n            <span class="sortable" data-field="PURCHASE_CURRENCY"><%- curr %></span>\n        </th>\n        <th class="status">\n            <span class="sortable" data-field="status_desc"><%- status %></span>\n        </th>\n        <th class="empty">&nbsp;</th>\n        <th class="mobile">&nbsp;</th>\n    </tr>\n    </thead>\n    <tbody></tbody>\n    <tfoot class=\'summary\'>\n    <tr>\n        <td colspan="8"></td>\n    </tr>\n    </tfoot>\n</table>\n'}),define("text!apps/ua_currency_convert/templates/ua_currency_convert_list_item.tmpl",[],function(){return'<td class="attach widescreen">\n    <% if (ATT_CNT != \'0\') { %>\n    <span class=\'att-cnt\'>&nbsp;</span>\n    <% } %>\n</td>\n<td class="check widescreen"><input type=\'checkbox\'/><span class="checkbox"></span></td>\n<td class="number widescreen"><%- NUM_DOC %></td>\n<td class="date widescreen"><%- DATE_DOC %></td>\n<% if (isMultiClient()) { %>\n    <td class="payer ellipsis widescreen"><%- CLN_NAME %></td>\n<% } %>\n<td class="deposit_account widescreen"><%- SALE_ACCOUNT %></td>\n<td class="amount widescreen"><%- formatAmount(PURCHASE_SUM) %></td>\n<td class="currency widescreen"><%- PURCHASE_CURRENCY %></td>\n<td class="status widescreen"><%- status_desc %></td>\n<td class="empty widescreen">&nbsp;</td>\n<td class=\'mobile\'>\n    <span class=\'attaches<% if (ATT_CNT != \'0\') { %> att-cnt <% } %>\'>&nbsp;</span>\n    <span class=\'date\'><%- DATE_DOC %></span>\n    <span class=\'amount\'><%- formatAmount(PURCHASE_SUM) %>&nbsp;<%- PURCHASE_CURRENCY %></span>\n    <span class=\'rcpt ellipsis\'><%- SALE_ACCOUNT %></span>\n    <span class=\'status\'><%- status_desc %></span>\n</td>\n'}),define("styles!apps/ua_currency_convert/css/ua_currency_convert",[],function(){}),define("apps/ua_currency_convert/ua_currency_convert_list_view",["underscore","commons/base_object/document/group_opers_doc_list_view","commons/base_object/group_opers_list_item_view","text!apps/ua_currency_convert/templates/ua_currency_convert_list.tmpl","text!apps/ua_currency_convert/templates/ua_currency_convert_list_item.tmpl","i18n!apps/ua_currency_convert/nls/ua_currency_convert","styles!apps/ua_currency_convert/css/ua_currency_convert.css"],function(a,b,c,d,e,f){"use strict";return b.extend({template:a.template(d),templateHelpers:a.extend({},b.prototype.templateHelpers,f),footerNls:f,childView:c.extend({template:a.template(e)})})}),define("nls/states_types",{root:{any:"любые","new":"новые",in_bank:"в банке",rejected:"отвергнутые",signed:"подписаные",executed:"исполненные",partly_executed:"исп. частично",sent_to_client:"отправленные клиенту",not_confirmed:"не подтвержденные",requires_confirmation:"требуют подтверждения",formed:"сформированные",approved:"одобренные"},uk:!0,en:!0}),define("nls/uk/states_types",{any:"будь-які","new":"нові",in_bank:"у банку",rejected:"відхилені",signed:"підписані",executed:"виконані",partly_executed:"виконані частково",sent_to_client:"відправлені клієнту",not_confirmed:"не підтверджені",requires_confirmation:"вимагають підтвердження",formed:"сформовані",approved:"узгоджені"}),define("nls/en/states_types",{any:"any","new":"new",in_bank:"in bank",rejected:"rejected",signed:"signed",executed:"executed",partly_executed:"partly executed",sent_to_client:"sent to the client",not_confirmed:"not confirmed",requires_confirmation:"requires confirmation",formed:"formed",approved:"approved"}),define("commons/base_object/document/document_state_filter_view",["underscore","commons/base_object/document/document_filter_view","i18n!nls/states_types"],function(a,b,c){"use strict";return b.extend({ui:a.extend({statesChosen:"#state_chosen_filter",statesChosenContainer:"div.state-chosen-filter"},b.prototype.ui),events:a.extend({"chosen:select @ui.statesChosen":"onStateFilterChanged"},b.prototype.events),states:{work:[{id:"any",name:c.any},{id:"new",name:c["new"],filter:"0,1,3004"},{id:"in_bank",name:c.in_bank,filter:"2,3,4,11,12,13,17,2001,2002"},{id:"rejected",name:c.rejected,filter:"6"}]},cache:{},onShow:function(){this.createStateFilter(),b.prototype.onShow.call(this)},createStateFilter:function(){this.ui.statesChosenContainer.show(),this.ui.statesChosen.chosen({searchable:!1,data:{array:[],id:"id",text:"name"}}),this.configureStateFilterForStatusTab()},onStateFilterChanged:function(a,b){b.id!==this.getSelectedState()&&(this.setSelectedState(b.id),this.reload())},changeStatus:function(a){b.prototype.changeStatus.call(this,a),this.configureStateFilterForStatusTab()},configureStateFilterForStatusTab:function(){return this.isStateFilterRequired()?(this.ui.statesChosenContainer.show(),this.ui.statesChosen.trigger("refresh",{array:this.getStatesRef()}),void this.ui.statesChosen.trigger("chooseById",this.getSelectedState())):void this.ui.statesChosenContainer.hide()},reload:function(a){a=this.addStateFilterData(a),b.prototype.reload.call(this,a)},addStateFilterData:function(b){if(this.isStateFilterRequired()){var c=a.findWhere(this.getStatesRef(),{id:this.getSelectedState()});b=c&&c.filter?a.extend({},b,{status:c.filter}):b}return b},getStatesRef:function(){return this.states[this.tabsStatuses.selectedTab]},getSelectedState:function(){return this.cache[this.docType+this.tabsStatuses.selectedTab]||"any"},setSelectedState:function(a){return this.cache[this.docType+this.tabsStatuses.selectedTab]=a},isStateFilterRequired:function(){return this.getStatesRef()&&this.getStatesRef().length>1},onBeforeDestroy:function(){this.ui.statesChosen.disposeChosen()}})}),define("text!commons/base_object/document/templates/document_ext_filter_minimized_item.tmpl",[],function(){return"<label><%- (label ? label + ': ' : '') %></label>\n<span class=\"value <%- id %>\"><%- displayValue %></span>\n<span class=\"delete-filter-item\">&#10005;</span>"}),define("nls/document-filter",{root:{status_all:"Все",period_from:"Период с",period_to:"по",getdocs:"Получить",loading_docs:"Получение",incorrect_filter_date:"Дата окончания интервала для получения документов ранее даты начала интервала",ua_payment:"Гривневые поручения",bank_ua_payment_request:"Гривневые требования",ua_payment_request:"Гривневые требования",ua_currency_purchase:"Покупка валюты",ua_currency_sale:"Продажа валюты",ua_currency_convert:"Конвертация валюты",ua_currency_payment:"Валютные поручения",pay_sheet:"Зарплатные ведомости",letter:"Письма",inStatus:"В статусе",any:"Все",several:"Выбрано статусов: {1}",num_doc:"Номер документа",currency:"Валюта",amount:"Сумма",from:"от",to:"до",amount_from:"Сумма от",amount_to:"Сумма до",payer:"Плательщик",recipient:"Получатель",account:"Счет",start_entering:"Начинайте вводить",start_entering_acc:"Начинайте вводить номер счета",start_entering_name:"Начинайте вводить наименование",all:"Все",amountError:"Максимальная сумма должна быть больше минимальной"},uk:!0,en:!0}),define("nls/uk/document-filter",{status_all:"Всі",period_from:"Перiод від",period_to:"до",getdocs:"Отримати",loading_docs:"Отримання",incorrect_filter_date:"Дата завершення інтервалу для отримання документів раніше дати початку інтервалу",ua_payment:"Гривневі доручення",bank_ua_payment_request:"Гривневі вимоги",ua_payment_request:"Гривневі вимоги",ua_currency_purchase:"Купівля валюти",ua_currency_sale:"Продаж валюти",ua_currency_payment:"Валютні доручення",ua_currency_convert:"Конвертація валюти",pay_sheet:"Зарплатні відомості",letter:"Листи",inStatus:"У статусі",any:"Всі",several:"Обрано статусів: {1}",num_doc:"Номер документа",currency:"Валюта",amount:"Сума",from:"від",to:"до",amount_from:"Сума від",amount_to:"Сума до",payer:"Платник",recipient:"Отримувач",account:"Рахунок",start_entering:"Починайте вводити",start_entering_acc:"Починайте вводити номер рахунку",start_entering_name:"Починайте вводити найменування",all:"Всі",amountError:"Максимальна сума повинна бути більше ніж мінімальна"}),define("nls/en/document-filter",{status_all:"All",period_from:"Period from",period_to:"to",getdocs:"Receive",loading_docs:"Loading",incorrect_filter_date:"Interval final date for receiving the statement is earlier than its initial one",ua_payment:"Hryvnia Payment orders",bank_ua_payment_request:"Hryvnia Payment requests",ua_payment_request:"Hryvnia Outgoing Payment Request-Orders",ua_currency_purchase:"Currency purchase",ua_currency_sale:"Currency sale",ua_currency_convert:"Currency conversion",ua_currency_payment:"Currency payments",pay_sheet:"Salary sheets",letter:"Letters",inStatus:"In status",any:"Any",several:"Selected statuses: {1}",num_doc:"Document number",currency:"Currency",amount:"Amount",from:"from",to:"to",amount_from:"Amount from",amount_to:"Amount to",payer:"Payer",recipient:"Recipient",account:"Account",start_entering:"Start typing",start_entering_acc:"Start typing the account",start_entering_name:"Start typing the name",all:"All",amountError:"The maximum amount should be more than the minimum"}),define("commons/base_object/document/document_ext_filter_view",["underscore","backbone","marionette","app","bifit","collections/thesaurus","dialogUtils","text!commons/base_object/document/templates/document_ext_filter_minimized_item.tmpl","i18n!nls/document-filter"],function(a,b,c,d,e,f,g,h,i){"use strict";return c.CompositeView.extend({template:a.template('<div id="expanded-view"></div><div id="minimized-view"></div>'),templateHelpers:{isMultiClient:d.isMultiClient},ui:{expanded:"#expanded-view",minimized:"#minimized-view"},events:{"chosen:select #client":"onClientSelected"},fieldsMeta:{},childView:c.ItemView.extend({template:a.template(h),tagName:"span",id:function(){return this.model.id},triggers:{"click .delete-filter-item":"deleteFilterItem"}}),selectedClient:null,childViewContainer:"#minimized-view",childEvents:{deleteFilterItem:"deleteFilterItem"},isExpanded:!0,isFieldsOrder:!1,getExtFilterData:function(){if(this.isExpanded&&this.resetFilterCollection(),this.isValidFilterData()){var b={};return a.extend(b,this.getQueryFilter()),a.extend(b,this.getAdditionalFilter()),a.extend(b,this.getClientIdFilter()),b}},toggleMode:function(){this.isExpanded?this.isValidFilterData()&&(this.ui.expanded.hide(),this.ui.minimized.show(),this.resetFilterCollection()):(this.ui.expanded.show(),this.ui.minimized.hide(),this.restoreFilter()),this.isExpanded=!this.isExpanded,this.trigger("filter:resized")},resetFilter:function(){this.clearForm(),this.setDefaults(),!this.isExpanded&&this.collection.length&&(this.collection.reset(),this.trigger("filter:changed"),this.trigger("filter:resized"))},clearForm:function(){this.ui.expanded.find("input:text:not([readonly])").val("").change().trigger("empty")},setDefaults:function(){},initialize:function(){},onShow:function(){this.initForm(),this.ui.client&&this.ui.client.length&&this.initClientChosen(),this.collection.length&&this.restoreFilter()},initForm:function(){},restoreFilter:function(){this.restoreQueryFields(),this.restoreAdditionalFields()},restoreQueryFields:function(){a.each(this.fieldsMeta,function(a,b){var c=this.collection.get(b);if(0!==this.ui[b].length){var d=c?c.get("displayValue"):"";this.ui[b].val(d),d||this.ui[b].trigger("empty"),this.ui[b].change()}}.bind(this))},restoreAdditionalFields:function(){},resetFilterCollection:function(){var b=a.union(this.collectQueryData(),this.collectAdditionalData());this.isFieldsOrder&&b.sort(function(b,c){return a.has(b,"order")&&a.has(c,"order")?b.order-c.order:0}),this.collection.reset(b)},collectQueryData:function(){var b=[];return a.each(this.fieldsMeta,function(c,d){var e=this.getFilterValue(d);if(e){var f={id:d,idx:c.idx,order:c.order,value:e,type:c.type,operation:c.operation,displayValue:this.getDisplayValue(d),label:"<="===c.operation&&a.findWhere(b,{idx:c.idx})?c.shortLabel:c.label};"client"===c.type&&this.selectedClient&&this.selectedClient.name_cln===f.value&&(f.client_id=this.selectedClient.client_id),b.push(f)}}.bind(this)),b},collectAdditionalData:function(){return[]},getQueryFilter:function(){var b="";return a.each(this.fieldsMeta,function(a,c){var d=this.collection.get(c);if(d){var e=this.getQueryPart(d);e&&(b+=(b?" && ":"")+e)}}.bind(this)),b?{query:b}:{}},getQueryPart:function(a){var b=a.get("type");return"amount"===b?this.getAmountQuery(a):"client"===b?this.getClientQuery(a):"number"===b?this.getNumberQuery(a):this.getStringQuery(a)},getAdditionalFilter:function(){return{}},getClientIdFilter:function(){var a=this.collection.get("client");if(a){var b=a.get("client_id");if(b)return{clients:b}}},isValidFilterData:function(){return this.hasAmountFields()?this.isAmountValid():!0},hasAmountFields:function(){return!!a.findWhere(this.fieldsMeta,{type:"amount"})},isAmountValid:function(){var a=+this.ui.AMOUNT_MIN.getUnformattedValue(),b=+this.ui.AMOUNT_MAX.getUnformattedValue();return!(b>0&&a>b)},clearInvalidFields:function(){this.hasAmountFields()&&!this.isAmountValid()&&this.clearAmountFields()},clearAmountFields:function(){this.ui.AMOUNT_MIN.val(""),this.ui.AMOUNT_MAX.val(""),b.Validation.callbacks.valid(null,"AMOUNT_MIN")},validateFilterAmount:function(){this.isAmountValid()?b.Validation.callbacks.valid(null,"AMOUNT_MIN"):b.Validation.invalidField(this,"AMOUNT_MIN",i.amountError)},getFilterValue:function(a){var b=this.ui[a].getUnformattedValue();return this.fieldsMeta[a]&&("amount"===this.fieldsMeta[a].type||"number"===this.fieldsMeta[a].type)&&0>=b?null:b?b.trim():null},getDisplayValue:function(a){return this.ui[a].val().trim()},deleteFilterItem:function(b,c){var d=c.model.id,e=this.fieldsMeta[d];if(e&&">="===e.operation){var f;a.each(this.fieldsMeta,function(a,b){e.idx===a.idx&&b!==d&&"<="===a.operation&&(f=b)}),f&&this.collection.get(f)&&this.ui.minimized.find("#"+f).find("label").html(this.fieldsMeta[f].label+":")}this.collection.remove(c.model),this.ui[d].trigger("empty"),this.trigger("filter:changed"),this.trigger("filter:resized")},onClientSelected:function(a,b){this.selectedClient=b},initClientChosen:function(){this.ui.client.chosen({data:{array:f.getThesaurus("sub_clients").array,id:"client_id",text:"name_cln"}})},getStringQuery:function(a){return"["+a.get("idx")+"] hasi '"+e.escapeSpecialChars(a.get("value"))+"'"},getAmountQuery:function(a){return"["+a.get("idx")+"] "+a.get("operation")+" "+a.get("value")},getNumberQuery:function(a){return"["+a.get("idx")+"] has '"+a.get("value")+"'"},getClientQuery:function(a){return a.get("client_id")?"":this.getStringQuery(a)},onBeforeDestroy:function(){this.ui.client&&this.ui.client.length&&this.ui.client.disposeChosen()}})}),define("text!apps/ua_currency_convert/templates/ua_currency_convert_ext_filter.tmpl",[],function(){return'<div id="expanded-view">\n    <% if (isMultiClient()) { %>\n    <div class="data-row">\n        <div class="row">\n            <label class="col-xs-12"><%- payer %></label>\n        </div>\n        <div class="row">\n            <div class="col-xs-12"><input class="ellipsis" id="client" placeholder="<%- start_entering_name %>"></div>\n        </div>\n    </div>\n    <% } %>\n    <div class="data-row">\n        <div class="row">\n            <label class="col-xs-3"><%- num_doc %></label>\n            <label class="col-xs-6"><%- amount %></label>\n            <label class="col-xs-3"><%- currency %></label>\n        </div>\n        <div class="row">\n            <div class="col-xs-3">\n                <input id="NUM_DOC" maxlength="10">\n            </div>\n            <div class="col-xs-6 amount-filter">\n                <input id="AMOUNT_MIN" class="sum" autocomplete="off" placeholder="<%- from %>">\n                <label class="amount-to">-</label>\n                <input id="AMOUNT_MAX" class="sum" autocomplete="off" placeholder="<%- to %>">\n            </div>\n            <div class="col-xs-3">\n                <input id="PURCHASE_CURRENCY" autocomplete="off" placeholder="<%- all %>">\n            </div>\n        </div>\n    </div>\n    <div class="data-row">\n        <div class="row">\n            <label class="col-xs-6"><%- cur_acc %></label>\n        </div>\n        <div class="row">\n            <div class="col-xs-6">\n                <input class="ellipsis" id="SALE_ACCOUNT" maxlength="14" placeholder="<%- start_entering %>">\n            </div>\n        </div>\n    </div>\n</div>\n<div id="minimized-view"></div>\n'}),define("apps/ua_currency_convert/ua_currency_convert_ext_filter_view",["jquery","underscore","backbone","app","bifit","collections/thesaurus","appsPieces","commons/base_object/document/document_ext_filter_view","text!apps/ua_currency_convert/templates/ua_currency_convert_ext_filter.tmpl","i18n!apps/ua_currency_convert/nls/ua_currency_convert","i18n!nls/document-filter"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l=new c.Collection,m={},n=function(a){return"UAH"!==a.currency&&!b.contains(["2","9","10"],a.type)},o=function(c){return m[c]?a.when(m[c]):g.getClnAccounts(c).then(function(a){return a=b.filter(a,n),g.setAccountComments(a)}).then(function(a){return m[c]=a,a})};return h.extend({template:b.template(i),templateHelpers:b.extend({},h.prototype.templateHelpers,j,k),className:"ua_currency_convert",ui:b.defaults({client:"#client",NUM_DOC:"#NUM_DOC",AMOUNT_MIN:"#AMOUNT_MIN",AMOUNT_MAX:"#AMOUNT_MAX",SALE_ACCOUNT:"#SALE_ACCOUNT",PURCHASE_CURRENCY:"#PURCHASE_CURRENCY"},h.prototype.ui),events:b.defaults({"blur @ui.AMOUNT_MIN":"validateFilterAmount","blur @ui.AMOUNT_MAX":"validateFilterAmount","change @ui.PURCHASE_CURRENCY":"onChangeCurrency","chosen:select @ui.PURCHASE_CURRENCY":"onChangeCurrency","chosen:select @ui.SALE_ACCOUNT":"onChangeAccount","change @ui.client":"onClientNameChanged"},h.prototype.events),fieldsMeta:{client:{idx:"2",type:"client",label:k.payer},NUM_DOC:{idx:"1",label:k.num_doc},AMOUNT_MIN:{idx:"11",label:k.amount_from,type:"amount",operation:">="},AMOUNT_MAX:{idx:"11",label:k.amount_to,shortLabel:k.to,type:"amount",operation:"<="},PURCHASE_CURRENCY:{idx:"12",label:k.currency},SALE_ACCOUNT:{idx:"19",label:j.cur_acc}},accounts:null,initialize:function(a){this.collection=l,this.accounts=[],h.prototype.initialize.call(this,a)},initForm:function(){this.addFormatters(),this.initCurrencyChosen(),this.initAccountsChosen(),this.listenTo(d.mainLayout.content,"content:reloaded",this.highlightFoundText)},addFormatters:function(){this.ui.AMOUNT_MIN.formatter("amount"),this.ui.AMOUNT_MAX.formatter("amount"),this.ui.SALE_ACCOUNT.formatter("number")},initCurrencyChosen:function(){var a=[k.all];this.ui.PURCHASE_CURRENCY.chosen({searchable:!1,data:{array:a},value:k.all}),this.getClientCurrenciesPromise().done(function(b){a.push.apply(a,b),this.ui.PURCHASE_CURRENCY.trigger("refresh",{array:a,value:k.all})}.bind(this))},getClientCurrenciesPromise:function(){var c;return c=d.isMultiClient()?f.getThesaurus("accs_currency").fetch().then(b.partial(b.pluck,b,"currency")):a.when(b.keys(g.getAccounts(["1"],!0))),c.then(function(a){return b.chain(a).without("UAH").sort().value()}).promise()},initAccountsChosen:function(){if(this.ui.SALE_ACCOUNT.chosen({accType:!0,data:{id:d.isMultiClient()?"id":"account_id",array:this.accounts,text:["account","currency"]}}),!d.isMultiClient()){var a=b.chain(f.getThesaurus("accs_info").array).filter(n).sortBy("account").value();g.setAccountComments(a).done(function(a){this.accounts=g.addAccountTypeDescription(a),this.refreshAccounts()}.bind(this))}},onChangeCurrency:function(){g.getCurrencies().done(function(a){var c=b.findWhere(a,{currency:this.ui.PURCHASE_CURRENCY.val()}),d=c?c.decimals:2;this.updateAmountDecimals("AMOUNT_MIN",d),this.updateAmountDecimals("AMOUNT_MAX",d)}.bind(this)),this.refreshAccounts()},onChangeAccount:function(a,b){this.ui.SALE_ACCOUNT.val(b.account)},restoreQueryFields:function(){h.prototype.restoreQueryFields.apply(this,arguments);var a=this.collection.get("PURCHASE_CURRENCY");this.ui.PURCHASE_CURRENCY.trigger("choose",a?a.get("value"):k.all)},getFilterValue:function(a){return"PURCHASE_CURRENCY"===a&&this.ui[a].val()===k.all?"":h.prototype.getFilterValue.apply(this,arguments)},onClientNameChanged:function(){var c=this.ui.client.val(),d=b.findWhere(f.getThesaurus("sub_clients").array,{name_cln:c});a.when(d?o(d.client_id):[]).done(function(a){this.accounts=g.addAccountTypeDescription(a),this.refreshAccounts()}.bind(this))},refreshAccounts:function(){var a=this.ui.PURCHASE_CURRENCY.val(),c=a&&a!==k.all?b.where(this.accounts,{currency:a}):this.accounts,d=this.ui.SALE_ACCOUNT.val();if(this.ui.SALE_ACCOUNT.trigger("refresh",{array:c}),d){var e=!c.length||b.any(c,function(a){return a.account.indexOf(d)>-1});this.ui.SALE_ACCOUNT.val(e?d:"").change()}},setDefaults:function(){this.ui.PURCHASE_CURRENCY.trigger("choose",k.all)},highlightFoundText:function(){var a=this.collection.get("NUM_DOC");a&&g.highlightFoundText(a.get("value"),"td.number");var b=this.collection.get("client");b&&g.highlightFoundText(b.get("value"),"td.payer");var c=this.collection.get("SALE_ACCOUNT");c&&g.highlightFoundText(c.get("value"),"td.deposit_account")},updateAmountDecimals:function(a,b){this.ui[a].formatter("amount",{decimallength:b});var c=this.ui[a].getUnformattedValue();this.ui[a].val(e.changeFloatScaleWithoutRounding(c,b)).blur()}})}),define("apps/ua_currency_convert/ua_currency_convert_filter_view",["commons/base_object/document/document_state_filter_view","apps/ua_currency_convert/ua_currency_convert_ext_filter_view","i18n!apps/ua_currency_convert/nls/ua_currency_convert"],function(a,b,c){"use strict";return a.extend({documentTypeTitle:c.ua_currency_convert_list,ExtFilterComponent:b})}),define("text!apps/ua_currency_convert/templates/ua_currency_convert_edit.tmpl",[],function(){return'<form>\n    <div class="grey-container">\n        <h1><%- ua_currency_convert %></h1>\n\n        <% if (isMultiClient) { %>\n            <div class="sub-client-info"></div>\n        <% } %>\n\n        <% if (viewMode) { %>\n            <span id="status_desc" class="status-code-<%- statusCode %>"><%- status_desc %></span>\n        <% } %>\n\n    </div>\n\n    <div class="grey-container">\n        <div class="row form-group">\n            <div class="col-xs-3">\n                <label for="NUM_DOC"><%- number_doc %></label>\n                <input type="text" name="NUM_DOC" id="NUM_DOC" maxlength="10"\n                       placeholder="<%- num_doc_placeholder %>" tabindex="1"/>\n            </div>\n            <div class="col-xs-3 col-xs-offset-6">\n                <label for="DATE_DOC" class="date-doc"><%- date_doc %></label>\n                <div class="datepicker-container">\n                    <input type="text" name="DATE_DOC" id="DATE_DOC" autocomplete="off" class="form-control date datepicker"\n                           maxlength="10"\n                           placeholder="<%- date_doc_placeholder %>" tabindex="2"/>\n                    <span class="datepicker"></span>\n                </div>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label for="SALE_SUM"><%- ask_for_sale %></label>\n            <div class="row">\n                <div class="col-xs-5">\n                    <input type="text" id="SALE_SUM" name="SALE_SUM" placeholder="0.00" class="amount calc"\n                           autocomplete="off" tabindex="3"/>\n                </div>\n                <div class="col-xs-2">\n                    <input type="text" id="SALE_CURRENCY" name="SALE_CURRENCY" class="currency" tabindex="4"/>\n                </div>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label for="PURCHASE_SUM"><%- ask_for_purchase %></label>\n            <div class="row">\n                <div class="col-xs-5">\n                    <input type="text" id="PURCHASE_SUM" name="PURCHASE_SUM" placeholder="0.00" autocomplete="off"\n                           class="amount calc" tabindex="5"/>\n                </div>\n                <div class="col-xs-2">\n                    <input type="text" id="PURCHASE_CURRENCY" name="PURCHASE_CURRENCY" class="currency" tabindex="6"/>\n                </div>\n            </div>\n        </div>\n\n        <div class="row form-group">\n            <div class="col-xs-7">\n                <input class="rate_kind" id="PURCHASE_RATE_KIND" tabindex="7"/>\n            </div>\n        </div>\n\n        <div class="row form-group">\n            <div class="col-xs-2 sale-rate">\n                <label class="currency"><%- one_exch_item %><span id="PURCHASE_CURRENCY_SPAN" class="currency"></span></label>\n            </div>\n            <div class="col-xs-3 sale-rate">\n                <input type="text" name="PURCHASE_RATE" id="PURCHASE_RATE" autocomplete="off" class="amount calc"\n                       placeholder="0.000000" tabindex="8"/>\n            </div>\n            <div class="col-xs-1 sale-rate">\n                <label class="currency">\n                    <span id="SALE_CURRENCY_SPAN" class="currency"></span>\n                </label>\n            </div>\n        </div>\n\n        <div class="form-group row">\n            <div class="col-xs-7">\n                <label for="SALE_ACCOUNT"><%- sale_acc_label %></label>\n                <input type="text" id="SALE_ACCOUNT" name="SALE_ACCOUNT" autocomplete="off" class="account"\n                       readonly="readonly" tabindex="9"/>\n            </div>\n        </div>\n\n        <div class="form-group row">\n            <div class="col-xs-7">\n                <label for="PURCHASE_ACCOUNT"><%- purchase_acc_label %></label>\n                <input type="text" id="PURCHASE_ACCOUNT" name="PURCHASE_ACCOUNT" autocomplete="off" class="account"\n                       readonly="readonly" tabindex="10"/>\n            </div>\n        </div>\n\n        <div class="form-group">\n            <label for="PURCHASE_REASON"><%- purchase_reason %></label>\n            <textarea rows="1" id="PURCHASE_REASON" name="PURCHASE_REASON" tabindex="11"></textarea>\n        </div>\n\n        <div class="form-group row">\n            <div class="col-xs-7">\n                <label for="RETURN_ACCOUNT"><%- return_acc_label %></label>\n                <input type="text" id="RETURN_ACCOUNT" name="RETURN_ACCOUNT" autocomplete="off" class="account"\n                       readonly="readonly" tabindex="12"/>\n            </div>\n        </div>\n\n        <div class="form-group row">\n            <div class="col-xs-7">\n                <label for="COMMISSION_ACCOUNT"><%- commission_acc_label %></label>\n                <input type="text" id="COMMISSION_ACCOUNT" name="COMMISSION_ACCOUNT" autocomplete="off" class="account"\n                       readonly="readonly" tabindex="13"/>\n            </div>\n        </div>\n\n        <div class="row">\n            <div class="col-xs-8">\n                <label for="CLN_EMPLOYEE_FIO"><%- cln_employee %></label>\n                <input id="CLN_EMPLOYEE_FIO" class="fio" type="text" maxlength="40" name="CLN_EMPLOYEE_FIO"\n                       placeholder="<%- cln_employee_fio_placeholder %>" tabindex="14"/>\n            </div>\n            <div class="col-xs-4">\n                <label for="CLN_EMPLOYEE_PHONE"><%- phone %></label>\n                <input id="CLN_EMPLOYEE_PHONE" class="phone" type="text" maxlength="20" name="CLN_EMPLOYEE_PHONE"\n                       placeholder="<%- cln_employee_phone_placeholder %>" tabindex="15"/>\n            </div>\n        </div>\n\n        <div class="row form-group">\n            <div class="attach-container"></div>\n        </div>\n    </div>\n\n\n</form>\n<div class="document-status-bar"></div>\n<div class="comments-bar"></div>\n';
}),define("apps/ua_currency_convert/base_ua_currency_convert_item_view",["underscore","bifit","commons/base_object/document/document_item_view","text!apps/ua_currency_convert/templates/ua_currency_convert_edit.tmpl","i18n!apps/ua_currency_convert/nls/ua_currency_convert","styles!apps/ua_currency_convert/css/ua_currency_convert","formatter"],function(a,b,c,d,e){"use strict";return c.extend({className:"doc-wrapper ua_currency_convert",template:a.template(d),templateHelpers:{},ui:{textarea:"textarea"},behaviors:{AttachBehavior:{viewType:"VIEW",docType:"ua_currency_convert",checkPermissions:!0}},initialize:function(a){this.rates=a.rates,this.currencies=a.currencies,this.getRatePrecision=a.getRatePrecision,this.customInitialize(a),this.fillUiElements(this.getUiElementsTitles())},onShow:function(){c.prototype.onShow.call(this),this.addFormatters();var a=this.model.get("SALE_CURRENCY"),b=this.model.get("PURCHASE_CURRENCY");this.ui.SALE_CURRENCY_SPAN.html(a),this.ui.PURCHASE_CURRENCY_SPAN.html(b),this.currencies.done(function(c){this.setSum(c,a,"SALE_SUM"),this.setSum(c,b,"PURCHASE_SUM")}.bind(this)),this.doCustomInitsOnShow()},addFormatters:function(){this.ui.textarea.formatter("oneline_textarea",{maxlength:550}).change();var a=this.RATE_FIELD,b=a.substr(0,a.length-4)+"CURRENCY",c=this.getRatePrecision(this.ui[b].val()),d=this.ui[this.RATE_FIELD];d.formatter("amount",{decimallength:c,maxlength:4}),d.val().length>0&&d.val(parseFloat(d.getUnformattedValue()).toFixed(c)).trigger("paste")},setSum:function(c,d,e){var f=b.formatAmount(this.model.get(e),{decimallength:a.findWhere(c,{currency:d}).decimals});this.ui[e].val(f)}})}),define("apps/ua_currency_convert/ua_currency_convert_item_view",["jquery","underscore","apps/ua_currency_convert/base_ua_currency_convert_item_view","i18n!apps/ua_currency_convert/nls/ua_currency_convert"],function(a,b,c,d){return c.extend({RATE_FIELD:"PURCHASE_RATE",getUiElementsTitles:function(){return["SALE_SUM","SALE_CURRENCY","SALE_ACCOUNT","PURCHASE_ACCOUNT","RETURN_ACCOUNT","COMMISSION_ACCOUNT","PURCHASE_SUM","CLN_EMPLOYEE_PHONE","SALE_CURRENCY_SPAN","PURCHASE_RATE_KIND","PURCHASE_CURRENCY_SPAN","PURCHASE_RATE"]},customInitialize:function(){this.templateHelpers=b.extend({},c.prototype.templateHelpers,d)},doCustomInitsOnShow:function(){var c=this.model.get("PURCHASE_RATE_KIND");"по курсу банка"!==c&&"за курсом банку"!==c||(c=d.rate1_label);var e=b.findWhere(this.rates,{label:c});a("div.sale-rate")["1"===e.id?"show":"hide"](),this.ui.PURCHASE_RATE_KIND.val(e.label);var f=this.model.get("SALE_CURRENCY");this.ui.SALE_ACCOUNT.val(this.model.get("SALE_ACCOUNT")+" "+f),this.ui.RETURN_ACCOUNT.val(this.model.get("RETURN_ACCOUNT")+" "+f),this.ui.PURCHASE_ACCOUNT.val(this.model.get("PURCHASE_ACCOUNT")+" "+this.model.get("PURCHASE_CURRENCY")),this.ui.COMMISSION_ACCOUNT.val(this.model.get("COMMISSION_ACCOUNT")+" UAH")},addFormatters:function(){this.ui.textarea.formatter("oneline_textarea",{maxlength:550}).change()}})}),define("apps/ua_currency_convert/base_ua_currency_convert_item_edit",["jquery","underscore","backbone","bifit","appsPieces","commons/base_object/document/document_item_edit","text!apps/ua_currency_convert/templates/ua_currency_convert_edit.tmpl","i18n!apps/ua_currency_convert/nls/ua_currency_convert","chosen","formatter"],function(a,b,c,d,e,f,g,h){"use strict";return f.extend({id:"edit",className:"doc-wrapper ua_currency_convert",template:b.template(g),templateHelpers:h,RATE_FIELD:null,ui:{textarea:"textarea",inputDate:"input.date"},behaviors:{AttachBehavior:{viewType:"EDIT",docType:"ua_currency_convert",checkPermissions:!0}},initialize:function(a){this.rates=a.rates,this.banks=a.banks,this.accounts=a.accounts,this.currencies=a.currencies,this.docType=a.docType,this.getClientProp=a.getClientProp,this.getBankAccount=a.getBankAccount,this.getRatePrecision=a.getRatePrecision,this.customInitialize(a),this.fillUiElements(this.getUiElementsTitles())},onShow:function(){f.prototype.onShow.call(this),this.addFormatters(),this.initAccountsChosen(),this.fillCurrencyList(),this.initRateType(),this.doCustomInitsOnShow(),this.ui.inputDate.formatter("date"),d.datePicker(a("input.datepicker"),{orientation:"bottom auto"})},addFormatters:function(){this.ui.CLN_EMPLOYEE_PHONE.formatter("phone"),this.ui.COMMISSION.formatter("amount",{decimallength:3,maxlength:2});var a=this.RATE_FIELD,b=a.substr(0,a.length-4)+"CURRENCY",c=this.getRatePrecision(this.ui[b].val()),d=this.ui[this.RATE_FIELD];d.formatter("amount",{decimallength:c,maxlength:4}),d.val().length>0&&d.val(parseFloat(d.getUnformattedValue()).toFixed(c)).trigger("paste")},initAccountsChosen:function(){var a={searchable:!1,width:"9em",data:{array:[],id:"account_id",text:"account"}};this.ui.SALE_ACCOUNT.chosen(a),this.ui.PURCHASE_ACCOUNT.chosen(a),this.ui.COMMISSION_ACCOUNT.chosen(a)},fillCurrencyList:function(){var a=b.without(b.keys(this.accounts),"UAH");if(0===a.length)throw h.no_cur_accs;a.sort(),this.ui.PURCHASE_CURRENCY.chosen({searchable:!1,width:"4em",data:{array:[]}}),this.ui.SALE_CURRENCY.chosen({searchable:!1,width:"4em",data:{array:a}});var e=this.model.get("SALE_CURRENCY");if(this.accounts[e]){this.ui.SALE_CURRENCY.val(e),this.onCurrencyChange("SALE",e);var f=this.ui.PURCHASE_CURRENCY.val();f||(f=d.getStorageDocData("PURCHASE_CURRENCY"),f=b.contains(a,f)?f:a[0]),this.ui.PURCHASE_CURRENCY.trigger("refresh",{array:b.without(b.keys(this.accounts),e,"UAH").sort()}),b.contains(a,f)?this.ui.PURCHASE_CURRENCY.trigger("chooseById",f):(this.ui.PURCHASE_CURRENCY.val(f),this.ui.PURCHASE_ACCOUNT.trigger("refresh",{array:[]}),c.Validation.invalidField(null,"PURCHASE_ACCOUNT",h.not_acount_for_cur))}else this.ui.SALE_ACCOUNT.trigger("refresh",{array:[]}),c.Validation.invalidField(null,"SALE_ACCOUNT",h.not_acount_for_cur)},onSelectPurchaseCurrency:function(a,c){var d=this.model.get("BNK_MFO"),e=d?b.where(this.accounts[c],{mfo:d}):this.accounts[c];this.onCurrencyChange("PURCHASE",c,e)},onSelectSaleCurrency:function(a,c){this.onCurrencyChange("SALE",c);var e=b.without(b.keys(this.accounts),c,"UAH"),f=this.ui.PURCHASE_CURRENCY.val()||d.getStorageDocData("PURCHASE_CURRENCY");f=b.contains(e,f)?f:e[0],this.ui.PURCHASE_CURRENCY.trigger("refresh",{array:e.sort()}),this.ui.PURCHASE_CURRENCY.trigger("chooseById",f)},changeRatePrecision:function(a){var b=this.getRatePrecision(a),c=this.ui[this.RATE_FIELD];c.formatter("amount",{maxlength:4,decimallength:b}),c.attr("placeholder",e.getDecimalsPlaceholder(b)),c.val().length>0&&c.val(parseFloat(c.getUnformattedValue()).toFixed(b)).trigger("paste")},onCurrencyChange:function(a,c,f){f=f||this.accounts[c];var g=a+"_CURRENCY";this.model.set(g,c),this.currencies.done(function(d){var f=this.ui[a+"_SUM"],g=b.findWhere(d,{currency:c}).decimals;f.formatter("amount",{decimallength:g,allowDisabled:!0}),f.attr("placeholder",e.getDecimalsPlaceholder(g)),f.val().length>0&&f.val(parseFloat(f.getUnformattedValue()).toFixed(g)).trigger("paste")}.bind(this)),this.ui[a+"_CURRENCY_SPAN"].html(c),d.setStorageDocData(g,c),this.refreshAccounts(a,f)},refreshAccounts:function(a,e){var f=a+"_ACCOUNT",g=1===e.length?e[0]:b.findWhere(e,{account:this.model.get(f)});g=g||(e.length>0?e[0]:""),this.ui[f].trigger("refresh",{array:e}),g?this.ui[f].trigger("chooseById",g.account_id):(this.model.set(f,""),c.Validation.invalidField(null,f,d.sprintf(h.not_acount_for_cur_for_mfo,this.model.get("BNK_MFO")))),this.ui[f].attr("disabled",1===e.length)},onSelectSaleAccount:function(a,e){c.Validation.callbacks.valid(null,"SALE_ACCOUNT");var f=this.docType+"_"+d.getKeyFromEvent(a.target);d.setStorageDocData(f,e.account_id),this.copySaleAccountProps(this.model,e);var g=b.findWhere(this.banks,{bik:e.mfo});if(this.isFillSaleBnkAccountRequired()){var i=this.getBankAccount(g.bik,e.currency);this.ui.SALE_BNK_ACCOUNT.val(i||""),this.model.set("SALE_BNK_ACCOUNT",i||"")}this.fillBanksAndAccountsInfo(g,e),this.model.set("BNK_ADDR",g.address||""),this.model.set("BNK_NAME",g.name||"");var j=this.ui.PURCHASE_CURRENCY.val(),k=this.accounts[j];k&&this.onCurrencyChange("PURCHASE",j,b.where(k,{mfo:e.mfo}));var l=b.where(this.accounts.UAH,{mfo:e.mfo});if(this.refreshAccounts("COMMISSION",l),b.isEmpty(l)?c.Validation.invalidField(null,"COMMISSION_ACCOUNT",d.sprintf(h.not_ua_acount_for_mfo,e.mfo)):c.Validation.callbacks.valid(null,"COMMISSION_ACCOUNT"),this.ui.SALE_BNK_ACCOUNT&&this.ui.SALE_BNK_ACCOUNT.val()){var m=this.validateField("SALE_BNK_ACCOUNT",this.ui.SALE_BNK_ACCOUNT.val());this.ui.SALE_BNK_ACCOUNT.css("border-color",m?"#FF6666":"")}},fillBanksAndAccountsInfo:function(){},onSelectAccount:function(a,b){var c=d.getKeyFromEvent(a.target),e=c.toUpperCase();this.model.set(e,b.account),this.validateField(e,b.account),d.setStorageDocData(this.docType+"_"+c,b.account_id)}})}),define("apps/ua_currency_convert/ua_currency_convert_item_edit",["jquery","underscore","backbone","bifit","appsPieces","apps/ua_currency_convert/base_ua_currency_convert_item_edit","i18n!apps/ua_currency_convert/nls/ua_currency_convert"],function(a,b,c,d,e,f,g){return f.extend({id:"edit",templateHelpers:g,events:{"keyup input.calc":"calcAmount","change input[type=text]":"onChangeField","change textarea":"onChangeField","chosen:select #SALE_ACCOUNT":"onSelectSaleAccount","chosen:select #PURCHASE_ACCOUNT":"onSelectAccount","chosen:select #COMMISSION_ACCOUNT":"onSelectAccount","chosen:select #PURCHASE_RATE_KIND":"onSelectRateKind","chosen:select #SALE_CURRENCY":"onSelectSaleCurrency","chosen:select #PURCHASE_CURRENCY":"onSelectPurchaseCurrency","hide #DATE_DOC":"onBlurDate","blur #DATE_DOC":"onBlurDate"},RATE_FIELD:"PURCHASE_RATE",initAccountsChosen:function(){this.accounts=e.addAccountTypeDescription(this.accounts);var a={searchable:!1,width:"20em",accType:!0,data:{array:[],id:"account_id",text:["account","currency"]}};this.ui.PURCHASE_ACCOUNT.chosen(a),this.ui.COMMISSION_ACCOUNT.chosen(a),this.ui.SALE_ACCOUNT.chosen(a)},customInitialize:function(a){},getUiElementsTitles:function(){return["SALE_SUM","SALE_CURRENCY","PURCHASE_SUM","PURCHASE_CURRENCY","PURCHASE_RATE_KIND","PURCHASE_RATE","SALE_ACCOUNT","SALE_CURRENCY_SPAN","PURCHASE_CURRENCY_SPAN","PURCHASE_ACCOUNT","COMMISSION_ACCOUNT","CLN_EMPLOYEE_PHONE","RETURN_ACCOUNT","DATE_DOC"]},doCustomInitsOnShow:function(){},addFormatters:function(){this.ui.CLN_EMPLOYEE_PHONE.formatter("phone"),this.ui.PURCHASE_RATE.formatter("amount",{decimallength:6,maxlength:4}),this.ui.textarea.formatter("oneline_textarea",{maxlength:255}).change()},isFillSaleBnkAccountRequired:function(){return!1},initRateType:function(){this.ui.PURCHASE_RATE_KIND.chosen({searchable:!1,data:{array:this.rates,id:"id",text:"label"}});var a=b.findWhere(this.rates,{label:this.model.get("PURCHASE_RATE_KIND")});this.ui.PURCHASE_RATE_KIND.trigger("chooseById",(a||b.last(this.rates)).id)},onSelectRateKind:function(b,c){"2"===c.id?(this.model.set("OPER_TYPE",""),this.ui.PURCHASE_RATE.val(""),this.ui.PURCHASE_SUM.attr("disabled",!1),this.ui.SALE_SUM.attr("disabled",!1)):this.model.get("PURCHASE_RATE_KIND")===g.rate0?(this.calcOutputField="0"===this.model.get("OPER_TYPE")?"PURCHASE_SUM":"SALE_SUM",this.ui.PURCHASE_SUM.attr("disabled","0"===this.model.get("OPER_TYPE")),this.ui.SALE_SUM.attr("disabled","0"!==this.model.get("OPER_TYPE"))):this.ui.SALE_SUM.val()&&this.ui.PURCHASE_SUM.val()?(this.calcOutputField="SALE_SUM",this.ui.PURCHASE_SUM.attr("disabled",!1),this.ui.SALE_SUM.attr("disabled",!0),this.ui.SALE_SUM.val("")):this.calcOutputField=this.ui.SALE_SUM.val()?"PURCHASE_SUM":"SALE_SUM",a("div.sale-rate")["1"===c.id?"show":"hide"](),this.model.set("PURCHASE_RATE_KIND",c.value,{silent:!0})},onChangeField:function(a){var c=a.target.id;if(-1===c.indexOf("DATE")){var e={SALE_SUM:d.getAmountConverterRule(4),PURCHASE_RATE:d.getAmountConverterRule(6),PURCHASE_SUM:d.getAmountConverterRule(4)},g=d.convertByRules(a,e,["PURCHASE_RATE_KIND"],this.model)||"";return b.contains(["SALE_SUM","PURCHASE_SUM"],a.target.id)&&0===g.length?!1:b.contains(["PURCHASE_ACCOUNT","SALE_ACCOUNT","COMMISSION_ACCOUNT","PURCHASE_CURRENCY"],a.target.id)?!0:f.prototype.onChangeField.call(this,a,g)}},onBlurDate:function(a){var b=a.target.id;""===this.ui[b].val().replace(/\s+/g,"").replace(/\./g,"")&&this.ui[b].val(""),this.validateField(b,this.ui[b].val())},fillBanksAndAccountsInfo:function(a,c){var d=["SALE","PURCHASE","COMMISSION"];b.each(d,function(b){this.model.set(b+"_BNK_NAME",a.name),this.model.set(b+"_BNK_MFO",a.bik)}.bind(this)),this.model.set("COMMISSION_BNK_ADDR",a.address||""),this.model.set("RETURN_ACCOUNT",c.account),this.ui.RETURN_ACCOUNT.val(c.account+" "+c.currency)},calcAmount:function(a){var e=this.model.get("PURCHASE_RATE_KIND");if("по курсу"===e||"за курсом"===e){var f={SALE_SUM:"PURCHASE_SUM",PURCHASE_SUM:"SALE_SUM"},g=f[a.target.id];if(g?this.calcOutputField=g:g=this.calcOutputField,g){var h=f[g];switch(h){case"SALE_SUM":this.model.set("OPER_TYPE","0");break;case"PURCHASE_SUM":this.model.set("OPER_TYPE","1")}c.Validation.callbacks.valid(null,g),c.Validation.callbacks.valid(null,h);var i=parseFloat(+this.ui[h].getUnformattedValue()),j=parseFloat(+this.ui.PURCHASE_RATE.getUnformattedValue());this.ui[g].attr("disabled",!!i),i&&j?this.currencies.done(function(a){var c=this.ui[g.split("_")[0]+"_CURRENCY"].val(),e=(b.findWhere(a,{currency:c})||{}).decimals||2,f="SALE_SUM"===g?i*j:i/j;f=d.formatAmount(f,{decimallength:e}),this.model.set(g,f,{silent:!0}),this.ui[g].val(f)}.bind(this)):(this.model.set(g,"",{silent:!0}),this.ui[g].val(""))}}},copySaleAccountProps:function(a,b){a.set({BNK_MFO:b.mfo,SALE_ACCOUNT:b.account,SALE_CURRENCY:b.currency})}})}),define("commons/base_object/document/document_print_processor",["jquery","underscore","bifit","printUtils"],function(a,b,c,d){"use strict";function e(b,c,d,e,f){this.form=b,this.$mainElement=a(b[0].querySelector("section.main").querySelector("article.main")),this.$printButton=a(b[0].querySelector("button.print.to-printer")),this.$printPdfButton=a(b[0].querySelector("button.print.to-pdf")),this.printStyle=d,this.pdfTemplate=e,this.documentType=c,this.modelStatus=f,this.printPromises=[]}return e.prototype.run=function(c){a(this.form[0].querySelector("#doc-div")).remove(),this.$mainElement.append('<style type="text/css">'+this.printStyle+"</style>"),this.$printPdfButton.parent().show(),d.spinBtn(this.$printButton),d.spinBtn(this.$printPdfButton),d.createLeftMenu(c,this.form).then(function(){var e=this.form.find("input[type=checkbox]");e.prop("disabled",!0),this.renderDocument(c[0],this.$mainElement);var f=!b.contains(["pay_sheet","assign_card_order","fire_staff_order","card_prolongation"],this.documentType);setTimeout(function(){a.when.apply(a,this.printPromises).then(function(){for(var b=f?this.$mainElement.clone(!0):this.$mainElement,g=1;g<c.length;g++)this.renderDocument(c[g],b);a.when.apply(a,this.printPromises).always(function(){f&&(this.$mainElement[0].innerHTML=b[0].innerHTML),e.prop("disabled",!1),d.stopBtn(this.$printButton),d.stopBtn(this.$printPdfButton)}.bind(this))}.bind(this))}.bind(this),300),this.addPrintPdfButtonHandler()}.bind(this))},e.prototype.renderDocument=function(){throw new Error("renderDocument is not implemented")},e.prototype.addPrintPdfButtonHandler=function(){this.$printPdfButton.bind("click",function(){var b=this.documentType+".pdf",e=this.prepareDocumentForPdf(this.$mainElement.clone(!0));a.ajax({type:"POST",url:localStorage.getItem("addr")+"/print_to_pdf;jsessionid="+c.getStoredItem("JSESSIONID"),contentType:"application/x-www-form-urlencoded; charset=UTF-8",mimeType:"text/plain; charset=x-user-defined",data:{html:this.getHtmlForPdf(e),fileName:b,stampAbsolutePosition:!0},success:function(a){d.createPdfFile(a,b,this.form[0])}.bind(this)})}.bind(this))},e.prototype.getHtmlForPdf=function(a){var c={"<br>":"<br/>",'"':'"',"<hr>":"<hr/>"};return b.template(this.pdfTemplate,{content_for_pdf:a[0].outerHTML}).replace(/<br>|"|<hr>/gi,function(a){return c[a]})},e.prototype.prepareDocumentForPdf=function(c){c.find("style").remove(),c.find("h1.empty").remove(),c.find(".hidden").remove(),c.find("colgroup").remove(),this.form.find("#ecp_owner").is(":checked")||c.find(".sign1, .sign2").children().remove(),this.form.find("#service_info").is(":checked")||0===c.find(".serv-info-table")||c.find(".serv-info-table").remove(),b.contains(["ua_payment","ua_payment_request","bank_ua_payment_request"],this.documentType)&&(this.form.find("#two_copies").is(":checked")||0===c.find(".doc-div-copied")||c.find(".doc-div-copied").remove());var d=c.find(".for-img img").parent();return d.empty(),this.form.find("#bank_stamp").is(":checked")&&d.each(function(){var b=a(this);b.append("<"+b.attr("data-stamp-name")+"/>")}),c},e}),define("text!apps/ua_currency_convert/templates/ua_currency_convert_print.tmpl",[],function(){return'<div class="main">\n    <table class="top_info">\n        <tbody class="centered">\n        <tr>\n            <td width="92%"></td>\n            <td width="8%" class="border ident bold-text">0408006</td>\n        </tr>\n        </tbody>\n    </table>\n    <div class="onright ua_info">Примірник N___</div>\n\n    <div class="centered bold-text">ЗАЯВА ПРО ОБМIН (КОНВЕРТАЦIЮ) IНОЗЕМНОЇ ВАЛЮТИ/</div>\n    <div class="centered bold-text">APPLICATION FOR FOREIGN CURRENCY EXCHANGE (CONVERSION)</div>\n    <div class="centered full-width bold-text num-date-doc"></div>\n    <div class="centered bold-text ua_bank_info"></div>\n    <div class="centered bold-text eng_bank_info"></div>\n    <div class="pad-top">\n        <table class="bordered padded">\n            <tr>\n                <td colspan="1" width="34%" class="bold-text">Найменування (прізвище, ім’я, по батькові) Клієнта /<br/>\n                    Client name (surname, name)\n                </td>\n                <td colspan="4"><%- CLN_NAME %></td>\n            </tr>\n            <tr>\n                <td colspan="1" width="34%" class="bold-text">Місцезнаходження (місце проживання) Клієнта /<br/>\n                    Client address of registered office (place of residence)\n                </td>\n                <td colspan="2"><%- CLN_ADDR %></td>\n                <td colspan="1" width="16%" class="bold-text">Код ЄДРПОУ<br/>(ідентифікаційний код)<br/>\n                    Клієнта / Client ID code\n                </td>\n                <td colspan="1" width="10%" class="centered"><%- CLN_OKPO %></td>\n            </tr>\n            <tr>\n                <td colspan="2" class="bold-text">Прiзвище, iнiцiали уповноваженого працiвника Клієнта\n                    / Surname, initials<br/>of the Client\'s responsible employee (hereinafter - the "Client\'s\n                    responsible<br/>\n                    employee")\n                </td>\n                <td colspan="3" width="53%"><%- CLN_EMPLOYEE_FIO %></td>\n            </tr>\n            <tr>\n                <td colspan="2" class="bold-text">Контактний телефон уповноваженого працiвника Клієнта / Contact<br/>\n                    telephone of the Client\'s responsible employee\n                </td>\n                <td colspan="3" width="53%"><%- CLN_EMPLOYEE_PHONE %></td>\n            </tr>\n        </table>\n    </div>\n\n    <div class="pad-top">\n        <table class="bordered padded">\n            <tr>\n                <td width="40%" class="bold-text">Сума та назва iноземної валюти, що пiдлягає купiвлi (цифрами) /<br/>\n                    Amount and name of FCY for purchase (in numbers)\n                </td>\n                <td class="purchase-sum-digits"></td>\n                <td width="10%" class="bold-text">Код валюти / Currency code</td>\n                <td width="10%" class="centered"><%- PURCHASE_CURRENCY %></td>\n            </tr>\n            <tr>\n                <td class="bold-text">Сума та назва iноземної валюти, що пiдлягає купiвлi (прописом) /<br/>\n                    Amount and name of FCY for purchase (in words)\n                </td>\n                <td colspan="3" class="purchase-sum-words"></td>\n            </tr>\n            <tr>\n                <td class="bold-text">Курс купiвлi / Exchange rate</td>\n                <td colspan="3" width="53%" class="purchase-rate"></td>\n            </tr>\n            <tr>\n                <td class="bold-text">Сума та назва iноземної валюти, що пiдлягає продажу (цифрами) /<br/>\n                    Amount and name of FCY for sale (in numbers)\n                </td>\n                <td class="sale-sum-digits"></td>\n                <td width="10%" class="bold-text">Код валюти / Currency code</td>\n                <td width="10%" class="centered"><%- SALE_CURRENCY %></td>\n            </tr>\n            <tr>\n                <td class="bold-text">Сума та назва iноземної валюти, що пiдлягає продажу (прописом) /<br/>\n                    Amount and name of FCY for sale (in words)\n                </td>\n                <td colspan="3" class="sale-sum-words"></td>\n            </tr>\n        </table>\n    </div>\n\n    <div class="pad-top">\n        <table class="bordered padded">\n            <tr>\n                <td class="bold-text">Підстава для купівлі іноземної валюти на МВРУ /\n                    Legal basis for purchase of FCY at the Ukrainian Interbank Currency Market (UICM):\n                </td>\n            </tr>\n            <tr>\n                <td><%- PURCHASE_REASON %></td>\n            </tr>\n        </table>\n    </div>\n\n    <div class="ua_info text" align="justify">\n        Клієнт доручає Банку здійснити обмін (конвертацію) іноземної валюти на умовах, визначених у цій Заяві. З метою\n        здійснення обміну (конвертації) іноземної валюти Клієнт надає Банку право здійснити договірне списання Суми\n        іноземної валюти, що підлягає продажу, з нижченаведеного поточного рахунку Клієнта в Банку. Клієнт доручає Банку\n        реалізувати зазначене право та здійснити договірне списання у випадку, якщо Клієнт самостійно не здійснить\n        переказ Суми іноземної валюти, що підлягає продажу, в дату подання Заяви./\n    </div>\n    <div class="eng_info text" align="justify">\n        The Client authorizes the Bank to exchange (convert) the foreign currency (FCY), based on conditions defined in\n        this Application. For the purpose of exchange (covert) FCY, the Client authorizes the Bank to perform direct\n        debiting of the Amount of FCY for sale from the FCY Account of the Client in the Bank. The Client authorizes\n        the Bank to realize mentioned right and to perform direct debiting of funds, if the Client does not provide\n        necessary amount of funds for sale at the date of Application.\n    </div>\n\n    <table class="bordered padded">\n        <tr>\n            <td width="27%" class="bold-text">Рахунок / Account</td>\n            <td width="36%"><%- SALE_ACCOUNT %></td>\n            <td width="22%" class="bold-text">Код Банку/Bank code</td>\n            <td width="15%" class="centered"><%- SALE_BNK_MFO %></td>\n        </tr>\n    </table>\n\n    <div class="ua_info text" align="justify">\n        Клієнт доручає Банку зарахувати Суму іноземної валюти, що підлягає купівлі, на наступний поточний рахунок\n        Клієнта\n        в Банку: / The Client authorizes the Bank to credit the Amount of FCY for purchase to the following Client’s\n        account with the Bank:\n    </div>\n\n    <table class="bordered padded">\n        <tr>\n            <td width="27%" class="bold-text">Рахунок / Account</td>\n            <td width="36%"><%- PURCHASE_ACCOUNT %></td>\n            <td width="22%" class="bold-text">Код Банку/Bank code</td>\n            <td width="15%" class="centered"><%- BNK_MFO %></td>\n        </tr>\n    </table>\n\n    <div class="ua_info text" align="justify">\n        У разі неможливості виконання Заяви Клієнт доручає Банку повернути Суму іноземної валюти, що підлягає продажу,\n        на наступний Рахунок Клієнта для повернення коштів. / If the Application cannot be fulfilled, the Client\n        authorizes\n        the Bank to return the Amount of FCY for sale to the following Client’s account for return of funds:\n    </div>\n\n    <table class="bordered padded">\n        <tr>\n            <td width="30%" class="bold-text">Рахунок Клієнта для повернення коштів /<br/> Client’s account for return\n                of funds\n            </td>\n            <td width="33%"><%- RETURN_ACCOUNT %></td>\n            <td width="22%" class="bold-text" style="vertical-align: middle;">Код Банку/Bank code</td>\n            <td width="15%" class="centered"><%- BNK_MFO %></td>\n        </tr>\n    </table>\n    <div class="ua_info text" align="justify">\n        Клієнт зобов’язується сплатити Банку комісійну винагороду в розмірі, визначеному Тарифами Банку станом на дату\n        прийняття Банком Заяви на виконання./\n    </div>\n    <div class="eng_info text" align="justify">\n        The Client undertakes to pay the commission fee to the Bank in the amount specified in the Bank’s Tariffs\n        effective\n        as of the Application execution acceptance date.\n    </div>\n    <div class="ua_info text" align="justify">\n        З метою сплати комісійної винагороди Клієнт доручає Банку здійснити договірне списання суми комісійної\n        винагороди\n        з нижченаведеного поточного рахунку Клієнта в Банку в гривнях. Клієнт доручає Банку реалізувати зазначене право\n        та здійснити договірне списання у випадку, якщо Клієнт самостійно не здійснить переказ суми комісійної\n        винагороди\n        в дату подання Заяви. У випадку здійснення Банком договірного списання Клієнт зобов’язується забезпечити\n        наявність\n        на Рахунку Клієнта в гривнях коштів у розмірі, необхідному для сплати комісійної винагороди./\n    </div>\n    <div class="eng_info text" align="justify">\n        In order to ensure payment of the commission fee the Client authorizes the Bank to perform direct debiting of\n        the\n        amount of the commission fee from the following Client’s account in UAH in the Bank. The Client authorizes the\n        Bank\n        to realize mentioned right and to perform direct debiting of funds, if the Client does not provide necessary\n        amount\n        of funds at the date of Application. If the Bank performs direct debiting, the Client ensures that the funds\n        in the required amount are available in the amount enough to pay the commission fee.\n    </div>\n\n    <table class="bordered padded">\n        <tr>\n            <td width="30%" class="bold-text">Рахунок Клієнта в гривнях / Account in UAH</td>\n            <td width="33%"><%- COMMISSION_ACCOUNT %></td>\n            <td width="22%" class="bold-text">Код Банку/Bank code</td>\n            <td width="15%" class="centered"><%- BNK_MFO %></td>\n        </tr>\n    </table>\n    <div class="ua_info text">\n        <p align="justify">\n            Якщо придбана на МВРУ іноземна валюта згідно з цією Заявою не буде перерахована Клієнтом за призначенням у\n            визначений законодавством України строк після зарахування на вищезазначений поточний рахунок Клієнта,\n            Клієнт доручає Банку продати цю іноземну валюту на МВРУ. / If the foreign currency purchased at the ICMU\n            under this Application will not be transferred by the Client according to intended purpose within the term\n            defined by the Ukrainian law after crediting to the above Client’s account, the Client authorizes the Bank\n            to sell this foreign currency at the ICMU.\n        </p>\n\n        <p align="justify">\n            Підписанням цієї Заяви Клієнт підтверджує свою згоду з усіма положеннями, вказаними в цій Заяві, в тому\n            числі\n            наведеними в примітці до цієї Заяви. / By signing this Application the Client confirms its consent will all\n            provisions specified in this Application, including in the note to this Application.\n        </p>\n\n        <p align="justify">\n            Ця Заява є невід’ємною частиною договору банківського рахунку, укладеного між Клієнтом та Банком. /\n            This Application shall be an inseparable part of the Bank account agreement, concluded between the Client\n            and\n            the Bank.\n        </p>\n    </div>\n\n    <table class="bordered padded">\n        <tbody>\n        <tr class="bold-text centered">\n            <td class="sign_column_1">\n                Керівник Клієнта /<br/>General manager of the Client\n            </td>\n            <td rowspan="2" valign="middle" class="seal">М.П./Seal</td>\n            <td class="sign_column_2">\n                Головний бухгалтер Клієнта (за наявності) /<br/>Chief accountant of the Client (if present)\n            </td>\n        </tr>\n        <tr>\n            <td class="sign">\n                <div>\n                    <div class="sign1"></div>\n                    <table class="sign">\n                        <tr>\n                            <td class="text italic-text">(Прізвище, ініціали/Surname, initials)</td>\n                        </tr>\n                    </table>\n                    <div class="italic-text">(Підпис/Signature)</div>\n                </div>\n            </td>\n            <td class="sign">\n                <div>\n                    <div class="sign2"></div>\n                    <table class="sign">\n                        <tr>\n                            <td class="italic-text">(Прізвище, ініціали/Surname, initials)</td>\n                        </tr>\n                    </table>\n                    <div class="text italic-text">(Підпис/Signature)</div>\n                </div>\n            </td>\n        </tr>\n        </tbody>\n    </table>\n    <div class="text bold-text">\n        Позначки Банку/Bank\'s remarks:\n    </div>\n    <table class="bordered padded banks-remarks">\n        <tr class="bold-text centered ">\n            <td>Дата виконання /Trade date</td>\n            <td>Розмiр комiсiї, % / Amount of commission fee, %</td>\n            <td>Сума комiсiї / Amount of commission fee</td>\n        </tr>\n        <tr>\n            <td class="empty_row"></td>\n            <td></td>\n            <td></td>\n        </tr>\n    </table>\n    <div class="for-service-info fleft"></div>\n</div>\n<div class="for-img" style="float: right"></div>\n<div class="eng_info text footer" align="justify">\n    <p class="eng_info" align="justify">\n        Примітка: Датою прийняття Заяви є дата отримання Банком Заяви, якщо вона надійшла не пізніше 12:00 відповідного\n        робочого дня. Банк приймає Заяву до виконання виключно за умови, що Клієнт надав необхідні документи відповідно\n        до законодавства України та вимог Банку. Банк має право відмовитися від прийняття Заяви до виконання та/або\n        відмовити у виконанні Заяви. Заява заповнюється українською мовою. Якщо Клієнт в графі "Курс купівлі" обрав\n        позначку "за курсом уповноваженого банку", підписанням цієї Заяви Клієнт підтверджує, що він ознайомлений з\n        поточним курсом\n        Банку, оприлюдненим на веб-сторінці Банку в мережі Інтернет (http://www.aval.ua), та/або в системі\n        "Клієнт-Банк", та/або засобами телефонного зв’язку з відповідальним співробітником Банку станом на дату\n        подання Заяви до Банку. Клієнт зобов’язується самостійно слідкувати за змінами курсу Банку до моменту її\n        виконання та не має претензій до Банку стосовно значення курсу Банку. Якщо після подання Заяви до Банку Клієнт\n        не згоден зі змінами курсу Банку та/або бажає відкликати Заяву з інших причин, Клієнт повинен негайно, але до\n        моменту купівлі іноземної валюти на підставі цієї Заяви, відкликати Заяву. /\n    </p>\n\n    <p class="eng_info" align="justify">\n        Note: The date of acceptance of the Application is the date of receiving this Application by the Bank, provided\n        that it was transferred not later than 12:00 of the relevant business day. The Bank accepts the Application\n        for execution only if the Client has provided the necessary documents according to the Ukrainian law and the\n        Bank’s requirements. The Bank has the right to refuse accepting the Application for execution and/or to\n        refuse execution of the Application. The Application must be filled in the Ukrainian language. If the Client\n        in the line "Exchange rate" chooses the option "According to the exchange rate of the Bank", by signing\n        this Application the Client acknowledges that it is aware of the current rate of the Bank published on the\n        Bank’s web page on Internet (http: //www.aval.ua) and/or in the "Client-Bank" system, and/or by means of\n        telephone communication with the responsible employee of the Bank as of the date of submitting the Application\n        to the Bank. The Client agrees to independently monitor changes of the exchange rate of the Bank up to\n        the moment of execution of this Application and has no claims as to the value of the Bank’s exchange rate.\n        If after submitting the Application to the Bank the Client does not agree with changes of the exchange rate\n        of the Bank and/or intends to withdraw the Application from other reasons, the Client must immediately,\n        but in any case by the moment of purchase of the foreign currency on the basis of this Application,\n        withdraw this Application.\n    </p>\n</div>\n';
}),define("text!apps/ua_currency_convert/templates/ua_currency_convert_print_pdf.tmpl",[],function(){return"<html>\n<head>\n    <style type=\"text/css\">\n        article div, div td, div span, div p, div h3 {\n            font-family: 'Times Roman', 'Times New Roman', Georgia, serif;\n            font-size: 8pt;\n            word-wrap: break-word;\n            line-height: 1;\n        }\n        .onright {\n            text-align: right;\n        }\n        .border {\n            border: 1px solid black;\n        }\n        .centered, table.centered td {\n            text-align: center;\n        }\n        .bold-text {\n            font-weight: bold;\n        }\n        .italic-text {\n            font-style: italic;\n        }\n        div.text {\n            padding: 1px 5px 0 10px;\n        }\n        .ua_info, div.ua_info p {\n            font-size: 6pt;\n        }\n        .eng_info {\n            font-size: 5pt;\n        }\n        table {\n            width: 100%;\n            border-collapse: collapse;\n        }\n        table td {\n            padding: 2px;\n        }\n        div.pad-top {\n            padding-top: 3px;\n        }\n        .bbordered {\n            border-bottom: 1px solid black;\n        }\n        table.bordered {\n            border-top: 1px solid black;\n            border-left: 1px solid black;\n        }\n        table.bordered td {\n            border-right: 1px solid black;\n            border-bottom: 1px solid black;\n            valign: top;\n        }\n        .sign_column_1 {\n            width: 41.7%;\n        }\n        .seal {\n            width: 20.6%;\n            vertical-align: middle;\n        }\n        .sign_column_2 {\n            width: 37.7%;\n        }\n        table.sign td {\n            height: 20px;\n            border-width: 1px 0 1px 0;\n        }\n        td.sign {\n            text-align: center;\n            padding-top: 3px;\n        }\n        div.sign1, div.sign2 {\n            height: 20px;\n        }\n        td.sign div {\n            padding: 0 3px 0 3px;\n        }\n        div.for-service-info {\n            padding-top: 10px;\n            padding-left: 3px;\n        }\n        div table.serv-info-table {\n            border-top: 1px solid black;\n            border-left: 1px solid black;\n            font-weight: 600;\n        }\n        div table.serv-info-table td {\n            border-right: 1px solid black;\n            border-bottom: 1px solid black;\n            padding: 2px 1px 2px 5px;\n        }\n        div.main {\n            height: 990px;\n        }\n        .empty_row {\n            height: 15px;\n        }\n    </style>\n</head>\n<body>\n<%= content_for_pdf %>\n</body>\n</html>"}),define("text!apps/ua_currency_convert/css/ua_currency_convert_print.css",[],function(){return"section.doc-print div.doc-div{\npadding:10mm 5mm 5mm 20mm;\nposition:relative;\n}\nsection.doc-print table.top_info .ident{\npadding:0 10px !important;\n}\n.italic-text{\nfont-style:italic;\n}\nsection.doc-print div.ua_currency_convert div.num-date-doc{\nmargin:0 0 2px 0;\n}\nsection.doc-print div.ua_currency_convert div.text{\npadding:1px 5px 0 10px;\n}\nsection.doc-print p{\nmargin-top:0;\nfont-size:inherit !important;\n}\nsection.doc-print div.ua_currency_convert table:not(.serv-info-table){\nborder-collapse:collapse;\nmargin-top:2px;\n}\nsection.doc-print div.ua_currency_convert table td{\npadding:3px !important;\nvertical-align:top;\n}\nsection.doc-print div.ua_currency_convert .eng_info{\nfont-size:5pt;\n}\nsection.doc-print div.ua_currency_convert .ua_info{\nfont-size:6pt;\n}\nsection.doc-print div.ua_currency_convert .banks-remarks tr{\nheight:1.5em;;\n}\nsection.doc-print article div,section.doc-print div td,section.doc-print div span{\nfont-family:'Times Roman','Times New Roman',Georgia,serif;\nfont-size:7pt;\n}\nsection.doc-print div.ua_currency_convert div + div.bbordered{\noverflow:hidden;\n}\ndiv.num-date-doc div.bbordered{\ndisplay:inline;\n}\nsection.doc-print table.serv-info-table td{\npadding:2px 1px 2px 5px !important;\nfont-size:8pt;\n}\nsection.doc-print div.for-img img{\ntop:12px !important;\n}\nsection.doc-print div.ua_currency_convert div.footer{\nbottom:0;\nposition:absolute;\nmargin:0 5mm 6mm 0;\n}\nsection.doc-print .border{\nborder:1px solid black;\n}\nsection.doc-print .sign_column_1{\nwidth:41.7%;\n}\nsection.doc-print div.ua_currency_convert table td.seal{\nwidth:20.6%;\nvertical-align:middle;\n}\nsection.doc-print .sign_column_2{\nwidth:37.7%;\n}\nsection.doc-print td.sign{\npadding:0 0.5em !important;\ntext-align:center;\nvertical-align:top;\n}\nsection.doc-print table.sign td{\nheight:20px;\nborder-right:none;\nborder-left:none;\nborder-top:1px solid black;\nborder-bottom:1px solid black;\n}\nsection.doc-print div.sign1,section.doc-print div.sign2{\nheight:2.2em;\nline-height:2.2em;\n}\nsection.doc-print div.sign1 span,section.doc-print div.sign2 span{\nfont-size:1em;\nline-height:1;\n}\nsection.doc-print div.ua_currency_convert table.serv-info-table td{\npadding:2px 1px 2px 5px !important;\n}\n"}),define("apps/ua_currency_convert/ua_currency_convert_print",["jquery","underscore","bifit","printUtils","appsPieces","commons/base_object/document/document_print_processor","text!apps/ua_currency_convert/templates/ua_currency_convert_print.tmpl","text!apps/ua_currency_convert/templates/ua_currency_convert_print_pdf.tmpl","text!apps/ua_currency_convert/css/ua_currency_convert_print.css"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a,b){f.call(this,a,b,i,h)}return j.prototype=Object.create(f.prototype),j.prototype.constructor=j,j.prototype.renderDocument=function(a,f){f.append('<div id="doc-div-'+a.id+'" class="doc-div"></div>');var h=f[0].querySelector("#doc-div-"+a.id);h.className=h.className+" "+a.type,h.innerHTML=b.template(g)(a.toJSON());var i=d.getNumDateStr(a.get("NUM_DOC"),a.get("DATE_DOC"));h.querySelector(".num-date-doc").innerHTML=i.replace("від","ВІД/DATED").replace("року","р.");var j=e.getMixedBankInfo(a.get("BNK_MFO")).then(function(a){h.querySelector(".ua_bank_info").innerHTML=a.name+", "+a.addr+" (далі - Банк)",h.querySelector(".eng_bank_info").innerHTML=a.nameLatin+", "+a.addrLatin+' (hereinafter - the "Bank")'});this.printPromises.push(j);var k=["за курсом","по курсу","за курсом не вище, нiж","по курсу не выше, чем"];h.querySelector(".purchase-rate").innerText=b.contains(k,a.get("PURCHASE_RATE_KIND"))?a.get("PURCHASE_RATE").replace(".",","):"за курсом уповноваженого банку";var l=function(a,b,e){a&&0!==b.length&&(h.querySelector("."+e+"-sum-words").innerText=d.amountToWords(c.removeThousandSeparator(b),a),h.querySelector("."+e+"-sum-digits").innerText=b.replace(".",","))},m=e.getCurrencies().then(function(c){var d=b.findWhere(c,{currency:a.get("SALE_CURRENCY")}),e=b.findWhere(c,{currency:a.get("PURCHASE_CURRENCY")}),f=a.toFormattedJSON();l(e,f.PURCHASE_SUM,"purchase"),l(d,f.SALE_SUM,"sale")});this.printPromises.push(m),this.printPromises.push(d.addDocumentAdditionalInfo(h,a))},function(a){d.createPrintFormForPdf().then(function(b){var c=new j(b,a[0].type);c.run(a)})}}),define("apps/ua_currency_convert/base_ua_currency_convert_controller",["jquery","underscore","backbone","app","bifit","appsPieces","thesaurusUtils","collections/thesaurus","services/doc_permissions","commons/base_object/document/group_opers_document_controller","apps/ua_currency_convert/ua_currency_convert_model","apps/ua_currency_convert/ua_currency_convert_list_view","apps/ua_currency_convert/ua_currency_convert_filter_view","apps/ua_currency_convert/ua_currency_convert_item_view","apps/ua_currency_convert/ua_currency_convert_item_edit","apps/ua_currency_convert/ua_currency_convert_print","text!apps/ua_currency_convert/templates/ua_currency_convert_list_item.tmpl","i18n!apps/ua_currency_convert/nls/ua_currency_convert"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";var s=function(a){return f.getRatePrecision(a,"convert")},t=function(a,b){return f.getClientOrBankParam(a+".ua_currency_convert.convert_bnk_account",b)},u=function(a,b){return g.getClientProp(a,b)},v=j.extend({tabsStatuses:{work:"0,1,2,3,4,6",executed:"5",selectedTab:"work"},Model:k,ListView:l,FilterView:m,View:n,Edit:o,docType:"ua_currency_convert",nls:r,listItemTemplate:q,aliases:null,viewDocumentOptions:function(){var a=j.prototype.viewDocumentOptions.call(this);return a.currencies=f.getCurrencies(),a.getRatePrecision=s,this.customViewDocumentOptions(a),a},showDocumentEdit:function(a,b){h.getThesaurus("account_alias",!1).fetch().done(function(c){this.aliases=c,j.prototype.showDocumentEdit.call(this,a,b)}.bind(this))},prepareContent:function(c){var d=j.prototype.prepareContent.call(this,c);return a.when(d).then(function(a){var c=b.findWhere(h.getThesaurus("bank_branches").array,{bik:a.BNK_MFO});return c&&(a.BNK_NAME=c.name),a})},editDocumentOptions:function(){var b=j.prototype.editDocumentOptions.call(this),c=a.Deferred();return f.setAccountComments(f.getAccounts()).done(function(a){b.accounts=a,b.banks=f.getBanks(),b.currencies=f.getCurrencies(),b.docType=this.docType,b.getClientProp=u,b.getBankAccount=t,b.getRatePrecision=s,this.customEditDocumentOptions(b),c.resolve(b)}.bind(this)),c},reloadDocumentsList:function(a){d.mainLayout.actionBar.show(this.createActionBar(this.actionsList)),j.prototype.reloadDocumentsList.call(this,a)},prepareContent4Create:function(a){var c=j.prototype.prepareContent4Create.call(this,a),d=this;return c.then(function(a){var c=f.getAccounts(),g=b.without(b.keys(c),"UAH"),h=a.SALE_CURRENCY||e.getStorageDocData("SALE_CURRENCY");h=b.contains(g,h)?h:g[0];var i=c[h],j=f.findAccount(i,a,"SALE_ACCOUNT",d.docType+"_sale_account");if(!a.SALE_ACCOUNT&&j){var k=b.findWhere(f.getBanks(),{bik:j.mfo});a.BNK_NAME=k.name,a.BNK_ADDR=k.address,a.BNK_MFO=j.mfo,a.SALE_ACCOUNT=j.account,a.SALE_CURRENCY=h,this.prepareCustomFields4Create(a,k)}else j||(a.SALE_CURRENCY=h);g=b.without(g,(j||{}).currency||"");var l=a.PURCHASE_CURRENCY||e.getStorageDocData("PURCHASE_CURRENCY");if(l=b.contains(g,l)?l:g[0],i=a.BNK_MFO?b.where(c[l],{mfo:a.BNK_MFO}):c[l],j=f.findAccount(i,a,"PURCHASE_ACCOUNT",d.docType+"_purchase_account"),!a.PURCHASE_ACCOUNT&&j&&(a.PURCHASE_CURRENCY=l,a.PURCHASE_ACCOUNT=j.account),!a.COMMISSION_ACCOUNT){var m=e.getStorageDocData(this.docType+"_commission_account"),n=b.findWhere(c.UAH,{account_id:m});n&&(a.COMMISSION_ACCOUNT=n.account)}return a}.bind(this))},parseFile4Import:function(c){var d=a.Deferred(),e=j.prototype.parseFile4Import.call(this,c);return e.done(function(a){b.each(a,function(a){if(a.BNK_MFO){var c=b.findWhere(f.getBanks(),{bik:a.BNK_MFO});c&&(a.BNK_ADDR=c.address,a.BNK_NAME=c.name)}}),d.resolve(a)}).fail(d.reject),d},PRINT:function(){this.printDocs([this.selectedModel])},printDocs:function(a){p(a,f.getCurrencies(),s)},isAccountsForCreateAction:function(){var a,c,d,e=b.filter(h.getThesaurus("accs_info").array,function(a){return a.permissions>0&&"1"===a.type&&"2"===a.status}),f=b.groupBy(e,"mfo"),g=b.any(f,function(e){return a=b.groupBy(e,"currency"),c=a.UAH,d=b.without(b.keys(a),"UAH"),c&&c.length>0&&d&&d.length>1});return g},getNoAccErrorText:function(){return b.without(b.keys(f.getAccounts()),"UAH").length>0?r.no_uah_accs:r.no_cur_accs},getWorkContent:function(a){var b=j.prototype.getWorkContent.call(this,a);return b.ATT_CNT="0",b}});return v.getClientProp=u,v.getBankAccount=t,v}),define("apps/ua_currency_convert/ua_currency_convert_controller",["jquery","underscore","bifit","appsPieces","collections/thesaurus","apps/ua_currency_convert/base_ua_currency_convert_controller","i18n!apps/ua_currency_convert/nls/ua_currency_convert"],function(a,b,c,d,e,f,g){var h=[{id:"1",label:g.rate0_label,value:g.rate0},{id:"2",label:g.rate1_label,value:g.rate1}];return f.extend({customViewDocumentOptions:function(a){a.rates=h},customEditDocumentOptions:function(a){a.rates=d.getAvailableRates(h)},prepareContent:function(i){var j=f.prototype.prepareContent.call(this,i);return j.then(function(f){var i=a.Deferred(),j=e.getThesaurus("clients").array[0];f.CLN_NAME=j.name_cln,f.CLN_ADDR=j.addr_cln,f.CLN_PHONES=j.phone_cln,f.CLN_OKPO=j.okpo;var k=f.PURCHASE_RATE_KIND||b.last(d.getAvailableRates(h)).value;"по курсу банка"!==k&&"за курсом банку"!==k||(k=g.rate1_label),f.SALE_SUM=f.SALE_SUM?c.roundFloat(f.SALE_SUM,4):"",f.PURCHASE_RATE=f.PURCHASE_RATE?c.changeFloatScale(f.PURCHASE_RATE,6):"",f.COMMISSION=f.COMMISSION?c.changeFloatScale(f.COMMISSION,2):"",f.PURCHASE_SUM=f.PURCHASE_SUM?c.roundFloat(f.PURCHASE_SUM,4):"";var l=c.translate("ua_currency_convert",k),m=c.translate("ua_currency_convert",f.TRANSIT_KIND||g.transit_kind);a.when(l,m).done(function(a,b){f.PURCHASE_RATE_KIND=a,f.TRANSIT_KIND=b,f.PURCHASE_RATE_KIND===g.rate0?f.OPER_TYPE=f.PURCHASE_SUM&&f.SALE_SUM&&!f.OPER_TYPE?"1":f.OPER_TYPE:f.OPER_TYPE="",i.resolve(f)});var n=["TRANSIT_ACCOUNT","TRANSIT_BNK_MFO","TRANSIT_BNK_NAME","TRANSIT_BNK_ADDR"];return b.each(n,function(a){f[a]=""}),i.promise()})},prepareContent4Import:function(b){return a.when(b).then(function(a){return"en"===localStorage.getItem("locale")&&(a.PURCHASE_RATE_KIND=this.translatePurchaseRateKind(a)),a}.bind(this))},prepareContent4Save:function(b){return a.when(b).then(function(a){return"en"===localStorage.getItem("locale")&&(a.PURCHASE_RATE_KIND=this.translatePurchaseRateKind(a)),a}.bind(this))},translatePurchaseRateKind:function(a){var c=b.findWhere(h,{label:a.PURCHASE_RATE_KIND});return c?c.value:a.PURCHASE_RATE_KIND},prepareContent4Edit:function(a){var b=f.prototype.prepareContent4Edit.call(this,a);return b.then(function(a){return c.translate("ua_currency_convert",a.PURCHASE_RATE_KIND,function(b){a.PURCHASE_RATE_KIND=b}),c.translate("ua_currency_convert",a.TRANSIT_KIND,function(b){a.TRANSIT_KIND=b}),a})},prepareContent4View:function(b){var d=a.Deferred(),e=f.prototype.createContentDeferred.call(this,b);return e.then(function(a){c.translate("ua_currency_convert",a.PURCHASE_RATE_KIND,function(b){a.PURCHASE_RATE_KIND=b,d.resolve(a)},this)}.bind(this)),d},prepareCustomFields4Create:function(a,b){a.RETURN_ACCOUNT=a.SALE_ACCOUNT},getContentFromForm:function(){var c=f.prototype.getContentFromForm.call(this),d={SALE_SUM:4,PURCHASE_RATE:6,PURCHASE_SUM:4};return b.each(d,function(b,d){var e=a("#"+d).getUnformattedValue();c[d]=e?parseFloat(e).toFixed(b):""}),b.each(["PURCHASE_ACCOUNT","SALE_ACCOUNT","COMMISSION_ACCOUNT","RETURN_ACCOUNT"],function(a){delete c[a]}),c}})}),function(a){var b=document,c="appendChild",d="styleSheet",e=b.createElement("style");e.type="text/css",b.getElementsByTagName("head")[0][c](e),e[d]?e[d].cssText=a:e[c](b.createTextNode(a))}("#ext_filter .ua_currency_convert #expanded-view{\nwidth:40.5em;\n}\n#ext_filter .ua_currency_convert #expanded-view div.arrow{\nbackground-repeat:no-repeat;\nbackground-position:center;\nheight:1.6em;\n}\narticle#content.main .doc-wrapper.ua_currency_convert{\nmax-width:30em;\nwidth:30em;\n}\n.ua_currency_convert.doc-wrapper h1 + div > div.amount{\nwidth:100%;\n}\n.ua_currency_convert div.inline-block{\ndisplay:inline-block;\nposition:relative;\nvertical-align:middle;\n}\n.ua_currency_convert div.amount input.currency{\nwidth:60px;\n}\n.ua_currency_convert input.transfer-kind{\nwidth:16em;\n}\n.ua_currency_convert div.transfer-kind div.chosen{\nvertical-align:top;\n}\n.ua_currency_convert div.commission div:first-child{\nfloat:left;\n}\n.ua_currency_convert div.purchase div:first-child{\nmargin-right:0.5em;\n}\narticle.main .ua_currency_convert div.arrow,#aside-right-list td.mobile div.arrow{\ndisplay:inline-block;\nmargin:0 0.7em;\nheight:10px;\nvertical-align:middle;\nwidth:13px;\n}\n.ua_currency_convert div.currencies{\nmargin-left:2em;\n}\n.ua_currency_convert div.currencies > *:not(:first-child){\nmargin-left:0.5em;\n}\n.ua_currency_convert div.additional div.exp-date{\nfloat:right;\n}\n.ua_currency_convert div.additional div.date-doc{\nfloat:right;\nclear:none;\n}\n.ua_currency_convert label span.currency{\nmargin:0 0.25em;\n}\n.ua_currency_convert.doc-wrapper label + input.fio{\ndisplay:inline;\nwidth:23em;\n}\n.ua_currency_convert.doc-wrapper input.fio + input.phone{\nmargin-left:0.25em;\nwidth:13em;\n}\n.ua_currency_convert.doc-wrapper input#SALE_RATE_KIND{\nwidth:11em;\n}\n.ua_currency_convert.doc-wrapper input#TRANSFER_KIND{\nwidth:17.5em;\n}\n.ua_currency_convert.doc-wrapper input.commission.amount{\nwidth:10.5em;\nmargin-right:0.9em;\n}\n.ua_currency_convert.doc-wrapper textarea{\nwidth:100%;\n}\n.ua_currency_convert input.currency{\nwidth:4.7em;\n}\n.ua_currency_convert .container .amount.calc:last-child{\nwidth:8em;\n}\n.ua_currency_convert div.sale-rate .error-tooltip{\nleft:155px;\n}\n.ua_currency_convert .amount-wrapper{\ndisplay:inline-block;\nvertical-align:top;\n}\ntable.list.ua_currency_convert th.currency{\nwhite-space:nowrap;\n}\n.ua_currency_convert div.additional{\nmargin-bottom:0em;\n}\n.ua_currency_convert div.additional + div.container{\nmargin-top:0em;\n}\ntable.ua_currency_convert tr th.number{\nwidth:7%;\n}\ntable.ua_currency_convert tr th.amount,\ntable.ua_currency_convert tr th.status{\nwidth:12%;\n}\ntable.ua_currency_convert .currency{\nwidth:15%;\n}\n.ua_currency_convert .sale-bnk-account{\ndisplay:inline-block;\nmargin-left:0.5em;\n}\n.ua_currency_convert div.datepicker-container{\nposition:relative;\n//margin-left:8px;\n}\n.ua_currency_convert div.datepicker-container > span.datepicker{\ntop:0.313em;\n}\n.ua_currency_convert label{\nmargin-bottom:0.25em !important;\n}\n.ua_currency_convert #status_desc{\nmargin-bottom:1em;\n}\n.ua_currency_convert label.date-doc{\n//margin-left:8px;\n}\n.ua_currency_convert label.currency{\nheight:26px;\nline-height:26px;\ntext-align:center;\nmargin-bottom:0 !important;\n}\n.ua_currency_convert input.currency{\nwidth:100%;\n}\n.ua_currency_convert div.sale-rate .error-tooltip{\nleft:0;\n}");